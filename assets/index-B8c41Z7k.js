var lie=Object.defineProperty;var cie=(t,e,r)=>e in t?lie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var uie=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var gm=(t,e,r)=>cie(t,typeof e!="symbol"?e+"":e,r);var hje=uie((Cje,sb)=>{function fie(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var dF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function KM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ME={exports:{}},vm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pF;function hie(){if(pF)return vm;pF=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var a in i)a!=="key"&&(s[a]=i[a])}else s=i;return i=s.ref,{$$typeof:t,type:n,key:o,ref:i!==void 0?i:null,props:s}}return vm.Fragment=e,vm.jsx=r,vm.jsxs=r,vm}var mF;function die(){return mF||(mF=1,ME.exports=hie()),ME.exports}var I=die(),DE={exports:{}},Pt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gF;function pie(){if(gF)return Pt;gF=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function m(K){return K===null||typeof K!="object"?null:(K=d&&K[d]||K["@@iterator"],typeof K=="function"?K:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,x={};function b(K,ce,S){this.props=K,this.context=ce,this.refs=x,this.updater=S||g}b.prototype.isReactComponent={},b.prototype.setState=function(K,ce){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,ce,"setState")},b.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function C(){}C.prototype=b.prototype;function E(K,ce,S){this.props=K,this.context=ce,this.refs=x,this.updater=S||g}var R=E.prototype=new C;R.constructor=E,y(R,b.prototype),R.isPureReactComponent=!0;var k=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function D(K,ce,S,A,M,L){return S=L.ref,{$$typeof:t,type:K,key:ce,ref:S!==void 0?S:null,props:L}}function H(K,ce){return D(K.type,ce,void 0,void 0,void 0,K.props)}function N(K){return typeof K=="object"&&K!==null&&K.$$typeof===t}function _(K){var ce={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(S){return ce[S]})}var B=/\/+/g;function j(K,ce){return typeof K=="object"&&K!==null&&K.key!=null?_(""+K.key):ce.toString(36)}function ee(){}function oe(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(ee,ee):(K.status="pending",K.then(function(ce){K.status==="pending"&&(K.status="fulfilled",K.value=ce)},function(ce){K.status==="pending"&&(K.status="rejected",K.reason=ce)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function re(K,ce,S,A,M){var L=typeof K;(L==="undefined"||L==="boolean")&&(K=null);var V=!1;if(K===null)V=!0;else switch(L){case"bigint":case"string":case"number":V=!0;break;case"object":switch(K.$$typeof){case t:case e:V=!0;break;case h:return V=K._init,re(V(K._payload),ce,S,A,M)}}if(V)return M=M(K),V=A===""?"."+j(K,0):A,k(M)?(S="",V!=null&&(S=V.replace(B,"$&/")+"/"),re(M,ce,S,"",function(ue){return ue})):M!=null&&(N(M)&&(M=H(M,S+(M.key==null||K&&K.key===M.key?"":(""+M.key).replace(B,"$&/")+"/")+V)),ce.push(M)),1;V=0;var J=A===""?".":A+":";if(k(K))for(var ae=0;ae<K.length;ae++)A=K[ae],L=J+j(A,ae),V+=re(A,ce,S,L,M);else if(ae=m(K),typeof ae=="function")for(K=ae.call(K),ae=0;!(A=K.next()).done;)A=A.value,L=J+j(A,ae++),V+=re(A,ce,S,L,M);else if(L==="object"){if(typeof K.then=="function")return re(oe(K),ce,S,A,M);throw ce=String(K),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return V}function q(K,ce,S){if(K==null)return K;var A=[],M=0;return re(K,A,"","",function(L){return ce.call(S,L,M++)}),A}function Z(K){if(K._status===-1){var ce=K._result;ce=ce(),ce.then(function(S){(K._status===0||K._status===-1)&&(K._status=1,K._result=S)},function(S){(K._status===0||K._status===-1)&&(K._status=2,K._result=S)}),K._status===-1&&(K._status=0,K._result=ce)}if(K._status===1)return K._result.default;throw K._result}var ve=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)};function ie(){}return Pt.Children={map:q,forEach:function(K,ce,S){q(K,function(){ce.apply(this,arguments)},S)},count:function(K){var ce=0;return q(K,function(){ce++}),ce},toArray:function(K){return q(K,function(ce){return ce})||[]},only:function(K){if(!N(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Pt.Component=b,Pt.Fragment=r,Pt.Profiler=i,Pt.PureComponent=E,Pt.StrictMode=n,Pt.Suspense=l,Pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Pt.__COMPILER_RUNTIME={__proto__:null,c:function(K){return O.H.useMemoCache(K)}},Pt.cache=function(K){return function(){return K.apply(null,arguments)}},Pt.cloneElement=function(K,ce,S){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var A=y({},K.props),M=K.key,L=void 0;if(ce!=null)for(V in ce.ref!==void 0&&(L=void 0),ce.key!==void 0&&(M=""+ce.key),ce)!P.call(ce,V)||V==="key"||V==="__self"||V==="__source"||V==="ref"&&ce.ref===void 0||(A[V]=ce[V]);var V=arguments.length-2;if(V===1)A.children=S;else if(1<V){for(var J=Array(V),ae=0;ae<V;ae++)J[ae]=arguments[ae+2];A.children=J}return D(K.type,M,void 0,void 0,L,A)},Pt.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:s,_context:K},K},Pt.createElement=function(K,ce,S){var A,M={},L=null;if(ce!=null)for(A in ce.key!==void 0&&(L=""+ce.key),ce)P.call(ce,A)&&A!=="key"&&A!=="__self"&&A!=="__source"&&(M[A]=ce[A]);var V=arguments.length-2;if(V===1)M.children=S;else if(1<V){for(var J=Array(V),ae=0;ae<V;ae++)J[ae]=arguments[ae+2];M.children=J}if(K&&K.defaultProps)for(A in V=K.defaultProps,V)M[A]===void 0&&(M[A]=V[A]);return D(K,L,void 0,void 0,null,M)},Pt.createRef=function(){return{current:null}},Pt.forwardRef=function(K){return{$$typeof:a,render:K}},Pt.isValidElement=N,Pt.lazy=function(K){return{$$typeof:h,_payload:{_status:-1,_result:K},_init:Z}},Pt.memo=function(K,ce){return{$$typeof:u,type:K,compare:ce===void 0?null:ce}},Pt.startTransition=function(K){var ce=O.T,S={};O.T=S;try{var A=K(),M=O.S;M!==null&&M(S,A),typeof A=="object"&&A!==null&&typeof A.then=="function"&&A.then(ie,ve)}catch(L){ve(L)}finally{O.T=ce}},Pt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Pt.use=function(K){return O.H.use(K)},Pt.useActionState=function(K,ce,S){return O.H.useActionState(K,ce,S)},Pt.useCallback=function(K,ce){return O.H.useCallback(K,ce)},Pt.useContext=function(K){return O.H.useContext(K)},Pt.useDebugValue=function(){},Pt.useDeferredValue=function(K,ce){return O.H.useDeferredValue(K,ce)},Pt.useEffect=function(K,ce,S){var A=O.H;if(typeof S=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return A.useEffect(K,ce)},Pt.useId=function(){return O.H.useId()},Pt.useImperativeHandle=function(K,ce,S){return O.H.useImperativeHandle(K,ce,S)},Pt.useInsertionEffect=function(K,ce){return O.H.useInsertionEffect(K,ce)},Pt.useLayoutEffect=function(K,ce){return O.H.useLayoutEffect(K,ce)},Pt.useMemo=function(K,ce){return O.H.useMemo(K,ce)},Pt.useOptimistic=function(K,ce){return O.H.useOptimistic(K,ce)},Pt.useReducer=function(K,ce,S){return O.H.useReducer(K,ce,S)},Pt.useRef=function(K){return O.H.useRef(K)},Pt.useState=function(K){return O.H.useState(K)},Pt.useSyncExternalStore=function(K,ce,S){return O.H.useSyncExternalStore(K,ce,S)},Pt.useTransition=function(){return O.H.useTransition()},Pt.version="19.1.0",Pt}var vF;function XM(){return vF||(vF=1,DE.exports=pie()),DE.exports}var Y=XM();const Kt=KM(Y),bO=fie({__proto__:null,default:Kt},[Y]);var PE={exports:{}},ym={},IE={exports:{}},NE={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yF;function mie(){return yF||(yF=1,function(t){function e(q,Z){var ve=q.length;q.push(Z);e:for(;0<ve;){var ie=ve-1>>>1,K=q[ie];if(0<i(K,Z))q[ie]=Z,q[ve]=K,ve=ie;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var Z=q[0],ve=q.pop();if(ve!==Z){q[0]=ve;e:for(var ie=0,K=q.length,ce=K>>>1;ie<ce;){var S=2*(ie+1)-1,A=q[S],M=S+1,L=q[M];if(0>i(A,ve))M<K&&0>i(L,A)?(q[ie]=L,q[M]=ve,ie=M):(q[ie]=A,q[S]=ve,ie=S);else if(M<K&&0>i(L,ve))q[ie]=L,q[M]=ve,ie=M;else break e}}return Z}function i(q,Z){var ve=q.sortIndex-Z.sortIndex;return ve!==0?ve:q.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,d=null,m=3,g=!1,y=!1,x=!1,b=!1,C=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function k(q){for(var Z=r(u);Z!==null;){if(Z.callback===null)n(u);else if(Z.startTime<=q)n(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=r(u)}}function O(q){if(x=!1,k(q),!y)if(r(l)!==null)y=!0,P||(P=!0,j());else{var Z=r(u);Z!==null&&re(O,Z.startTime-q)}}var P=!1,D=-1,H=5,N=-1;function _(){return b?!0:!(t.unstable_now()-N<H)}function B(){if(b=!1,P){var q=t.unstable_now();N=q;var Z=!0;try{e:{y=!1,x&&(x=!1,E(D),D=-1),g=!0;var ve=m;try{t:{for(k(q),d=r(l);d!==null&&!(d.expirationTime>q&&_());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,m=d.priorityLevel;var K=ie(d.expirationTime<=q);if(q=t.unstable_now(),typeof K=="function"){d.callback=K,k(q),Z=!0;break t}d===r(l)&&n(l),k(q)}else n(l);d=r(l)}if(d!==null)Z=!0;else{var ce=r(u);ce!==null&&re(O,ce.startTime-q),Z=!1}}break e}finally{d=null,m=ve,g=!1}Z=void 0}}finally{Z?j():P=!1}}}var j;if(typeof R=="function")j=function(){R(B)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,oe=ee.port2;ee.port1.onmessage=B,j=function(){oe.postMessage(null)}}else j=function(){C(B,0)};function re(q,Z){D=C(function(){q(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(q){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var ve=m;m=Z;try{return q()}finally{m=ve}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(q,Z){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ve=m;m=q;try{return Z()}finally{m=ve}},t.unstable_scheduleCallback=function(q,Z,ve){var ie=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ie+ve:ie):ve=ie,q){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ve+K,q={id:h++,callback:Z,priorityLevel:q,startTime:ve,expirationTime:K,sortIndex:-1},ve>ie?(q.sortIndex=ve,e(u,q),r(l)===null&&q===r(u)&&(x?(E(D),D=-1):x=!0,re(O,ve-ie))):(q.sortIndex=K,e(l,q),y||g||(y=!0,P||(P=!0,j()))),q},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(q){var Z=m;return function(){var ve=m;m=Z;try{return q.apply(this,arguments)}finally{m=ve}}}}(NE)),NE}var xF;function gie(){return xF||(xF=1,IE.exports=mie()),IE.exports}var LE={exports:{}},$i={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wF;function vie(){if(wF)return $i;wF=1;var t=XM();function e(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(l,u,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:d==null?null:""+d,children:l,containerInfo:u,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return $i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,$i.createPortal=function(l,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return s(l,u,null,h)},$i.flushSync=function(l){var u=o.T,h=n.p;try{if(o.T=null,n.p=2,l)return l()}finally{o.T=u,n.p=h,n.d.f()}},$i.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(l,u))},$i.prefetchDNS=function(l){typeof l=="string"&&n.d.D(l)},$i.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var h=u.as,d=a(h,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,g=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?n.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:d,integrity:m,fetchPriority:g}):h==="script"&&n.d.X(l,{crossOrigin:d,integrity:m,fetchPriority:g,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},$i.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=a(u.as,u.crossOrigin);n.d.M(l,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(l)},$i.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,d=a(h,u.crossOrigin);n.d.L(l,h,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},$i.preloadModule=function(l,u){if(typeof l=="string")if(u){var h=a(u.as,u.crossOrigin);n.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(l)},$i.requestFormReset=function(l){n.d.r(l)},$i.unstable_batchedUpdates=function(l,u){return l(u)},$i.useFormState=function(l,u,h){return o.H.useFormState(l,u,h)},$i.useFormStatus=function(){return o.H.useHostTransitionStatus()},$i.version="19.1.0",$i}var bF;function G7(){if(bF)return LE.exports;bF=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),LE.exports=vie(),LE.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SF;function yie(){if(SF)return ym;SF=1;var t=gie(),e=XM(),r=G7();function n(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function s(c){var f=c,p=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(p=f.return),c=f.return;while(c)}return f.tag===3?p:null}function o(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function a(c){if(s(c)!==c)throw Error(n(188))}function l(c){var f=c.alternate;if(!f){if(f=s(c),f===null)throw Error(n(188));return f!==c?null:c}for(var p=c,v=f;;){var w=p.return;if(w===null)break;var T=w.alternate;if(T===null){if(v=w.return,v!==null){p=v;continue}break}if(w.child===T.child){for(T=w.child;T;){if(T===p)return a(w),c;if(T===v)return a(w),f;T=T.sibling}throw Error(n(188))}if(p.return!==v.return)p=w,v=T;else{for(var F=!1,U=w.child;U;){if(U===p){F=!0,p=w,v=T;break}if(U===v){F=!0,v=w,p=T;break}U=U.sibling}if(!F){for(U=T.child;U;){if(U===p){F=!0,p=T,v=w;break}if(U===v){F=!0,v=T,p=w;break}U=U.sibling}if(!F)throw Error(n(189))}}if(p.alternate!==v)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?c:f}function u(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c;for(c=c.child;c!==null;){if(f=u(c),f!==null)return f;c=c.sibling}return null}var h=Object.assign,d=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),R=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),_=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function j(c){return c===null||typeof c!="object"?null:(c=B&&c[B]||c["@@iterator"],typeof c=="function"?c:null)}var ee=Symbol.for("react.client.reference");function oe(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===ee?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case y:return"Fragment";case b:return"Profiler";case x:return"StrictMode";case O:return"Suspense";case P:return"SuspenseList";case N:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case g:return"Portal";case R:return(c.displayName||"Context")+".Provider";case E:return(c._context.displayName||"Context")+".Consumer";case k:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case D:return f=c.displayName||null,f!==null?f:oe(c.type)||"Memo";case H:f=c._payload,c=c._init;try{return oe(c(f))}catch{}}return null}var re=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},ie=[],K=-1;function ce(c){return{current:c}}function S(c){0>K||(c.current=ie[K],ie[K]=null,K--)}function A(c,f){K++,ie[K]=c.current,c.current=f}var M=ce(null),L=ce(null),V=ce(null),J=ce(null);function ae(c,f){switch(A(V,f),A(L,c),A(M,null),f.nodeType){case 9:case 11:c=(c=f.documentElement)&&(c=c.namespaceURI)?j3(c):0;break;default:if(c=f.tagName,f=f.namespaceURI)f=j3(f),c=W3(f,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}S(M),A(M,c)}function ue(){S(M),S(L),S(V)}function pe(c){c.memoizedState!==null&&A(J,c);var f=M.current,p=W3(f,c.type);f!==p&&(A(L,c),A(M,p))}function ke(c){L.current===c&&(S(M),S(L)),J.current===c&&(S(J),fm._currentValue=ve)}var z=Object.prototype.hasOwnProperty,Be=t.unstable_scheduleCallback,Fe=t.unstable_cancelCallback,ze=t.unstable_shouldYield,Ge=t.unstable_requestPaint,Ee=t.unstable_now,Ue=t.unstable_getCurrentPriorityLevel,st=t.unstable_ImmediatePriority,tt=t.unstable_UserBlockingPriority,at=t.unstable_NormalPriority,je=t.unstable_LowPriority,er=t.unstable_IdlePriority,Nt=t.log,jt=t.unstable_setDisableYieldValue,Dt=null,Et=null;function Ct(c){if(typeof Nt=="function"&&jt(c),Et&&typeof Et.setStrictMode=="function")try{Et.setStrictMode(Dt,c)}catch{}}var Rt=Math.clz32?Math.clz32:Lt,Xe=Math.log,Je=Math.LN2;function Lt(c){return c>>>=0,c===0?32:31-(Xe(c)/Je|0)|0}var nt=256,ct=4194304;function ar(c){var f=c&42;if(f!==0)return f;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function vn(c,f,p){var v=c.pendingLanes;if(v===0)return 0;var w=0,T=c.suspendedLanes,F=c.pingedLanes;c=c.warmLanes;var U=v&134217727;return U!==0?(v=U&~T,v!==0?w=ar(v):(F&=U,F!==0?w=ar(F):p||(p=U&~c,p!==0&&(w=ar(p))))):(U=v&~T,U!==0?w=ar(U):F!==0?w=ar(F):p||(p=v&~c,p!==0&&(w=ar(p)))),w===0?0:f!==0&&f!==w&&(f&T)===0&&(T=w&-w,p=f&-f,T>=p||T===32&&(p&4194048)!==0)?f:w}function Br(c,f){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&f)===0}function qr(c,f){switch(c){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wn(){var c=nt;return nt<<=1,(nt&4194048)===0&&(nt=256),c}function Ai(){var c=ct;return ct<<=1,(ct&62914560)===0&&(ct=4194304),c}function ga(c){for(var f=[],p=0;31>p;p++)f.push(c);return f}function ii(c,f){c.pendingLanes|=f,f!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function So(c,f,p,v,w,T){var F=c.pendingLanes;c.pendingLanes=p,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=p,c.entangledLanes&=p,c.errorRecoveryDisabledLanes&=p,c.shellSuspendCounter=0;var U=c.entanglements,le=c.expirationTimes,we=c.hiddenUpdates;for(p=F&~p;0<p;){var Oe=31-Rt(p),De=1<<Oe;U[Oe]=0,le[Oe]=-1;var be=we[Oe];if(be!==null)for(we[Oe]=null,Oe=0;Oe<be.length;Oe++){var Se=be[Oe];Se!==null&&(Se.lane&=-536870913)}p&=~De}v!==0&&Xa(c,v,0),T!==0&&w===0&&c.tag!==0&&(c.suspendedLanes|=T&~(F&~f))}function Xa(c,f,p){c.pendingLanes|=f,c.suspendedLanes&=~f;var v=31-Rt(f);c.entangledLanes|=f,c.entanglements[v]=c.entanglements[v]|1073741824|p&4194090}function Or(c,f){var p=c.entangledLanes|=f;for(c=c.entanglements;p;){var v=31-Rt(p),w=1<<v;w&f|c[v]&f&&(c[v]|=f),p&=~w}}function zi(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function yt(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function On(){var c=Z.p;return c!==0?c:(c=window.event,c===void 0?32:aF(c.type))}function We(c,f){var p=Z.p;try{return Z.p=c,f()}finally{Z.p=p}}var qe=Math.random().toString(36).slice(2),ut="__reactFiber$"+qe,ht="__reactProps$"+qe,Ot="__reactContainer$"+qe,hn="__reactEvents$"+qe,Ts="__reactListeners$"+qe,W="__reactHandles$"+qe,te="__reactResources$"+qe,X="__reactMarker$"+qe;function Q(c){delete c[ut],delete c[ht],delete c[hn],delete c[Ts],delete c[W]}function ne(c){var f=c[ut];if(f)return f;for(var p=c.parentNode;p;){if(f=p[Ot]||p[ut]){if(p=f.alternate,f.child!==null||p!==null&&p.child!==null)for(c=G3(c);c!==null;){if(p=c[ut])return p;c=G3(c)}return f}c=p,p=c.parentNode}return null}function se(c){if(c=c[ut]||c[Ot]){var f=c.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return c}return null}function xe(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c.stateNode;throw Error(n(33))}function Re(c){var f=c[te];return f||(f=c[te]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function ge(c){c[X]=!0}var fe=new Set,G={};function de(c,f){Ce(c,f),Ce(c+"Capture",f)}function Ce(c,f){for(G[c]=f,c=0;c<f.length;c++)fe.add(f[c])}var Ne=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ie={},Le={};function it(c){return z.call(Le,c)?!0:z.call(Ie,c)?!1:Ne.test(c)?Le[c]=!0:(Ie[c]=!0,!1)}function Wt(c,f,p){if(it(f))if(p===null)c.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":c.removeAttribute(f);return;case"boolean":var v=f.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){c.removeAttribute(f);return}}c.setAttribute(f,""+p)}}function tr(c,f,p){if(p===null)c.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(f);return}c.setAttribute(f,""+p)}}function vr(c,f,p,v){if(v===null)c.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(p);return}c.setAttributeNS(f,p,""+v)}}var Vr,va;function ls(c){if(Vr===void 0)try{throw Error()}catch(p){var f=p.stack.trim().match(/\n( *(at )?)/);Vr=f&&f[1]||"",va=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vr+c+va}var ya=!1;function af(c,f){if(!c||ya)return"";ya=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(f){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(Se){var be=Se}Reflect.construct(c,[],De)}else{try{De.call()}catch(Se){be=Se}c.call(De.prototype)}}else{try{throw Error()}catch(Se){be=Se}(De=c())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(Se){if(Se&&be&&typeof Se.stack=="string")return[Se.stack,be.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=v.DetermineComponentFrameRoot(),F=T[0],U=T[1];if(F&&U){var le=F.split(`
`),we=U.split(`
`);for(w=v=0;v<le.length&&!le[v].includes("DetermineComponentFrameRoot");)v++;for(;w<we.length&&!we[w].includes("DetermineComponentFrameRoot");)w++;if(v===le.length||w===we.length)for(v=le.length-1,w=we.length-1;1<=v&&0<=w&&le[v]!==we[w];)w--;for(;1<=v&&0<=w;v--,w--)if(le[v]!==we[w]){if(v!==1||w!==1)do if(v--,w--,0>w||le[v]!==we[w]){var Oe=`
`+le[v].replace(" at new "," at ");return c.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",c.displayName)),Oe}while(1<=v&&0<=w);break}}}finally{ya=!1,Error.prepareStackTrace=p}return(p=c?c.displayName||c.name:"")?ls(p):""}function xa(c){switch(c.tag){case 26:case 27:case 5:return ls(c.type);case 16:return ls("Lazy");case 13:return ls("Suspense");case 19:return ls("SuspenseList");case 0:case 15:return af(c.type,!1);case 11:return af(c.type.render,!1);case 1:return af(c.type,!0);case 31:return ls("Activity");default:return""}}function NN(c){try{var f="";do f+=xa(c),c=c.return;while(c);return f}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Co(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function LN(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function nre(c){var f=LN(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),v=""+c[f];if(!c.hasOwnProperty(f)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var w=p.get,T=p.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return w.call(this)},set:function(F){v=""+F,T.call(this,F)}}),Object.defineProperty(c,f,{enumerable:p.enumerable}),{getValue:function(){return v},setValue:function(F){v=""+F},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function Wy(c){c._valueTracker||(c._valueTracker=nre(c))}function FN(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var p=f.getValue(),v="";return c&&(v=LN(c)?c.checked?"true":"false":c.value),c=v,c!==p?(f.setValue(c),!0):!1}function zy(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var ire=/[\n"\\]/g;function To(c){return c.replace(ire,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function kC(c,f,p,v,w,T,F,U){c.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?c.type=F:c.removeAttribute("type"),f!=null?F==="number"?(f===0&&c.value===""||c.value!=f)&&(c.value=""+Co(f)):c.value!==""+Co(f)&&(c.value=""+Co(f)):F!=="submit"&&F!=="reset"||c.removeAttribute("value"),f!=null?OC(c,F,Co(f)):p!=null?OC(c,F,Co(p)):v!=null&&c.removeAttribute("value"),w==null&&T!=null&&(c.defaultChecked=!!T),w!=null&&(c.checked=w&&typeof w!="function"&&typeof w!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?c.name=""+Co(U):c.removeAttribute("name")}function HN(c,f,p,v,w,T,F,U){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(c.type=T),f!=null||p!=null){if(!(T!=="submit"&&T!=="reset"||f!=null))return;p=p!=null?""+Co(p):"",f=f!=null?""+Co(f):p,U||f===c.value||(c.value=f),c.defaultValue=f}v=v??w,v=typeof v!="function"&&typeof v!="symbol"&&!!v,c.checked=U?c.checked:!!v,c.defaultChecked=!!v,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(c.name=F)}function OC(c,f,p){f==="number"&&zy(c.ownerDocument)===c||c.defaultValue===""+p||(c.defaultValue=""+p)}function Qh(c,f,p,v){if(c=c.options,f){f={};for(var w=0;w<p.length;w++)f["$"+p[w]]=!0;for(p=0;p<c.length;p++)w=f.hasOwnProperty("$"+c[p].value),c[p].selected!==w&&(c[p].selected=w),w&&v&&(c[p].defaultSelected=!0)}else{for(p=""+Co(p),f=null,w=0;w<c.length;w++){if(c[w].value===p){c[w].selected=!0,v&&(c[w].defaultSelected=!0);return}f!==null||c[w].disabled||(f=c[w])}f!==null&&(f.selected=!0)}}function BN(c,f,p){if(f!=null&&(f=""+Co(f),f!==c.value&&(c.value=f),p==null)){c.defaultValue!==f&&(c.defaultValue=f);return}c.defaultValue=p!=null?""+Co(p):""}function VN(c,f,p,v){if(f==null){if(v!=null){if(p!=null)throw Error(n(92));if(re(v)){if(1<v.length)throw Error(n(93));v=v[0]}p=v}p==null&&(p=""),f=p}p=Co(f),c.defaultValue=p,v=c.textContent,v===p&&v!==""&&v!==null&&(c.value=v)}function Zh(c,f){if(f){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=f;return}}c.textContent=f}var sre=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jN(c,f,p){var v=f.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?v?c.setProperty(f,""):f==="float"?c.cssFloat="":c[f]="":v?c.setProperty(f,p):typeof p!="number"||p===0||sre.has(f)?f==="float"?c.cssFloat=p:c[f]=(""+p).trim():c[f]=p+"px"}function WN(c,f,p){if(f!=null&&typeof f!="object")throw Error(n(62));if(c=c.style,p!=null){for(var v in p)!p.hasOwnProperty(v)||f!=null&&f.hasOwnProperty(v)||(v.indexOf("--")===0?c.setProperty(v,""):v==="float"?c.cssFloat="":c[v]="");for(var w in f)v=f[w],f.hasOwnProperty(w)&&p[w]!==v&&jN(c,w,v)}else for(var T in f)f.hasOwnProperty(T)&&jN(c,T,f[T])}function _C(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ore=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),are=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Uy(c){return are.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}var MC=null;function DC(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Jh=null,ed=null;function zN(c){var f=se(c);if(f&&(c=f.stateNode)){var p=c[ht]||null;e:switch(c=f.stateNode,f.type){case"input":if(kC(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),f=p.name,p.type==="radio"&&f!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+To(""+f)+'"][type="radio"]'),f=0;f<p.length;f++){var v=p[f];if(v!==c&&v.form===c.form){var w=v[ht]||null;if(!w)throw Error(n(90));kC(v,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(f=0;f<p.length;f++)v=p[f],v.form===c.form&&FN(v)}break e;case"textarea":BN(c,p.value,p.defaultValue);break e;case"select":f=p.value,f!=null&&Qh(c,!!p.multiple,f,!1)}}}var PC=!1;function UN(c,f,p){if(PC)return c(f,p);PC=!0;try{var v=c(f);return v}finally{if(PC=!1,(Jh!==null||ed!==null)&&(Ox(),Jh&&(f=Jh,c=ed,ed=Jh=null,zN(f),c)))for(f=0;f<c.length;f++)zN(c[f])}}function T0(c,f){var p=c.stateNode;if(p===null)return null;var v=p[ht]||null;if(v===null)return null;p=v[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(c=c.type,v=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!v;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(n(231,f,typeof p));return p}var Yl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),IC=!1;if(Yl)try{var E0={};Object.defineProperty(E0,"passive",{get:function(){IC=!0}}),window.addEventListener("test",E0,E0),window.removeEventListener("test",E0,E0)}catch{IC=!1}var $c=null,NC=null,$y=null;function $N(){if($y)return $y;var c,f=NC,p=f.length,v,w="value"in $c?$c.value:$c.textContent,T=w.length;for(c=0;c<p&&f[c]===w[c];c++);var F=p-c;for(v=1;v<=F&&f[p-v]===w[T-v];v++);return $y=w.slice(c,1<v?1-v:void 0)}function Gy(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function Yy(){return!0}function GN(){return!1}function Es(c){function f(p,v,w,T,F){this._reactName=p,this._targetInst=w,this.type=v,this.nativeEvent=T,this.target=F,this.currentTarget=null;for(var U in c)c.hasOwnProperty(U)&&(p=c[U],this[U]=p?p(T):T[U]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Yy:GN,this.isPropagationStopped=GN,this}return h(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Yy)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Yy)},persist:function(){},isPersistent:Yy}),f}var lf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qy=Es(lf),R0=h({},lf,{view:0,detail:0}),lre=Es(R0),LC,FC,A0,Ky=h({},R0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:BC,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==A0&&(A0&&c.type==="mousemove"?(LC=c.screenX-A0.screenX,FC=c.screenY-A0.screenY):FC=LC=0,A0=c),LC)},movementY:function(c){return"movementY"in c?c.movementY:FC}}),YN=Es(Ky),cre=h({},Ky,{dataTransfer:0}),ure=Es(cre),fre=h({},R0,{relatedTarget:0}),HC=Es(fre),hre=h({},lf,{animationName:0,elapsedTime:0,pseudoElement:0}),dre=Es(hre),pre=h({},lf,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),mre=Es(pre),gre=h({},lf,{data:0}),qN=Es(gre),vre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yre={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xre={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wre(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=xre[c])?!!f[c]:!1}function BC(){return wre}var bre=h({},R0,{key:function(c){if(c.key){var f=vre[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=Gy(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?yre[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:BC,charCode:function(c){return c.type==="keypress"?Gy(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Gy(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Sre=Es(bre),Cre=h({},Ky,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),KN=Es(Cre),Tre=h({},R0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:BC}),Ere=Es(Tre),Rre=h({},lf,{propertyName:0,elapsedTime:0,pseudoElement:0}),Are=Es(Rre),kre=h({},Ky,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),Ore=Es(kre),_re=h({},lf,{newState:0,oldState:0}),Mre=Es(_re),Dre=[9,13,27,32],VC=Yl&&"CompositionEvent"in window,k0=null;Yl&&"documentMode"in document&&(k0=document.documentMode);var Pre=Yl&&"TextEvent"in window&&!k0,XN=Yl&&(!VC||k0&&8<k0&&11>=k0),QN=" ",ZN=!1;function JN(c,f){switch(c){case"keyup":return Dre.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e4(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var td=!1;function Ire(c,f){switch(c){case"compositionend":return e4(f);case"keypress":return f.which!==32?null:(ZN=!0,QN);case"textInput":return c=f.data,c===QN&&ZN?null:c;default:return null}}function Nre(c,f){if(td)return c==="compositionend"||!VC&&JN(c,f)?(c=$N(),$y=NC=$c=null,td=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return XN&&f.locale!=="ko"?null:f.data;default:return null}}var Lre={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function t4(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!Lre[c.type]:f==="textarea"}function r4(c,f,p,v){Jh?ed?ed.push(v):ed=[v]:Jh=v,f=Nx(f,"onChange"),0<f.length&&(p=new qy("onChange","change",null,p,v),c.push({event:p,listeners:f}))}var O0=null,_0=null;function Fre(c){L3(c,0)}function Xy(c){var f=xe(c);if(FN(f))return c}function n4(c,f){if(c==="change")return f}var i4=!1;if(Yl){var jC;if(Yl){var WC="oninput"in document;if(!WC){var s4=document.createElement("div");s4.setAttribute("oninput","return;"),WC=typeof s4.oninput=="function"}jC=WC}else jC=!1;i4=jC&&(!document.documentMode||9<document.documentMode)}function o4(){O0&&(O0.detachEvent("onpropertychange",a4),_0=O0=null)}function a4(c){if(c.propertyName==="value"&&Xy(_0)){var f=[];r4(f,_0,c,DC(c)),UN(Fre,f)}}function Hre(c,f,p){c==="focusin"?(o4(),O0=f,_0=p,O0.attachEvent("onpropertychange",a4)):c==="focusout"&&o4()}function Bre(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Xy(_0)}function Vre(c,f){if(c==="click")return Xy(f)}function jre(c,f){if(c==="input"||c==="change")return Xy(f)}function Wre(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var Xs=typeof Object.is=="function"?Object.is:Wre;function M0(c,f){if(Xs(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var p=Object.keys(c),v=Object.keys(f);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var w=p[v];if(!z.call(f,w)||!Xs(c[w],f[w]))return!1}return!0}function l4(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function c4(c,f){var p=l4(c);c=0;for(var v;p;){if(p.nodeType===3){if(v=c+p.textContent.length,c<=f&&v>=f)return{node:p,offset:f-c};c=v}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=l4(p)}}function u4(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?u4(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function f4(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var f=zy(c.document);f instanceof c.HTMLIFrameElement;){try{var p=typeof f.contentWindow.location.href=="string"}catch{p=!1}if(p)c=f.contentWindow;else break;f=zy(c.document)}return f}function zC(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}var zre=Yl&&"documentMode"in document&&11>=document.documentMode,rd=null,UC=null,D0=null,$C=!1;function h4(c,f,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;$C||rd==null||rd!==zy(v)||(v=rd,"selectionStart"in v&&zC(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),D0&&M0(D0,v)||(D0=v,v=Nx(UC,"onSelect"),0<v.length&&(f=new qy("onSelect","select",null,f,p),c.push({event:f,listeners:v}),f.target=rd)))}function cf(c,f){var p={};return p[c.toLowerCase()]=f.toLowerCase(),p["Webkit"+c]="webkit"+f,p["Moz"+c]="moz"+f,p}var nd={animationend:cf("Animation","AnimationEnd"),animationiteration:cf("Animation","AnimationIteration"),animationstart:cf("Animation","AnimationStart"),transitionrun:cf("Transition","TransitionRun"),transitionstart:cf("Transition","TransitionStart"),transitioncancel:cf("Transition","TransitionCancel"),transitionend:cf("Transition","TransitionEnd")},GC={},d4={};Yl&&(d4=document.createElement("div").style,"AnimationEvent"in window||(delete nd.animationend.animation,delete nd.animationiteration.animation,delete nd.animationstart.animation),"TransitionEvent"in window||delete nd.transitionend.transition);function uf(c){if(GC[c])return GC[c];if(!nd[c])return c;var f=nd[c],p;for(p in f)if(f.hasOwnProperty(p)&&p in d4)return GC[c]=f[p];return c}var p4=uf("animationend"),m4=uf("animationiteration"),g4=uf("animationstart"),Ure=uf("transitionrun"),$re=uf("transitionstart"),Gre=uf("transitioncancel"),v4=uf("transitionend"),y4=new Map,YC="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");YC.push("scrollEnd");function wa(c,f){y4.set(c,f),de(f,[c])}var x4=new WeakMap;function Eo(c,f){if(typeof c=="object"&&c!==null){var p=x4.get(c);return p!==void 0?p:(f={value:c,source:f,stack:NN(f)},x4.set(c,f),f)}return{value:c,source:f,stack:NN(f)}}var Ro=[],id=0,qC=0;function Qy(){for(var c=id,f=qC=id=0;f<c;){var p=Ro[f];Ro[f++]=null;var v=Ro[f];Ro[f++]=null;var w=Ro[f];Ro[f++]=null;var T=Ro[f];if(Ro[f++]=null,v!==null&&w!==null){var F=v.pending;F===null?w.next=w:(w.next=F.next,F.next=w),v.pending=w}T!==0&&w4(p,w,T)}}function Zy(c,f,p,v){Ro[id++]=c,Ro[id++]=f,Ro[id++]=p,Ro[id++]=v,qC|=v,c.lanes|=v,c=c.alternate,c!==null&&(c.lanes|=v)}function KC(c,f,p,v){return Zy(c,f,p,v),Jy(c)}function sd(c,f){return Zy(c,null,null,f),Jy(c)}function w4(c,f,p){c.lanes|=p;var v=c.alternate;v!==null&&(v.lanes|=p);for(var w=!1,T=c.return;T!==null;)T.childLanes|=p,v=T.alternate,v!==null&&(v.childLanes|=p),T.tag===22&&(c=T.stateNode,c===null||c._visibility&1||(w=!0)),c=T,T=T.return;return c.tag===3?(T=c.stateNode,w&&f!==null&&(w=31-Rt(p),c=T.hiddenUpdates,v=c[w],v===null?c[w]=[f]:v.push(f),f.lane=p|536870912),T):null}function Jy(c){if(50<nm)throw nm=0,tE=null,Error(n(185));for(var f=c.return;f!==null;)c=f,f=c.return;return c.tag===3?c.stateNode:null}var od={};function Yre(c,f,p,v){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qs(c,f,p,v){return new Yre(c,f,p,v)}function XC(c){return c=c.prototype,!(!c||!c.isReactComponent)}function ql(c,f){var p=c.alternate;return p===null?(p=Qs(c.tag,f,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=f,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&65011712,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,f=c.dependencies,p.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p.refCleanup=c.refCleanup,p}function b4(c,f){c.flags&=65011714;var p=c.alternate;return p===null?(c.childLanes=0,c.lanes=f,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=p.childLanes,c.lanes=p.lanes,c.child=p.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=p.memoizedProps,c.memoizedState=p.memoizedState,c.updateQueue=p.updateQueue,c.type=p.type,f=p.dependencies,c.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),c}function ex(c,f,p,v,w,T){var F=0;if(v=c,typeof c=="function")XC(c)&&(F=1);else if(typeof c=="string")F=Kne(c,p,M.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case N:return c=Qs(31,p,f,w),c.elementType=N,c.lanes=T,c;case y:return ff(p.children,w,T,f);case x:F=8,w|=24;break;case b:return c=Qs(12,p,f,w|2),c.elementType=b,c.lanes=T,c;case O:return c=Qs(13,p,f,w),c.elementType=O,c.lanes=T,c;case P:return c=Qs(19,p,f,w),c.elementType=P,c.lanes=T,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case C:case R:F=10;break e;case E:F=9;break e;case k:F=11;break e;case D:F=14;break e;case H:F=16,v=null;break e}F=29,p=Error(n(130,c===null?"null":typeof c,"")),v=null}return f=Qs(F,p,f,w),f.elementType=c,f.type=v,f.lanes=T,f}function ff(c,f,p,v){return c=Qs(7,c,v,f),c.lanes=p,c}function QC(c,f,p){return c=Qs(6,c,null,f),c.lanes=p,c}function ZC(c,f,p){return f=Qs(4,c.children!==null?c.children:[],c.key,f),f.lanes=p,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}var ad=[],ld=0,tx=null,rx=0,Ao=[],ko=0,hf=null,Kl=1,Xl="";function df(c,f){ad[ld++]=rx,ad[ld++]=tx,tx=c,rx=f}function S4(c,f,p){Ao[ko++]=Kl,Ao[ko++]=Xl,Ao[ko++]=hf,hf=c;var v=Kl;c=Xl;var w=32-Rt(v)-1;v&=~(1<<w),p+=1;var T=32-Rt(f)+w;if(30<T){var F=w-w%5;T=(v&(1<<F)-1).toString(32),v>>=F,w-=F,Kl=1<<32-Rt(f)+w|p<<w|v,Xl=T+c}else Kl=1<<T|p<<w|v,Xl=c}function JC(c){c.return!==null&&(df(c,1),S4(c,1,0))}function eT(c){for(;c===tx;)tx=ad[--ld],ad[ld]=null,rx=ad[--ld],ad[ld]=null;for(;c===hf;)hf=Ao[--ko],Ao[ko]=null,Xl=Ao[--ko],Ao[ko]=null,Kl=Ao[--ko],Ao[ko]=null}var cs=null,yn=null,pr=!1,pf=null,Qa=!1,tT=Error(n(519));function mf(c){var f=Error(n(418,""));throw N0(Eo(f,c)),tT}function C4(c){var f=c.stateNode,p=c.type,v=c.memoizedProps;switch(f[ut]=c,f[ht]=v,p){case"dialog":Yt("cancel",f),Yt("close",f);break;case"iframe":case"object":case"embed":Yt("load",f);break;case"video":case"audio":for(p=0;p<sm.length;p++)Yt(sm[p],f);break;case"source":Yt("error",f);break;case"img":case"image":case"link":Yt("error",f),Yt("load",f);break;case"details":Yt("toggle",f);break;case"input":Yt("invalid",f),HN(f,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),Wy(f);break;case"select":Yt("invalid",f);break;case"textarea":Yt("invalid",f),VN(f,v.value,v.defaultValue,v.children),Wy(f)}p=v.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||f.textContent===""+p||v.suppressHydrationWarning===!0||V3(f.textContent,p)?(v.popover!=null&&(Yt("beforetoggle",f),Yt("toggle",f)),v.onScroll!=null&&Yt("scroll",f),v.onScrollEnd!=null&&Yt("scrollend",f),v.onClick!=null&&(f.onclick=Lx),f=!0):f=!1,f||mf(c)}function T4(c){for(cs=c.return;cs;)switch(cs.tag){case 5:case 13:Qa=!1;return;case 27:case 3:Qa=!0;return;default:cs=cs.return}}function P0(c){if(c!==cs)return!1;if(!pr)return T4(c),pr=!0,!1;var f=c.tag,p;if((p=f!==3&&f!==27)&&((p=f===5)&&(p=c.type,p=!(p!=="form"&&p!=="button")||vE(c.type,c.memoizedProps)),p=!p),p&&yn&&mf(c),T4(c),f===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(n(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8)if(p=c.data,p==="/$"){if(f===0){yn=Sa(c.nextSibling);break e}f--}else p!=="$"&&p!=="$!"&&p!=="$?"||f++;c=c.nextSibling}yn=null}}else f===27?(f=yn,au(c.type)?(c=bE,bE=null,yn=c):yn=f):yn=cs?Sa(c.stateNode.nextSibling):null;return!0}function I0(){yn=cs=null,pr=!1}function E4(){var c=pf;return c!==null&&(ks===null?ks=c:ks.push.apply(ks,c),pf=null),c}function N0(c){pf===null?pf=[c]:pf.push(c)}var rT=ce(null),gf=null,Ql=null;function Gc(c,f,p){A(rT,f._currentValue),f._currentValue=p}function Zl(c){c._currentValue=rT.current,S(rT)}function nT(c,f,p){for(;c!==null;){var v=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,v!==null&&(v.childLanes|=f)):v!==null&&(v.childLanes&f)!==f&&(v.childLanes|=f),c===p)break;c=c.return}}function iT(c,f,p,v){var w=c.child;for(w!==null&&(w.return=c);w!==null;){var T=w.dependencies;if(T!==null){var F=w.child;T=T.firstContext;e:for(;T!==null;){var U=T;T=w;for(var le=0;le<f.length;le++)if(U.context===f[le]){T.lanes|=p,U=T.alternate,U!==null&&(U.lanes|=p),nT(T.return,p,c),v||(F=null);break e}T=U.next}}else if(w.tag===18){if(F=w.return,F===null)throw Error(n(341));F.lanes|=p,T=F.alternate,T!==null&&(T.lanes|=p),nT(F,p,c),F=null}else F=w.child;if(F!==null)F.return=w;else for(F=w;F!==null;){if(F===c){F=null;break}if(w=F.sibling,w!==null){w.return=F.return,F=w;break}F=F.return}w=F}}function L0(c,f,p,v){c=null;for(var w=f,T=!1;w!==null;){if(!T){if((w.flags&524288)!==0)T=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var F=w.alternate;if(F===null)throw Error(n(387));if(F=F.memoizedProps,F!==null){var U=w.type;Xs(w.pendingProps.value,F.value)||(c!==null?c.push(U):c=[U])}}else if(w===J.current){if(F=w.alternate,F===null)throw Error(n(387));F.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(c!==null?c.push(fm):c=[fm])}w=w.return}c!==null&&iT(f,c,p,v),f.flags|=262144}function nx(c){for(c=c.firstContext;c!==null;){if(!Xs(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function vf(c){gf=c,Ql=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function Ui(c){return R4(gf,c)}function ix(c,f){return gf===null&&vf(c),R4(c,f)}function R4(c,f){var p=f._currentValue;if(f={context:f,memoizedValue:p,next:null},Ql===null){if(c===null)throw Error(n(308));Ql=f,c.dependencies={lanes:0,firstContext:f},c.flags|=524288}else Ql=Ql.next=f;return p}var qre=typeof AbortController<"u"?AbortController:function(){var c=[],f=this.signal={aborted:!1,addEventListener:function(p,v){c.push(v)}};this.abort=function(){f.aborted=!0,c.forEach(function(p){return p()})}},Kre=t.unstable_scheduleCallback,Xre=t.unstable_NormalPriority,si={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sT(){return{controller:new qre,data:new Map,refCount:0}}function F0(c){c.refCount--,c.refCount===0&&Kre(Xre,function(){c.controller.abort()})}var H0=null,oT=0,cd=0,ud=null;function Qre(c,f){if(H0===null){var p=H0=[];oT=0,cd=lE(),ud={status:"pending",value:void 0,then:function(v){p.push(v)}}}return oT++,f.then(A4,A4),f}function A4(){if(--oT===0&&H0!==null){ud!==null&&(ud.status="fulfilled");var c=H0;H0=null,cd=0,ud=null;for(var f=0;f<c.length;f++)(0,c[f])()}}function Zre(c,f){var p=[],v={status:"pending",value:null,reason:null,then:function(w){p.push(w)}};return c.then(function(){v.status="fulfilled",v.value=f;for(var w=0;w<p.length;w++)(0,p[w])(f)},function(w){for(v.status="rejected",v.reason=w,w=0;w<p.length;w++)(0,p[w])(void 0)}),v}var k4=q.S;q.S=function(c,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&Qre(c,f),k4!==null&&k4(c,f)};var yf=ce(null);function aT(){var c=yf.current;return c!==null?c:jr.pooledCache}function sx(c,f){f===null?A(yf,yf.current):A(yf,f.pool)}function O4(){var c=aT();return c===null?null:{parent:si._currentValue,pool:c}}var B0=Error(n(460)),_4=Error(n(474)),ox=Error(n(542)),lT={then:function(){}};function M4(c){return c=c.status,c==="fulfilled"||c==="rejected"}function ax(){}function D4(c,f,p){switch(p=c[p],p===void 0?c.push(f):p!==f&&(f.then(ax,ax),f=p),f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,I4(c),c;default:if(typeof f.status=="string")f.then(ax,ax);else{if(c=jr,c!==null&&100<c.shellSuspendCounter)throw Error(n(482));c=f,c.status="pending",c.then(function(v){if(f.status==="pending"){var w=f;w.status="fulfilled",w.value=v}},function(v){if(f.status==="pending"){var w=f;w.status="rejected",w.reason=v}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,I4(c),c}throw V0=f,B0}}var V0=null;function P4(){if(V0===null)throw Error(n(459));var c=V0;return V0=null,c}function I4(c){if(c===B0||c===ox)throw Error(n(483))}var Yc=!1;function cT(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uT(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function qc(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Kc(c,f,p){var v=c.updateQueue;if(v===null)return null;if(v=v.shared,(xr&2)!==0){var w=v.pending;return w===null?f.next=f:(f.next=w.next,w.next=f),v.pending=f,f=Jy(c),w4(c,null,p),f}return Zy(c,v,f,p),Jy(c)}function j0(c,f,p){if(f=f.updateQueue,f!==null&&(f=f.shared,(p&4194048)!==0)){var v=f.lanes;v&=c.pendingLanes,p|=v,f.lanes=p,Or(c,p)}}function fT(c,f){var p=c.updateQueue,v=c.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var w=null,T=null;if(p=p.firstBaseUpdate,p!==null){do{var F={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};T===null?w=T=F:T=T.next=F,p=p.next}while(p!==null);T===null?w=T=f:T=T.next=f}else w=T=f;p={baseState:v.baseState,firstBaseUpdate:w,lastBaseUpdate:T,shared:v.shared,callbacks:v.callbacks},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=f:c.next=f,p.lastBaseUpdate=f}var hT=!1;function W0(){if(hT){var c=ud;if(c!==null)throw c}}function z0(c,f,p,v){hT=!1;var w=c.updateQueue;Yc=!1;var T=w.firstBaseUpdate,F=w.lastBaseUpdate,U=w.shared.pending;if(U!==null){w.shared.pending=null;var le=U,we=le.next;le.next=null,F===null?T=we:F.next=we,F=le;var Oe=c.alternate;Oe!==null&&(Oe=Oe.updateQueue,U=Oe.lastBaseUpdate,U!==F&&(U===null?Oe.firstBaseUpdate=we:U.next=we,Oe.lastBaseUpdate=le))}if(T!==null){var De=w.baseState;F=0,Oe=we=le=null,U=T;do{var be=U.lane&-536870913,Se=be!==U.lane;if(Se?(rr&be)===be:(v&be)===be){be!==0&&be===cd&&(hT=!0),Oe!==null&&(Oe=Oe.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var xt=c,mt=U;be=f;var Tr=p;switch(mt.tag){case 1:if(xt=mt.payload,typeof xt=="function"){De=xt.call(Tr,De,be);break e}De=xt;break e;case 3:xt.flags=xt.flags&-65537|128;case 0:if(xt=mt.payload,be=typeof xt=="function"?xt.call(Tr,De,be):xt,be==null)break e;De=h({},De,be);break e;case 2:Yc=!0}}be=U.callback,be!==null&&(c.flags|=64,Se&&(c.flags|=8192),Se=w.callbacks,Se===null?w.callbacks=[be]:Se.push(be))}else Se={lane:be,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Oe===null?(we=Oe=Se,le=De):Oe=Oe.next=Se,F|=be;if(U=U.next,U===null){if(U=w.shared.pending,U===null)break;Se=U,U=Se.next,Se.next=null,w.lastBaseUpdate=Se,w.shared.pending=null}}while(!0);Oe===null&&(le=De),w.baseState=le,w.firstBaseUpdate=we,w.lastBaseUpdate=Oe,T===null&&(w.shared.lanes=0),nu|=F,c.lanes=F,c.memoizedState=De}}function N4(c,f){if(typeof c!="function")throw Error(n(191,c));c.call(f)}function L4(c,f){var p=c.callbacks;if(p!==null)for(c.callbacks=null,c=0;c<p.length;c++)N4(p[c],f)}var fd=ce(null),lx=ce(0);function F4(c,f){c=sc,A(lx,c),A(fd,f),sc=c|f.baseLanes}function dT(){A(lx,sc),A(fd,fd.current)}function pT(){sc=lx.current,S(fd),S(lx)}var Xc=0,Ht=null,Sr=null,zn=null,cx=!1,hd=!1,xf=!1,ux=0,U0=0,dd=null,Jre=0;function _n(){throw Error(n(321))}function mT(c,f){if(f===null)return!1;for(var p=0;p<f.length&&p<c.length;p++)if(!Xs(c[p],f[p]))return!1;return!0}function gT(c,f,p,v,w,T){return Xc=T,Ht=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,q.H=c===null||c.memoizedState===null?wL:bL,xf=!1,T=p(v,w),xf=!1,hd&&(T=B4(f,p,v,w)),H4(c),T}function H4(c){q.H=gx;var f=Sr!==null&&Sr.next!==null;if(Xc=0,zn=Sr=Ht=null,cx=!1,U0=0,dd=null,f)throw Error(n(300));c===null||pi||(c=c.dependencies,c!==null&&nx(c)&&(pi=!0))}function B4(c,f,p,v){Ht=c;var w=0;do{if(hd&&(dd=null),U0=0,hd=!1,25<=w)throw Error(n(301));if(w+=1,zn=Sr=null,c.updateQueue!=null){var T=c.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}q.H=one,T=f(p,v)}while(hd);return T}function ene(){var c=q.H,f=c.useState()[0];return f=typeof f.then=="function"?$0(f):f,c=c.useState()[0],(Sr!==null?Sr.memoizedState:null)!==c&&(Ht.flags|=1024),f}function vT(){var c=ux!==0;return ux=0,c}function yT(c,f,p){f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~p}function xT(c){if(cx){for(c=c.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}cx=!1}Xc=0,zn=Sr=Ht=null,hd=!1,U0=ux=0,dd=null}function Rs(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?Ht.memoizedState=zn=c:zn=zn.next=c,zn}function Un(){if(Sr===null){var c=Ht.alternate;c=c!==null?c.memoizedState:null}else c=Sr.next;var f=zn===null?Ht.memoizedState:zn.next;if(f!==null)zn=f,Sr=c;else{if(c===null)throw Ht.alternate===null?Error(n(467)):Error(n(310));Sr=c,c={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},zn===null?Ht.memoizedState=zn=c:zn=zn.next=c}return zn}function wT(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $0(c){var f=U0;return U0+=1,dd===null&&(dd=[]),c=D4(dd,c,f),f=Ht,(zn===null?f.memoizedState:zn.next)===null&&(f=f.alternate,q.H=f===null||f.memoizedState===null?wL:bL),c}function fx(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return $0(c);if(c.$$typeof===R)return Ui(c)}throw Error(n(438,String(c)))}function bT(c){var f=null,p=Ht.updateQueue;if(p!==null&&(f=p.memoCache),f==null){var v=Ht.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(f={data:v.data.map(function(w){return w.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),p===null&&(p=wT(),Ht.updateQueue=p),p.memoCache=f,p=f.data[f.index],p===void 0)for(p=f.data[f.index]=Array(c),v=0;v<c;v++)p[v]=_;return f.index++,p}function Jl(c,f){return typeof f=="function"?f(c):f}function hx(c){var f=Un();return ST(f,Sr,c)}function ST(c,f,p){var v=c.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=p;var w=c.baseQueue,T=v.pending;if(T!==null){if(w!==null){var F=w.next;w.next=T.next,T.next=F}f.baseQueue=w=T,v.pending=null}if(T=c.baseState,w===null)c.memoizedState=T;else{f=w.next;var U=F=null,le=null,we=f,Oe=!1;do{var De=we.lane&-536870913;if(De!==we.lane?(rr&De)===De:(Xc&De)===De){var be=we.revertLane;if(be===0)le!==null&&(le=le.next={lane:0,revertLane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),De===cd&&(Oe=!0);else if((Xc&be)===be){we=we.next,be===cd&&(Oe=!0);continue}else De={lane:0,revertLane:we.revertLane,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},le===null?(U=le=De,F=T):le=le.next=De,Ht.lanes|=be,nu|=be;De=we.action,xf&&p(T,De),T=we.hasEagerState?we.eagerState:p(T,De)}else be={lane:De,revertLane:we.revertLane,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},le===null?(U=le=be,F=T):le=le.next=be,Ht.lanes|=De,nu|=De;we=we.next}while(we!==null&&we!==f);if(le===null?F=T:le.next=U,!Xs(T,c.memoizedState)&&(pi=!0,Oe&&(p=ud,p!==null)))throw p;c.memoizedState=T,c.baseState=F,c.baseQueue=le,v.lastRenderedState=T}return w===null&&(v.lanes=0),[c.memoizedState,v.dispatch]}function CT(c){var f=Un(),p=f.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=c;var v=p.dispatch,w=p.pending,T=f.memoizedState;if(w!==null){p.pending=null;var F=w=w.next;do T=c(T,F.action),F=F.next;while(F!==w);Xs(T,f.memoizedState)||(pi=!0),f.memoizedState=T,f.baseQueue===null&&(f.baseState=T),p.lastRenderedState=T}return[T,v]}function V4(c,f,p){var v=Ht,w=Un(),T=pr;if(T){if(p===void 0)throw Error(n(407));p=p()}else p=f();var F=!Xs((Sr||w).memoizedState,p);F&&(w.memoizedState=p,pi=!0),w=w.queue;var U=z4.bind(null,v,w,c);if(G0(2048,8,U,[c]),w.getSnapshot!==f||F||zn!==null&&zn.memoizedState.tag&1){if(v.flags|=2048,pd(9,dx(),W4.bind(null,v,w,p,f),null),jr===null)throw Error(n(349));T||(Xc&124)!==0||j4(v,f,p)}return p}function j4(c,f,p){c.flags|=16384,c={getSnapshot:f,value:p},f=Ht.updateQueue,f===null?(f=wT(),Ht.updateQueue=f,f.stores=[c]):(p=f.stores,p===null?f.stores=[c]:p.push(c))}function W4(c,f,p,v){f.value=p,f.getSnapshot=v,U4(f)&&$4(c)}function z4(c,f,p){return p(function(){U4(f)&&$4(c)})}function U4(c){var f=c.getSnapshot;c=c.value;try{var p=f();return!Xs(c,p)}catch{return!0}}function $4(c){var f=sd(c,2);f!==null&&ro(f,c,2)}function TT(c){var f=Rs();if(typeof c=="function"){var p=c;if(c=p(),xf){Ct(!0);try{p()}finally{Ct(!1)}}}return f.memoizedState=f.baseState=c,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:c},f}function G4(c,f,p,v){return c.baseState=p,ST(c,Sr,typeof v=="function"?v:Jl)}function tne(c,f,p,v,w){if(mx(c))throw Error(n(485));if(c=f.action,c!==null){var T={payload:w,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){T.listeners.push(F)}};q.T!==null?p(!0):T.isTransition=!1,v(T),p=f.pending,p===null?(T.next=f.pending=T,Y4(f,T)):(T.next=p.next,f.pending=p.next=T)}}function Y4(c,f){var p=f.action,v=f.payload,w=c.state;if(f.isTransition){var T=q.T,F={};q.T=F;try{var U=p(w,v),le=q.S;le!==null&&le(F,U),q4(c,f,U)}catch(we){ET(c,f,we)}finally{q.T=T}}else try{T=p(w,v),q4(c,f,T)}catch(we){ET(c,f,we)}}function q4(c,f,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(v){K4(c,f,v)},function(v){return ET(c,f,v)}):K4(c,f,p)}function K4(c,f,p){f.status="fulfilled",f.value=p,X4(f),c.state=p,f=c.pending,f!==null&&(p=f.next,p===f?c.pending=null:(p=p.next,f.next=p,Y4(c,p)))}function ET(c,f,p){var v=c.pending;if(c.pending=null,v!==null){v=v.next;do f.status="rejected",f.reason=p,X4(f),f=f.next;while(f!==v)}c.action=null}function X4(c){c=c.listeners;for(var f=0;f<c.length;f++)(0,c[f])()}function Q4(c,f){return f}function Z4(c,f){if(pr){var p=jr.formState;if(p!==null){e:{var v=Ht;if(pr){if(yn){t:{for(var w=yn,T=Qa;w.nodeType!==8;){if(!T){w=null;break t}if(w=Sa(w.nextSibling),w===null){w=null;break t}}T=w.data,w=T==="F!"||T==="F"?w:null}if(w){yn=Sa(w.nextSibling),v=w.data==="F!";break e}}mf(v)}v=!1}v&&(f=p[0])}}return p=Rs(),p.memoizedState=p.baseState=f,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q4,lastRenderedState:f},p.queue=v,p=vL.bind(null,Ht,v),v.dispatch=p,v=TT(!1),T=_T.bind(null,Ht,!1,v.queue),v=Rs(),w={state:f,dispatch:null,action:c,pending:null},v.queue=w,p=tne.bind(null,Ht,w,T,p),w.dispatch=p,v.memoizedState=c,[f,p,!1]}function J4(c){var f=Un();return eL(f,Sr,c)}function eL(c,f,p){if(f=ST(c,f,Q4)[0],c=hx(Jl)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var v=$0(f)}catch(F){throw F===B0?ox:F}else v=f;f=Un();var w=f.queue,T=w.dispatch;return p!==f.memoizedState&&(Ht.flags|=2048,pd(9,dx(),rne.bind(null,w,p),null)),[v,T,c]}function rne(c,f){c.action=f}function tL(c){var f=Un(),p=Sr;if(p!==null)return eL(f,p,c);Un(),f=f.memoizedState,p=Un();var v=p.queue.dispatch;return p.memoizedState=c,[f,v,!1]}function pd(c,f,p,v){return c={tag:c,create:p,deps:v,inst:f,next:null},f=Ht.updateQueue,f===null&&(f=wT(),Ht.updateQueue=f),p=f.lastEffect,p===null?f.lastEffect=c.next=c:(v=p.next,p.next=c,c.next=v,f.lastEffect=c),c}function dx(){return{destroy:void 0,resource:void 0}}function rL(){return Un().memoizedState}function px(c,f,p,v){var w=Rs();v=v===void 0?null:v,Ht.flags|=c,w.memoizedState=pd(1|f,dx(),p,v)}function G0(c,f,p,v){var w=Un();v=v===void 0?null:v;var T=w.memoizedState.inst;Sr!==null&&v!==null&&mT(v,Sr.memoizedState.deps)?w.memoizedState=pd(f,T,p,v):(Ht.flags|=c,w.memoizedState=pd(1|f,T,p,v))}function nL(c,f){px(8390656,8,c,f)}function iL(c,f){G0(2048,8,c,f)}function sL(c,f){return G0(4,2,c,f)}function oL(c,f){return G0(4,4,c,f)}function aL(c,f){if(typeof f=="function"){c=c();var p=f(c);return function(){typeof p=="function"?p():f(null)}}if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function lL(c,f,p){p=p!=null?p.concat([c]):null,G0(4,4,aL.bind(null,f,c),p)}function RT(){}function cL(c,f){var p=Un();f=f===void 0?null:f;var v=p.memoizedState;return f!==null&&mT(f,v[1])?v[0]:(p.memoizedState=[c,f],c)}function uL(c,f){var p=Un();f=f===void 0?null:f;var v=p.memoizedState;if(f!==null&&mT(f,v[1]))return v[0];if(v=c(),xf){Ct(!0);try{c()}finally{Ct(!1)}}return p.memoizedState=[v,f],v}function AT(c,f,p){return p===void 0||(Xc&1073741824)!==0?c.memoizedState=f:(c.memoizedState=p,c=d3(),Ht.lanes|=c,nu|=c,p)}function fL(c,f,p,v){return Xs(p,f)?p:fd.current!==null?(c=AT(c,p,v),Xs(c,f)||(pi=!0),c):(Xc&42)===0?(pi=!0,c.memoizedState=p):(c=d3(),Ht.lanes|=c,nu|=c,f)}function hL(c,f,p,v,w){var T=Z.p;Z.p=T!==0&&8>T?T:8;var F=q.T,U={};q.T=U,_T(c,!1,f,p);try{var le=w(),we=q.S;if(we!==null&&we(U,le),le!==null&&typeof le=="object"&&typeof le.then=="function"){var Oe=Zre(le,v);Y0(c,f,Oe,to(c))}else Y0(c,f,v,to(c))}catch(De){Y0(c,f,{then:function(){},status:"rejected",reason:De},to())}finally{Z.p=T,q.T=F}}function nne(){}function kT(c,f,p,v){if(c.tag!==5)throw Error(n(476));var w=dL(c).queue;hL(c,w,f,ve,p===null?nne:function(){return pL(c),p(v)})}function dL(c){var f=c.memoizedState;if(f!==null)return f;f={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:ve},next:null};var p={};return f.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:p},next:null},c.memoizedState=f,c=c.alternate,c!==null&&(c.memoizedState=f),f}function pL(c){var f=dL(c).next.queue;Y0(c,f,{},to())}function OT(){return Ui(fm)}function mL(){return Un().memoizedState}function gL(){return Un().memoizedState}function ine(c){for(var f=c.return;f!==null;){switch(f.tag){case 24:case 3:var p=to();c=qc(p);var v=Kc(f,c,p);v!==null&&(ro(v,f,p),j0(v,f,p)),f={cache:sT()},c.payload=f;return}f=f.return}}function sne(c,f,p){var v=to();p={lane:v,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},mx(c)?yL(f,p):(p=KC(c,f,p,v),p!==null&&(ro(p,c,v),xL(p,f,v)))}function vL(c,f,p){var v=to();Y0(c,f,p,v)}function Y0(c,f,p,v){var w={lane:v,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(mx(c))yL(f,w);else{var T=c.alternate;if(c.lanes===0&&(T===null||T.lanes===0)&&(T=f.lastRenderedReducer,T!==null))try{var F=f.lastRenderedState,U=T(F,p);if(w.hasEagerState=!0,w.eagerState=U,Xs(U,F))return Zy(c,f,w,0),jr===null&&Qy(),!1}catch{}finally{}if(p=KC(c,f,w,v),p!==null)return ro(p,c,v),xL(p,f,v),!0}return!1}function _T(c,f,p,v){if(v={lane:2,revertLane:lE(),action:v,hasEagerState:!1,eagerState:null,next:null},mx(c)){if(f)throw Error(n(479))}else f=KC(c,p,v,2),f!==null&&ro(f,c,2)}function mx(c){var f=c.alternate;return c===Ht||f!==null&&f===Ht}function yL(c,f){hd=cx=!0;var p=c.pending;p===null?f.next=f:(f.next=p.next,p.next=f),c.pending=f}function xL(c,f,p){if((p&4194048)!==0){var v=f.lanes;v&=c.pendingLanes,p|=v,f.lanes=p,Or(c,p)}}var gx={readContext:Ui,use:fx,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n},wL={readContext:Ui,use:fx,useCallback:function(c,f){return Rs().memoizedState=[c,f===void 0?null:f],c},useContext:Ui,useEffect:nL,useImperativeHandle:function(c,f,p){p=p!=null?p.concat([c]):null,px(4194308,4,aL.bind(null,f,c),p)},useLayoutEffect:function(c,f){return px(4194308,4,c,f)},useInsertionEffect:function(c,f){px(4,2,c,f)},useMemo:function(c,f){var p=Rs();f=f===void 0?null:f;var v=c();if(xf){Ct(!0);try{c()}finally{Ct(!1)}}return p.memoizedState=[v,f],v},useReducer:function(c,f,p){var v=Rs();if(p!==void 0){var w=p(f);if(xf){Ct(!0);try{p(f)}finally{Ct(!1)}}}else w=f;return v.memoizedState=v.baseState=w,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:w},v.queue=c,c=c.dispatch=sne.bind(null,Ht,c),[v.memoizedState,c]},useRef:function(c){var f=Rs();return c={current:c},f.memoizedState=c},useState:function(c){c=TT(c);var f=c.queue,p=vL.bind(null,Ht,f);return f.dispatch=p,[c.memoizedState,p]},useDebugValue:RT,useDeferredValue:function(c,f){var p=Rs();return AT(p,c,f)},useTransition:function(){var c=TT(!1);return c=hL.bind(null,Ht,c.queue,!0,!1),Rs().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,f,p){var v=Ht,w=Rs();if(pr){if(p===void 0)throw Error(n(407));p=p()}else{if(p=f(),jr===null)throw Error(n(349));(rr&124)!==0||j4(v,f,p)}w.memoizedState=p;var T={value:p,getSnapshot:f};return w.queue=T,nL(z4.bind(null,v,T,c),[c]),v.flags|=2048,pd(9,dx(),W4.bind(null,v,T,p,f),null),p},useId:function(){var c=Rs(),f=jr.identifierPrefix;if(pr){var p=Xl,v=Kl;p=(v&~(1<<32-Rt(v)-1)).toString(32)+p,f=""+f+"R"+p,p=ux++,0<p&&(f+="H"+p.toString(32)),f+=""}else p=Jre++,f=""+f+"r"+p.toString(32)+"";return c.memoizedState=f},useHostTransitionStatus:OT,useFormState:Z4,useActionState:Z4,useOptimistic:function(c){var f=Rs();f.memoizedState=f.baseState=c;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=p,f=_T.bind(null,Ht,!0,p),p.dispatch=f,[c,f]},useMemoCache:bT,useCacheRefresh:function(){return Rs().memoizedState=ine.bind(null,Ht)}},bL={readContext:Ui,use:fx,useCallback:cL,useContext:Ui,useEffect:iL,useImperativeHandle:lL,useInsertionEffect:sL,useLayoutEffect:oL,useMemo:uL,useReducer:hx,useRef:rL,useState:function(){return hx(Jl)},useDebugValue:RT,useDeferredValue:function(c,f){var p=Un();return fL(p,Sr.memoizedState,c,f)},useTransition:function(){var c=hx(Jl)[0],f=Un().memoizedState;return[typeof c=="boolean"?c:$0(c),f]},useSyncExternalStore:V4,useId:mL,useHostTransitionStatus:OT,useFormState:J4,useActionState:J4,useOptimistic:function(c,f){var p=Un();return G4(p,Sr,c,f)},useMemoCache:bT,useCacheRefresh:gL},one={readContext:Ui,use:fx,useCallback:cL,useContext:Ui,useEffect:iL,useImperativeHandle:lL,useInsertionEffect:sL,useLayoutEffect:oL,useMemo:uL,useReducer:CT,useRef:rL,useState:function(){return CT(Jl)},useDebugValue:RT,useDeferredValue:function(c,f){var p=Un();return Sr===null?AT(p,c,f):fL(p,Sr.memoizedState,c,f)},useTransition:function(){var c=CT(Jl)[0],f=Un().memoizedState;return[typeof c=="boolean"?c:$0(c),f]},useSyncExternalStore:V4,useId:mL,useHostTransitionStatus:OT,useFormState:tL,useActionState:tL,useOptimistic:function(c,f){var p=Un();return Sr!==null?G4(p,Sr,c,f):(p.baseState=c,[c,p.queue.dispatch])},useMemoCache:bT,useCacheRefresh:gL},md=null,q0=0;function vx(c){var f=q0;return q0+=1,md===null&&(md=[]),D4(md,c,f)}function K0(c,f){f=f.props.ref,c.ref=f!==void 0?f:null}function yx(c,f){throw f.$$typeof===d?Error(n(525)):(c=Object.prototype.toString.call(f),Error(n(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c)))}function SL(c){var f=c._init;return f(c._payload)}function CL(c){function f(me,he){if(c){var ye=me.deletions;ye===null?(me.deletions=[he],me.flags|=16):ye.push(he)}}function p(me,he){if(!c)return null;for(;he!==null;)f(me,he),he=he.sibling;return null}function v(me){for(var he=new Map;me!==null;)me.key!==null?he.set(me.key,me):he.set(me.index,me),me=me.sibling;return he}function w(me,he){return me=ql(me,he),me.index=0,me.sibling=null,me}function T(me,he,ye){return me.index=ye,c?(ye=me.alternate,ye!==null?(ye=ye.index,ye<he?(me.flags|=67108866,he):ye):(me.flags|=67108866,he)):(me.flags|=1048576,he)}function F(me){return c&&me.alternate===null&&(me.flags|=67108866),me}function U(me,he,ye,Me){return he===null||he.tag!==6?(he=QC(ye,me.mode,Me),he.return=me,he):(he=w(he,ye),he.return=me,he)}function le(me,he,ye,Me){var et=ye.type;return et===y?Oe(me,he,ye.props.children,Me,ye.key):he!==null&&(he.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===H&&SL(et)===he.type)?(he=w(he,ye.props),K0(he,ye),he.return=me,he):(he=ex(ye.type,ye.key,ye.props,null,me.mode,Me),K0(he,ye),he.return=me,he)}function we(me,he,ye,Me){return he===null||he.tag!==4||he.stateNode.containerInfo!==ye.containerInfo||he.stateNode.implementation!==ye.implementation?(he=ZC(ye,me.mode,Me),he.return=me,he):(he=w(he,ye.children||[]),he.return=me,he)}function Oe(me,he,ye,Me,et){return he===null||he.tag!==7?(he=ff(ye,me.mode,Me,et),he.return=me,he):(he=w(he,ye),he.return=me,he)}function De(me,he,ye){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return he=QC(""+he,me.mode,ye),he.return=me,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case m:return ye=ex(he.type,he.key,he.props,null,me.mode,ye),K0(ye,he),ye.return=me,ye;case g:return he=ZC(he,me.mode,ye),he.return=me,he;case H:var Me=he._init;return he=Me(he._payload),De(me,he,ye)}if(re(he)||j(he))return he=ff(he,me.mode,ye,null),he.return=me,he;if(typeof he.then=="function")return De(me,vx(he),ye);if(he.$$typeof===R)return De(me,ix(me,he),ye);yx(me,he)}return null}function be(me,he,ye,Me){var et=he!==null?he.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return et!==null?null:U(me,he,""+ye,Me);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case m:return ye.key===et?le(me,he,ye,Me):null;case g:return ye.key===et?we(me,he,ye,Me):null;case H:return et=ye._init,ye=et(ye._payload),be(me,he,ye,Me)}if(re(ye)||j(ye))return et!==null?null:Oe(me,he,ye,Me,null);if(typeof ye.then=="function")return be(me,he,vx(ye),Me);if(ye.$$typeof===R)return be(me,he,ix(me,ye),Me);yx(me,ye)}return null}function Se(me,he,ye,Me,et){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return me=me.get(ye)||null,U(he,me,""+Me,et);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:return me=me.get(Me.key===null?ye:Me.key)||null,le(he,me,Me,et);case g:return me=me.get(Me.key===null?ye:Me.key)||null,we(he,me,Me,et);case H:var zt=Me._init;return Me=zt(Me._payload),Se(me,he,ye,Me,et)}if(re(Me)||j(Me))return me=me.get(ye)||null,Oe(he,me,Me,et,null);if(typeof Me.then=="function")return Se(me,he,ye,vx(Me),et);if(Me.$$typeof===R)return Se(me,he,ye,ix(he,Me),et);yx(he,Me)}return null}function xt(me,he,ye,Me){for(var et=null,zt=null,ot=he,vt=he=0,gi=null;ot!==null&&vt<ye.length;vt++){ot.index>vt?(gi=ot,ot=null):gi=ot.sibling;var fr=be(me,ot,ye[vt],Me);if(fr===null){ot===null&&(ot=gi);break}c&&ot&&fr.alternate===null&&f(me,ot),he=T(fr,he,vt),zt===null?et=fr:zt.sibling=fr,zt=fr,ot=gi}if(vt===ye.length)return p(me,ot),pr&&df(me,vt),et;if(ot===null){for(;vt<ye.length;vt++)ot=De(me,ye[vt],Me),ot!==null&&(he=T(ot,he,vt),zt===null?et=ot:zt.sibling=ot,zt=ot);return pr&&df(me,vt),et}for(ot=v(ot);vt<ye.length;vt++)gi=Se(ot,me,vt,ye[vt],Me),gi!==null&&(c&&gi.alternate!==null&&ot.delete(gi.key===null?vt:gi.key),he=T(gi,he,vt),zt===null?et=gi:zt.sibling=gi,zt=gi);return c&&ot.forEach(function(hu){return f(me,hu)}),pr&&df(me,vt),et}function mt(me,he,ye,Me){if(ye==null)throw Error(n(151));for(var et=null,zt=null,ot=he,vt=he=0,gi=null,fr=ye.next();ot!==null&&!fr.done;vt++,fr=ye.next()){ot.index>vt?(gi=ot,ot=null):gi=ot.sibling;var hu=be(me,ot,fr.value,Me);if(hu===null){ot===null&&(ot=gi);break}c&&ot&&hu.alternate===null&&f(me,ot),he=T(hu,he,vt),zt===null?et=hu:zt.sibling=hu,zt=hu,ot=gi}if(fr.done)return p(me,ot),pr&&df(me,vt),et;if(ot===null){for(;!fr.done;vt++,fr=ye.next())fr=De(me,fr.value,Me),fr!==null&&(he=T(fr,he,vt),zt===null?et=fr:zt.sibling=fr,zt=fr);return pr&&df(me,vt),et}for(ot=v(ot);!fr.done;vt++,fr=ye.next())fr=Se(ot,me,vt,fr.value,Me),fr!==null&&(c&&fr.alternate!==null&&ot.delete(fr.key===null?vt:fr.key),he=T(fr,he,vt),zt===null?et=fr:zt.sibling=fr,zt=fr);return c&&ot.forEach(function(aie){return f(me,aie)}),pr&&df(me,vt),et}function Tr(me,he,ye,Me){if(typeof ye=="object"&&ye!==null&&ye.type===y&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case m:e:{for(var et=ye.key;he!==null;){if(he.key===et){if(et=ye.type,et===y){if(he.tag===7){p(me,he.sibling),Me=w(he,ye.props.children),Me.return=me,me=Me;break e}}else if(he.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===H&&SL(et)===he.type){p(me,he.sibling),Me=w(he,ye.props),K0(Me,ye),Me.return=me,me=Me;break e}p(me,he);break}else f(me,he);he=he.sibling}ye.type===y?(Me=ff(ye.props.children,me.mode,Me,ye.key),Me.return=me,me=Me):(Me=ex(ye.type,ye.key,ye.props,null,me.mode,Me),K0(Me,ye),Me.return=me,me=Me)}return F(me);case g:e:{for(et=ye.key;he!==null;){if(he.key===et)if(he.tag===4&&he.stateNode.containerInfo===ye.containerInfo&&he.stateNode.implementation===ye.implementation){p(me,he.sibling),Me=w(he,ye.children||[]),Me.return=me,me=Me;break e}else{p(me,he);break}else f(me,he);he=he.sibling}Me=ZC(ye,me.mode,Me),Me.return=me,me=Me}return F(me);case H:return et=ye._init,ye=et(ye._payload),Tr(me,he,ye,Me)}if(re(ye))return xt(me,he,ye,Me);if(j(ye)){if(et=j(ye),typeof et!="function")throw Error(n(150));return ye=et.call(ye),mt(me,he,ye,Me)}if(typeof ye.then=="function")return Tr(me,he,vx(ye),Me);if(ye.$$typeof===R)return Tr(me,he,ix(me,ye),Me);yx(me,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint"?(ye=""+ye,he!==null&&he.tag===6?(p(me,he.sibling),Me=w(he,ye),Me.return=me,me=Me):(p(me,he),Me=QC(ye,me.mode,Me),Me.return=me,me=Me),F(me)):p(me,he)}return function(me,he,ye,Me){try{q0=0;var et=Tr(me,he,ye,Me);return md=null,et}catch(ot){if(ot===B0||ot===ox)throw ot;var zt=Qs(29,ot,null,me.mode);return zt.lanes=Me,zt.return=me,zt}finally{}}}var gd=CL(!0),TL=CL(!1),Oo=ce(null),Za=null;function Qc(c){var f=c.alternate;A(oi,oi.current&1),A(Oo,c),Za===null&&(f===null||fd.current!==null||f.memoizedState!==null)&&(Za=c)}function EL(c){if(c.tag===22){if(A(oi,oi.current),A(Oo,c),Za===null){var f=c.alternate;f!==null&&f.memoizedState!==null&&(Za=c)}}else Zc()}function Zc(){A(oi,oi.current),A(Oo,Oo.current)}function ec(c){S(Oo),Za===c&&(Za=null),S(oi)}var oi=ce(0);function xx(c){for(var f=c;f!==null;){if(f.tag===13){var p=f.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||wE(p)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function MT(c,f,p,v){f=c.memoizedState,p=p(v,f),p=p==null?f:h({},f,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var DT={enqueueSetState:function(c,f,p){c=c._reactInternals;var v=to(),w=qc(v);w.payload=f,p!=null&&(w.callback=p),f=Kc(c,w,v),f!==null&&(ro(f,c,v),j0(f,c,v))},enqueueReplaceState:function(c,f,p){c=c._reactInternals;var v=to(),w=qc(v);w.tag=1,w.payload=f,p!=null&&(w.callback=p),f=Kc(c,w,v),f!==null&&(ro(f,c,v),j0(f,c,v))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var p=to(),v=qc(p);v.tag=2,f!=null&&(v.callback=f),f=Kc(c,v,p),f!==null&&(ro(f,c,p),j0(f,c,p))}};function RL(c,f,p,v,w,T,F){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(v,T,F):f.prototype&&f.prototype.isPureReactComponent?!M0(p,v)||!M0(w,T):!0}function AL(c,f,p,v){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(p,v),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(p,v),f.state!==c&&DT.enqueueReplaceState(f,f.state,null)}function wf(c,f){var p=f;if("ref"in f){p={};for(var v in f)v!=="ref"&&(p[v]=f[v])}if(c=c.defaultProps){p===f&&(p=h({},p));for(var w in c)p[w]===void 0&&(p[w]=c[w])}return p}var wx=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)};function kL(c){wx(c)}function OL(c){console.error(c)}function _L(c){wx(c)}function bx(c,f){try{var p=c.onUncaughtError;p(f.value,{componentStack:f.stack})}catch(v){setTimeout(function(){throw v})}}function ML(c,f,p){try{var v=c.onCaughtError;v(p.value,{componentStack:p.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function PT(c,f,p){return p=qc(p),p.tag=3,p.payload={element:null},p.callback=function(){bx(c,f)},p}function DL(c){return c=qc(c),c.tag=3,c}function PL(c,f,p,v){var w=p.type.getDerivedStateFromError;if(typeof w=="function"){var T=v.value;c.payload=function(){return w(T)},c.callback=function(){ML(f,p,v)}}var F=p.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(c.callback=function(){ML(f,p,v),typeof w!="function"&&(iu===null?iu=new Set([this]):iu.add(this));var U=v.stack;this.componentDidCatch(v.value,{componentStack:U!==null?U:""})})}function ane(c,f,p,v,w){if(p.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(f=p.alternate,f!==null&&L0(f,p,w,!0),p=Oo.current,p!==null){switch(p.tag){case 13:return Za===null?nE():p.alternate===null&&xn===0&&(xn=3),p.flags&=-257,p.flags|=65536,p.lanes=w,v===lT?p.flags|=16384:(f=p.updateQueue,f===null?p.updateQueue=new Set([v]):f.add(v),sE(c,v,w)),!1;case 22:return p.flags|=65536,v===lT?p.flags|=16384:(f=p.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([v])},p.updateQueue=f):(p=f.retryQueue,p===null?f.retryQueue=new Set([v]):p.add(v)),sE(c,v,w)),!1}throw Error(n(435,p.tag))}return sE(c,v,w),nE(),!1}if(pr)return f=Oo.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=w,v!==tT&&(c=Error(n(422),{cause:v}),N0(Eo(c,p)))):(v!==tT&&(f=Error(n(423),{cause:v}),N0(Eo(f,p))),c=c.current.alternate,c.flags|=65536,w&=-w,c.lanes|=w,v=Eo(v,p),w=PT(c.stateNode,v,w),fT(c,w),xn!==4&&(xn=2)),!1;var T=Error(n(520),{cause:v});if(T=Eo(T,p),rm===null?rm=[T]:rm.push(T),xn!==4&&(xn=2),f===null)return!0;v=Eo(v,p),p=f;do{switch(p.tag){case 3:return p.flags|=65536,c=w&-w,p.lanes|=c,c=PT(p.stateNode,v,c),fT(p,c),!1;case 1:if(f=p.type,T=p.stateNode,(p.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(iu===null||!iu.has(T))))return p.flags|=65536,w&=-w,p.lanes|=w,w=DL(w),PL(w,c,p,v),fT(p,w),!1}p=p.return}while(p!==null);return!1}var IL=Error(n(461)),pi=!1;function ki(c,f,p,v){f.child=c===null?TL(f,null,p,v):gd(f,c.child,p,v)}function NL(c,f,p,v,w){p=p.render;var T=f.ref;if("ref"in v){var F={};for(var U in v)U!=="ref"&&(F[U]=v[U])}else F=v;return vf(f),v=gT(c,f,p,F,T,w),U=vT(),c!==null&&!pi?(yT(c,f,w),tc(c,f,w)):(pr&&U&&JC(f),f.flags|=1,ki(c,f,v,w),f.child)}function LL(c,f,p,v,w){if(c===null){var T=p.type;return typeof T=="function"&&!XC(T)&&T.defaultProps===void 0&&p.compare===null?(f.tag=15,f.type=T,FL(c,f,T,v,w)):(c=ex(p.type,null,v,f,f.mode,w),c.ref=f.ref,c.return=f,f.child=c)}if(T=c.child,!jT(c,w)){var F=T.memoizedProps;if(p=p.compare,p=p!==null?p:M0,p(F,v)&&c.ref===f.ref)return tc(c,f,w)}return f.flags|=1,c=ql(T,v),c.ref=f.ref,c.return=f,f.child=c}function FL(c,f,p,v,w){if(c!==null){var T=c.memoizedProps;if(M0(T,v)&&c.ref===f.ref)if(pi=!1,f.pendingProps=v=T,jT(c,w))(c.flags&131072)!==0&&(pi=!0);else return f.lanes=c.lanes,tc(c,f,w)}return IT(c,f,p,v,w)}function HL(c,f,p){var v=f.pendingProps,w=v.children,T=c!==null?c.memoizedState:null;if(v.mode==="hidden"){if((f.flags&128)!==0){if(v=T!==null?T.baseLanes|p:p,c!==null){for(w=f.child=c.child,T=0;w!==null;)T=T|w.lanes|w.childLanes,w=w.sibling;f.childLanes=T&~v}else f.childLanes=0,f.child=null;return BL(c,f,v,p)}if((p&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},c!==null&&sx(f,T!==null?T.cachePool:null),T!==null?F4(f,T):dT(),EL(f);else return f.lanes=f.childLanes=536870912,BL(c,f,T!==null?T.baseLanes|p:p,p)}else T!==null?(sx(f,T.cachePool),F4(f,T),Zc(),f.memoizedState=null):(c!==null&&sx(f,null),dT(),Zc());return ki(c,f,w,p),f.child}function BL(c,f,p,v){var w=aT();return w=w===null?null:{parent:si._currentValue,pool:w},f.memoizedState={baseLanes:p,cachePool:w},c!==null&&sx(f,null),dT(),EL(f),c!==null&&L0(c,f,v,!0),null}function Sx(c,f){var p=f.ref;if(p===null)c!==null&&c.ref!==null&&(f.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(c===null||c.ref!==p)&&(f.flags|=4194816)}}function IT(c,f,p,v,w){return vf(f),p=gT(c,f,p,v,void 0,w),v=vT(),c!==null&&!pi?(yT(c,f,w),tc(c,f,w)):(pr&&v&&JC(f),f.flags|=1,ki(c,f,p,w),f.child)}function VL(c,f,p,v,w,T){return vf(f),f.updateQueue=null,p=B4(f,v,p,w),H4(c),v=vT(),c!==null&&!pi?(yT(c,f,T),tc(c,f,T)):(pr&&v&&JC(f),f.flags|=1,ki(c,f,p,T),f.child)}function jL(c,f,p,v,w){if(vf(f),f.stateNode===null){var T=od,F=p.contextType;typeof F=="object"&&F!==null&&(T=Ui(F)),T=new p(v,T),f.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=DT,f.stateNode=T,T._reactInternals=f,T=f.stateNode,T.props=v,T.state=f.memoizedState,T.refs={},cT(f),F=p.contextType,T.context=typeof F=="object"&&F!==null?Ui(F):od,T.state=f.memoizedState,F=p.getDerivedStateFromProps,typeof F=="function"&&(MT(f,p,F,v),T.state=f.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(F=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),F!==T.state&&DT.enqueueReplaceState(T,T.state,null),z0(f,v,T,w),W0(),T.state=f.memoizedState),typeof T.componentDidMount=="function"&&(f.flags|=4194308),v=!0}else if(c===null){T=f.stateNode;var U=f.memoizedProps,le=wf(p,U);T.props=le;var we=T.context,Oe=p.contextType;F=od,typeof Oe=="object"&&Oe!==null&&(F=Ui(Oe));var De=p.getDerivedStateFromProps;Oe=typeof De=="function"||typeof T.getSnapshotBeforeUpdate=="function",U=f.pendingProps!==U,Oe||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(U||we!==F)&&AL(f,T,v,F),Yc=!1;var be=f.memoizedState;T.state=be,z0(f,v,T,w),W0(),we=f.memoizedState,U||be!==we||Yc?(typeof De=="function"&&(MT(f,p,De,v),we=f.memoizedState),(le=Yc||RL(f,p,le,v,be,we,F))?(Oe||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(f.flags|=4194308)):(typeof T.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=v,f.memoizedState=we),T.props=v,T.state=we,T.context=F,v=le):(typeof T.componentDidMount=="function"&&(f.flags|=4194308),v=!1)}else{T=f.stateNode,uT(c,f),F=f.memoizedProps,Oe=wf(p,F),T.props=Oe,De=f.pendingProps,be=T.context,we=p.contextType,le=od,typeof we=="object"&&we!==null&&(le=Ui(we)),U=p.getDerivedStateFromProps,(we=typeof U=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(F!==De||be!==le)&&AL(f,T,v,le),Yc=!1,be=f.memoizedState,T.state=be,z0(f,v,T,w),W0();var Se=f.memoizedState;F!==De||be!==Se||Yc||c!==null&&c.dependencies!==null&&nx(c.dependencies)?(typeof U=="function"&&(MT(f,p,U,v),Se=f.memoizedState),(Oe=Yc||RL(f,p,Oe,v,be,Se,le)||c!==null&&c.dependencies!==null&&nx(c.dependencies))?(we||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(v,Se,le),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(v,Se,le)),typeof T.componentDidUpdate=="function"&&(f.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof T.componentDidUpdate!="function"||F===c.memoizedProps&&be===c.memoizedState||(f.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||F===c.memoizedProps&&be===c.memoizedState||(f.flags|=1024),f.memoizedProps=v,f.memoizedState=Se),T.props=v,T.state=Se,T.context=le,v=Oe):(typeof T.componentDidUpdate!="function"||F===c.memoizedProps&&be===c.memoizedState||(f.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||F===c.memoizedProps&&be===c.memoizedState||(f.flags|=1024),v=!1)}return T=v,Sx(c,f),v=(f.flags&128)!==0,T||v?(T=f.stateNode,p=v&&typeof p.getDerivedStateFromError!="function"?null:T.render(),f.flags|=1,c!==null&&v?(f.child=gd(f,c.child,null,w),f.child=gd(f,null,p,w)):ki(c,f,p,w),f.memoizedState=T.state,c=f.child):c=tc(c,f,w),c}function WL(c,f,p,v){return I0(),f.flags|=256,ki(c,f,p,v),f.child}var NT={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function LT(c){return{baseLanes:c,cachePool:O4()}}function FT(c,f,p){return c=c!==null?c.childLanes&~p:0,f&&(c|=_o),c}function zL(c,f,p){var v=f.pendingProps,w=!1,T=(f.flags&128)!==0,F;if((F=T)||(F=c!==null&&c.memoizedState===null?!1:(oi.current&2)!==0),F&&(w=!0,f.flags&=-129),F=(f.flags&32)!==0,f.flags&=-33,c===null){if(pr){if(w?Qc(f):Zc(),pr){var U=yn,le;if(le=U){e:{for(le=U,U=Qa;le.nodeType!==8;){if(!U){U=null;break e}if(le=Sa(le.nextSibling),le===null){U=null;break e}}U=le}U!==null?(f.memoizedState={dehydrated:U,treeContext:hf!==null?{id:Kl,overflow:Xl}:null,retryLane:536870912,hydrationErrors:null},le=Qs(18,null,null,0),le.stateNode=U,le.return=f,f.child=le,cs=f,yn=null,le=!0):le=!1}le||mf(f)}if(U=f.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return wE(U)?f.lanes=32:f.lanes=536870912,null;ec(f)}return U=v.children,v=v.fallback,w?(Zc(),w=f.mode,U=Cx({mode:"hidden",children:U},w),v=ff(v,w,p,null),U.return=f,v.return=f,U.sibling=v,f.child=U,w=f.child,w.memoizedState=LT(p),w.childLanes=FT(c,F,p),f.memoizedState=NT,v):(Qc(f),HT(f,U))}if(le=c.memoizedState,le!==null&&(U=le.dehydrated,U!==null)){if(T)f.flags&256?(Qc(f),f.flags&=-257,f=BT(c,f,p)):f.memoizedState!==null?(Zc(),f.child=c.child,f.flags|=128,f=null):(Zc(),w=v.fallback,U=f.mode,v=Cx({mode:"visible",children:v.children},U),w=ff(w,U,p,null),w.flags|=2,v.return=f,w.return=f,v.sibling=w,f.child=v,gd(f,c.child,null,p),v=f.child,v.memoizedState=LT(p),v.childLanes=FT(c,F,p),f.memoizedState=NT,f=w);else if(Qc(f),wE(U)){if(F=U.nextSibling&&U.nextSibling.dataset,F)var we=F.dgst;F=we,v=Error(n(419)),v.stack="",v.digest=F,N0({value:v,source:null,stack:null}),f=BT(c,f,p)}else if(pi||L0(c,f,p,!1),F=(p&c.childLanes)!==0,pi||F){if(F=jr,F!==null&&(v=p&-p,v=(v&42)!==0?1:zi(v),v=(v&(F.suspendedLanes|p))!==0?0:v,v!==0&&v!==le.retryLane))throw le.retryLane=v,sd(c,v),ro(F,c,v),IL;U.data==="$?"||nE(),f=BT(c,f,p)}else U.data==="$?"?(f.flags|=192,f.child=c.child,f=null):(c=le.treeContext,yn=Sa(U.nextSibling),cs=f,pr=!0,pf=null,Qa=!1,c!==null&&(Ao[ko++]=Kl,Ao[ko++]=Xl,Ao[ko++]=hf,Kl=c.id,Xl=c.overflow,hf=f),f=HT(f,v.children),f.flags|=4096);return f}return w?(Zc(),w=v.fallback,U=f.mode,le=c.child,we=le.sibling,v=ql(le,{mode:"hidden",children:v.children}),v.subtreeFlags=le.subtreeFlags&65011712,we!==null?w=ql(we,w):(w=ff(w,U,p,null),w.flags|=2),w.return=f,v.return=f,v.sibling=w,f.child=v,v=w,w=f.child,U=c.child.memoizedState,U===null?U=LT(p):(le=U.cachePool,le!==null?(we=si._currentValue,le=le.parent!==we?{parent:we,pool:we}:le):le=O4(),U={baseLanes:U.baseLanes|p,cachePool:le}),w.memoizedState=U,w.childLanes=FT(c,F,p),f.memoizedState=NT,v):(Qc(f),p=c.child,c=p.sibling,p=ql(p,{mode:"visible",children:v.children}),p.return=f,p.sibling=null,c!==null&&(F=f.deletions,F===null?(f.deletions=[c],f.flags|=16):F.push(c)),f.child=p,f.memoizedState=null,p)}function HT(c,f){return f=Cx({mode:"visible",children:f},c.mode),f.return=c,c.child=f}function Cx(c,f){return c=Qs(22,c,null,f),c.lanes=0,c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},c}function BT(c,f,p){return gd(f,c.child,null,p),c=HT(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function UL(c,f,p){c.lanes|=f;var v=c.alternate;v!==null&&(v.lanes|=f),nT(c.return,f,p)}function VT(c,f,p,v,w){var T=c.memoizedState;T===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:w}:(T.isBackwards=f,T.rendering=null,T.renderingStartTime=0,T.last=v,T.tail=p,T.tailMode=w)}function $L(c,f,p){var v=f.pendingProps,w=v.revealOrder,T=v.tail;if(ki(c,f,v.children,p),v=oi.current,(v&2)!==0)v=v&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&UL(c,p,f);else if(c.tag===19)UL(c,p,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}v&=1}switch(A(oi,v),w){case"forwards":for(p=f.child,w=null;p!==null;)c=p.alternate,c!==null&&xx(c)===null&&(w=p),p=p.sibling;p=w,p===null?(w=f.child,f.child=null):(w=p.sibling,p.sibling=null),VT(f,!1,w,p,T);break;case"backwards":for(p=null,w=f.child,f.child=null;w!==null;){if(c=w.alternate,c!==null&&xx(c)===null){f.child=w;break}c=w.sibling,w.sibling=p,p=w,w=c}VT(f,!0,p,null,T);break;case"together":VT(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function tc(c,f,p){if(c!==null&&(f.dependencies=c.dependencies),nu|=f.lanes,(p&f.childLanes)===0)if(c!==null){if(L0(c,f,p,!1),(p&f.childLanes)===0)return null}else return null;if(c!==null&&f.child!==c.child)throw Error(n(153));if(f.child!==null){for(c=f.child,p=ql(c,c.pendingProps),f.child=p,p.return=f;c.sibling!==null;)c=c.sibling,p=p.sibling=ql(c,c.pendingProps),p.return=f;p.sibling=null}return f.child}function jT(c,f){return(c.lanes&f)!==0?!0:(c=c.dependencies,!!(c!==null&&nx(c)))}function lne(c,f,p){switch(f.tag){case 3:ae(f,f.stateNode.containerInfo),Gc(f,si,c.memoizedState.cache),I0();break;case 27:case 5:pe(f);break;case 4:ae(f,f.stateNode.containerInfo);break;case 10:Gc(f,f.type,f.memoizedProps.value);break;case 13:var v=f.memoizedState;if(v!==null)return v.dehydrated!==null?(Qc(f),f.flags|=128,null):(p&f.child.childLanes)!==0?zL(c,f,p):(Qc(f),c=tc(c,f,p),c!==null?c.sibling:null);Qc(f);break;case 19:var w=(c.flags&128)!==0;if(v=(p&f.childLanes)!==0,v||(L0(c,f,p,!1),v=(p&f.childLanes)!==0),w){if(v)return $L(c,f,p);f.flags|=128}if(w=f.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),A(oi,oi.current),v)break;return null;case 22:case 23:return f.lanes=0,HL(c,f,p);case 24:Gc(f,si,c.memoizedState.cache)}return tc(c,f,p)}function GL(c,f,p){if(c!==null)if(c.memoizedProps!==f.pendingProps)pi=!0;else{if(!jT(c,p)&&(f.flags&128)===0)return pi=!1,lne(c,f,p);pi=(c.flags&131072)!==0}else pi=!1,pr&&(f.flags&1048576)!==0&&S4(f,rx,f.index);switch(f.lanes=0,f.tag){case 16:e:{c=f.pendingProps;var v=f.elementType,w=v._init;if(v=w(v._payload),f.type=v,typeof v=="function")XC(v)?(c=wf(v,c),f.tag=1,f=jL(null,f,v,c,p)):(f.tag=0,f=IT(null,f,v,c,p));else{if(v!=null){if(w=v.$$typeof,w===k){f.tag=11,f=NL(null,f,v,c,p);break e}else if(w===D){f.tag=14,f=LL(null,f,v,c,p);break e}}throw f=oe(v)||v,Error(n(306,f,""))}}return f;case 0:return IT(c,f,f.type,f.pendingProps,p);case 1:return v=f.type,w=wf(v,f.pendingProps),jL(c,f,v,w,p);case 3:e:{if(ae(f,f.stateNode.containerInfo),c===null)throw Error(n(387));v=f.pendingProps;var T=f.memoizedState;w=T.element,uT(c,f),z0(f,v,null,p);var F=f.memoizedState;if(v=F.cache,Gc(f,si,v),v!==T.cache&&iT(f,[si],p,!0),W0(),v=F.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:F.cache},f.updateQueue.baseState=T,f.memoizedState=T,f.flags&256){f=WL(c,f,v,p);break e}else if(v!==w){w=Eo(Error(n(424)),f),N0(w),f=WL(c,f,v,p);break e}else{switch(c=f.stateNode.containerInfo,c.nodeType){case 9:c=c.body;break;default:c=c.nodeName==="HTML"?c.ownerDocument.body:c}for(yn=Sa(c.firstChild),cs=f,pr=!0,pf=null,Qa=!0,p=TL(f,null,v,p),f.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(I0(),v===w){f=tc(c,f,p);break e}ki(c,f,v,p)}f=f.child}return f;case 26:return Sx(c,f),c===null?(p=X3(f.type,null,f.pendingProps,null))?f.memoizedState=p:pr||(p=f.type,c=f.pendingProps,v=Fx(V.current).createElement(p),v[ut]=f,v[ht]=c,_i(v,p,c),ge(v),f.stateNode=v):f.memoizedState=X3(f.type,c.memoizedProps,f.pendingProps,c.memoizedState),null;case 27:return pe(f),c===null&&pr&&(v=f.stateNode=Y3(f.type,f.pendingProps,V.current),cs=f,Qa=!0,w=yn,au(f.type)?(bE=w,yn=Sa(v.firstChild)):yn=w),ki(c,f,f.pendingProps.children,p),Sx(c,f),c===null&&(f.flags|=4194304),f.child;case 5:return c===null&&pr&&((w=v=yn)&&(v=Lne(v,f.type,f.pendingProps,Qa),v!==null?(f.stateNode=v,cs=f,yn=Sa(v.firstChild),Qa=!1,w=!0):w=!1),w||mf(f)),pe(f),w=f.type,T=f.pendingProps,F=c!==null?c.memoizedProps:null,v=T.children,vE(w,T)?v=null:F!==null&&vE(w,F)&&(f.flags|=32),f.memoizedState!==null&&(w=gT(c,f,ene,null,null,p),fm._currentValue=w),Sx(c,f),ki(c,f,v,p),f.child;case 6:return c===null&&pr&&((c=p=yn)&&(p=Fne(p,f.pendingProps,Qa),p!==null?(f.stateNode=p,cs=f,yn=null,c=!0):c=!1),c||mf(f)),null;case 13:return zL(c,f,p);case 4:return ae(f,f.stateNode.containerInfo),v=f.pendingProps,c===null?f.child=gd(f,null,v,p):ki(c,f,v,p),f.child;case 11:return NL(c,f,f.type,f.pendingProps,p);case 7:return ki(c,f,f.pendingProps,p),f.child;case 8:return ki(c,f,f.pendingProps.children,p),f.child;case 12:return ki(c,f,f.pendingProps.children,p),f.child;case 10:return v=f.pendingProps,Gc(f,f.type,v.value),ki(c,f,v.children,p),f.child;case 9:return w=f.type._context,v=f.pendingProps.children,vf(f),w=Ui(w),v=v(w),f.flags|=1,ki(c,f,v,p),f.child;case 14:return LL(c,f,f.type,f.pendingProps,p);case 15:return FL(c,f,f.type,f.pendingProps,p);case 19:return $L(c,f,p);case 31:return v=f.pendingProps,p=f.mode,v={mode:v.mode,children:v.children},c===null?(p=Cx(v,p),p.ref=f.ref,f.child=p,p.return=f,f=p):(p=ql(c.child,v),p.ref=f.ref,f.child=p,p.return=f,f=p),f;case 22:return HL(c,f,p);case 24:return vf(f),v=Ui(si),c===null?(w=aT(),w===null&&(w=jr,T=sT(),w.pooledCache=T,T.refCount++,T!==null&&(w.pooledCacheLanes|=p),w=T),f.memoizedState={parent:v,cache:w},cT(f),Gc(f,si,w)):((c.lanes&p)!==0&&(uT(c,f),z0(f,null,null,p),W0()),w=c.memoizedState,T=f.memoizedState,w.parent!==v?(w={parent:v,cache:v},f.memoizedState=w,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=w),Gc(f,si,v)):(v=T.cache,Gc(f,si,v),v!==w.cache&&iT(f,[si],p,!0))),ki(c,f,f.pendingProps.children,p),f.child;case 29:throw f.pendingProps}throw Error(n(156,f.tag))}function rc(c){c.flags|=4}function YL(c,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!tF(f)){if(f=Oo.current,f!==null&&((rr&4194048)===rr?Za!==null:(rr&62914560)!==rr&&(rr&536870912)===0||f!==Za))throw V0=lT,_4;c.flags|=8192}}function Tx(c,f){f!==null&&(c.flags|=4),c.flags&16384&&(f=c.tag!==22?Ai():536870912,c.lanes|=f,wd|=f)}function X0(c,f){if(!pr)switch(c.tailMode){case"hidden":f=c.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:v.sibling=null}}function dn(c){var f=c.alternate!==null&&c.alternate.child===c.child,p=0,v=0;if(f)for(var w=c.child;w!==null;)p|=w.lanes|w.childLanes,v|=w.subtreeFlags&65011712,v|=w.flags&65011712,w.return=c,w=w.sibling;else for(w=c.child;w!==null;)p|=w.lanes|w.childLanes,v|=w.subtreeFlags,v|=w.flags,w.return=c,w=w.sibling;return c.subtreeFlags|=v,c.childLanes=p,f}function cne(c,f,p){var v=f.pendingProps;switch(eT(f),f.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(f),null;case 1:return dn(f),null;case 3:return p=f.stateNode,v=null,c!==null&&(v=c.memoizedState.cache),f.memoizedState.cache!==v&&(f.flags|=2048),Zl(si),ue(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(c===null||c.child===null)&&(P0(f)?rc(f):c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,E4())),dn(f),null;case 26:return p=f.memoizedState,c===null?(rc(f),p!==null?(dn(f),YL(f,p)):(dn(f),f.flags&=-16777217)):p?p!==c.memoizedState?(rc(f),dn(f),YL(f,p)):(dn(f),f.flags&=-16777217):(c.memoizedProps!==v&&rc(f),dn(f),f.flags&=-16777217),null;case 27:ke(f),p=V.current;var w=f.type;if(c!==null&&f.stateNode!=null)c.memoizedProps!==v&&rc(f);else{if(!v){if(f.stateNode===null)throw Error(n(166));return dn(f),null}c=M.current,P0(f)?C4(f):(c=Y3(w,v,p),f.stateNode=c,rc(f))}return dn(f),null;case 5:if(ke(f),p=f.type,c!==null&&f.stateNode!=null)c.memoizedProps!==v&&rc(f);else{if(!v){if(f.stateNode===null)throw Error(n(166));return dn(f),null}if(c=M.current,P0(f))C4(f);else{switch(w=Fx(V.current),c){case 1:c=w.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:c=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":c=w.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":c=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":c=w.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild);break;case"select":c=typeof v.is=="string"?w.createElement("select",{is:v.is}):w.createElement("select"),v.multiple?c.multiple=!0:v.size&&(c.size=v.size);break;default:c=typeof v.is=="string"?w.createElement(p,{is:v.is}):w.createElement(p)}}c[ut]=f,c[ht]=v;e:for(w=f.child;w!==null;){if(w.tag===5||w.tag===6)c.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===f)break e;for(;w.sibling===null;){if(w.return===null||w.return===f)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}f.stateNode=c;e:switch(_i(c,p,v),p){case"button":case"input":case"select":case"textarea":c=!!v.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&rc(f)}}return dn(f),f.flags&=-16777217,null;case 6:if(c&&f.stateNode!=null)c.memoizedProps!==v&&rc(f);else{if(typeof v!="string"&&f.stateNode===null)throw Error(n(166));if(c=V.current,P0(f)){if(c=f.stateNode,p=f.memoizedProps,v=null,w=cs,w!==null)switch(w.tag){case 27:case 5:v=w.memoizedProps}c[ut]=f,c=!!(c.nodeValue===p||v!==null&&v.suppressHydrationWarning===!0||V3(c.nodeValue,p)),c||mf(f)}else c=Fx(c).createTextNode(v),c[ut]=f,f.stateNode=c}return dn(f),null;case 13:if(v=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(w=P0(f),v!==null&&v.dehydrated!==null){if(c===null){if(!w)throw Error(n(318));if(w=f.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[ut]=f}else I0(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;dn(f),w=!1}else w=E4(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=w),w=!0;if(!w)return f.flags&256?(ec(f),f):(ec(f),null)}if(ec(f),(f.flags&128)!==0)return f.lanes=p,f;if(p=v!==null,c=c!==null&&c.memoizedState!==null,p){v=f.child,w=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(w=v.alternate.memoizedState.cachePool.pool);var T=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(T=v.memoizedState.cachePool.pool),T!==w&&(v.flags|=2048)}return p!==c&&p&&(f.child.flags|=8192),Tx(f,f.updateQueue),dn(f),null;case 4:return ue(),c===null&&hE(f.stateNode.containerInfo),dn(f),null;case 10:return Zl(f.type),dn(f),null;case 19:if(S(oi),w=f.memoizedState,w===null)return dn(f),null;if(v=(f.flags&128)!==0,T=w.rendering,T===null)if(v)X0(w,!1);else{if(xn!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(T=xx(c),T!==null){for(f.flags|=128,X0(w,!1),c=T.updateQueue,f.updateQueue=c,Tx(f,c),f.subtreeFlags=0,c=p,p=f.child;p!==null;)b4(p,c),p=p.sibling;return A(oi,oi.current&1|2),f.child}c=c.sibling}w.tail!==null&&Ee()>Ax&&(f.flags|=128,v=!0,X0(w,!1),f.lanes=4194304)}else{if(!v)if(c=xx(T),c!==null){if(f.flags|=128,v=!0,c=c.updateQueue,f.updateQueue=c,Tx(f,c),X0(w,!0),w.tail===null&&w.tailMode==="hidden"&&!T.alternate&&!pr)return dn(f),null}else 2*Ee()-w.renderingStartTime>Ax&&p!==536870912&&(f.flags|=128,v=!0,X0(w,!1),f.lanes=4194304);w.isBackwards?(T.sibling=f.child,f.child=T):(c=w.last,c!==null?c.sibling=T:f.child=T,w.last=T)}return w.tail!==null?(f=w.tail,w.rendering=f,w.tail=f.sibling,w.renderingStartTime=Ee(),f.sibling=null,c=oi.current,A(oi,v?c&1|2:c&1),f):(dn(f),null);case 22:case 23:return ec(f),pT(),v=f.memoizedState!==null,c!==null?c.memoizedState!==null!==v&&(f.flags|=8192):v&&(f.flags|=8192),v?(p&536870912)!==0&&(f.flags&128)===0&&(dn(f),f.subtreeFlags&6&&(f.flags|=8192)):dn(f),p=f.updateQueue,p!==null&&Tx(f,p.retryQueue),p=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),v=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==p&&(f.flags|=2048),c!==null&&S(yf),null;case 24:return p=null,c!==null&&(p=c.memoizedState.cache),f.memoizedState.cache!==p&&(f.flags|=2048),Zl(si),dn(f),null;case 25:return null;case 30:return null}throw Error(n(156,f.tag))}function une(c,f){switch(eT(f),f.tag){case 1:return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return Zl(si),ue(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 26:case 27:case 5:return ke(f),null;case 13:if(ec(f),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(n(340));I0()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return S(oi),null;case 4:return ue(),null;case 10:return Zl(f.type),null;case 22:case 23:return ec(f),pT(),c!==null&&S(yf),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 24:return Zl(si),null;case 25:return null;default:return null}}function qL(c,f){switch(eT(f),f.tag){case 3:Zl(si),ue();break;case 26:case 27:case 5:ke(f);break;case 4:ue();break;case 13:ec(f);break;case 19:S(oi);break;case 10:Zl(f.type);break;case 22:case 23:ec(f),pT(),c!==null&&S(yf);break;case 24:Zl(si)}}function Q0(c,f){try{var p=f.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var w=v.next;p=w;do{if((p.tag&c)===c){v=void 0;var T=p.create,F=p.inst;v=T(),F.destroy=v}p=p.next}while(p!==w)}}catch(U){_r(f,f.return,U)}}function Jc(c,f,p){try{var v=f.updateQueue,w=v!==null?v.lastEffect:null;if(w!==null){var T=w.next;v=T;do{if((v.tag&c)===c){var F=v.inst,U=F.destroy;if(U!==void 0){F.destroy=void 0,w=f;var le=p,we=U;try{we()}catch(Oe){_r(w,le,Oe)}}}v=v.next}while(v!==T)}}catch(Oe){_r(f,f.return,Oe)}}function KL(c){var f=c.updateQueue;if(f!==null){var p=c.stateNode;try{L4(f,p)}catch(v){_r(c,c.return,v)}}}function XL(c,f,p){p.props=wf(c.type,c.memoizedProps),p.state=c.memoizedState;try{p.componentWillUnmount()}catch(v){_r(c,f,v)}}function Z0(c,f){try{var p=c.ref;if(p!==null){switch(c.tag){case 26:case 27:case 5:var v=c.stateNode;break;case 30:v=c.stateNode;break;default:v=c.stateNode}typeof p=="function"?c.refCleanup=p(v):p.current=v}}catch(w){_r(c,f,w)}}function Ja(c,f){var p=c.ref,v=c.refCleanup;if(p!==null)if(typeof v=="function")try{v()}catch(w){_r(c,f,w)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(w){_r(c,f,w)}else p.current=null}function QL(c){var f=c.type,p=c.memoizedProps,v=c.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":p.autoFocus&&v.focus();break e;case"img":p.src?v.src=p.src:p.srcSet&&(v.srcset=p.srcSet)}}catch(w){_r(c,c.return,w)}}function WT(c,f,p){try{var v=c.stateNode;Mne(v,c.type,p,f),v[ht]=f}catch(w){_r(c,c.return,w)}}function ZL(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&au(c.type)||c.tag===4}function zT(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||ZL(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&au(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function UT(c,f,p){var v=c.tag;if(v===5||v===6)c=c.stateNode,f?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(c,f):(f=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,f.appendChild(c),p=p._reactRootContainer,p!=null||f.onclick!==null||(f.onclick=Lx));else if(v!==4&&(v===27&&au(c.type)&&(p=c.stateNode,f=null),c=c.child,c!==null))for(UT(c,f,p),c=c.sibling;c!==null;)UT(c,f,p),c=c.sibling}function Ex(c,f,p){var v=c.tag;if(v===5||v===6)c=c.stateNode,f?p.insertBefore(c,f):p.appendChild(c);else if(v!==4&&(v===27&&au(c.type)&&(p=c.stateNode),c=c.child,c!==null))for(Ex(c,f,p),c=c.sibling;c!==null;)Ex(c,f,p),c=c.sibling}function JL(c){var f=c.stateNode,p=c.memoizedProps;try{for(var v=c.type,w=f.attributes;w.length;)f.removeAttributeNode(w[0]);_i(f,v,p),f[ut]=c,f[ht]=p}catch(T){_r(c,c.return,T)}}var nc=!1,Mn=!1,$T=!1,e3=typeof WeakSet=="function"?WeakSet:Set,mi=null;function fne(c,f){if(c=c.containerInfo,mE=zx,c=f4(c),zC(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var w=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{p.nodeType,T.nodeType}catch{p=null;break e}var F=0,U=-1,le=-1,we=0,Oe=0,De=c,be=null;t:for(;;){for(var Se;De!==p||w!==0&&De.nodeType!==3||(U=F+w),De!==T||v!==0&&De.nodeType!==3||(le=F+v),De.nodeType===3&&(F+=De.nodeValue.length),(Se=De.firstChild)!==null;)be=De,De=Se;for(;;){if(De===c)break t;if(be===p&&++we===w&&(U=F),be===T&&++Oe===v&&(le=F),(Se=De.nextSibling)!==null)break;De=be,be=De.parentNode}De=Se}p=U===-1||le===-1?null:{start:U,end:le}}else p=null}p=p||{start:0,end:0}}else p=null;for(gE={focusedElem:c,selectionRange:p},zx=!1,mi=f;mi!==null;)if(f=mi,c=f.child,(f.subtreeFlags&1024)!==0&&c!==null)c.return=f,mi=c;else for(;mi!==null;){switch(f=mi,T=f.alternate,c=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((c&1024)!==0&&T!==null){c=void 0,p=f,w=T.memoizedProps,T=T.memoizedState,v=p.stateNode;try{var xt=wf(p.type,w,p.elementType===p.type);c=v.getSnapshotBeforeUpdate(xt,T),v.__reactInternalSnapshotBeforeUpdate=c}catch(mt){_r(p,p.return,mt)}}break;case 3:if((c&1024)!==0){if(c=f.stateNode.containerInfo,p=c.nodeType,p===9)xE(c);else if(p===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":xE(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(n(163))}if(c=f.sibling,c!==null){c.return=f.return,mi=c;break}mi=f.return}}function t3(c,f,p){var v=p.flags;switch(p.tag){case 0:case 11:case 15:eu(c,p),v&4&&Q0(5,p);break;case 1:if(eu(c,p),v&4)if(c=p.stateNode,f===null)try{c.componentDidMount()}catch(F){_r(p,p.return,F)}else{var w=wf(p.type,f.memoizedProps);f=f.memoizedState;try{c.componentDidUpdate(w,f,c.__reactInternalSnapshotBeforeUpdate)}catch(F){_r(p,p.return,F)}}v&64&&KL(p),v&512&&Z0(p,p.return);break;case 3:if(eu(c,p),v&64&&(c=p.updateQueue,c!==null)){if(f=null,p.child!==null)switch(p.child.tag){case 27:case 5:f=p.child.stateNode;break;case 1:f=p.child.stateNode}try{L4(c,f)}catch(F){_r(p,p.return,F)}}break;case 27:f===null&&v&4&&JL(p);case 26:case 5:eu(c,p),f===null&&v&4&&QL(p),v&512&&Z0(p,p.return);break;case 12:eu(c,p);break;case 13:eu(c,p),v&4&&i3(c,p),v&64&&(c=p.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(p=wne.bind(null,p),Hne(c,p))));break;case 22:if(v=p.memoizedState!==null||nc,!v){f=f!==null&&f.memoizedState!==null||Mn,w=nc;var T=Mn;nc=v,(Mn=f)&&!T?tu(c,p,(p.subtreeFlags&8772)!==0):eu(c,p),nc=w,Mn=T}break;case 30:break;default:eu(c,p)}}function r3(c){var f=c.alternate;f!==null&&(c.alternate=null,r3(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&Q(f)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var sn=null,As=!1;function ic(c,f,p){for(p=p.child;p!==null;)n3(c,f,p),p=p.sibling}function n3(c,f,p){if(Et&&typeof Et.onCommitFiberUnmount=="function")try{Et.onCommitFiberUnmount(Dt,p)}catch{}switch(p.tag){case 26:Mn||Ja(p,f),ic(c,f,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Mn||Ja(p,f);var v=sn,w=As;au(p.type)&&(sn=p.stateNode,As=!1),ic(c,f,p),am(p.stateNode),sn=v,As=w;break;case 5:Mn||Ja(p,f);case 6:if(v=sn,w=As,sn=null,ic(c,f,p),sn=v,As=w,sn!==null)if(As)try{(sn.nodeType===9?sn.body:sn.nodeName==="HTML"?sn.ownerDocument.body:sn).removeChild(p.stateNode)}catch(T){_r(p,f,T)}else try{sn.removeChild(p.stateNode)}catch(T){_r(p,f,T)}break;case 18:sn!==null&&(As?(c=sn,$3(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,p.stateNode),mm(c)):$3(sn,p.stateNode));break;case 4:v=sn,w=As,sn=p.stateNode.containerInfo,As=!0,ic(c,f,p),sn=v,As=w;break;case 0:case 11:case 14:case 15:Mn||Jc(2,p,f),Mn||Jc(4,p,f),ic(c,f,p);break;case 1:Mn||(Ja(p,f),v=p.stateNode,typeof v.componentWillUnmount=="function"&&XL(p,f,v)),ic(c,f,p);break;case 21:ic(c,f,p);break;case 22:Mn=(v=Mn)||p.memoizedState!==null,ic(c,f,p),Mn=v;break;default:ic(c,f,p)}}function i3(c,f){if(f.memoizedState===null&&(c=f.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{mm(c)}catch(p){_r(f,f.return,p)}}function hne(c){switch(c.tag){case 13:case 19:var f=c.stateNode;return f===null&&(f=c.stateNode=new e3),f;case 22:return c=c.stateNode,f=c._retryCache,f===null&&(f=c._retryCache=new e3),f;default:throw Error(n(435,c.tag))}}function GT(c,f){var p=hne(c);f.forEach(function(v){var w=bne.bind(null,c,v);p.has(v)||(p.add(v),v.then(w,w))})}function Zs(c,f){var p=f.deletions;if(p!==null)for(var v=0;v<p.length;v++){var w=p[v],T=c,F=f,U=F;e:for(;U!==null;){switch(U.tag){case 27:if(au(U.type)){sn=U.stateNode,As=!1;break e}break;case 5:sn=U.stateNode,As=!1;break e;case 3:case 4:sn=U.stateNode.containerInfo,As=!0;break e}U=U.return}if(sn===null)throw Error(n(160));n3(T,F,w),sn=null,As=!1,T=w.alternate,T!==null&&(T.return=null),w.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)s3(f,c),f=f.sibling}var ba=null;function s3(c,f){var p=c.alternate,v=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:Zs(f,c),Js(c),v&4&&(Jc(3,c,c.return),Q0(3,c),Jc(5,c,c.return));break;case 1:Zs(f,c),Js(c),v&512&&(Mn||p===null||Ja(p,p.return)),v&64&&nc&&(c=c.updateQueue,c!==null&&(v=c.callbacks,v!==null&&(p=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=p===null?v:p.concat(v))));break;case 26:var w=ba;if(Zs(f,c),Js(c),v&512&&(Mn||p===null||Ja(p,p.return)),v&4){var T=p!==null?p.memoizedState:null;if(v=c.memoizedState,p===null)if(v===null)if(c.stateNode===null){e:{v=c.type,p=c.memoizedProps,w=w.ownerDocument||w;t:switch(v){case"title":T=w.getElementsByTagName("title")[0],(!T||T[X]||T[ut]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=w.createElement(v),w.head.insertBefore(T,w.querySelector("head > title"))),_i(T,v,p),T[ut]=c,ge(T),v=T;break e;case"link":var F=J3("link","href",w).get(v+(p.href||""));if(F){for(var U=0;U<F.length;U++)if(T=F[U],T.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&T.getAttribute("rel")===(p.rel==null?null:p.rel)&&T.getAttribute("title")===(p.title==null?null:p.title)&&T.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){F.splice(U,1);break t}}T=w.createElement(v),_i(T,v,p),w.head.appendChild(T);break;case"meta":if(F=J3("meta","content",w).get(v+(p.content||""))){for(U=0;U<F.length;U++)if(T=F[U],T.getAttribute("content")===(p.content==null?null:""+p.content)&&T.getAttribute("name")===(p.name==null?null:p.name)&&T.getAttribute("property")===(p.property==null?null:p.property)&&T.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&T.getAttribute("charset")===(p.charSet==null?null:p.charSet)){F.splice(U,1);break t}}T=w.createElement(v),_i(T,v,p),w.head.appendChild(T);break;default:throw Error(n(468,v))}T[ut]=c,ge(T),v=T}c.stateNode=v}else eF(w,c.type,c.stateNode);else c.stateNode=Z3(w,v,c.memoizedProps);else T!==v?(T===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):T.count--,v===null?eF(w,c.type,c.stateNode):Z3(w,v,c.memoizedProps)):v===null&&c.stateNode!==null&&WT(c,c.memoizedProps,p.memoizedProps)}break;case 27:Zs(f,c),Js(c),v&512&&(Mn||p===null||Ja(p,p.return)),p!==null&&v&4&&WT(c,c.memoizedProps,p.memoizedProps);break;case 5:if(Zs(f,c),Js(c),v&512&&(Mn||p===null||Ja(p,p.return)),c.flags&32){w=c.stateNode;try{Zh(w,"")}catch(Se){_r(c,c.return,Se)}}v&4&&c.stateNode!=null&&(w=c.memoizedProps,WT(c,w,p!==null?p.memoizedProps:w)),v&1024&&($T=!0);break;case 6:if(Zs(f,c),Js(c),v&4){if(c.stateNode===null)throw Error(n(162));v=c.memoizedProps,p=c.stateNode;try{p.nodeValue=v}catch(Se){_r(c,c.return,Se)}}break;case 3:if(Vx=null,w=ba,ba=Hx(f.containerInfo),Zs(f,c),ba=w,Js(c),v&4&&p!==null&&p.memoizedState.isDehydrated)try{mm(f.containerInfo)}catch(Se){_r(c,c.return,Se)}$T&&($T=!1,o3(c));break;case 4:v=ba,ba=Hx(c.stateNode.containerInfo),Zs(f,c),Js(c),ba=v;break;case 12:Zs(f,c),Js(c);break;case 13:Zs(f,c),Js(c),c.child.flags&8192&&c.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(ZT=Ee()),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,GT(c,v)));break;case 22:w=c.memoizedState!==null;var le=p!==null&&p.memoizedState!==null,we=nc,Oe=Mn;if(nc=we||w,Mn=Oe||le,Zs(f,c),Mn=Oe,nc=we,Js(c),v&8192)e:for(f=c.stateNode,f._visibility=w?f._visibility&-2:f._visibility|1,w&&(p===null||le||nc||Mn||bf(c)),p=null,f=c;;){if(f.tag===5||f.tag===26){if(p===null){le=p=f;try{if(T=le.stateNode,w)F=T.style,typeof F.setProperty=="function"?F.setProperty("display","none","important"):F.display="none";else{U=le.stateNode;var De=le.memoizedProps.style,be=De!=null&&De.hasOwnProperty("display")?De.display:null;U.style.display=be==null||typeof be=="boolean"?"":(""+be).trim()}}catch(Se){_r(le,le.return,Se)}}}else if(f.tag===6){if(p===null){le=f;try{le.stateNode.nodeValue=w?"":le.memoizedProps}catch(Se){_r(le,le.return,Se)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===c)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break e;for(;f.sibling===null;){if(f.return===null||f.return===c)break e;p===f&&(p=null),f=f.return}p===f&&(p=null),f.sibling.return=f.return,f=f.sibling}v&4&&(v=c.updateQueue,v!==null&&(p=v.retryQueue,p!==null&&(v.retryQueue=null,GT(c,p))));break;case 19:Zs(f,c),Js(c),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,GT(c,v)));break;case 30:break;case 21:break;default:Zs(f,c),Js(c)}}function Js(c){var f=c.flags;if(f&2){try{for(var p,v=c.return;v!==null;){if(ZL(v)){p=v;break}v=v.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var w=p.stateNode,T=zT(c);Ex(c,T,w);break;case 5:var F=p.stateNode;p.flags&32&&(Zh(F,""),p.flags&=-33);var U=zT(c);Ex(c,U,F);break;case 3:case 4:var le=p.stateNode.containerInfo,we=zT(c);UT(c,we,le);break;default:throw Error(n(161))}}catch(Oe){_r(c,c.return,Oe)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function o3(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var f=c;o3(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),c=c.sibling}}function eu(c,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)t3(c,f.alternate,f),f=f.sibling}function bf(c){for(c=c.child;c!==null;){var f=c;switch(f.tag){case 0:case 11:case 14:case 15:Jc(4,f,f.return),bf(f);break;case 1:Ja(f,f.return);var p=f.stateNode;typeof p.componentWillUnmount=="function"&&XL(f,f.return,p),bf(f);break;case 27:am(f.stateNode);case 26:case 5:Ja(f,f.return),bf(f);break;case 22:f.memoizedState===null&&bf(f);break;case 30:bf(f);break;default:bf(f)}c=c.sibling}}function tu(c,f,p){for(p=p&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var v=f.alternate,w=c,T=f,F=T.flags;switch(T.tag){case 0:case 11:case 15:tu(w,T,p),Q0(4,T);break;case 1:if(tu(w,T,p),v=T,w=v.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(we){_r(v,v.return,we)}if(v=T,w=v.updateQueue,w!==null){var U=v.stateNode;try{var le=w.shared.hiddenCallbacks;if(le!==null)for(w.shared.hiddenCallbacks=null,w=0;w<le.length;w++)N4(le[w],U)}catch(we){_r(v,v.return,we)}}p&&F&64&&KL(T),Z0(T,T.return);break;case 27:JL(T);case 26:case 5:tu(w,T,p),p&&v===null&&F&4&&QL(T),Z0(T,T.return);break;case 12:tu(w,T,p);break;case 13:tu(w,T,p),p&&F&4&&i3(w,T);break;case 22:T.memoizedState===null&&tu(w,T,p),Z0(T,T.return);break;case 30:break;default:tu(w,T,p)}f=f.sibling}}function YT(c,f){var p=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),c=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(c=f.memoizedState.cachePool.pool),c!==p&&(c!=null&&c.refCount++,p!=null&&F0(p))}function qT(c,f){c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&F0(c))}function el(c,f,p,v){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)a3(c,f,p,v),f=f.sibling}function a3(c,f,p,v){var w=f.flags;switch(f.tag){case 0:case 11:case 15:el(c,f,p,v),w&2048&&Q0(9,f);break;case 1:el(c,f,p,v);break;case 3:el(c,f,p,v),w&2048&&(c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&F0(c)));break;case 12:if(w&2048){el(c,f,p,v),c=f.stateNode;try{var T=f.memoizedProps,F=T.id,U=T.onPostCommit;typeof U=="function"&&U(F,f.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(le){_r(f,f.return,le)}}else el(c,f,p,v);break;case 13:el(c,f,p,v);break;case 23:break;case 22:T=f.stateNode,F=f.alternate,f.memoizedState!==null?T._visibility&2?el(c,f,p,v):J0(c,f):T._visibility&2?el(c,f,p,v):(T._visibility|=2,vd(c,f,p,v,(f.subtreeFlags&10256)!==0)),w&2048&&YT(F,f);break;case 24:el(c,f,p,v),w&2048&&qT(f.alternate,f);break;default:el(c,f,p,v)}}function vd(c,f,p,v,w){for(w=w&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var T=c,F=f,U=p,le=v,we=F.flags;switch(F.tag){case 0:case 11:case 15:vd(T,F,U,le,w),Q0(8,F);break;case 23:break;case 22:var Oe=F.stateNode;F.memoizedState!==null?Oe._visibility&2?vd(T,F,U,le,w):J0(T,F):(Oe._visibility|=2,vd(T,F,U,le,w)),w&&we&2048&&YT(F.alternate,F);break;case 24:vd(T,F,U,le,w),w&&we&2048&&qT(F.alternate,F);break;default:vd(T,F,U,le,w)}f=f.sibling}}function J0(c,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var p=c,v=f,w=v.flags;switch(v.tag){case 22:J0(p,v),w&2048&&YT(v.alternate,v);break;case 24:J0(p,v),w&2048&&qT(v.alternate,v);break;default:J0(p,v)}f=f.sibling}}var em=8192;function yd(c){if(c.subtreeFlags&em)for(c=c.child;c!==null;)l3(c),c=c.sibling}function l3(c){switch(c.tag){case 26:yd(c),c.flags&em&&c.memoizedState!==null&&Qne(ba,c.memoizedState,c.memoizedProps);break;case 5:yd(c);break;case 3:case 4:var f=ba;ba=Hx(c.stateNode.containerInfo),yd(c),ba=f;break;case 22:c.memoizedState===null&&(f=c.alternate,f!==null&&f.memoizedState!==null?(f=em,em=16777216,yd(c),em=f):yd(c));break;default:yd(c)}}function c3(c){var f=c.alternate;if(f!==null&&(c=f.child,c!==null)){f.child=null;do f=c.sibling,c.sibling=null,c=f;while(c!==null)}}function tm(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var p=0;p<f.length;p++){var v=f[p];mi=v,f3(v,c)}c3(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)u3(c),c=c.sibling}function u3(c){switch(c.tag){case 0:case 11:case 15:tm(c),c.flags&2048&&Jc(9,c,c.return);break;case 3:tm(c);break;case 12:tm(c);break;case 22:var f=c.stateNode;c.memoizedState!==null&&f._visibility&2&&(c.return===null||c.return.tag!==13)?(f._visibility&=-3,Rx(c)):tm(c);break;default:tm(c)}}function Rx(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var p=0;p<f.length;p++){var v=f[p];mi=v,f3(v,c)}c3(c)}for(c=c.child;c!==null;){switch(f=c,f.tag){case 0:case 11:case 15:Jc(8,f,f.return),Rx(f);break;case 22:p=f.stateNode,p._visibility&2&&(p._visibility&=-3,Rx(f));break;default:Rx(f)}c=c.sibling}}function f3(c,f){for(;mi!==null;){var p=mi;switch(p.tag){case 0:case 11:case 15:Jc(8,p,f);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var v=p.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:F0(p.memoizedState.cache)}if(v=p.child,v!==null)v.return=p,mi=v;else e:for(p=c;mi!==null;){v=mi;var w=v.sibling,T=v.return;if(r3(v),v===p){mi=null;break e}if(w!==null){w.return=T,mi=w;break e}mi=T}}}var dne={getCacheForType:function(c){var f=Ui(si),p=f.data.get(c);return p===void 0&&(p=c(),f.data.set(c,p)),p}},pne=typeof WeakMap=="function"?WeakMap:Map,xr=0,jr=null,Gt=null,rr=0,wr=0,eo=null,ru=!1,xd=!1,KT=!1,sc=0,xn=0,nu=0,Sf=0,XT=0,_o=0,wd=0,rm=null,ks=null,QT=!1,ZT=0,Ax=1/0,kx=null,iu=null,Oi=0,su=null,bd=null,Sd=0,JT=0,eE=null,h3=null,nm=0,tE=null;function to(){if((xr&2)!==0&&rr!==0)return rr&-rr;if(q.T!==null){var c=cd;return c!==0?c:lE()}return On()}function d3(){_o===0&&(_o=(rr&536870912)===0||pr?Wn():536870912);var c=Oo.current;return c!==null&&(c.flags|=32),_o}function ro(c,f,p){(c===jr&&(wr===2||wr===9)||c.cancelPendingCommit!==null)&&(Cd(c,0),ou(c,rr,_o,!1)),ii(c,p),((xr&2)===0||c!==jr)&&(c===jr&&((xr&2)===0&&(Sf|=p),xn===4&&ou(c,rr,_o,!1)),tl(c))}function p3(c,f,p){if((xr&6)!==0)throw Error(n(327));var v=!p&&(f&124)===0&&(f&c.expiredLanes)===0||Br(c,f),w=v?vne(c,f):iE(c,f,!0),T=v;do{if(w===0){xd&&!v&&ou(c,f,0,!1);break}else{if(p=c.current.alternate,T&&!mne(p)){w=iE(c,f,!1),T=!1;continue}if(w===2){if(T=f,c.errorRecoveryDisabledLanes&T)var F=0;else F=c.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){f=F;e:{var U=c;w=rm;var le=U.current.memoizedState.isDehydrated;if(le&&(Cd(U,F).flags|=256),F=iE(U,F,!1),F!==2){if(KT&&!le){U.errorRecoveryDisabledLanes|=T,Sf|=T,w=4;break e}T=ks,ks=w,T!==null&&(ks===null?ks=T:ks.push.apply(ks,T))}w=F}if(T=!1,w!==2)continue}}if(w===1){Cd(c,0),ou(c,f,0,!0);break}e:{switch(v=c,T=w,T){case 0:case 1:throw Error(n(345));case 4:if((f&4194048)!==f)break;case 6:ou(v,f,_o,!ru);break e;case 2:ks=null;break;case 3:case 5:break;default:throw Error(n(329))}if((f&62914560)===f&&(w=ZT+300-Ee(),10<w)){if(ou(v,f,_o,!ru),vn(v,0,!0)!==0)break e;v.timeoutHandle=z3(m3.bind(null,v,p,ks,kx,QT,f,_o,Sf,wd,ru,T,2,-0,0),w);break e}m3(v,p,ks,kx,QT,f,_o,Sf,wd,ru,T,0,-0,0)}}break}while(!0);tl(c)}function m3(c,f,p,v,w,T,F,U,le,we,Oe,De,be,Se){if(c.timeoutHandle=-1,De=f.subtreeFlags,(De&8192||(De&16785408)===16785408)&&(um={stylesheets:null,count:0,unsuspend:Xne},l3(f),De=Zne(),De!==null)){c.cancelPendingCommit=De(S3.bind(null,c,f,T,p,v,w,F,U,le,Oe,1,be,Se)),ou(c,T,F,!we);return}S3(c,f,T,p,v,w,F,U,le)}function mne(c){for(var f=c;;){var p=f.tag;if((p===0||p===11||p===15)&&f.flags&16384&&(p=f.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var v=0;v<p.length;v++){var w=p[v],T=w.getSnapshot;w=w.value;try{if(!Xs(T(),w))return!1}catch{return!1}}if(p=f.child,f.subtreeFlags&16384&&p!==null)p.return=f,f=p;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function ou(c,f,p,v){f&=~XT,f&=~Sf,c.suspendedLanes|=f,c.pingedLanes&=~f,v&&(c.warmLanes|=f),v=c.expirationTimes;for(var w=f;0<w;){var T=31-Rt(w),F=1<<T;v[T]=-1,w&=~F}p!==0&&Xa(c,p,f)}function Ox(){return(xr&6)===0?(im(0),!1):!0}function rE(){if(Gt!==null){if(wr===0)var c=Gt.return;else c=Gt,Ql=gf=null,xT(c),md=null,q0=0,c=Gt;for(;c!==null;)qL(c.alternate,c),c=c.return;Gt=null}}function Cd(c,f){var p=c.timeoutHandle;p!==-1&&(c.timeoutHandle=-1,Pne(p)),p=c.cancelPendingCommit,p!==null&&(c.cancelPendingCommit=null,p()),rE(),jr=c,Gt=p=ql(c.current,null),rr=f,wr=0,eo=null,ru=!1,xd=Br(c,f),KT=!1,wd=_o=XT=Sf=nu=xn=0,ks=rm=null,QT=!1,(f&8)!==0&&(f|=f&32);var v=c.entangledLanes;if(v!==0)for(c=c.entanglements,v&=f;0<v;){var w=31-Rt(v),T=1<<w;f|=c[w],v&=~T}return sc=f,Qy(),p}function g3(c,f){Ht=null,q.H=gx,f===B0||f===ox?(f=P4(),wr=3):f===_4?(f=P4(),wr=4):wr=f===IL?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,eo=f,Gt===null&&(xn=1,bx(c,Eo(f,c.current)))}function v3(){var c=q.H;return q.H=gx,c===null?gx:c}function y3(){var c=q.A;return q.A=dne,c}function nE(){xn=4,ru||(rr&4194048)!==rr&&Oo.current!==null||(xd=!0),(nu&134217727)===0&&(Sf&134217727)===0||jr===null||ou(jr,rr,_o,!1)}function iE(c,f,p){var v=xr;xr|=2;var w=v3(),T=y3();(jr!==c||rr!==f)&&(kx=null,Cd(c,f)),f=!1;var F=xn;e:do try{if(wr!==0&&Gt!==null){var U=Gt,le=eo;switch(wr){case 8:rE(),F=6;break e;case 3:case 2:case 9:case 6:Oo.current===null&&(f=!0);var we=wr;if(wr=0,eo=null,Td(c,U,le,we),p&&xd){F=0;break e}break;default:we=wr,wr=0,eo=null,Td(c,U,le,we)}}gne(),F=xn;break}catch(Oe){g3(c,Oe)}while(!0);return f&&c.shellSuspendCounter++,Ql=gf=null,xr=v,q.H=w,q.A=T,Gt===null&&(jr=null,rr=0,Qy()),F}function gne(){for(;Gt!==null;)x3(Gt)}function vne(c,f){var p=xr;xr|=2;var v=v3(),w=y3();jr!==c||rr!==f?(kx=null,Ax=Ee()+500,Cd(c,f)):xd=Br(c,f);e:do try{if(wr!==0&&Gt!==null){f=Gt;var T=eo;t:switch(wr){case 1:wr=0,eo=null,Td(c,f,T,1);break;case 2:case 9:if(M4(T)){wr=0,eo=null,w3(f);break}f=function(){wr!==2&&wr!==9||jr!==c||(wr=7),tl(c)},T.then(f,f);break e;case 3:wr=7;break e;case 4:wr=5;break e;case 7:M4(T)?(wr=0,eo=null,w3(f)):(wr=0,eo=null,Td(c,f,T,7));break;case 5:var F=null;switch(Gt.tag){case 26:F=Gt.memoizedState;case 5:case 27:var U=Gt;if(!F||tF(F)){wr=0,eo=null;var le=U.sibling;if(le!==null)Gt=le;else{var we=U.return;we!==null?(Gt=we,_x(we)):Gt=null}break t}}wr=0,eo=null,Td(c,f,T,5);break;case 6:wr=0,eo=null,Td(c,f,T,6);break;case 8:rE(),xn=6;break e;default:throw Error(n(462))}}yne();break}catch(Oe){g3(c,Oe)}while(!0);return Ql=gf=null,q.H=v,q.A=w,xr=p,Gt!==null?0:(jr=null,rr=0,Qy(),xn)}function yne(){for(;Gt!==null&&!ze();)x3(Gt)}function x3(c){var f=GL(c.alternate,c,sc);c.memoizedProps=c.pendingProps,f===null?_x(c):Gt=f}function w3(c){var f=c,p=f.alternate;switch(f.tag){case 15:case 0:f=VL(p,f,f.pendingProps,f.type,void 0,rr);break;case 11:f=VL(p,f,f.pendingProps,f.type.render,f.ref,rr);break;case 5:xT(f);default:qL(p,f),f=Gt=b4(f,sc),f=GL(p,f,sc)}c.memoizedProps=c.pendingProps,f===null?_x(c):Gt=f}function Td(c,f,p,v){Ql=gf=null,xT(f),md=null,q0=0;var w=f.return;try{if(ane(c,w,f,p,rr)){xn=1,bx(c,Eo(p,c.current)),Gt=null;return}}catch(T){if(w!==null)throw Gt=w,T;xn=1,bx(c,Eo(p,c.current)),Gt=null;return}f.flags&32768?(pr||v===1?c=!0:xd||(rr&536870912)!==0?c=!1:(ru=c=!0,(v===2||v===9||v===3||v===6)&&(v=Oo.current,v!==null&&v.tag===13&&(v.flags|=16384))),b3(f,c)):_x(f)}function _x(c){var f=c;do{if((f.flags&32768)!==0){b3(f,ru);return}c=f.return;var p=cne(f.alternate,f,sc);if(p!==null){Gt=p;return}if(f=f.sibling,f!==null){Gt=f;return}Gt=f=c}while(f!==null);xn===0&&(xn=5)}function b3(c,f){do{var p=une(c.alternate,c);if(p!==null){p.flags&=32767,Gt=p;return}if(p=c.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!f&&(c=c.sibling,c!==null)){Gt=c;return}Gt=c=p}while(c!==null);xn=6,Gt=null}function S3(c,f,p,v,w,T,F,U,le){c.cancelPendingCommit=null;do Mx();while(Oi!==0);if((xr&6)!==0)throw Error(n(327));if(f!==null){if(f===c.current)throw Error(n(177));if(T=f.lanes|f.childLanes,T|=qC,So(c,p,T,F,U,le),c===jr&&(Gt=jr=null,rr=0),bd=f,su=c,Sd=p,JT=T,eE=w,h3=v,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,Sne(at,function(){return A3(),null})):(c.callbackNode=null,c.callbackPriority=0),v=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||v){v=q.T,q.T=null,w=Z.p,Z.p=2,F=xr,xr|=4;try{fne(c,f,p)}finally{xr=F,Z.p=w,q.T=v}}Oi=1,C3(),T3(),E3()}}function C3(){if(Oi===1){Oi=0;var c=su,f=bd,p=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||p){p=q.T,q.T=null;var v=Z.p;Z.p=2;var w=xr;xr|=4;try{s3(f,c);var T=gE,F=f4(c.containerInfo),U=T.focusedElem,le=T.selectionRange;if(F!==U&&U&&U.ownerDocument&&u4(U.ownerDocument.documentElement,U)){if(le!==null&&zC(U)){var we=le.start,Oe=le.end;if(Oe===void 0&&(Oe=we),"selectionStart"in U)U.selectionStart=we,U.selectionEnd=Math.min(Oe,U.value.length);else{var De=U.ownerDocument||document,be=De&&De.defaultView||window;if(be.getSelection){var Se=be.getSelection(),xt=U.textContent.length,mt=Math.min(le.start,xt),Tr=le.end===void 0?mt:Math.min(le.end,xt);!Se.extend&&mt>Tr&&(F=Tr,Tr=mt,mt=F);var me=c4(U,mt),he=c4(U,Tr);if(me&&he&&(Se.rangeCount!==1||Se.anchorNode!==me.node||Se.anchorOffset!==me.offset||Se.focusNode!==he.node||Se.focusOffset!==he.offset)){var ye=De.createRange();ye.setStart(me.node,me.offset),Se.removeAllRanges(),mt>Tr?(Se.addRange(ye),Se.extend(he.node,he.offset)):(ye.setEnd(he.node,he.offset),Se.addRange(ye))}}}}for(De=[],Se=U;Se=Se.parentNode;)Se.nodeType===1&&De.push({element:Se,left:Se.scrollLeft,top:Se.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<De.length;U++){var Me=De[U];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}zx=!!mE,gE=mE=null}finally{xr=w,Z.p=v,q.T=p}}c.current=f,Oi=2}}function T3(){if(Oi===2){Oi=0;var c=su,f=bd,p=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||p){p=q.T,q.T=null;var v=Z.p;Z.p=2;var w=xr;xr|=4;try{t3(c,f.alternate,f)}finally{xr=w,Z.p=v,q.T=p}}Oi=3}}function E3(){if(Oi===4||Oi===3){Oi=0,Ge();var c=su,f=bd,p=Sd,v=h3;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?Oi=5:(Oi=0,bd=su=null,R3(c,c.pendingLanes));var w=c.pendingLanes;if(w===0&&(iu=null),yt(p),f=f.stateNode,Et&&typeof Et.onCommitFiberRoot=="function")try{Et.onCommitFiberRoot(Dt,f,void 0,(f.current.flags&128)===128)}catch{}if(v!==null){f=q.T,w=Z.p,Z.p=2,q.T=null;try{for(var T=c.onRecoverableError,F=0;F<v.length;F++){var U=v[F];T(U.value,{componentStack:U.stack})}}finally{q.T=f,Z.p=w}}(Sd&3)!==0&&Mx(),tl(c),w=c.pendingLanes,(p&4194090)!==0&&(w&42)!==0?c===tE?nm++:(nm=0,tE=c):nm=0,im(0)}}function R3(c,f){(c.pooledCacheLanes&=f)===0&&(f=c.pooledCache,f!=null&&(c.pooledCache=null,F0(f)))}function Mx(c){return C3(),T3(),E3(),A3()}function A3(){if(Oi!==5)return!1;var c=su,f=JT;JT=0;var p=yt(Sd),v=q.T,w=Z.p;try{Z.p=32>p?32:p,q.T=null,p=eE,eE=null;var T=su,F=Sd;if(Oi=0,bd=su=null,Sd=0,(xr&6)!==0)throw Error(n(331));var U=xr;if(xr|=4,u3(T.current),a3(T,T.current,F,p),xr=U,im(0,!1),Et&&typeof Et.onPostCommitFiberRoot=="function")try{Et.onPostCommitFiberRoot(Dt,T)}catch{}return!0}finally{Z.p=w,q.T=v,R3(c,f)}}function k3(c,f,p){f=Eo(p,f),f=PT(c.stateNode,f,2),c=Kc(c,f,2),c!==null&&(ii(c,2),tl(c))}function _r(c,f,p){if(c.tag===3)k3(c,c,p);else for(;f!==null;){if(f.tag===3){k3(f,c,p);break}else if(f.tag===1){var v=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(iu===null||!iu.has(v))){c=Eo(p,c),p=DL(2),v=Kc(f,p,2),v!==null&&(PL(p,v,f,c),ii(v,2),tl(v));break}}f=f.return}}function sE(c,f,p){var v=c.pingCache;if(v===null){v=c.pingCache=new pne;var w=new Set;v.set(f,w)}else w=v.get(f),w===void 0&&(w=new Set,v.set(f,w));w.has(p)||(KT=!0,w.add(p),c=xne.bind(null,c,f,p),f.then(c,c))}function xne(c,f,p){var v=c.pingCache;v!==null&&v.delete(f),c.pingedLanes|=c.suspendedLanes&p,c.warmLanes&=~p,jr===c&&(rr&p)===p&&(xn===4||xn===3&&(rr&62914560)===rr&&300>Ee()-ZT?(xr&2)===0&&Cd(c,0):XT|=p,wd===rr&&(wd=0)),tl(c)}function O3(c,f){f===0&&(f=Ai()),c=sd(c,f),c!==null&&(ii(c,f),tl(c))}function wne(c){var f=c.memoizedState,p=0;f!==null&&(p=f.retryLane),O3(c,p)}function bne(c,f){var p=0;switch(c.tag){case 13:var v=c.stateNode,w=c.memoizedState;w!==null&&(p=w.retryLane);break;case 19:v=c.stateNode;break;case 22:v=c.stateNode._retryCache;break;default:throw Error(n(314))}v!==null&&v.delete(f),O3(c,p)}function Sne(c,f){return Be(c,f)}var Dx=null,Ed=null,oE=!1,Px=!1,aE=!1,Cf=0;function tl(c){c!==Ed&&c.next===null&&(Ed===null?Dx=Ed=c:Ed=Ed.next=c),Px=!0,oE||(oE=!0,Tne())}function im(c,f){if(!aE&&Px){aE=!0;do for(var p=!1,v=Dx;v!==null;){if(c!==0){var w=v.pendingLanes;if(w===0)var T=0;else{var F=v.suspendedLanes,U=v.pingedLanes;T=(1<<31-Rt(42|c)+1)-1,T&=w&~(F&~U),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(p=!0,P3(v,T))}else T=rr,T=vn(v,v===jr?T:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(T&3)===0||Br(v,T)||(p=!0,P3(v,T));v=v.next}while(p);aE=!1}}function Cne(){_3()}function _3(){Px=oE=!1;var c=0;Cf!==0&&(Dne()&&(c=Cf),Cf=0);for(var f=Ee(),p=null,v=Dx;v!==null;){var w=v.next,T=M3(v,f);T===0?(v.next=null,p===null?Dx=w:p.next=w,w===null&&(Ed=p)):(p=v,(c!==0||(T&3)!==0)&&(Px=!0)),v=w}im(c)}function M3(c,f){for(var p=c.suspendedLanes,v=c.pingedLanes,w=c.expirationTimes,T=c.pendingLanes&-62914561;0<T;){var F=31-Rt(T),U=1<<F,le=w[F];le===-1?((U&p)===0||(U&v)!==0)&&(w[F]=qr(U,f)):le<=f&&(c.expiredLanes|=U),T&=~U}if(f=jr,p=rr,p=vn(c,c===f?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),v=c.callbackNode,p===0||c===f&&(wr===2||wr===9)||c.cancelPendingCommit!==null)return v!==null&&v!==null&&Fe(v),c.callbackNode=null,c.callbackPriority=0;if((p&3)===0||Br(c,p)){if(f=p&-p,f===c.callbackPriority)return f;switch(v!==null&&Fe(v),yt(p)){case 2:case 8:p=tt;break;case 32:p=at;break;case 268435456:p=er;break;default:p=at}return v=D3.bind(null,c),p=Be(p,v),c.callbackPriority=f,c.callbackNode=p,f}return v!==null&&v!==null&&Fe(v),c.callbackPriority=2,c.callbackNode=null,2}function D3(c,f){if(Oi!==0&&Oi!==5)return c.callbackNode=null,c.callbackPriority=0,null;var p=c.callbackNode;if(Mx()&&c.callbackNode!==p)return null;var v=rr;return v=vn(c,c===jr?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),v===0?null:(p3(c,v,f),M3(c,Ee()),c.callbackNode!=null&&c.callbackNode===p?D3.bind(null,c):null)}function P3(c,f){if(Mx())return null;p3(c,f,!0)}function Tne(){Ine(function(){(xr&6)!==0?Be(st,Cne):_3()})}function lE(){return Cf===0&&(Cf=Wn()),Cf}function I3(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:Uy(""+c)}function N3(c,f){var p=f.ownerDocument.createElement("input");return p.name=f.name,p.value=f.value,c.id&&p.setAttribute("form",c.id),f.parentNode.insertBefore(p,f),c=new FormData(c),p.parentNode.removeChild(p),c}function Ene(c,f,p,v,w){if(f==="submit"&&p&&p.stateNode===w){var T=I3((w[ht]||null).action),F=v.submitter;F&&(f=(f=F[ht]||null)?I3(f.formAction):F.getAttribute("formAction"),f!==null&&(T=f,F=null));var U=new qy("action","action",null,v,w);c.push({event:U,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(Cf!==0){var le=F?N3(w,F):new FormData(w);kT(p,{pending:!0,data:le,method:w.method,action:T},null,le)}}else typeof T=="function"&&(U.preventDefault(),le=F?N3(w,F):new FormData(w),kT(p,{pending:!0,data:le,method:w.method,action:T},T,le))},currentTarget:w}]})}}for(var cE=0;cE<YC.length;cE++){var uE=YC[cE],Rne=uE.toLowerCase(),Ane=uE[0].toUpperCase()+uE.slice(1);wa(Rne,"on"+Ane)}wa(p4,"onAnimationEnd"),wa(m4,"onAnimationIteration"),wa(g4,"onAnimationStart"),wa("dblclick","onDoubleClick"),wa("focusin","onFocus"),wa("focusout","onBlur"),wa(Ure,"onTransitionRun"),wa($re,"onTransitionStart"),wa(Gre,"onTransitionCancel"),wa(v4,"onTransitionEnd"),Ce("onMouseEnter",["mouseout","mouseover"]),Ce("onMouseLeave",["mouseout","mouseover"]),Ce("onPointerEnter",["pointerout","pointerover"]),Ce("onPointerLeave",["pointerout","pointerover"]),de("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),de("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),de("onBeforeInput",["compositionend","keypress","textInput","paste"]),de("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kne=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sm));function L3(c,f){f=(f&4)!==0;for(var p=0;p<c.length;p++){var v=c[p],w=v.event;v=v.listeners;e:{var T=void 0;if(f)for(var F=v.length-1;0<=F;F--){var U=v[F],le=U.instance,we=U.currentTarget;if(U=U.listener,le!==T&&w.isPropagationStopped())break e;T=U,w.currentTarget=we;try{T(w)}catch(Oe){wx(Oe)}w.currentTarget=null,T=le}else for(F=0;F<v.length;F++){if(U=v[F],le=U.instance,we=U.currentTarget,U=U.listener,le!==T&&w.isPropagationStopped())break e;T=U,w.currentTarget=we;try{T(w)}catch(Oe){wx(Oe)}w.currentTarget=null,T=le}}}}function Yt(c,f){var p=f[hn];p===void 0&&(p=f[hn]=new Set);var v=c+"__bubble";p.has(v)||(F3(f,c,2,!1),p.add(v))}function fE(c,f,p){var v=0;f&&(v|=4),F3(p,c,v,f)}var Ix="_reactListening"+Math.random().toString(36).slice(2);function hE(c){if(!c[Ix]){c[Ix]=!0,fe.forEach(function(p){p!=="selectionchange"&&(kne.has(p)||fE(p,!1,c),fE(p,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[Ix]||(f[Ix]=!0,fE("selectionchange",!1,f))}}function F3(c,f,p,v){switch(aF(f)){case 2:var w=tie;break;case 8:w=rie;break;default:w=RE}p=w.bind(null,f,p,c),w=void 0,!IC||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(w=!0),v?w!==void 0?c.addEventListener(f,p,{capture:!0,passive:w}):c.addEventListener(f,p,!0):w!==void 0?c.addEventListener(f,p,{passive:w}):c.addEventListener(f,p,!1)}function dE(c,f,p,v,w){var T=v;if((f&1)===0&&(f&2)===0&&v!==null)e:for(;;){if(v===null)return;var F=v.tag;if(F===3||F===4){var U=v.stateNode.containerInfo;if(U===w)break;if(F===4)for(F=v.return;F!==null;){var le=F.tag;if((le===3||le===4)&&F.stateNode.containerInfo===w)return;F=F.return}for(;U!==null;){if(F=ne(U),F===null)return;if(le=F.tag,le===5||le===6||le===26||le===27){v=T=F;continue e}U=U.parentNode}}v=v.return}UN(function(){var we=T,Oe=DC(p),De=[];e:{var be=y4.get(c);if(be!==void 0){var Se=qy,xt=c;switch(c){case"keypress":if(Gy(p)===0)break e;case"keydown":case"keyup":Se=Sre;break;case"focusin":xt="focus",Se=HC;break;case"focusout":xt="blur",Se=HC;break;case"beforeblur":case"afterblur":Se=HC;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Se=YN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Se=ure;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Se=Ere;break;case p4:case m4:case g4:Se=dre;break;case v4:Se=Are;break;case"scroll":case"scrollend":Se=lre;break;case"wheel":Se=Ore;break;case"copy":case"cut":case"paste":Se=mre;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Se=KN;break;case"toggle":case"beforetoggle":Se=Mre}var mt=(f&4)!==0,Tr=!mt&&(c==="scroll"||c==="scrollend"),me=mt?be!==null?be+"Capture":null:be;mt=[];for(var he=we,ye;he!==null;){var Me=he;if(ye=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||ye===null||me===null||(Me=T0(he,me),Me!=null&&mt.push(om(he,Me,ye))),Tr)break;he=he.return}0<mt.length&&(be=new Se(be,xt,null,p,Oe),De.push({event:be,listeners:mt}))}}if((f&7)===0){e:{if(be=c==="mouseover"||c==="pointerover",Se=c==="mouseout"||c==="pointerout",be&&p!==MC&&(xt=p.relatedTarget||p.fromElement)&&(ne(xt)||xt[Ot]))break e;if((Se||be)&&(be=Oe.window===Oe?Oe:(be=Oe.ownerDocument)?be.defaultView||be.parentWindow:window,Se?(xt=p.relatedTarget||p.toElement,Se=we,xt=xt?ne(xt):null,xt!==null&&(Tr=s(xt),mt=xt.tag,xt!==Tr||mt!==5&&mt!==27&&mt!==6)&&(xt=null)):(Se=null,xt=we),Se!==xt)){if(mt=YN,Me="onMouseLeave",me="onMouseEnter",he="mouse",(c==="pointerout"||c==="pointerover")&&(mt=KN,Me="onPointerLeave",me="onPointerEnter",he="pointer"),Tr=Se==null?be:xe(Se),ye=xt==null?be:xe(xt),be=new mt(Me,he+"leave",Se,p,Oe),be.target=Tr,be.relatedTarget=ye,Me=null,ne(Oe)===we&&(mt=new mt(me,he+"enter",xt,p,Oe),mt.target=ye,mt.relatedTarget=Tr,Me=mt),Tr=Me,Se&&xt)t:{for(mt=Se,me=xt,he=0,ye=mt;ye;ye=Rd(ye))he++;for(ye=0,Me=me;Me;Me=Rd(Me))ye++;for(;0<he-ye;)mt=Rd(mt),he--;for(;0<ye-he;)me=Rd(me),ye--;for(;he--;){if(mt===me||me!==null&&mt===me.alternate)break t;mt=Rd(mt),me=Rd(me)}mt=null}else mt=null;Se!==null&&H3(De,be,Se,mt,!1),xt!==null&&Tr!==null&&H3(De,Tr,xt,mt,!0)}}e:{if(be=we?xe(we):window,Se=be.nodeName&&be.nodeName.toLowerCase(),Se==="select"||Se==="input"&&be.type==="file")var et=n4;else if(t4(be))if(i4)et=jre;else{et=Bre;var zt=Hre}else Se=be.nodeName,!Se||Se.toLowerCase()!=="input"||be.type!=="checkbox"&&be.type!=="radio"?we&&_C(we.elementType)&&(et=n4):et=Vre;if(et&&(et=et(c,we))){r4(De,et,p,Oe);break e}zt&&zt(c,be,we),c==="focusout"&&we&&be.type==="number"&&we.memoizedProps.value!=null&&OC(be,"number",be.value)}switch(zt=we?xe(we):window,c){case"focusin":(t4(zt)||zt.contentEditable==="true")&&(rd=zt,UC=we,D0=null);break;case"focusout":D0=UC=rd=null;break;case"mousedown":$C=!0;break;case"contextmenu":case"mouseup":case"dragend":$C=!1,h4(De,p,Oe);break;case"selectionchange":if(zre)break;case"keydown":case"keyup":h4(De,p,Oe)}var ot;if(VC)e:{switch(c){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else td?JN(c,p)&&(vt="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&(vt="onCompositionStart");vt&&(XN&&p.locale!=="ko"&&(td||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&td&&(ot=$N()):($c=Oe,NC="value"in $c?$c.value:$c.textContent,td=!0)),zt=Nx(we,vt),0<zt.length&&(vt=new qN(vt,c,null,p,Oe),De.push({event:vt,listeners:zt}),ot?vt.data=ot:(ot=e4(p),ot!==null&&(vt.data=ot)))),(ot=Pre?Ire(c,p):Nre(c,p))&&(vt=Nx(we,"onBeforeInput"),0<vt.length&&(zt=new qN("onBeforeInput","beforeinput",null,p,Oe),De.push({event:zt,listeners:vt}),zt.data=ot)),Ene(De,c,we,p,Oe)}L3(De,f)})}function om(c,f,p){return{instance:c,listener:f,currentTarget:p}}function Nx(c,f){for(var p=f+"Capture",v=[];c!==null;){var w=c,T=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||T===null||(w=T0(c,p),w!=null&&v.unshift(om(c,w,T)),w=T0(c,f),w!=null&&v.push(om(c,w,T))),c.tag===3)return v;c=c.return}return[]}function Rd(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function H3(c,f,p,v,w){for(var T=f._reactName,F=[];p!==null&&p!==v;){var U=p,le=U.alternate,we=U.stateNode;if(U=U.tag,le!==null&&le===v)break;U!==5&&U!==26&&U!==27||we===null||(le=we,w?(we=T0(p,T),we!=null&&F.unshift(om(p,we,le))):w||(we=T0(p,T),we!=null&&F.push(om(p,we,le)))),p=p.return}F.length!==0&&c.push({event:f,listeners:F})}var One=/\r\n?/g,_ne=/\u0000|\uFFFD/g;function B3(c){return(typeof c=="string"?c:""+c).replace(One,`
`).replace(_ne,"")}function V3(c,f){return f=B3(f),B3(c)===f}function Lx(){}function Cr(c,f,p,v,w,T){switch(p){case"children":typeof v=="string"?f==="body"||f==="textarea"&&v===""||Zh(c,v):(typeof v=="number"||typeof v=="bigint")&&f!=="body"&&Zh(c,""+v);break;case"className":tr(c,"class",v);break;case"tabIndex":tr(c,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":tr(c,p,v);break;case"style":WN(c,v,T);break;case"data":if(f!=="object"){tr(c,"data",v);break}case"src":case"href":if(v===""&&(f!=="a"||p!=="href")){c.removeAttribute(p);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){c.removeAttribute(p);break}v=Uy(""+v),c.setAttribute(p,v);break;case"action":case"formAction":if(typeof v=="function"){c.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(p==="formAction"?(f!=="input"&&Cr(c,f,"name",w.name,w,null),Cr(c,f,"formEncType",w.formEncType,w,null),Cr(c,f,"formMethod",w.formMethod,w,null),Cr(c,f,"formTarget",w.formTarget,w,null)):(Cr(c,f,"encType",w.encType,w,null),Cr(c,f,"method",w.method,w,null),Cr(c,f,"target",w.target,w,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){c.removeAttribute(p);break}v=Uy(""+v),c.setAttribute(p,v);break;case"onClick":v!=null&&(c.onclick=Lx);break;case"onScroll":v!=null&&Yt("scroll",c);break;case"onScrollEnd":v!=null&&Yt("scrollend",c);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(p=v.__html,p!=null){if(w.children!=null)throw Error(n(60));c.innerHTML=p}}break;case"multiple":c.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":c.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){c.removeAttribute("xlink:href");break}p=Uy(""+v),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(p,""+v):c.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(p,""):c.removeAttribute(p);break;case"capture":case"download":v===!0?c.setAttribute(p,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(p,v):c.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?c.setAttribute(p,v):c.removeAttribute(p);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?c.removeAttribute(p):c.setAttribute(p,v);break;case"popover":Yt("beforetoggle",c),Yt("toggle",c),Wt(c,"popover",v);break;case"xlinkActuate":vr(c,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":vr(c,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":vr(c,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":vr(c,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":vr(c,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":vr(c,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":vr(c,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":vr(c,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":vr(c,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":Wt(c,"is",v);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=ore.get(p)||p,Wt(c,p,v))}}function pE(c,f,p,v,w,T){switch(p){case"style":WN(c,v,T);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(p=v.__html,p!=null){if(w.children!=null)throw Error(n(60));c.innerHTML=p}}break;case"children":typeof v=="string"?Zh(c,v):(typeof v=="number"||typeof v=="bigint")&&Zh(c,""+v);break;case"onScroll":v!=null&&Yt("scroll",c);break;case"onScrollEnd":v!=null&&Yt("scrollend",c);break;case"onClick":v!=null&&(c.onclick=Lx);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!G.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(w=p.endsWith("Capture"),f=p.slice(2,w?p.length-7:void 0),T=c[ht]||null,T=T!=null?T[p]:null,typeof T=="function"&&c.removeEventListener(f,T,w),typeof v=="function")){typeof T!="function"&&T!==null&&(p in c?c[p]=null:c.hasAttribute(p)&&c.removeAttribute(p)),c.addEventListener(f,v,w);break e}p in c?c[p]=v:v===!0?c.setAttribute(p,""):Wt(c,p,v)}}}function _i(c,f,p){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yt("error",c),Yt("load",c);var v=!1,w=!1,T;for(T in p)if(p.hasOwnProperty(T)){var F=p[T];if(F!=null)switch(T){case"src":v=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:Cr(c,f,T,F,p,null)}}w&&Cr(c,f,"srcSet",p.srcSet,p,null),v&&Cr(c,f,"src",p.src,p,null);return;case"input":Yt("invalid",c);var U=T=F=w=null,le=null,we=null;for(v in p)if(p.hasOwnProperty(v)){var Oe=p[v];if(Oe!=null)switch(v){case"name":w=Oe;break;case"type":F=Oe;break;case"checked":le=Oe;break;case"defaultChecked":we=Oe;break;case"value":T=Oe;break;case"defaultValue":U=Oe;break;case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(n(137,f));break;default:Cr(c,f,v,Oe,p,null)}}HN(c,T,U,le,we,F,w,!1),Wy(c);return;case"select":Yt("invalid",c),v=F=T=null;for(w in p)if(p.hasOwnProperty(w)&&(U=p[w],U!=null))switch(w){case"value":T=U;break;case"defaultValue":F=U;break;case"multiple":v=U;default:Cr(c,f,w,U,p,null)}f=T,p=F,c.multiple=!!v,f!=null?Qh(c,!!v,f,!1):p!=null&&Qh(c,!!v,p,!0);return;case"textarea":Yt("invalid",c),T=w=v=null;for(F in p)if(p.hasOwnProperty(F)&&(U=p[F],U!=null))switch(F){case"value":v=U;break;case"defaultValue":w=U;break;case"children":T=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:Cr(c,f,F,U,p,null)}VN(c,v,w,T),Wy(c);return;case"option":for(le in p)if(p.hasOwnProperty(le)&&(v=p[le],v!=null))switch(le){case"selected":c.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Cr(c,f,le,v,p,null)}return;case"dialog":Yt("beforetoggle",c),Yt("toggle",c),Yt("cancel",c),Yt("close",c);break;case"iframe":case"object":Yt("load",c);break;case"video":case"audio":for(v=0;v<sm.length;v++)Yt(sm[v],c);break;case"image":Yt("error",c),Yt("load",c);break;case"details":Yt("toggle",c);break;case"embed":case"source":case"link":Yt("error",c),Yt("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(we in p)if(p.hasOwnProperty(we)&&(v=p[we],v!=null))switch(we){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:Cr(c,f,we,v,p,null)}return;default:if(_C(f)){for(Oe in p)p.hasOwnProperty(Oe)&&(v=p[Oe],v!==void 0&&pE(c,f,Oe,v,p,void 0));return}}for(U in p)p.hasOwnProperty(U)&&(v=p[U],v!=null&&Cr(c,f,U,v,p,null))}function Mne(c,f,p,v){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,T=null,F=null,U=null,le=null,we=null,Oe=null;for(Se in p){var De=p[Se];if(p.hasOwnProperty(Se)&&De!=null)switch(Se){case"checked":break;case"value":break;case"defaultValue":le=De;default:v.hasOwnProperty(Se)||Cr(c,f,Se,null,v,De)}}for(var be in v){var Se=v[be];if(De=p[be],v.hasOwnProperty(be)&&(Se!=null||De!=null))switch(be){case"type":T=Se;break;case"name":w=Se;break;case"checked":we=Se;break;case"defaultChecked":Oe=Se;break;case"value":F=Se;break;case"defaultValue":U=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(n(137,f));break;default:Se!==De&&Cr(c,f,be,Se,v,De)}}kC(c,F,U,le,we,Oe,T,w);return;case"select":Se=F=U=be=null;for(T in p)if(le=p[T],p.hasOwnProperty(T)&&le!=null)switch(T){case"value":break;case"multiple":Se=le;default:v.hasOwnProperty(T)||Cr(c,f,T,null,v,le)}for(w in v)if(T=v[w],le=p[w],v.hasOwnProperty(w)&&(T!=null||le!=null))switch(w){case"value":be=T;break;case"defaultValue":U=T;break;case"multiple":F=T;default:T!==le&&Cr(c,f,w,T,v,le)}f=U,p=F,v=Se,be!=null?Qh(c,!!p,be,!1):!!v!=!!p&&(f!=null?Qh(c,!!p,f,!0):Qh(c,!!p,p?[]:"",!1));return;case"textarea":Se=be=null;for(U in p)if(w=p[U],p.hasOwnProperty(U)&&w!=null&&!v.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:Cr(c,f,U,null,v,w)}for(F in v)if(w=v[F],T=p[F],v.hasOwnProperty(F)&&(w!=null||T!=null))switch(F){case"value":be=w;break;case"defaultValue":Se=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==T&&Cr(c,f,F,w,v,T)}BN(c,be,Se);return;case"option":for(var xt in p)if(be=p[xt],p.hasOwnProperty(xt)&&be!=null&&!v.hasOwnProperty(xt))switch(xt){case"selected":c.selected=!1;break;default:Cr(c,f,xt,null,v,be)}for(le in v)if(be=v[le],Se=p[le],v.hasOwnProperty(le)&&be!==Se&&(be!=null||Se!=null))switch(le){case"selected":c.selected=be&&typeof be!="function"&&typeof be!="symbol";break;default:Cr(c,f,le,be,v,Se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var mt in p)be=p[mt],p.hasOwnProperty(mt)&&be!=null&&!v.hasOwnProperty(mt)&&Cr(c,f,mt,null,v,be);for(we in v)if(be=v[we],Se=p[we],v.hasOwnProperty(we)&&be!==Se&&(be!=null||Se!=null))switch(we){case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,f));break;default:Cr(c,f,we,be,v,Se)}return;default:if(_C(f)){for(var Tr in p)be=p[Tr],p.hasOwnProperty(Tr)&&be!==void 0&&!v.hasOwnProperty(Tr)&&pE(c,f,Tr,void 0,v,be);for(Oe in v)be=v[Oe],Se=p[Oe],!v.hasOwnProperty(Oe)||be===Se||be===void 0&&Se===void 0||pE(c,f,Oe,be,v,Se);return}}for(var me in p)be=p[me],p.hasOwnProperty(me)&&be!=null&&!v.hasOwnProperty(me)&&Cr(c,f,me,null,v,be);for(De in v)be=v[De],Se=p[De],!v.hasOwnProperty(De)||be===Se||be==null&&Se==null||Cr(c,f,De,be,v,Se)}var mE=null,gE=null;function Fx(c){return c.nodeType===9?c:c.ownerDocument}function j3(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function W3(c,f){if(c===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&f==="foreignObject"?0:c}function vE(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var yE=null;function Dne(){var c=window.event;return c&&c.type==="popstate"?c===yE?!1:(yE=c,!0):(yE=null,!1)}var z3=typeof setTimeout=="function"?setTimeout:void 0,Pne=typeof clearTimeout=="function"?clearTimeout:void 0,U3=typeof Promise=="function"?Promise:void 0,Ine=typeof queueMicrotask=="function"?queueMicrotask:typeof U3<"u"?function(c){return U3.resolve(null).then(c).catch(Nne)}:z3;function Nne(c){setTimeout(function(){throw c})}function au(c){return c==="head"}function $3(c,f){var p=f,v=0,w=0;do{var T=p.nextSibling;if(c.removeChild(p),T&&T.nodeType===8)if(p=T.data,p==="/$"){if(0<v&&8>v){p=v;var F=c.ownerDocument;if(p&1&&am(F.documentElement),p&2&&am(F.body),p&4)for(p=F.head,am(p),F=p.firstChild;F;){var U=F.nextSibling,le=F.nodeName;F[X]||le==="SCRIPT"||le==="STYLE"||le==="LINK"&&F.rel.toLowerCase()==="stylesheet"||p.removeChild(F),F=U}}if(w===0){c.removeChild(T),mm(f);return}w--}else p==="$"||p==="$?"||p==="$!"?w++:v=p.charCodeAt(0)-48;else v=0;p=T}while(p);mm(f)}function xE(c){var f=c.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var p=f;switch(f=f.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":xE(p),Q(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}c.removeChild(p)}}function Lne(c,f,p,v){for(;c.nodeType===1;){var w=p;if(c.nodeName.toLowerCase()!==f.toLowerCase()){if(!v&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(v){if(!c[X])switch(f){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(T=c.getAttribute("rel"),T==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(T!==w.rel||c.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||c.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||c.getAttribute("title")!==(w.title==null?null:w.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(T=c.getAttribute("src"),(T!==(w.src==null?null:w.src)||c.getAttribute("type")!==(w.type==null?null:w.type)||c.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&T&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(f==="input"&&c.type==="hidden"){var T=w.name==null?null:""+w.name;if(w.type==="hidden"&&c.getAttribute("name")===T)return c}else return c;if(c=Sa(c.nextSibling),c===null)break}return null}function Fne(c,f,p){if(f==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!p||(c=Sa(c.nextSibling),c===null))return null;return c}function wE(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState==="complete"}function Hne(c,f){var p=c.ownerDocument;if(c.data!=="$?"||p.readyState==="complete")f();else{var v=function(){f(),p.removeEventListener("DOMContentLoaded",v)};p.addEventListener("DOMContentLoaded",v),c._reactRetry=v}}function Sa(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return c}var bE=null;function G3(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(f===0)return c;f--}else p==="/$"&&f++}c=c.previousSibling}return null}function Y3(c,f,p){switch(f=Fx(p),c){case"html":if(c=f.documentElement,!c)throw Error(n(452));return c;case"head":if(c=f.head,!c)throw Error(n(453));return c;case"body":if(c=f.body,!c)throw Error(n(454));return c;default:throw Error(n(451))}}function am(c){for(var f=c.attributes;f.length;)c.removeAttributeNode(f[0]);Q(c)}var Mo=new Map,q3=new Set;function Hx(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var oc=Z.d;Z.d={f:Bne,r:Vne,D:jne,C:Wne,L:zne,m:Une,X:Gne,S:$ne,M:Yne};function Bne(){var c=oc.f(),f=Ox();return c||f}function Vne(c){var f=se(c);f!==null&&f.tag===5&&f.type==="form"?pL(f):oc.r(c)}var Ad=typeof document>"u"?null:document;function K3(c,f,p){var v=Ad;if(v&&typeof f=="string"&&f){var w=To(f);w='link[rel="'+c+'"][href="'+w+'"]',typeof p=="string"&&(w+='[crossorigin="'+p+'"]'),q3.has(w)||(q3.add(w),c={rel:c,crossOrigin:p,href:f},v.querySelector(w)===null&&(f=v.createElement("link"),_i(f,"link",c),ge(f),v.head.appendChild(f)))}}function jne(c){oc.D(c),K3("dns-prefetch",c,null)}function Wne(c,f){oc.C(c,f),K3("preconnect",c,f)}function zne(c,f,p){oc.L(c,f,p);var v=Ad;if(v&&c&&f){var w='link[rel="preload"][as="'+To(f)+'"]';f==="image"&&p&&p.imageSrcSet?(w+='[imagesrcset="'+To(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(w+='[imagesizes="'+To(p.imageSizes)+'"]')):w+='[href="'+To(c)+'"]';var T=w;switch(f){case"style":T=kd(c);break;case"script":T=Od(c)}Mo.has(T)||(c=h({rel:"preload",href:f==="image"&&p&&p.imageSrcSet?void 0:c,as:f},p),Mo.set(T,c),v.querySelector(w)!==null||f==="style"&&v.querySelector(lm(T))||f==="script"&&v.querySelector(cm(T))||(f=v.createElement("link"),_i(f,"link",c),ge(f),v.head.appendChild(f)))}}function Une(c,f){oc.m(c,f);var p=Ad;if(p&&c){var v=f&&typeof f.as=="string"?f.as:"script",w='link[rel="modulepreload"][as="'+To(v)+'"][href="'+To(c)+'"]',T=w;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Od(c)}if(!Mo.has(T)&&(c=h({rel:"modulepreload",href:c},f),Mo.set(T,c),p.querySelector(w)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(cm(T)))return}v=p.createElement("link"),_i(v,"link",c),ge(v),p.head.appendChild(v)}}}function $ne(c,f,p){oc.S(c,f,p);var v=Ad;if(v&&c){var w=Re(v).hoistableStyles,T=kd(c);f=f||"default";var F=w.get(T);if(!F){var U={loading:0,preload:null};if(F=v.querySelector(lm(T)))U.loading=5;else{c=h({rel:"stylesheet",href:c,"data-precedence":f},p),(p=Mo.get(T))&&SE(c,p);var le=F=v.createElement("link");ge(le),_i(le,"link",c),le._p=new Promise(function(we,Oe){le.onload=we,le.onerror=Oe}),le.addEventListener("load",function(){U.loading|=1}),le.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Bx(F,f,v)}F={type:"stylesheet",instance:F,count:1,state:U},w.set(T,F)}}}function Gne(c,f){oc.X(c,f);var p=Ad;if(p&&c){var v=Re(p).hoistableScripts,w=Od(c),T=v.get(w);T||(T=p.querySelector(cm(w)),T||(c=h({src:c,async:!0},f),(f=Mo.get(w))&&CE(c,f),T=p.createElement("script"),ge(T),_i(T,"link",c),p.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},v.set(w,T))}}function Yne(c,f){oc.M(c,f);var p=Ad;if(p&&c){var v=Re(p).hoistableScripts,w=Od(c),T=v.get(w);T||(T=p.querySelector(cm(w)),T||(c=h({src:c,async:!0,type:"module"},f),(f=Mo.get(w))&&CE(c,f),T=p.createElement("script"),ge(T),_i(T,"link",c),p.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},v.set(w,T))}}function X3(c,f,p,v){var w=(w=V.current)?Hx(w):null;if(!w)throw Error(n(446));switch(c){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(f=kd(p.href),p=Re(w).hoistableStyles,v=p.get(f),v||(v={type:"style",instance:null,count:0,state:null},p.set(f,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){c=kd(p.href);var T=Re(w).hoistableStyles,F=T.get(c);if(F||(w=w.ownerDocument||w,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(c,F),(T=w.querySelector(lm(c)))&&!T._p&&(F.instance=T,F.state.loading=5),Mo.has(c)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Mo.set(c,p),T||qne(w,c,p,F.state))),f&&v===null)throw Error(n(528,""));return F}if(f&&v!==null)throw Error(n(529,""));return null;case"script":return f=p.async,p=p.src,typeof p=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Od(p),p=Re(w).hoistableScripts,v=p.get(f),v||(v={type:"script",instance:null,count:0,state:null},p.set(f,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,c))}}function kd(c){return'href="'+To(c)+'"'}function lm(c){return'link[rel="stylesheet"]['+c+"]"}function Q3(c){return h({},c,{"data-precedence":c.precedence,precedence:null})}function qne(c,f,p,v){c.querySelector('link[rel="preload"][as="style"]['+f+"]")?v.loading=1:(f=c.createElement("link"),v.preload=f,f.addEventListener("load",function(){return v.loading|=1}),f.addEventListener("error",function(){return v.loading|=2}),_i(f,"link",p),ge(f),c.head.appendChild(f))}function Od(c){return'[src="'+To(c)+'"]'}function cm(c){return"script[async]"+c}function Z3(c,f,p){if(f.count++,f.instance===null)switch(f.type){case"style":var v=c.querySelector('style[data-href~="'+To(p.href)+'"]');if(v)return f.instance=v,ge(v),v;var w=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return v=(c.ownerDocument||c).createElement("style"),ge(v),_i(v,"style",w),Bx(v,p.precedence,c),f.instance=v;case"stylesheet":w=kd(p.href);var T=c.querySelector(lm(w));if(T)return f.state.loading|=4,f.instance=T,ge(T),T;v=Q3(p),(w=Mo.get(w))&&SE(v,w),T=(c.ownerDocument||c).createElement("link"),ge(T);var F=T;return F._p=new Promise(function(U,le){F.onload=U,F.onerror=le}),_i(T,"link",v),f.state.loading|=4,Bx(T,p.precedence,c),f.instance=T;case"script":return T=Od(p.src),(w=c.querySelector(cm(T)))?(f.instance=w,ge(w),w):(v=p,(w=Mo.get(T))&&(v=h({},p),CE(v,w)),c=c.ownerDocument||c,w=c.createElement("script"),ge(w),_i(w,"link",v),c.head.appendChild(w),f.instance=w);case"void":return null;default:throw Error(n(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(v=f.instance,f.state.loading|=4,Bx(v,p.precedence,c));return f.instance}function Bx(c,f,p){for(var v=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=v.length?v[v.length-1]:null,T=w,F=0;F<v.length;F++){var U=v[F];if(U.dataset.precedence===f)T=U;else if(T!==w)break}T?T.parentNode.insertBefore(c,T.nextSibling):(f=p.nodeType===9?p.head:p,f.insertBefore(c,f.firstChild))}function SE(c,f){c.crossOrigin==null&&(c.crossOrigin=f.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=f.referrerPolicy),c.title==null&&(c.title=f.title)}function CE(c,f){c.crossOrigin==null&&(c.crossOrigin=f.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=f.referrerPolicy),c.integrity==null&&(c.integrity=f.integrity)}var Vx=null;function J3(c,f,p){if(Vx===null){var v=new Map,w=Vx=new Map;w.set(p,v)}else w=Vx,v=w.get(p),v||(v=new Map,w.set(p,v));if(v.has(c))return v;for(v.set(c,null),p=p.getElementsByTagName(c),w=0;w<p.length;w++){var T=p[w];if(!(T[X]||T[ut]||c==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var F=T.getAttribute(f)||"";F=c+F;var U=v.get(F);U?U.push(T):v.set(F,[T])}}return v}function eF(c,f,p){c=c.ownerDocument||c,c.head.insertBefore(p,f==="title"?c.querySelector("head > title"):null)}function Kne(c,f,p){if(p===1||f.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return c=f.disabled,typeof f.precedence=="string"&&c==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function tF(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}var um=null;function Xne(){}function Qne(c,f,p){if(um===null)throw Error(n(475));var v=um;if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var w=kd(p.href),T=c.querySelector(lm(w));if(T){c=T._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(v.count++,v=jx.bind(v),c.then(v,v)),f.state.loading|=4,f.instance=T,ge(T);return}T=c.ownerDocument||c,p=Q3(p),(w=Mo.get(w))&&SE(p,w),T=T.createElement("link"),ge(T);var F=T;F._p=new Promise(function(U,le){F.onload=U,F.onerror=le}),_i(T,"link",p),f.instance=T}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(v.count++,f=jx.bind(v),c.addEventListener("load",f),c.addEventListener("error",f))}}function Zne(){if(um===null)throw Error(n(475));var c=um;return c.stylesheets&&c.count===0&&TE(c,c.stylesheets),0<c.count?function(f){var p=setTimeout(function(){if(c.stylesheets&&TE(c,c.stylesheets),c.unsuspend){var v=c.unsuspend;c.unsuspend=null,v()}},6e4);return c.unsuspend=f,function(){c.unsuspend=null,clearTimeout(p)}}:null}function jx(){if(this.count--,this.count===0){if(this.stylesheets)TE(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var Wx=null;function TE(c,f){c.stylesheets=null,c.unsuspend!==null&&(c.count++,Wx=new Map,f.forEach(Jne,c),Wx=null,jx.call(c))}function Jne(c,f){if(!(f.state.loading&4)){var p=Wx.get(c);if(p)var v=p.get(null);else{p=new Map,Wx.set(c,p);for(var w=c.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<w.length;T++){var F=w[T];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(p.set(F.dataset.precedence,F),v=F)}v&&p.set(null,v)}w=f.instance,F=w.getAttribute("data-precedence"),T=p.get(F)||v,T===v&&p.set(null,w),p.set(F,w),this.count++,v=jx.bind(this),w.addEventListener("load",v),w.addEventListener("error",v),T?T.parentNode.insertBefore(w,T.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(w,c.firstChild)),f.state.loading|=4}}var fm={$$typeof:R,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function eie(c,f,p,v,w,T,F,U){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ga(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ga(0),this.hiddenUpdates=ga(null),this.identifierPrefix=v,this.onUncaughtError=w,this.onCaughtError=T,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function rF(c,f,p,v,w,T,F,U,le,we,Oe,De){return c=new eie(c,f,p,F,U,le,we,De),f=1,T===!0&&(f|=24),T=Qs(3,null,null,f),c.current=T,T.stateNode=c,f=sT(),f.refCount++,c.pooledCache=f,f.refCount++,T.memoizedState={element:v,isDehydrated:p,cache:f},cT(T),c}function nF(c){return c?(c=od,c):od}function iF(c,f,p,v,w,T){w=nF(w),v.context===null?v.context=w:v.pendingContext=w,v=qc(f),v.payload={element:p},T=T===void 0?null:T,T!==null&&(v.callback=T),p=Kc(c,v,f),p!==null&&(ro(p,c,f),j0(p,c,f))}function sF(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<f?p:f}}function EE(c,f){sF(c,f),(c=c.alternate)&&sF(c,f)}function oF(c){if(c.tag===13){var f=sd(c,67108864);f!==null&&ro(f,c,67108864),EE(c,67108864)}}var zx=!0;function tie(c,f,p,v){var w=q.T;q.T=null;var T=Z.p;try{Z.p=2,RE(c,f,p,v)}finally{Z.p=T,q.T=w}}function rie(c,f,p,v){var w=q.T;q.T=null;var T=Z.p;try{Z.p=8,RE(c,f,p,v)}finally{Z.p=T,q.T=w}}function RE(c,f,p,v){if(zx){var w=AE(v);if(w===null)dE(c,f,v,Ux,p),lF(c,v);else if(iie(w,c,f,p,v))v.stopPropagation();else if(lF(c,v),f&4&&-1<nie.indexOf(c)){for(;w!==null;){var T=se(w);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var F=ar(T.pendingLanes);if(F!==0){var U=T;for(U.pendingLanes|=2,U.entangledLanes|=2;F;){var le=1<<31-Rt(F);U.entanglements[1]|=le,F&=~le}tl(T),(xr&6)===0&&(Ax=Ee()+500,im(0))}}break;case 13:U=sd(T,2),U!==null&&ro(U,T,2),Ox(),EE(T,2)}if(T=AE(v),T===null&&dE(c,f,v,Ux,p),T===w)break;w=T}w!==null&&v.stopPropagation()}else dE(c,f,v,null,p)}}function AE(c){return c=DC(c),kE(c)}var Ux=null;function kE(c){if(Ux=null,c=ne(c),c!==null){var f=s(c);if(f===null)c=null;else{var p=f.tag;if(p===13){if(c=o(f),c!==null)return c;c=null}else if(p===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null)}}return Ux=c,null}function aF(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ue()){case st:return 2;case tt:return 8;case at:case je:return 32;case er:return 268435456;default:return 32}default:return 32}}var OE=!1,lu=null,cu=null,uu=null,hm=new Map,dm=new Map,fu=[],nie="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lF(c,f){switch(c){case"focusin":case"focusout":lu=null;break;case"dragenter":case"dragleave":cu=null;break;case"mouseover":case"mouseout":uu=null;break;case"pointerover":case"pointerout":hm.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":dm.delete(f.pointerId)}}function pm(c,f,p,v,w,T){return c===null||c.nativeEvent!==T?(c={blockedOn:f,domEventName:p,eventSystemFlags:v,nativeEvent:T,targetContainers:[w]},f!==null&&(f=se(f),f!==null&&oF(f)),c):(c.eventSystemFlags|=v,f=c.targetContainers,w!==null&&f.indexOf(w)===-1&&f.push(w),c)}function iie(c,f,p,v,w){switch(f){case"focusin":return lu=pm(lu,c,f,p,v,w),!0;case"dragenter":return cu=pm(cu,c,f,p,v,w),!0;case"mouseover":return uu=pm(uu,c,f,p,v,w),!0;case"pointerover":var T=w.pointerId;return hm.set(T,pm(hm.get(T)||null,c,f,p,v,w)),!0;case"gotpointercapture":return T=w.pointerId,dm.set(T,pm(dm.get(T)||null,c,f,p,v,w)),!0}return!1}function cF(c){var f=ne(c.target);if(f!==null){var p=s(f);if(p!==null){if(f=p.tag,f===13){if(f=o(p),f!==null){c.blockedOn=f,We(c.priority,function(){if(p.tag===13){var v=to();v=zi(v);var w=sd(p,v);w!==null&&ro(w,p,v),EE(p,v)}});return}}else if(f===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function $x(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var p=AE(c.nativeEvent);if(p===null){p=c.nativeEvent;var v=new p.constructor(p.type,p);MC=v,p.target.dispatchEvent(v),MC=null}else return f=se(p),f!==null&&oF(f),c.blockedOn=p,!1;f.shift()}return!0}function uF(c,f,p){$x(c)&&p.delete(f)}function sie(){OE=!1,lu!==null&&$x(lu)&&(lu=null),cu!==null&&$x(cu)&&(cu=null),uu!==null&&$x(uu)&&(uu=null),hm.forEach(uF),dm.forEach(uF)}function Gx(c,f){c.blockedOn===f&&(c.blockedOn=null,OE||(OE=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,sie)))}var Yx=null;function fF(c){Yx!==c&&(Yx=c,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Yx===c&&(Yx=null);for(var f=0;f<c.length;f+=3){var p=c[f],v=c[f+1],w=c[f+2];if(typeof v!="function"){if(kE(v||p)===null)continue;break}var T=se(p);T!==null&&(c.splice(f,3),f-=3,kT(T,{pending:!0,data:w,method:p.method,action:v},v,w))}}))}function mm(c){function f(le){return Gx(le,c)}lu!==null&&Gx(lu,c),cu!==null&&Gx(cu,c),uu!==null&&Gx(uu,c),hm.forEach(f),dm.forEach(f);for(var p=0;p<fu.length;p++){var v=fu[p];v.blockedOn===c&&(v.blockedOn=null)}for(;0<fu.length&&(p=fu[0],p.blockedOn===null);)cF(p),p.blockedOn===null&&fu.shift();if(p=(c.ownerDocument||c).$$reactFormReplay,p!=null)for(v=0;v<p.length;v+=3){var w=p[v],T=p[v+1],F=w[ht]||null;if(typeof T=="function")F||fF(p);else if(F){var U=null;if(T&&T.hasAttribute("formAction")){if(w=T,F=T[ht]||null)U=F.formAction;else if(kE(w)!==null)continue}else U=F.action;typeof U=="function"?p[v+1]=U:(p.splice(v,3),v-=3),fF(p)}}}function _E(c){this._internalRoot=c}qx.prototype.render=_E.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(n(409));var p=f.current,v=to();iF(p,v,c,f,null,null)},qx.prototype.unmount=_E.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;iF(c.current,2,null,c,null,null),Ox(),f[Ot]=null}};function qx(c){this._internalRoot=c}qx.prototype.unstable_scheduleHydration=function(c){if(c){var f=On();c={blockedOn:null,target:c,priority:f};for(var p=0;p<fu.length&&f!==0&&f<fu[p].priority;p++);fu.splice(p,0,c),p===0&&cF(c)}};var hF=e.version;if(hF!=="19.1.0")throw Error(n(527,hF,"19.1.0"));Z.findDOMNode=function(c){var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(n(188)):(c=Object.keys(c).join(","),Error(n(268,c)));return c=l(f),c=c!==null?u(c):null,c=c===null?null:c.stateNode,c};var oie={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kx.isDisabled&&Kx.supportsFiber)try{Dt=Kx.inject(oie),Et=Kx}catch{}}return ym.createRoot=function(c,f){if(!i(c))throw Error(n(299));var p=!1,v="",w=kL,T=OL,F=_L,U=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(v=f.identifierPrefix),f.onUncaughtError!==void 0&&(w=f.onUncaughtError),f.onCaughtError!==void 0&&(T=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(U=f.unstable_transitionCallbacks)),f=rF(c,1,!1,null,null,p,v,w,T,F,U,null),c[Ot]=f.current,hE(c),new _E(f)},ym.hydrateRoot=function(c,f,p){if(!i(c))throw Error(n(299));var v=!1,w="",T=kL,F=OL,U=_L,le=null,we=null;return p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onUncaughtError!==void 0&&(T=p.onUncaughtError),p.onCaughtError!==void 0&&(F=p.onCaughtError),p.onRecoverableError!==void 0&&(U=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(le=p.unstable_transitionCallbacks),p.formState!==void 0&&(we=p.formState)),f=rF(c,1,!0,f,p??null,v,w,T,F,U,le,we),f.context=nF(null),p=f.current,v=to(),v=zi(v),w=qc(v),w.callback=null,Kc(p,w,v),p=v,f.current.lanes=p,ii(f,p),tl(f),c[Ot]=f.current,hE(c),new qx(f)},ym.version="19.1.0",ym}var CF;function xie(){if(CF)return PE.exports;CF=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),PE.exports=yie(),PE.exports}var wie=xie();const bie=KM(wie);function mh(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(n=>r.searchParams.append("args[]",n)),`Minified MUI error #${t}; visit ${r} for the full message.`}const Rl="$$material";function Xg(){return Xg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xg.apply(null,arguments)}function Sie(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Cie(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Tie=function(){function t(r){var n=this;this._insertTag=function(i){var s;n.tags.length===0?n.insertionPoint?s=n.insertionPoint.nextSibling:n.prepend?s=n.container.firstChild:s=n.before:s=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,s),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Cie(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=Sie(i);try{s.insertRule(n,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t}(),qi="-ms-",ob="-moz-",mr="-webkit-",Y7="comm",QM="rule",ZM="decl",Eie="@import",q7="@keyframes",Rie="@layer",Aie=Math.abs,vS=String.fromCharCode,kie=Object.assign;function Oie(t,e){return Ii(t,0)^45?(((e<<2^Ii(t,0))<<2^Ii(t,1))<<2^Ii(t,2))<<2^Ii(t,3):0}function K7(t){return t.trim()}function _ie(t,e){return(t=e.exec(t))?t[0]:t}function gr(t,e,r){return t.replace(e,r)}function SO(t,e){return t.indexOf(e)}function Ii(t,e){return t.charCodeAt(e)|0}function Qg(t,e,r){return t.slice(e,r)}function gl(t){return t.length}function JM(t){return t.length}function Xx(t,e){return e.push(t),t}function Mie(t,e){return t.map(e).join("")}var yS=1,Mp=1,X7=0,Gs=0,ei=0,n0="";function xS(t,e,r,n,i,s,o){return{value:t,root:e,parent:r,type:n,props:i,children:s,line:yS,column:Mp,length:o,return:""}}function xm(t,e){return kie(xS("",null,null,"",null,null,0),t,{length:-t.length},e)}function Die(){return ei}function Pie(){return ei=Gs>0?Ii(n0,--Gs):0,Mp--,ei===10&&(Mp=1,yS--),ei}function ho(){return ei=Gs<X7?Ii(n0,Gs++):0,Mp++,ei===10&&(Mp=1,yS++),ei}function Al(){return Ii(n0,Gs)}function kw(){return Gs}function qv(t,e){return Qg(n0,t,e)}function Zg(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Q7(t){return yS=Mp=1,X7=gl(n0=t),Gs=0,[]}function Z7(t){return n0="",t}function Ow(t){return K7(qv(Gs-1,CO(t===91?t+2:t===40?t+1:t)))}function Iie(t){for(;(ei=Al())&&ei<33;)ho();return Zg(t)>2||Zg(ei)>3?"":" "}function Nie(t,e){for(;--e&&ho()&&!(ei<48||ei>102||ei>57&&ei<65||ei>70&&ei<97););return qv(t,kw()+(e<6&&Al()==32&&ho()==32))}function CO(t){for(;ho();)switch(ei){case t:return Gs;case 34:case 39:t!==34&&t!==39&&CO(ei);break;case 40:t===41&&CO(t);break;case 92:ho();break}return Gs}function Lie(t,e){for(;ho()&&t+ei!==57;)if(t+ei===84&&Al()===47)break;return"/*"+qv(e,Gs-1)+"*"+vS(t===47?t:ho())}function Fie(t){for(;!Zg(Al());)ho();return qv(t,Gs)}function Hie(t){return Z7(_w("",null,null,null,[""],t=Q7(t),0,[0],t))}function _w(t,e,r,n,i,s,o,a,l){for(var u=0,h=0,d=o,m=0,g=0,y=0,x=1,b=1,C=1,E=0,R="",k=i,O=s,P=n,D=R;b;)switch(y=E,E=ho()){case 40:if(y!=108&&Ii(D,d-1)==58){SO(D+=gr(Ow(E),"&","&\f"),"&\f")!=-1&&(C=-1);break}case 34:case 39:case 91:D+=Ow(E);break;case 9:case 10:case 13:case 32:D+=Iie(y);break;case 92:D+=Nie(kw()-1,7);continue;case 47:switch(Al()){case 42:case 47:Xx(Bie(Lie(ho(),kw()),e,r),l);break;default:D+="/"}break;case 123*x:a[u++]=gl(D)*C;case 125*x:case 59:case 0:switch(E){case 0:case 125:b=0;case 59+h:C==-1&&(D=gr(D,/\f/g,"")),g>0&&gl(D)-d&&Xx(g>32?EF(D+";",n,r,d-1):EF(gr(D," ","")+";",n,r,d-2),l);break;case 59:D+=";";default:if(Xx(P=TF(D,e,r,u,h,i,a,R,k=[],O=[],d),s),E===123)if(h===0)_w(D,e,P,P,k,s,d,a,O);else switch(m===99&&Ii(D,3)===110?100:m){case 100:case 108:case 109:case 115:_w(t,P,P,n&&Xx(TF(t,P,P,0,0,i,a,R,i,k=[],d),O),i,O,d,a,n?k:O);break;default:_w(D,P,P,P,[""],O,0,a,O)}}u=h=g=0,x=C=1,R=D="",d=o;break;case 58:d=1+gl(D),g=y;default:if(x<1){if(E==123)--x;else if(E==125&&x++==0&&Pie()==125)continue}switch(D+=vS(E),E*x){case 38:C=h>0?1:(D+="\f",-1);break;case 44:a[u++]=(gl(D)-1)*C,C=1;break;case 64:Al()===45&&(D+=Ow(ho())),m=Al(),h=d=gl(R=D+=Fie(kw())),E++;break;case 45:y===45&&gl(D)==2&&(x=0)}}return s}function TF(t,e,r,n,i,s,o,a,l,u,h){for(var d=i-1,m=i===0?s:[""],g=JM(m),y=0,x=0,b=0;y<n;++y)for(var C=0,E=Qg(t,d+1,d=Aie(x=o[y])),R=t;C<g;++C)(R=K7(x>0?m[C]+" "+E:gr(E,/&\f/g,m[C])))&&(l[b++]=R);return xS(t,e,r,i===0?QM:a,l,u,h)}function Bie(t,e,r){return xS(t,e,r,Y7,vS(Die()),Qg(t,2,-2),0)}function EF(t,e,r,n){return xS(t,e,r,ZM,Qg(t,0,n),Qg(t,n+1,-1),n)}function mp(t,e){for(var r="",n=JM(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function Vie(t,e,r,n){switch(t.type){case Rie:if(t.children.length)break;case Eie:case ZM:return t.return=t.return||t.value;case Y7:return"";case q7:return t.return=t.value+"{"+mp(t.children,n)+"}";case QM:t.value=t.props.join(",")}return gl(r=mp(t.children,n))?t.return=t.value+"{"+r+"}":""}function jie(t){var e=JM(t);return function(r,n,i,s){for(var o="",a=0;a<e;a++)o+=t[a](r,n,i,s)||"";return o}}function Wie(t){return function(e){e.root||(e=e.return)&&t(e)}}function J7(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var zie=function(e,r,n){for(var i=0,s=0;i=s,s=Al(),i===38&&s===12&&(r[n]=1),!Zg(s);)ho();return qv(e,Gs)},Uie=function(e,r){var n=-1,i=44;do switch(Zg(i)){case 0:i===38&&Al()===12&&(r[n]=1),e[n]+=zie(Gs-1,r,n);break;case 2:e[n]+=Ow(i);break;case 4:if(i===44){e[++n]=Al()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=vS(i)}while(i=ho());return e},$ie=function(e,r){return Z7(Uie(Q7(e),r))},RF=new WeakMap,Gie=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!RF.get(n))&&!i){RF.set(e,!0);for(var s=[],o=$ie(r,s),a=n.props,l=0,u=0;l<o.length;l++)for(var h=0;h<a.length;h++,u++)e.props[u]=s[l]?o[l].replace(/&\f/g,a[h]):a[h]+" "+o[l]}}},Yie=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function eU(t,e){switch(Oie(t,e)){case 5103:return mr+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return mr+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return mr+t+ob+t+qi+t+t;case 6828:case 4268:return mr+t+qi+t+t;case 6165:return mr+t+qi+"flex-"+t+t;case 5187:return mr+t+gr(t,/(\w+).+(:[^]+)/,mr+"box-$1$2"+qi+"flex-$1$2")+t;case 5443:return mr+t+qi+"flex-item-"+gr(t,/flex-|-self/,"")+t;case 4675:return mr+t+qi+"flex-line-pack"+gr(t,/align-content|flex-|-self/,"")+t;case 5548:return mr+t+qi+gr(t,"shrink","negative")+t;case 5292:return mr+t+qi+gr(t,"basis","preferred-size")+t;case 6060:return mr+"box-"+gr(t,"-grow","")+mr+t+qi+gr(t,"grow","positive")+t;case 4554:return mr+gr(t,/([^-])(transform)/g,"$1"+mr+"$2")+t;case 6187:return gr(gr(gr(t,/(zoom-|grab)/,mr+"$1"),/(image-set)/,mr+"$1"),t,"")+t;case 5495:case 3959:return gr(t,/(image-set\([^]*)/,mr+"$1$`$1");case 4968:return gr(gr(t,/(.+:)(flex-)?(.*)/,mr+"box-pack:$3"+qi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+mr+t+t;case 4095:case 3583:case 4068:case 2532:return gr(t,/(.+)-inline(.+)/,mr+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(gl(t)-1-e>6)switch(Ii(t,e+1)){case 109:if(Ii(t,e+4)!==45)break;case 102:return gr(t,/(.+:)(.+)-([^]+)/,"$1"+mr+"$2-$3$1"+ob+(Ii(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~SO(t,"stretch")?eU(gr(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Ii(t,e+1)!==115)break;case 6444:switch(Ii(t,gl(t)-3-(~SO(t,"!important")&&10))){case 107:return gr(t,":",":"+mr)+t;case 101:return gr(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+mr+(Ii(t,14)===45?"inline-":"")+"box$3$1"+mr+"$2$3$1"+qi+"$2box$3")+t}break;case 5936:switch(Ii(t,e+11)){case 114:return mr+t+qi+gr(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return mr+t+qi+gr(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return mr+t+qi+gr(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return mr+t+qi+t+t}return t}var qie=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case ZM:e.return=eU(e.value,e.length);break;case q7:return mp([xm(e,{value:gr(e.value,"@","@"+mr)})],i);case QM:if(e.length)return Mie(e.props,function(s){switch(_ie(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return mp([xm(e,{props:[gr(s,/:(read-\w+)/,":"+ob+"$1")]})],i);case"::placeholder":return mp([xm(e,{props:[gr(s,/:(plac\w+)/,":"+mr+"input-$1")]}),xm(e,{props:[gr(s,/:(plac\w+)/,":"+ob+"$1")]}),xm(e,{props:[gr(s,/:(plac\w+)/,qi+"input-$1")]})],i)}return""})}},Kie=[qie],Xie=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(x){var b=x.getAttribute("data-emotion");b.indexOf(" ")!==-1&&(document.head.appendChild(x),x.setAttribute("data-s",""))})}var i=e.stylisPlugins||Kie,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(x){for(var b=x.getAttribute("data-emotion").split(" "),C=1;C<b.length;C++)s[b[C]]=!0;a.push(x)});var l,u=[Gie,Yie];{var h,d=[Vie,Wie(function(x){h.insert(x)})],m=jie(u.concat(i,d)),g=function(b){return mp(Hie(b),m)};l=function(b,C,E,R){h=E,g(b?b+"{"+C.styles+"}":C.styles),R&&(y.inserted[C.name]=!0)}}var y={key:r,sheet:new Tie({key:r,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:l};return y.sheet.hydrate(a),y},FE={exports:{}},yr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AF;function Qie(){if(AF)return yr;AF=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,s=t?Symbol.for("react.profiler"):60114,o=t?Symbol.for("react.provider"):60109,a=t?Symbol.for("react.context"):60110,l=t?Symbol.for("react.async_mode"):60111,u=t?Symbol.for("react.concurrent_mode"):60111,h=t?Symbol.for("react.forward_ref"):60112,d=t?Symbol.for("react.suspense"):60113,m=t?Symbol.for("react.suspense_list"):60120,g=t?Symbol.for("react.memo"):60115,y=t?Symbol.for("react.lazy"):60116,x=t?Symbol.for("react.block"):60121,b=t?Symbol.for("react.fundamental"):60117,C=t?Symbol.for("react.responder"):60118,E=t?Symbol.for("react.scope"):60119;function R(O){if(typeof O=="object"&&O!==null){var P=O.$$typeof;switch(P){case e:switch(O=O.type,O){case l:case u:case n:case s:case i:case d:return O;default:switch(O=O&&O.$$typeof,O){case a:case h:case y:case g:case o:return O;default:return P}}case r:return P}}}function k(O){return R(O)===u}return yr.AsyncMode=l,yr.ConcurrentMode=u,yr.ContextConsumer=a,yr.ContextProvider=o,yr.Element=e,yr.ForwardRef=h,yr.Fragment=n,yr.Lazy=y,yr.Memo=g,yr.Portal=r,yr.Profiler=s,yr.StrictMode=i,yr.Suspense=d,yr.isAsyncMode=function(O){return k(O)||R(O)===l},yr.isConcurrentMode=k,yr.isContextConsumer=function(O){return R(O)===a},yr.isContextProvider=function(O){return R(O)===o},yr.isElement=function(O){return typeof O=="object"&&O!==null&&O.$$typeof===e},yr.isForwardRef=function(O){return R(O)===h},yr.isFragment=function(O){return R(O)===n},yr.isLazy=function(O){return R(O)===y},yr.isMemo=function(O){return R(O)===g},yr.isPortal=function(O){return R(O)===r},yr.isProfiler=function(O){return R(O)===s},yr.isStrictMode=function(O){return R(O)===i},yr.isSuspense=function(O){return R(O)===d},yr.isValidElementType=function(O){return typeof O=="string"||typeof O=="function"||O===n||O===u||O===s||O===i||O===d||O===m||typeof O=="object"&&O!==null&&(O.$$typeof===y||O.$$typeof===g||O.$$typeof===o||O.$$typeof===a||O.$$typeof===h||O.$$typeof===b||O.$$typeof===C||O.$$typeof===E||O.$$typeof===x)},yr.typeOf=R,yr}var kF;function Zie(){return kF||(kF=1,FE.exports=Qie()),FE.exports}var HE,OF;function Jie(){if(OF)return HE;OF=1;var t=Zie(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[t.ForwardRef]=n,s[t.Memo]=i;function o(y){return t.isMemo(y)?i:s[y.$$typeof]||e}var a=Object.defineProperty,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,m=Object.prototype;function g(y,x,b){if(typeof x!="string"){if(m){var C=d(x);C&&C!==m&&g(y,C,b)}var E=l(x);u&&(E=E.concat(u(x)));for(var R=o(y),k=o(x),O=0;O<E.length;++O){var P=E[O];if(!r[P]&&!(b&&b[P])&&!(k&&k[P])&&!(R&&R[P])){var D=h(x,P);try{a(y,P,D)}catch{}}}}return y}return HE=g,HE}Jie();var ese=!0;function tU(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var eD=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||ese===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},tD=function(e,r,n){eD(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var s=r;do e.insert(r===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function tse(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var rse={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},nse=/[A-Z]|^ms/g,ise=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rU=function(e){return e.charCodeAt(1)===45},_F=function(e){return e!=null&&typeof e!="boolean"},BE=J7(function(t){return rU(t)?t:t.replace(nse,"-$&").toLowerCase()}),MF=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(ise,function(n,i,s){return vl={name:i,styles:s,next:vl},i})}return rse[e]!==1&&!rU(e)&&typeof r=="number"&&r!==0?r+"px":r};function Jg(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return vl={name:i.name,styles:i.styles,next:vl},i.name;var s=r;if(s.styles!==void 0){var o=s.next;if(o!==void 0)for(;o!==void 0;)vl={name:o.name,styles:o.styles,next:vl},o=o.next;var a=s.styles+";";return a}return sse(t,e,r)}case"function":{if(t!==void 0){var l=vl,u=r(t);return vl=l,Jg(t,e,u)}break}}var h=r;if(e==null)return h;var d=e[h];return d!==void 0?d:h}function sse(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Jg(t,e,r[i])+";";else for(var s in r){var o=r[s];if(typeof o!="object"){var a=o;e!=null&&e[a]!==void 0?n+=s+"{"+e[a]+"}":_F(a)&&(n+=BE(s)+":"+MF(s,a)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var l=0;l<o.length;l++)_F(o[l])&&(n+=BE(s)+":"+MF(s,o[l])+";");else{var u=Jg(t,e,o);switch(s){case"animation":case"animationName":{n+=BE(s)+":"+u+";";break}default:n+=s+"{"+u+"}"}}}return n}var DF=/label:\s*([^\s;{]+)\s*(;|$)/g,vl;function Kv(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";vl=void 0;var s=t[0];if(s==null||s.raw===void 0)n=!1,i+=Jg(r,e,s);else{var o=s;i+=o[0]}for(var a=1;a<t.length;a++)if(i+=Jg(r,e,t[a]),n){var l=s;i+=l[a]}DF.lastIndex=0;for(var u="",h;(h=DF.exec(i))!==null;)u+="-"+h[1];var d=tse(i)+u;return{name:d,styles:i,next:vl}}var ose=function(e){return e()},nU=bO.useInsertionEffect?bO.useInsertionEffect:!1,iU=nU||ose,PF=nU||Y.useLayoutEffect,sU=Y.createContext(typeof HTMLElement<"u"?Xie({key:"css"}):null);sU.Provider;var rD=function(e){return Y.forwardRef(function(r,n){var i=Y.useContext(sU);return e(r,i,n)})},Xv=Y.createContext({}),nD={}.hasOwnProperty,TO="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ase=function(e,r){var n={};for(var i in r)nD.call(r,i)&&(n[i]=r[i]);return n[TO]=e,n},lse=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return eD(r,n,i),iU(function(){return tD(r,n,i)}),null},cse=rD(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[TO],s=[n],o="";typeof t.className=="string"?o=tU(e.registered,s,t.className):t.className!=null&&(o=t.className+" ");var a=Kv(s,void 0,Y.useContext(Xv));o+=e.key+"-"+a.name;var l={};for(var u in t)nD.call(t,u)&&u!=="css"&&u!==TO&&(l[u]=t[u]);return l.className=o,r&&(l.ref=r),Y.createElement(Y.Fragment,null,Y.createElement(lse,{cache:e,serialized:a,isStringTag:typeof i=="string"}),Y.createElement(i,l))}),use=cse,IF=function(e,r){var n=arguments;if(r==null||!nD.call(r,"css"))return Y.createElement.apply(void 0,n);var i=n.length,s=new Array(i);s[0]=use,s[1]=ase(e,r);for(var o=2;o<i;o++)s[o]=n[o];return Y.createElement.apply(null,s)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(IF||(IF={}));var fse=rD(function(t,e){var r=t.styles,n=Kv([r],void 0,Y.useContext(Xv)),i=Y.useRef();return PF(function(){var s=e.key+"-global",o=new e.sheet.constructor({key:s,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),a=!1,l=document.querySelector('style[data-emotion="'+s+" "+n.name+'"]');return e.sheet.tags.length&&(o.before=e.sheet.tags[0]),l!==null&&(a=!0,l.setAttribute("data-emotion",s),o.hydrate([l])),i.current=[o,a],function(){o.flush()}},[e]),PF(function(){var s=i.current,o=s[0],a=s[1];if(a){s[1]=!1;return}if(n.next!==void 0&&tD(e,n.next,!0),o.tags.length){var l=o.tags[o.tags.length-1].nextElementSibling;o.before=l,o.flush()}e.insert("",n,o,!1)},[e,n.name]),null});function iD(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Kv(e)}function Qv(){var t=iD.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var hse=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,dse=J7(function(t){return hse.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),pse=dse,mse=function(e){return e!=="theme"},NF=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?pse:mse},LF=function(e,r,n){var i;if(r){var s=r.shouldForwardProp;i=e.__emotion_forwardProp&&s?function(o){return e.__emotion_forwardProp(o)&&s(o)}:s}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},gse=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return eD(r,n,i),iU(function(){return tD(r,n,i)}),null},vse=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,s,o;r!==void 0&&(s=r.label,o=r.target);var a=LF(e,r,n),l=a||NF(i),u=!l("as");return function(){var h=arguments,d=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&d.push("label:"+s+";"),h[0]==null||h[0].raw===void 0)d.push.apply(d,h);else{var m=h[0];d.push(m[0]);for(var g=h.length,y=1;y<g;y++)d.push(h[y],m[y])}var x=rD(function(b,C,E){var R=u&&b.as||i,k="",O=[],P=b;if(b.theme==null){P={};for(var D in b)P[D]=b[D];P.theme=Y.useContext(Xv)}typeof b.className=="string"?k=tU(C.registered,O,b.className):b.className!=null&&(k=b.className+" ");var H=Kv(d.concat(O),C.registered,P);k+=C.key+"-"+H.name,o!==void 0&&(k+=" "+o);var N=u&&a===void 0?NF(R):l,_={};for(var B in b)u&&B==="as"||N(B)&&(_[B]=b[B]);return _.className=k,E&&(_.ref=E),Y.createElement(Y.Fragment,null,Y.createElement(gse,{cache:C,serialized:H,isStringTag:typeof R=="string"}),Y.createElement(R,_))});return x.displayName=s!==void 0?s:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",x.defaultProps=e.defaultProps,x.__emotion_real=x,x.__emotion_base=i,x.__emotion_styles=d,x.__emotion_forwardProp=a,Object.defineProperty(x,"toString",{value:function(){return"."+o}}),x.withComponent=function(b,C){var E=t(b,Xg({},r,C,{shouldForwardProp:LF(x,C,!0)}));return E.apply(void 0,d)},x}},yse=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],EO=vse.bind(null);yse.forEach(function(t){EO[t]=EO(t)});function xse(t){return t==null||Object.keys(t).length===0}function oU(t){const{styles:e,defaultTheme:r={}}=t,n=typeof e=="function"?i=>e(xse(i)?r:i):e;return I.jsx(fse,{styles:n})}function aU(t,e){return EO(t,e)}function wse(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const FF=[];function HF(t){return FF[0]=t,Kv(FF)}var VE={exports:{}},Er={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BF;function bse(){if(BF)return Er;BF=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function y(x){if(typeof x=="object"&&x!==null){var b=x.$$typeof;switch(b){case t:switch(x=x.type,x){case r:case i:case n:case l:case u:case m:return x;default:switch(x=x&&x.$$typeof,x){case o:case a:case d:case h:return x;case s:return x;default:return b}}case e:return b}}}return Er.ContextConsumer=s,Er.ContextProvider=o,Er.Element=t,Er.ForwardRef=a,Er.Fragment=r,Er.Lazy=d,Er.Memo=h,Er.Portal=e,Er.Profiler=i,Er.StrictMode=n,Er.Suspense=l,Er.SuspenseList=u,Er.isContextConsumer=function(x){return y(x)===s},Er.isContextProvider=function(x){return y(x)===o},Er.isElement=function(x){return typeof x=="object"&&x!==null&&x.$$typeof===t},Er.isForwardRef=function(x){return y(x)===a},Er.isFragment=function(x){return y(x)===r},Er.isLazy=function(x){return y(x)===d},Er.isMemo=function(x){return y(x)===h},Er.isPortal=function(x){return y(x)===e},Er.isProfiler=function(x){return y(x)===i},Er.isStrictMode=function(x){return y(x)===n},Er.isSuspense=function(x){return y(x)===l},Er.isSuspenseList=function(x){return y(x)===u},Er.isValidElementType=function(x){return typeof x=="string"||typeof x=="function"||x===r||x===i||x===n||x===l||x===u||typeof x=="object"&&x!==null&&(x.$$typeof===d||x.$$typeof===h||x.$$typeof===o||x.$$typeof===s||x.$$typeof===a||x.$$typeof===g||x.getModuleId!==void 0)},Er.typeOf=y,Er}var VF;function Sse(){return VF||(VF=1,VE.exports=bse()),VE.exports}var lU=Sse();function yl(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function cU(t){if(Y.isValidElement(t)||lU.isValidElementType(t)||!yl(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=cU(t[r])}),e}function po(t,e,r={clone:!0}){const n=r.clone?{...t}:t;return yl(t)&&yl(e)&&Object.keys(e).forEach(i=>{Y.isValidElement(e[i])||lU.isValidElementType(e[i])?n[i]=e[i]:yl(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&yl(t[i])?n[i]=po(t[i],e[i],r):r.clone?n[i]=yl(e[i])?cU(e[i]):e[i]:n[i]=e[i]}),n}const Cse=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,n)=>r.val-n.val),e.reduce((r,n)=>({...r,[n.key]:n.val}),{})};function Tse(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...i}=t,s=Cse(e),o=Object.keys(s);function a(m){return`@media (min-width:${typeof e[m]=="number"?e[m]:m}${r})`}function l(m){return`@media (max-width:${(typeof e[m]=="number"?e[m]:m)-n/100}${r})`}function u(m,g){const y=o.indexOf(g);return`@media (min-width:${typeof e[m]=="number"?e[m]:m}${r}) and (max-width:${(y!==-1&&typeof e[o[y]]=="number"?e[o[y]]:g)-n/100}${r})`}function h(m){return o.indexOf(m)+1<o.length?u(m,o[o.indexOf(m)+1]):a(m)}function d(m){const g=o.indexOf(m);return g===0?a(o[1]):g===o.length-1?l(o[g]):u(m,o[o.indexOf(m)+1]).replace("@media","@media not all and")}return{keys:o,values:s,up:a,down:l,between:u,only:h,not:d,unit:r,...i}}function Ese(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,i)=>{var o,a;const s=/min-width:\s*([0-9.]+)/;return+(((o=n.match(s))==null?void 0:o[1])||0)-+(((a=i.match(s))==null?void 0:a[1])||0)});return r.length?r.reduce((n,i)=>{const s=e[i];return delete n[i],n[i]=s,n},{...e}):e}function Rse(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function Ase(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,s=Number.isNaN(+n)?n||0:+n;return t.containerQueries(i).up(s)}function kse(t){const e=(s,o)=>s.replace("@media",o?`@container ${o}`:"@container");function r(s,o){s.up=(...a)=>e(t.breakpoints.up(...a),o),s.down=(...a)=>e(t.breakpoints.down(...a),o),s.between=(...a)=>e(t.breakpoints.between(...a),o),s.only=(...a)=>e(t.breakpoints.only(...a),o),s.not=(...a)=>{const l=e(t.breakpoints.not(...a),o);return l.includes("not all and")?l.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):l}}const n={},i=s=>(r(n,s),n);return r(i),{...t,containerQueries:i}}const Ose={borderRadius:4};function xg(t,e){return e?po(t,e,{clone:!1}):t}const wS={xs:0,sm:600,md:900,lg:1200,xl:1536},jF={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${wS[t]}px)`},_se={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:wS[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function _c(t,e,r){const n=t.theme||{};if(Array.isArray(e)){const s=n.breakpoints||jF;return e.reduce((o,a,l)=>(o[s.up(s.keys[l])]=r(e[l]),o),{})}if(typeof e=="object"){const s=n.breakpoints||jF;return Object.keys(e).reduce((o,a)=>{if(Rse(s.keys,a)){const l=Ase(n.containerQueries?n:_se,a);l&&(o[l]=r(e[a],a))}else if(Object.keys(s.values||wS).includes(a)){const l=s.up(a);o[l]=r(e[a],a)}else{const l=a;o[l]=e[l]}return o},{})}return r(e)}function Mse(t={}){var r;return((r=t.keys)==null?void 0:r.reduce((n,i)=>{const s=t.up(i);return n[s]={},n},{}))||{}}function Dse(t,e){return t.reduce((r,n)=>{const i=r[n];return(!i||Object.keys(i).length===0)&&delete r[n],r},e)}function Tt(t){if(typeof t!="string")throw new Error(mh(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Ru(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const n=`vars.${e}`.split(".").reduce((i,s)=>i&&i[s]?i[s]:null,t);if(n!=null)return n}return e.split(".").reduce((n,i)=>n&&n[i]!=null?n[i]:null,t)}function ab(t,e,r,n=r){let i;return typeof t=="function"?i=t(r):Array.isArray(t)?i=t[r]||n:i=Ru(t,r)||n,e&&(i=e(i,n,t)),i}function Hn(t){const{prop:e,cssProperty:r=t.prop,themeKey:n,transform:i}=t,s=o=>{if(o[e]==null)return null;const a=o[e],l=o.theme,u=Ru(l,n)||{};return _c(o,a,d=>{let m=ab(u,i,d);return d===m&&typeof d=="string"&&(m=ab(u,i,`${e}${d==="default"?"":Tt(d)}`,d)),r===!1?m:{[r]:m}})};return s.propTypes={},s.filterProps=[e],s}function Pse(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const Ise={m:"margin",p:"padding"},Nse={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},WF={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Lse=Pse(t=>{if(t.length>2)if(WF[t])t=WF[t];else return[t];const[e,r]=t.split(""),n=Ise[e],i=Nse[r]||"";return Array.isArray(i)?i.map(s=>n+s):[n+i]}),sD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],oD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...sD,...oD];function Zv(t,e,r,n){const i=Ru(t,e,!0)??r;return typeof i=="number"||typeof i=="string"?s=>typeof s=="string"?s:typeof i=="string"?i.startsWith("var(")&&s===0?0:i.startsWith("var(")&&s===1?i:`calc(${s} * ${i})`:i*s:Array.isArray(i)?s=>{if(typeof s=="string")return s;const o=Math.abs(s),a=i[o];return s>=0?a:typeof a=="number"?-a:typeof a=="string"&&a.startsWith("var(")?`calc(-1 * ${a})`:`-${a}`}:typeof i=="function"?i:()=>{}}function aD(t){return Zv(t,"spacing",8)}function Jv(t,e){return typeof e=="string"||e==null?e:t(e)}function Fse(t,e){return r=>t.reduce((n,i)=>(n[i]=Jv(e,r),n),{})}function Hse(t,e,r,n){if(!e.includes(r))return null;const i=Lse(r),s=Fse(i,n),o=t[r];return _c(t,o,s)}function uU(t,e){const r=aD(t.theme);return Object.keys(t).map(n=>Hse(t,e,n,r)).reduce(xg,{})}function Sn(t){return uU(t,sD)}Sn.propTypes={};Sn.filterProps=sD;function Cn(t){return uU(t,oD)}Cn.propTypes={};Cn.filterProps=oD;function fU(t=8,e=aD({spacing:t})){if(t.mui)return t;const r=(...n)=>(n.length===0?[1]:n).map(s=>{const o=e(s);return typeof o=="number"?`${o}px`:o}).join(" ");return r.mui=!0,r}function bS(...t){const e=t.reduce((n,i)=>(i.filterProps.forEach(s=>{n[s]=i}),n),{}),r=n=>Object.keys(n).reduce((i,s)=>e[s]?xg(i,e[s](n)):i,{});return r.propTypes={},r.filterProps=t.reduce((n,i)=>n.concat(i.filterProps),[]),r}function $o(t){return typeof t!="number"?t:`${t}px solid`}function la(t,e){return Hn({prop:t,themeKey:"borders",transform:e})}const Bse=la("border",$o),Vse=la("borderTop",$o),jse=la("borderRight",$o),Wse=la("borderBottom",$o),zse=la("borderLeft",$o),Use=la("borderColor"),$se=la("borderTopColor"),Gse=la("borderRightColor"),Yse=la("borderBottomColor"),qse=la("borderLeftColor"),Kse=la("outline",$o),Xse=la("outlineColor"),SS=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Zv(t.theme,"shape.borderRadius",4),r=n=>({borderRadius:Jv(e,n)});return _c(t,t.borderRadius,r)}return null};SS.propTypes={};SS.filterProps=["borderRadius"];bS(Bse,Vse,jse,Wse,zse,Use,$se,Gse,Yse,qse,SS,Kse,Xse);const CS=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Zv(t.theme,"spacing",8),r=n=>({gap:Jv(e,n)});return _c(t,t.gap,r)}return null};CS.propTypes={};CS.filterProps=["gap"];const TS=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Zv(t.theme,"spacing",8),r=n=>({columnGap:Jv(e,n)});return _c(t,t.columnGap,r)}return null};TS.propTypes={};TS.filterProps=["columnGap"];const ES=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Zv(t.theme,"spacing",8),r=n=>({rowGap:Jv(e,n)});return _c(t,t.rowGap,r)}return null};ES.propTypes={};ES.filterProps=["rowGap"];const Qse=Hn({prop:"gridColumn"}),Zse=Hn({prop:"gridRow"}),Jse=Hn({prop:"gridAutoFlow"}),eoe=Hn({prop:"gridAutoColumns"}),toe=Hn({prop:"gridAutoRows"}),roe=Hn({prop:"gridTemplateColumns"}),noe=Hn({prop:"gridTemplateRows"}),ioe=Hn({prop:"gridTemplateAreas"}),soe=Hn({prop:"gridArea"});bS(CS,TS,ES,Qse,Zse,Jse,eoe,toe,roe,noe,ioe,soe);function gp(t,e){return e==="grey"?e:t}const ooe=Hn({prop:"color",themeKey:"palette",transform:gp}),aoe=Hn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:gp}),loe=Hn({prop:"backgroundColor",themeKey:"palette",transform:gp});bS(ooe,aoe,loe);function lo(t){return t<=1&&t!==0?`${t*100}%`:t}const coe=Hn({prop:"width",transform:lo}),lD=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{var i,s,o,a,l;const n=((o=(s=(i=t.theme)==null?void 0:i.breakpoints)==null?void 0:s.values)==null?void 0:o[r])||wS[r];return n?((l=(a=t.theme)==null?void 0:a.breakpoints)==null?void 0:l.unit)!=="px"?{maxWidth:`${n}${t.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:lo(r)}};return _c(t,t.maxWidth,e)}return null};lD.filterProps=["maxWidth"];const uoe=Hn({prop:"minWidth",transform:lo}),foe=Hn({prop:"height",transform:lo}),hoe=Hn({prop:"maxHeight",transform:lo}),doe=Hn({prop:"minHeight",transform:lo});Hn({prop:"size",cssProperty:"width",transform:lo});Hn({prop:"size",cssProperty:"height",transform:lo});const poe=Hn({prop:"boxSizing"});bS(coe,lD,uoe,foe,hoe,doe,poe);const ey={border:{themeKey:"borders",transform:$o},borderTop:{themeKey:"borders",transform:$o},borderRight:{themeKey:"borders",transform:$o},borderBottom:{themeKey:"borders",transform:$o},borderLeft:{themeKey:"borders",transform:$o},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:$o},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:SS},color:{themeKey:"palette",transform:gp},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:gp},backgroundColor:{themeKey:"palette",transform:gp},p:{style:Cn},pt:{style:Cn},pr:{style:Cn},pb:{style:Cn},pl:{style:Cn},px:{style:Cn},py:{style:Cn},padding:{style:Cn},paddingTop:{style:Cn},paddingRight:{style:Cn},paddingBottom:{style:Cn},paddingLeft:{style:Cn},paddingX:{style:Cn},paddingY:{style:Cn},paddingInline:{style:Cn},paddingInlineStart:{style:Cn},paddingInlineEnd:{style:Cn},paddingBlock:{style:Cn},paddingBlockStart:{style:Cn},paddingBlockEnd:{style:Cn},m:{style:Sn},mt:{style:Sn},mr:{style:Sn},mb:{style:Sn},ml:{style:Sn},mx:{style:Sn},my:{style:Sn},margin:{style:Sn},marginTop:{style:Sn},marginRight:{style:Sn},marginBottom:{style:Sn},marginLeft:{style:Sn},marginX:{style:Sn},marginY:{style:Sn},marginInline:{style:Sn},marginInlineStart:{style:Sn},marginInlineEnd:{style:Sn},marginBlock:{style:Sn},marginBlockStart:{style:Sn},marginBlockEnd:{style:Sn},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:CS},rowGap:{style:ES},columnGap:{style:TS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:lo},maxWidth:{style:lD},minWidth:{transform:lo},height:{transform:lo},maxHeight:{transform:lo},minHeight:{transform:lo},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function moe(...t){const e=t.reduce((n,i)=>n.concat(Object.keys(i)),[]),r=new Set(e);return t.every(n=>r.size===Object.keys(n).length)}function goe(t,e){return typeof t=="function"?t(e):t}function voe(){function t(r,n,i,s){const o={[r]:n,theme:i},a=s[r];if(!a)return{[r]:n};const{cssProperty:l=r,themeKey:u,transform:h,style:d}=a;if(n==null)return null;if(u==="typography"&&n==="inherit")return{[r]:n};const m=Ru(i,u)||{};return d?d(o):_c(o,n,y=>{let x=ab(m,h,y);return y===x&&typeof y=="string"&&(x=ab(m,h,`${r}${y==="default"?"":Tt(y)}`,y)),l===!1?x:{[l]:x}})}function e(r){const{sx:n,theme:i={}}=r||{};if(!n)return null;const s=i.unstable_sxConfig??ey;function o(a){let l=a;if(typeof a=="function")l=a(i);else if(typeof a!="object")return a;if(!l)return null;const u=Mse(i.breakpoints),h=Object.keys(u);let d=u;return Object.keys(l).forEach(m=>{const g=goe(l[m],i);if(g!=null)if(typeof g=="object")if(s[m])d=xg(d,t(m,g,i,s));else{const y=_c({theme:i},g,x=>({[m]:x}));moe(y,g)?d[m]=e({sx:g,theme:i}):d=xg(d,y)}else d=xg(d,t(m,g,i,s))}),Ese(i,Dse(h,d))}return Array.isArray(n)?n.map(o):o(n)}return e}const Vu=voe();Vu.filterProps=["sx"];function yoe(t,e){var n;const r=this;if(r.vars){if(!((n=r.colorSchemes)!=null&&n[t])||typeof r.getColorSchemeSelector!="function")return{};let i=r.getColorSchemeSelector(t);return i==="&"?e:((i.includes("data-")||i.includes("."))&&(i=`*:where(${i.replace(/\s*&$/,"")}) &`),{[i]:e})}return r.palette.mode===t?e:{}}function cD(t={},...e){const{breakpoints:r={},palette:n={},spacing:i,shape:s={},...o}=t,a=Tse(r),l=fU(i);let u=po({breakpoints:a,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:l,shape:{...Ose,...s}},o);return u=kse(u),u.applyStyles=yoe,u=e.reduce((h,d)=>po(h,d),u),u.unstable_sxConfig={...ey,...o==null?void 0:o.unstable_sxConfig},u.unstable_sx=function(d){return Vu({sx:d,theme:this})},u}function xoe(t){return Object.keys(t).length===0}function hU(t=null){const e=Y.useContext(Xv);return!e||xoe(e)?t:e}const woe=cD();function uD(t=woe){return hU(t)}function boe({styles:t,themeId:e,defaultTheme:r={}}){const n=uD(r),i=typeof t=="function"?t(e&&n[e]||n):t;return I.jsx(oU,{styles:i})}const Soe=t=>{var n;const e={systemProps:{},otherProps:{}},r=((n=t==null?void 0:t.theme)==null?void 0:n.unstable_sxConfig)??ey;return Object.keys(t).forEach(i=>{r[i]?e.systemProps[i]=t[i]:e.otherProps[i]=t[i]}),e};function dU(t){const{sx:e,...r}=t,{systemProps:n,otherProps:i}=Soe(r);let s;return Array.isArray(e)?s=[n,...e]:typeof e=="function"?s=(...o)=>{const a=e(...o);return yl(a)?{...n,...a}:n}:s={...n,...e},{...i,sx:s}}const zF=t=>t,Coe=()=>{let t=zF;return{configure(e){t=e},generate(e){return t(e)},reset(){t=zF}}},pU=Coe();function mU(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=mU(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function St(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=mU(t))&&(n&&(n+=" "),n+=e);return n}function Toe(t={}){const{themeId:e,defaultTheme:r,defaultClassName:n="MuiBox-root",generateClassName:i}=t,s=aU("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(Vu);return Y.forwardRef(function(l,u){const h=uD(r),{className:d,component:m="div",...g}=dU(l);return I.jsx(s,{as:m,ref:u,className:St(d,i?i(n):n),theme:e&&h[e]||h,...g})})}const Eoe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Hr(t,e,r="Mui"){const n=Eoe[e];return n?`${r}-${n}`:`${pU.generate(t)}-${e}`}function br(t,e,r="Mui"){const n={};return e.forEach(i=>{n[i]=Hr(t,i,r)}),n}function gU(t){const{variants:e,...r}=t,n={variants:e,style:HF(r),isProcessed:!0};return n.style===r||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=HF(i.style))}),n}const Roe=cD();function jE(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Aoe(t){return t?(e,r)=>r[t]:null}function koe(t,e,r){t.theme=Moe(t.theme)?r:t.theme[e]||t.theme}function Mw(t,e){const r=typeof e=="function"?e(t):e;if(Array.isArray(r))return r.flatMap(n=>Mw(t,n));if(Array.isArray(r==null?void 0:r.variants)){let n;if(r.isProcessed)n=r.style;else{const{variants:i,...s}=r;n=s}return vU(t,r.variants,[n])}return r!=null&&r.isProcessed?r.style:r}function vU(t,e,r=[]){var i;let n;e:for(let s=0;s<e.length;s+=1){const o=e[s];if(typeof o.props=="function"){if(n??(n={...t,...t.ownerState,ownerState:t.ownerState}),!o.props(n))continue}else for(const a in o.props)if(t[a]!==o.props[a]&&((i=t.ownerState)==null?void 0:i[a])!==o.props[a])continue e;typeof o.style=="function"?(n??(n={...t,...t.ownerState,ownerState:t.ownerState}),r.push(o.style(n))):r.push(o.style)}return r}function Ooe(t={}){const{themeId:e,defaultTheme:r=Roe,rootShouldForwardProp:n=jE,slotShouldForwardProp:i=jE}=t;function s(a){koe(a,e,r)}return(a,l={})=>{wse(a,O=>O.filter(P=>P!==Vu));const{name:u,slot:h,skipVariantsResolver:d,skipSx:m,overridesResolver:g=Aoe(Poe(h)),...y}=l,x=d!==void 0?d:h&&h!=="Root"&&h!=="root"||!1,b=m||!1;let C=jE;h==="Root"||h==="root"?C=n:h?C=i:Doe(a)&&(C=void 0);const E=aU(a,{shouldForwardProp:C,label:_oe(),...y}),R=O=>{if(O.__emotion_real===O)return O;if(typeof O=="function")return function(D){return Mw(D,O)};if(yl(O)){const P=gU(O);return P.variants?function(H){return Mw(H,P)}:P.style}return O},k=(...O)=>{const P=[],D=O.map(R),H=[];if(P.push(s),u&&g&&H.push(function(j){var q,Z;const oe=(Z=(q=j.theme.components)==null?void 0:q[u])==null?void 0:Z.styleOverrides;if(!oe)return null;const re={};for(const ve in oe)re[ve]=Mw(j,oe[ve]);return g(j,re)}),u&&!x&&H.push(function(j){var re,q;const ee=j.theme,oe=(q=(re=ee==null?void 0:ee.components)==null?void 0:re[u])==null?void 0:q.variants;return oe?vU(j,oe):null}),b||H.push(Vu),Array.isArray(D[0])){const B=D.shift(),j=new Array(P.length).fill(""),ee=new Array(H.length).fill("");let oe;oe=[...j,...B,...ee],oe.raw=[...j,...B.raw,...ee],P.unshift(oe)}const N=[...P,...D,...H],_=E(...N);return a.muiName&&(_.muiName=a.muiName),_};return E.withConfig&&(k.withConfig=E.withConfig),k}}function _oe(t,e){return void 0}function Moe(t){for(const e in t)return!1;return!0}function Doe(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Poe(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function lb(t,e){const r={...e};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=n;if(i==="components"||i==="slots")r[i]={...t[i],...r[i]};else if(i==="componentsProps"||i==="slotProps"){const s=t[i],o=e[i];if(!o)r[i]=s||{};else if(!s)r[i]=o;else{r[i]={...o};for(const a in s)if(Object.prototype.hasOwnProperty.call(s,a)){const l=a;r[i][l]=lb(s[l],o[l])}}}else r[i]===void 0&&(r[i]=t[i])}return r}const gh=typeof window<"u"?Y.useLayoutEffect:Y.useEffect;function Ioe(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function fD(t,e=0,r=1){return Ioe(t,e,r)}function Noe(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(n=>n+n)),r?`rgb${r.length===4?"a":""}(${r.map((n,i)=>i<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function ju(t){if(t.type)return t;if(t.charAt(0)==="#")return ju(Noe(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(mh(9,t));let n=t.substring(e+1,t.length-1),i;if(r==="color"){if(n=n.split(" "),i=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(mh(10,i))}else n=n.split(",");return n=n.map(s=>parseFloat(s)),{type:r,values:n,colorSpace:i}}const Loe=t=>{const e=ju(t);return e.values.slice(0,3).map((r,n)=>e.type.includes("hsl")&&n!==0?`${r}%`:r).join(" ")},ng=(t,e)=>{try{return Loe(t)}catch{return t}};function RS(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return e.includes("rgb")?n=n.map((i,s)=>s<3?parseInt(i,10):i):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${r} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function yU(t){t=ju(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,s=n*Math.min(i,1-i),o=(u,h=(u+r/30)%12)=>i-s*Math.max(Math.min(h-3,9-h,1),-1);let a="rgb";const l=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),RS({type:a,values:l})}function RO(t){t=ju(t);let e=t.type==="hsl"||t.type==="hsla"?ju(yU(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Foe(t,e){const r=RO(t),n=RO(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function Fi(t,e){return t=ju(t),e=fD(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,RS(t)}function Qx(t,e,r){try{return Fi(t,e)}catch{return t}}function hD(t,e){if(t=ju(t),e=fD(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return RS(t)}function Mr(t,e,r){try{return hD(t,e)}catch{return t}}function dD(t,e){if(t=ju(t),e=fD(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return RS(t)}function Dr(t,e,r){try{return dD(t,e)}catch{return t}}function Hoe(t,e=.15){return RO(t)>.5?hD(t,e):dD(t,e)}function Zx(t,e,r){try{return Hoe(t,e)}catch{return t}}const xU=Y.createContext(null);function pD(){return Y.useContext(xU)}const Boe=typeof Symbol=="function"&&Symbol.for,Voe=Boe?Symbol.for("mui.nested"):"__THEME_NESTED__";function joe(t,e){return typeof e=="function"?e(t):{...t,...e}}function Woe(t){const{children:e,theme:r}=t,n=pD(),i=Y.useMemo(()=>{const s=n===null?{...r}:joe(n,r);return s!=null&&(s[Voe]=n!==null),s},[r,n]);return I.jsx(xU.Provider,{value:i,children:e})}const wU=Y.createContext();function zoe({value:t,...e}){return I.jsx(wU.Provider,{value:t??!0,...e})}const AS=()=>Y.useContext(wU)??!1,bU=Y.createContext(void 0);function Uoe({value:t,children:e}){return I.jsx(bU.Provider,{value:t,children:e})}function $oe(t){const{theme:e,name:r,props:n}=t;if(!e||!e.components||!e.components[r])return n;const i=e.components[r];return i.defaultProps?lb(i.defaultProps,n):!i.styleOverrides&&!i.variants?lb(i,n):n}function Goe({props:t,name:e}){const r=Y.useContext(bU);return $oe({props:t,name:e,theme:{components:r}})}const UF={};function $F(t,e,r,n=!1){return Y.useMemo(()=>{const i=t&&e[t]||e;if(typeof r=="function"){const s=r(i),o=t?{...e,[t]:s}:s;return n?()=>o:o}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,n])}function SU(t){const{children:e,theme:r,themeId:n}=t,i=hU(UF),s=pD()||UF,o=$F(n,i,r),a=$F(n,s,r,!0),l=(n?o[n]:o).direction==="rtl";return I.jsx(Woe,{theme:a,children:I.jsx(Xv.Provider,{value:o,children:I.jsx(zoe,{value:l,children:I.jsx(Uoe,{value:n?o[n].components:o.components,children:e})})})})}const GF={theme:void 0};function Yoe(t){let e,r;return function(i){let s=e;return(s===void 0||i.theme!==r)&&(GF.theme=i.theme,s=gU(t(GF)),e=s,r=i.theme),s}}const mD="mode",gD="color-scheme",qoe="data-color-scheme";function Koe(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=mD,colorSchemeStorageKey:s=gD,attribute:o=qoe,colorSchemeNode:a="document.documentElement",nonce:l}=t||{};let u="",h=o;if(o==="class"&&(h=".%s"),o==="data"&&(h="[data-%s]"),h.startsWith(".")){const m=h.substring(1);u+=`${a}.classList.remove('${m}'.replace('%s', light), '${m}'.replace('%s', dark));
      ${a}.classList.add('${m}'.replace('%s', colorScheme));`}const d=h.match(/\[([^\]]+)\]/);if(d){const[m,g]=d[1].split("=");g||(u+=`${a}.removeAttribute('${m}'.replace('%s', light));
      ${a}.removeAttribute('${m}'.replace('%s', dark));`),u+=`
      ${a}.setAttribute('${m}'.replace('%s', colorScheme), ${g?`${g}.replace('%s', colorScheme)`:'""'});`}else u+=`${a}.setAttribute('${h}', colorScheme);`;return I.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${e}';
  const dark = localStorage.getItem('${s}-dark') || '${n}';
  const light = localStorage.getItem('${s}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${u}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function Xoe(){}const Qoe=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let n;try{n=e.localStorage.getItem(t)}catch{}return n||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return Xoe;const n=i=>{const s=i.newValue;i.key===t&&r(s)};return e.addEventListener("storage",n),()=>{e.removeEventListener("storage",n)}}});function WE(){}function YF(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function CU(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function Zoe(t){return CU(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function Joe(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:n,supportedColorSchemes:i=[],modeStorageKey:s=mD,colorSchemeStorageKey:o=gD,storageWindow:a=typeof window>"u"?void 0:window,storageManager:l=Qoe,noSsr:u=!1}=t,h=i.join(","),d=i.length>1,m=Y.useMemo(()=>l==null?void 0:l({key:s,storageWindow:a}),[l,s,a]),g=Y.useMemo(()=>l==null?void 0:l({key:`${o}-light`,storageWindow:a}),[l,o,a]),y=Y.useMemo(()=>l==null?void 0:l({key:`${o}-dark`,storageWindow:a}),[l,o,a]),[x,b]=Y.useState(()=>{const H=(m==null?void 0:m.get(e))||e,N=(g==null?void 0:g.get(r))||r,_=(y==null?void 0:y.get(n))||n;return{mode:H,systemMode:YF(H),lightColorScheme:N,darkColorScheme:_}}),[C,E]=Y.useState(u||!d);Y.useEffect(()=>{E(!0)},[]);const R=Zoe(x),k=Y.useCallback(H=>{b(N=>{if(H===N.mode)return N;const _=H??e;return m==null||m.set(_),{...N,mode:_,systemMode:YF(_)}})},[m,e]),O=Y.useCallback(H=>{H?typeof H=="string"?H&&!h.includes(H)?console.error(`\`${H}\` does not exist in \`theme.colorSchemes\`.`):b(N=>{const _={...N};return CU(N,B=>{B==="light"&&(g==null||g.set(H),_.lightColorScheme=H),B==="dark"&&(y==null||y.set(H),_.darkColorScheme=H)}),_}):b(N=>{const _={...N},B=H.light===null?r:H.light,j=H.dark===null?n:H.dark;return B&&(h.includes(B)?(_.lightColorScheme=B,g==null||g.set(B)):console.error(`\`${B}\` does not exist in \`theme.colorSchemes\`.`)),j&&(h.includes(j)?(_.darkColorScheme=j,y==null||y.set(j)):console.error(`\`${j}\` does not exist in \`theme.colorSchemes\`.`)),_}):b(N=>(g==null||g.set(r),y==null||y.set(n),{...N,lightColorScheme:r,darkColorScheme:n}))},[h,g,y,r,n]),P=Y.useCallback(H=>{x.mode==="system"&&b(N=>{const _=H!=null&&H.matches?"dark":"light";return N.systemMode===_?N:{...N,systemMode:_}})},[x.mode]),D=Y.useRef(P);return D.current=P,Y.useEffect(()=>{if(typeof window.matchMedia!="function"||!d)return;const H=(..._)=>D.current(..._),N=window.matchMedia("(prefers-color-scheme: dark)");return N.addListener(H),H(N),()=>{N.removeListener(H)}},[d]),Y.useEffect(()=>{if(d){const H=(m==null?void 0:m.subscribe(B=>{(!B||["light","dark","system"].includes(B))&&k(B||e)}))||WE,N=(g==null?void 0:g.subscribe(B=>{(!B||h.match(B))&&O({light:B})}))||WE,_=(y==null?void 0:y.subscribe(B=>{(!B||h.match(B))&&O({dark:B})}))||WE;return()=>{H(),N(),_()}}},[O,k,h,e,a,d,m,g,y]),{...x,mode:C?x.mode:void 0,systemMode:C?x.systemMode:void 0,colorScheme:C?R:void 0,setMode:k,setColorScheme:O}}const eae="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function tae(t){const{themeId:e,theme:r={},modeStorageKey:n=mD,colorSchemeStorageKey:i=gD,disableTransitionOnChange:s=!1,defaultColorScheme:o,resolveTheme:a}=t,l={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},u=Y.createContext(void 0),h=()=>Y.useContext(u)||l,d={},m={};function g(C){var Dt,Et,Ct,Rt;const{children:E,theme:R,modeStorageKey:k=n,colorSchemeStorageKey:O=i,disableTransitionOnChange:P=s,storageManager:D,storageWindow:H=typeof window>"u"?void 0:window,documentNode:N=typeof document>"u"?void 0:document,colorSchemeNode:_=typeof document>"u"?void 0:document.documentElement,disableNestedContext:B=!1,disableStyleSheetGeneration:j=!1,defaultMode:ee="system",forceThemeRerender:oe=!1,noSsr:re}=C,q=Y.useRef(!1),Z=pD(),ve=Y.useContext(u),ie=!!ve&&!B,K=Y.useMemo(()=>R||(typeof r=="function"?r():r),[R]),ce=K[e],S=ce||K,{colorSchemes:A=d,components:M=m,cssVarPrefix:L}=S,V=Object.keys(A).filter(Xe=>!!A[Xe]).join(","),J=Y.useMemo(()=>V.split(","),[V]),ae=typeof o=="string"?o:o.light,ue=typeof o=="string"?o:o.dark,pe=A[ae]&&A[ue]?ee:((Et=(Dt=A[S.defaultColorScheme])==null?void 0:Dt.palette)==null?void 0:Et.mode)||((Ct=S.palette)==null?void 0:Ct.mode),{mode:ke,setMode:z,systemMode:Be,lightColorScheme:Fe,darkColorScheme:ze,colorScheme:Ge,setColorScheme:Ee}=Joe({supportedColorSchemes:J,defaultLightColorScheme:ae,defaultDarkColorScheme:ue,modeStorageKey:k,colorSchemeStorageKey:O,defaultMode:pe,storageManager:D,storageWindow:H,noSsr:re});let Ue=ke,st=Ge;ie&&(Ue=ve.mode,st=ve.colorScheme);let tt=st||S.defaultColorScheme;S.vars&&!oe&&(tt=S.defaultColorScheme);const at=Y.useMemo(()=>{var Lt;const Xe=((Lt=S.generateThemeVars)==null?void 0:Lt.call(S))||S.vars,Je={...S,components:M,colorSchemes:A,cssVarPrefix:L,vars:Xe};if(typeof Je.generateSpacing=="function"&&(Je.spacing=Je.generateSpacing()),tt){const nt=A[tt];nt&&typeof nt=="object"&&Object.keys(nt).forEach(ct=>{nt[ct]&&typeof nt[ct]=="object"?Je[ct]={...Je[ct],...nt[ct]}:Je[ct]=nt[ct]})}return a?a(Je):Je},[S,tt,M,A,L]),je=S.colorSchemeSelector;gh(()=>{if(st&&_&&je&&je!=="media"){const Xe=je;let Je=je;if(Xe==="class"&&(Je=".%s"),Xe==="data"&&(Je="[data-%s]"),Xe!=null&&Xe.startsWith("data-")&&!Xe.includes("%s")&&(Je=`[${Xe}="%s"]`),Je.startsWith("."))_.classList.remove(...J.map(Lt=>Je.substring(1).replace("%s",Lt))),_.classList.add(Je.substring(1).replace("%s",st));else{const Lt=Je.replace("%s",st).match(/\[([^\]]+)\]/);if(Lt){const[nt,ct]=Lt[1].split("=");ct||J.forEach(ar=>{_.removeAttribute(nt.replace(st,ar))}),_.setAttribute(nt,ct?ct.replace(/"|'/g,""):"")}else _.setAttribute(Je,st)}}},[st,je,_,J]),Y.useEffect(()=>{let Xe;if(P&&q.current&&N){const Je=N.createElement("style");Je.appendChild(N.createTextNode(eae)),N.head.appendChild(Je),window.getComputedStyle(N.body),Xe=setTimeout(()=>{N.head.removeChild(Je)},1)}return()=>{clearTimeout(Xe)}},[st,P,N]),Y.useEffect(()=>(q.current=!0,()=>{q.current=!1}),[]);const er=Y.useMemo(()=>({allColorSchemes:J,colorScheme:st,darkColorScheme:ze,lightColorScheme:Fe,mode:Ue,setColorScheme:Ee,setMode:z,systemMode:Be}),[J,st,ze,Fe,Ue,Ee,z,Be,at.colorSchemeSelector]);let Nt=!0;(j||S.cssVariables===!1||ie&&(Z==null?void 0:Z.cssVarPrefix)===L)&&(Nt=!1);const jt=I.jsxs(Y.Fragment,{children:[I.jsx(SU,{themeId:ce?e:void 0,theme:at,children:E}),Nt&&I.jsx(oU,{styles:((Rt=at.generateStyleSheets)==null?void 0:Rt.call(at))||[]})]});return ie?jt:I.jsx(u.Provider,{value:er,children:jt})}const y=typeof o=="string"?o:o.light,x=typeof o=="string"?o:o.dark;return{CssVarsProvider:g,useColorScheme:h,getInitColorSchemeScript:C=>Koe({colorSchemeStorageKey:i,defaultLightColorScheme:y,defaultDarkColorScheme:x,modeStorageKey:n,...C})}}function rae(t=""){function e(...n){if(!n.length)return"";const i=n[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...n.slice(1))})`:`, ${i}`}return(n,...i)=>`var(--${t?`${t}-`:""}${n}${e(...i)})`}const qF=(t,e,r,n=[])=>{let i=t;e.forEach((s,o)=>{o===e.length-1?Array.isArray(i)?i[Number(s)]=r:i&&typeof i=="object"&&(i[s]=r):i&&typeof i=="object"&&(i[s]||(i[s]=n.includes(s)?[]:{}),i=i[s])})},nae=(t,e,r)=>{function n(i,s=[],o=[]){Object.entries(i).forEach(([a,l])=>{(!r||r&&!r([...s,a]))&&l!=null&&(typeof l=="object"&&Object.keys(l).length>0?n(l,[...s,a],Array.isArray(l)?[...o,a]:o):e([...s,a],l,o))})}n(t)},iae=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>t.includes(n))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function zE(t,e){const{prefix:r,shouldSkipGeneratingVar:n}=e||{},i={},s={},o={};return nae(t,(a,l,u)=>{if((typeof l=="string"||typeof l=="number")&&(!n||!n(a,l))){const h=`--${r?`${r}-`:""}${a.join("-")}`,d=iae(a,l);Object.assign(i,{[h]:d}),qF(s,a,`var(${h})`,u),qF(o,a,`var(${h}, ${d})`,u)}},a=>a[0]==="vars"),{css:i,vars:s,varsWithDefaults:o}}function sae(t,e={}){const{getSelector:r=b,disableCssColorScheme:n,colorSchemeSelector:i}=e,{colorSchemes:s={},components:o,defaultColorScheme:a="light",...l}=t,{vars:u,css:h,varsWithDefaults:d}=zE(l,e);let m=d;const g={},{[a]:y,...x}=s;if(Object.entries(x||{}).forEach(([R,k])=>{const{vars:O,css:P,varsWithDefaults:D}=zE(k,e);m=po(m,D),g[R]={css:P,vars:O}}),y){const{css:R,vars:k,varsWithDefaults:O}=zE(y,e);m=po(m,O),g[a]={css:R,vars:k}}function b(R,k){var P,D;let O=i;if(i==="class"&&(O=".%s"),i==="data"&&(O="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(O=`[${i}="%s"]`),R){if(O==="media")return t.defaultColorScheme===R?":root":{[`@media (prefers-color-scheme: ${((D=(P=s[R])==null?void 0:P.palette)==null?void 0:D.mode)||R})`]:{":root":k}};if(O)return t.defaultColorScheme===R?`:root, ${O.replace("%s",String(R))}`:O.replace("%s",String(R))}return":root"}return{vars:m,generateThemeVars:()=>{let R={...u};return Object.entries(g).forEach(([,{vars:k}])=>{R=po(R,k)}),R},generateStyleSheets:()=>{var H,N;const R=[],k=t.defaultColorScheme||"light";function O(_,B){Object.keys(B).length&&R.push(typeof _=="string"?{[_]:{...B}}:_)}O(r(void 0,{...h}),h);const{[k]:P,...D}=g;if(P){const{css:_}=P,B=(N=(H=s[k])==null?void 0:H.palette)==null?void 0:N.mode,j=!n&&B?{colorScheme:B,..._}:{..._};O(r(k,{...j}),j)}return Object.entries(D).forEach(([_,{css:B}])=>{var oe,re;const j=(re=(oe=s[_])==null?void 0:oe.palette)==null?void 0:re.mode,ee=!n&&j?{colorScheme:j,...B}:{...B};O(r(_,{...ee}),ee)}),R}}}function oae(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function Gr(t,e,r=void 0){const n={};for(const i in t){const s=t[i];let o="",a=!0;for(let l=0;l<s.length;l+=1){const u=s[l];u&&(o+=(a===!0?"":" ")+e(u),a=!1,r&&r[u]&&(o+=" "+r[u]))}n[i]=o}return n}function aae(t,e){var r,n,i;return Y.isValidElement(t)&&e.indexOf(t.type.muiName??((i=(n=(r=t.type)==null?void 0:r._payload)==null?void 0:n.value)==null?void 0:i.muiName))!==-1}const ev={black:"#000",white:"#fff"},lae={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},_d={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Md={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},wm={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Dd={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Pd={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Id={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function TU(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:ev.white,default:ev.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const cae=TU();function EU(){return{text:{primary:ev.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:ev.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const KF=EU();function XF(t,e,r,n){const i=n.light||n,s=n.dark||n*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=dD(t.main,i):e==="dark"&&(t.dark=hD(t.main,s)))}function uae(t="light"){return t==="dark"?{main:Dd[200],light:Dd[50],dark:Dd[400]}:{main:Dd[700],light:Dd[400],dark:Dd[800]}}function fae(t="light"){return t==="dark"?{main:_d[200],light:_d[50],dark:_d[400]}:{main:_d[500],light:_d[300],dark:_d[700]}}function hae(t="light"){return t==="dark"?{main:Md[500],light:Md[300],dark:Md[700]}:{main:Md[700],light:Md[400],dark:Md[800]}}function dae(t="light"){return t==="dark"?{main:Pd[400],light:Pd[300],dark:Pd[700]}:{main:Pd[700],light:Pd[500],dark:Pd[900]}}function pae(t="light"){return t==="dark"?{main:Id[400],light:Id[300],dark:Id[700]}:{main:Id[800],light:Id[500],dark:Id[900]}}function mae(t="light"){return t==="dark"?{main:wm[400],light:wm[300],dark:wm[700]}:{main:"#ed6c02",light:wm[500],dark:wm[900]}}function vD(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:n=.2,...i}=t,s=t.primary||uae(e),o=t.secondary||fae(e),a=t.error||hae(e),l=t.info||dae(e),u=t.success||pae(e),h=t.warning||mae(e);function d(x){return Foe(x,KF.text.primary)>=r?KF.text.primary:cae.text.primary}const m=({color:x,name:b,mainShade:C=500,lightShade:E=300,darkShade:R=700})=>{if(x={...x},!x.main&&x[C]&&(x.main=x[C]),!x.hasOwnProperty("main"))throw new Error(mh(11,b?` (${b})`:"",C));if(typeof x.main!="string")throw new Error(mh(12,b?` (${b})`:"",JSON.stringify(x.main)));return XF(x,"light",E,n),XF(x,"dark",R,n),x.contrastText||(x.contrastText=d(x.main)),x};let g;return e==="light"?g=TU():e==="dark"&&(g=EU()),po({common:{...ev},mode:e,primary:m({color:s,name:"primary"}),secondary:m({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:m({color:a,name:"error"}),warning:m({color:h,name:"warning"}),info:m({color:l,name:"info"}),success:m({color:u,name:"success"}),grey:lae,contrastThreshold:r,getContrastText:d,augmentColor:m,tonalOffset:n,...g},i)}function gae(t){const e={};return Object.entries(t).forEach(n=>{const[i,s]=n;typeof s=="object"&&(e[i]=`${s.fontStyle?`${s.fontStyle} `:""}${s.fontVariant?`${s.fontVariant} `:""}${s.fontWeight?`${s.fontWeight} `:""}${s.fontStretch?`${s.fontStretch} `:""}${s.fontSize||""}${s.lineHeight?`/${s.lineHeight} `:""}${s.fontFamily||""}`)}),e}function vae(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function yae(t){return Math.round(t*1e5)/1e5}const QF={textTransform:"uppercase"},ZF='"Roboto", "Helvetica", "Arial", sans-serif';function RU(t,e){const{fontFamily:r=ZF,fontSize:n=14,fontWeightLight:i=300,fontWeightRegular:s=400,fontWeightMedium:o=500,fontWeightBold:a=700,htmlFontSize:l=16,allVariants:u,pxToRem:h,...d}=typeof e=="function"?e(t):e,m=n/14,g=h||(b=>`${b/l*m}rem`),y=(b,C,E,R,k)=>({fontFamily:r,fontWeight:b,fontSize:g(C),lineHeight:E,...r===ZF?{letterSpacing:`${yae(R/C)}em`}:{},...k,...u}),x={h1:y(i,96,1.167,-1.5),h2:y(i,60,1.2,-.5),h3:y(s,48,1.167,0),h4:y(s,34,1.235,.25),h5:y(s,24,1.334,0),h6:y(o,20,1.6,.15),subtitle1:y(s,16,1.75,.15),subtitle2:y(o,14,1.57,.1),body1:y(s,16,1.5,.15),body2:y(s,14,1.43,.15),button:y(o,14,1.75,.4,QF),caption:y(s,12,1.66,.4),overline:y(s,12,2.66,1,QF),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return po({htmlFontSize:l,pxToRem:g,fontFamily:r,fontSize:n,fontWeightLight:i,fontWeightRegular:s,fontWeightMedium:o,fontWeightBold:a,...x},d,{clone:!1})}const xae=.2,wae=.14,bae=.12;function on(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${xae})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${wae})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${bae})`].join(",")}const Sae=["none",on(0,2,1,-1,0,1,1,0,0,1,3,0),on(0,3,1,-2,0,2,2,0,0,1,5,0),on(0,3,3,-2,0,3,4,0,0,1,8,0),on(0,2,4,-1,0,4,5,0,0,1,10,0),on(0,3,5,-1,0,5,8,0,0,1,14,0),on(0,3,5,-1,0,6,10,0,0,1,18,0),on(0,4,5,-2,0,7,10,1,0,2,16,1),on(0,5,5,-3,0,8,10,1,0,3,14,2),on(0,5,6,-3,0,9,12,1,0,3,16,2),on(0,6,6,-3,0,10,14,1,0,4,18,3),on(0,6,7,-4,0,11,15,1,0,4,20,3),on(0,7,8,-4,0,12,17,2,0,5,22,4),on(0,7,8,-4,0,13,19,2,0,5,24,4),on(0,7,9,-4,0,14,21,2,0,5,26,4),on(0,8,9,-5,0,15,22,2,0,6,28,5),on(0,8,10,-5,0,16,24,2,0,6,30,5),on(0,8,11,-5,0,17,26,2,0,6,32,5),on(0,9,11,-5,0,18,28,2,0,7,34,6),on(0,9,12,-6,0,19,29,2,0,7,36,6),on(0,10,13,-6,0,20,31,3,0,8,38,7),on(0,10,13,-6,0,21,33,3,0,8,40,7),on(0,10,14,-6,0,22,35,3,0,8,42,7),on(0,11,14,-7,0,23,36,3,0,9,44,8),on(0,11,15,-7,0,24,38,3,0,9,46,8)],Cae={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},AU={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function JF(t){return`${Math.round(t)}ms`}function Tae(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Eae(t){const e={...Cae,...t.easing},r={...AU,...t.duration};return{getAutoHeightDuration:Tae,create:(i=["all"],s={})=>{const{duration:o=r.standard,easing:a=e.easeInOut,delay:l=0,...u}=s;return(Array.isArray(i)?i:[i]).map(h=>`${h} ${typeof o=="string"?o:JF(o)} ${a} ${typeof l=="string"?l:JF(l)}`).join(",")},...t,easing:e,duration:r}}const Rae={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Aae(t){return yl(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function kU(t={}){const e={...t};function r(n){const i=Object.entries(n);for(let s=0;s<i.length;s++){const[o,a]=i[s];!Aae(a)||o.startsWith("unstable_")?delete n[o]:yl(a)&&(n[o]={...a},r(n[o]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function AO(t={},...e){const{breakpoints:r,mixins:n={},spacing:i,palette:s={},transitions:o={},typography:a={},shape:l,...u}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(mh(20));const h=vD(s),d=cD(t);let m=po(d,{mixins:vae(d.breakpoints,n),palette:h,shadows:Sae.slice(),typography:RU(h,a),transitions:Eae(o),zIndex:{...Rae}});return m=po(m,u),m=e.reduce((g,y)=>po(g,y),m),m.unstable_sxConfig={...ey,...u==null?void 0:u.unstable_sxConfig},m.unstable_sx=function(y){return Vu({sx:y,theme:this})},m.toRuntimeSource=kU,m}function kO(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const kae=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=kO(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function OU(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function _U(t){return t==="dark"?kae:[]}function Oae(t){const{palette:e={mode:"light"},opacity:r,overlays:n,...i}=t,s=vD(e);return{palette:s,opacity:{...OU(s.mode),...r},overlays:n||_U(s.mode),...i}}function _ae(t){var e;return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((e=t[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const Mae=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],Dae=t=>(e,r)=>{const n=t.rootSelector||":root",i=t.colorSchemeSelector;let s=i;if(i==="class"&&(s=".%s"),i==="data"&&(s="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(s=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const o={};return Mae(t.cssVarPrefix).forEach(a=>{o[a]=r[a],delete r[a]}),s==="media"?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:o}}:s?{[s.replace("%s",e)]:o,[`${n}, ${s.replace("%s",e)}`]:r}:{[n]:{...r,...o}}}if(s&&s!=="media")return`${n}, ${s.replace("%s",String(e))}`}else if(e){if(s==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:r}};if(s)return s.replace("%s",String(e))}return n};function Pae(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Ae(t,e,r){!t[e]&&r&&(t[e]=r)}function ig(t){return typeof t!="string"||!t.startsWith("hsl")?t:yU(t)}function ac(t,e){`${e}Channel`in t||(t[`${e}Channel`]=ng(ig(t[e])))}function Iae(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const rl=t=>{try{return t()}catch{}},Nae=(t="mui")=>rae(t);function UE(t,e,r,n){if(!e)return;e=e===!0?{}:e;const i=n==="dark"?"dark":"light";if(!r){t[n]=Oae({...e,palette:{mode:i,...e==null?void 0:e.palette}});return}const{palette:s,...o}=AO({...r,palette:{mode:i,...e==null?void 0:e.palette}});return t[n]={...e,palette:s,opacity:{...OU(i),...e==null?void 0:e.opacity},overlays:(e==null?void 0:e.overlays)||_U(i)},o}function Lae(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:i=!1,cssVarPrefix:s="mui",shouldSkipGeneratingVar:o=_ae,colorSchemeSelector:a=r.light&&r.dark?"media":void 0,rootSelector:l=":root",...u}=t,h=Object.keys(r)[0],d=n||(r.light&&h!=="light"?"light":h),m=Nae(s),{[d]:g,light:y,dark:x,...b}=r,C={...b};let E=g;if((d==="dark"&&!("dark"in r)||d==="light"&&!("light"in r))&&(E=!0),!E)throw new Error(mh(21,d));const R=UE(C,E,u,d);y&&!C.light&&UE(C,y,void 0,"light"),x&&!C.dark&&UE(C,x,void 0,"dark");let k={defaultColorScheme:d,...R,cssVarPrefix:s,colorSchemeSelector:a,rootSelector:l,getCssVar:m,colorSchemes:C,font:{...gae(R.typography),...R.font},spacing:Iae(u.spacing)};Object.keys(k.colorSchemes).forEach(N=>{const _=k.colorSchemes[N].palette,B=j=>{const ee=j.split("-"),oe=ee[1],re=ee[2];return m(j,_[oe][re])};if(_.mode==="light"&&(Ae(_.common,"background","#fff"),Ae(_.common,"onBackground","#000")),_.mode==="dark"&&(Ae(_.common,"background","#000"),Ae(_.common,"onBackground","#fff")),Pae(_,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),_.mode==="light"){Ae(_.Alert,"errorColor",Mr(_.error.light,.6)),Ae(_.Alert,"infoColor",Mr(_.info.light,.6)),Ae(_.Alert,"successColor",Mr(_.success.light,.6)),Ae(_.Alert,"warningColor",Mr(_.warning.light,.6)),Ae(_.Alert,"errorFilledBg",B("palette-error-main")),Ae(_.Alert,"infoFilledBg",B("palette-info-main")),Ae(_.Alert,"successFilledBg",B("palette-success-main")),Ae(_.Alert,"warningFilledBg",B("palette-warning-main")),Ae(_.Alert,"errorFilledColor",rl(()=>_.getContrastText(_.error.main))),Ae(_.Alert,"infoFilledColor",rl(()=>_.getContrastText(_.info.main))),Ae(_.Alert,"successFilledColor",rl(()=>_.getContrastText(_.success.main))),Ae(_.Alert,"warningFilledColor",rl(()=>_.getContrastText(_.warning.main))),Ae(_.Alert,"errorStandardBg",Dr(_.error.light,.9)),Ae(_.Alert,"infoStandardBg",Dr(_.info.light,.9)),Ae(_.Alert,"successStandardBg",Dr(_.success.light,.9)),Ae(_.Alert,"warningStandardBg",Dr(_.warning.light,.9)),Ae(_.Alert,"errorIconColor",B("palette-error-main")),Ae(_.Alert,"infoIconColor",B("palette-info-main")),Ae(_.Alert,"successIconColor",B("palette-success-main")),Ae(_.Alert,"warningIconColor",B("palette-warning-main")),Ae(_.AppBar,"defaultBg",B("palette-grey-100")),Ae(_.Avatar,"defaultBg",B("palette-grey-400")),Ae(_.Button,"inheritContainedBg",B("palette-grey-300")),Ae(_.Button,"inheritContainedHoverBg",B("palette-grey-A100")),Ae(_.Chip,"defaultBorder",B("palette-grey-400")),Ae(_.Chip,"defaultAvatarColor",B("palette-grey-700")),Ae(_.Chip,"defaultIconColor",B("palette-grey-700")),Ae(_.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ae(_.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ae(_.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ae(_.LinearProgress,"primaryBg",Dr(_.primary.main,.62)),Ae(_.LinearProgress,"secondaryBg",Dr(_.secondary.main,.62)),Ae(_.LinearProgress,"errorBg",Dr(_.error.main,.62)),Ae(_.LinearProgress,"infoBg",Dr(_.info.main,.62)),Ae(_.LinearProgress,"successBg",Dr(_.success.main,.62)),Ae(_.LinearProgress,"warningBg",Dr(_.warning.main,.62)),Ae(_.Skeleton,"bg",`rgba(${B("palette-text-primaryChannel")} / 0.11)`),Ae(_.Slider,"primaryTrack",Dr(_.primary.main,.62)),Ae(_.Slider,"secondaryTrack",Dr(_.secondary.main,.62)),Ae(_.Slider,"errorTrack",Dr(_.error.main,.62)),Ae(_.Slider,"infoTrack",Dr(_.info.main,.62)),Ae(_.Slider,"successTrack",Dr(_.success.main,.62)),Ae(_.Slider,"warningTrack",Dr(_.warning.main,.62));const j=Zx(_.background.default,.8);Ae(_.SnackbarContent,"bg",j),Ae(_.SnackbarContent,"color",rl(()=>_.getContrastText(j))),Ae(_.SpeedDialAction,"fabHoverBg",Zx(_.background.paper,.15)),Ae(_.StepConnector,"border",B("palette-grey-400")),Ae(_.StepContent,"border",B("palette-grey-400")),Ae(_.Switch,"defaultColor",B("palette-common-white")),Ae(_.Switch,"defaultDisabledColor",B("palette-grey-100")),Ae(_.Switch,"primaryDisabledColor",Dr(_.primary.main,.62)),Ae(_.Switch,"secondaryDisabledColor",Dr(_.secondary.main,.62)),Ae(_.Switch,"errorDisabledColor",Dr(_.error.main,.62)),Ae(_.Switch,"infoDisabledColor",Dr(_.info.main,.62)),Ae(_.Switch,"successDisabledColor",Dr(_.success.main,.62)),Ae(_.Switch,"warningDisabledColor",Dr(_.warning.main,.62)),Ae(_.TableCell,"border",Dr(Qx(_.divider,1),.88)),Ae(_.Tooltip,"bg",Qx(_.grey[700],.92))}if(_.mode==="dark"){Ae(_.Alert,"errorColor",Dr(_.error.light,.6)),Ae(_.Alert,"infoColor",Dr(_.info.light,.6)),Ae(_.Alert,"successColor",Dr(_.success.light,.6)),Ae(_.Alert,"warningColor",Dr(_.warning.light,.6)),Ae(_.Alert,"errorFilledBg",B("palette-error-dark")),Ae(_.Alert,"infoFilledBg",B("palette-info-dark")),Ae(_.Alert,"successFilledBg",B("palette-success-dark")),Ae(_.Alert,"warningFilledBg",B("palette-warning-dark")),Ae(_.Alert,"errorFilledColor",rl(()=>_.getContrastText(_.error.dark))),Ae(_.Alert,"infoFilledColor",rl(()=>_.getContrastText(_.info.dark))),Ae(_.Alert,"successFilledColor",rl(()=>_.getContrastText(_.success.dark))),Ae(_.Alert,"warningFilledColor",rl(()=>_.getContrastText(_.warning.dark))),Ae(_.Alert,"errorStandardBg",Mr(_.error.light,.9)),Ae(_.Alert,"infoStandardBg",Mr(_.info.light,.9)),Ae(_.Alert,"successStandardBg",Mr(_.success.light,.9)),Ae(_.Alert,"warningStandardBg",Mr(_.warning.light,.9)),Ae(_.Alert,"errorIconColor",B("palette-error-main")),Ae(_.Alert,"infoIconColor",B("palette-info-main")),Ae(_.Alert,"successIconColor",B("palette-success-main")),Ae(_.Alert,"warningIconColor",B("palette-warning-main")),Ae(_.AppBar,"defaultBg",B("palette-grey-900")),Ae(_.AppBar,"darkBg",B("palette-background-paper")),Ae(_.AppBar,"darkColor",B("palette-text-primary")),Ae(_.Avatar,"defaultBg",B("palette-grey-600")),Ae(_.Button,"inheritContainedBg",B("palette-grey-800")),Ae(_.Button,"inheritContainedHoverBg",B("palette-grey-700")),Ae(_.Chip,"defaultBorder",B("palette-grey-700")),Ae(_.Chip,"defaultAvatarColor",B("palette-grey-300")),Ae(_.Chip,"defaultIconColor",B("palette-grey-300")),Ae(_.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ae(_.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ae(_.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ae(_.LinearProgress,"primaryBg",Mr(_.primary.main,.5)),Ae(_.LinearProgress,"secondaryBg",Mr(_.secondary.main,.5)),Ae(_.LinearProgress,"errorBg",Mr(_.error.main,.5)),Ae(_.LinearProgress,"infoBg",Mr(_.info.main,.5)),Ae(_.LinearProgress,"successBg",Mr(_.success.main,.5)),Ae(_.LinearProgress,"warningBg",Mr(_.warning.main,.5)),Ae(_.Skeleton,"bg",`rgba(${B("palette-text-primaryChannel")} / 0.13)`),Ae(_.Slider,"primaryTrack",Mr(_.primary.main,.5)),Ae(_.Slider,"secondaryTrack",Mr(_.secondary.main,.5)),Ae(_.Slider,"errorTrack",Mr(_.error.main,.5)),Ae(_.Slider,"infoTrack",Mr(_.info.main,.5)),Ae(_.Slider,"successTrack",Mr(_.success.main,.5)),Ae(_.Slider,"warningTrack",Mr(_.warning.main,.5));const j=Zx(_.background.default,.98);Ae(_.SnackbarContent,"bg",j),Ae(_.SnackbarContent,"color",rl(()=>_.getContrastText(j))),Ae(_.SpeedDialAction,"fabHoverBg",Zx(_.background.paper,.15)),Ae(_.StepConnector,"border",B("palette-grey-600")),Ae(_.StepContent,"border",B("palette-grey-600")),Ae(_.Switch,"defaultColor",B("palette-grey-300")),Ae(_.Switch,"defaultDisabledColor",B("palette-grey-600")),Ae(_.Switch,"primaryDisabledColor",Mr(_.primary.main,.55)),Ae(_.Switch,"secondaryDisabledColor",Mr(_.secondary.main,.55)),Ae(_.Switch,"errorDisabledColor",Mr(_.error.main,.55)),Ae(_.Switch,"infoDisabledColor",Mr(_.info.main,.55)),Ae(_.Switch,"successDisabledColor",Mr(_.success.main,.55)),Ae(_.Switch,"warningDisabledColor",Mr(_.warning.main,.55)),Ae(_.TableCell,"border",Mr(Qx(_.divider,1),.68)),Ae(_.Tooltip,"bg",Qx(_.grey[700],.92))}ac(_.background,"default"),ac(_.background,"paper"),ac(_.common,"background"),ac(_.common,"onBackground"),ac(_,"divider"),Object.keys(_).forEach(j=>{const ee=_[j];j!=="tonalOffset"&&ee&&typeof ee=="object"&&(ee.main&&Ae(_[j],"mainChannel",ng(ig(ee.main))),ee.light&&Ae(_[j],"lightChannel",ng(ig(ee.light))),ee.dark&&Ae(_[j],"darkChannel",ng(ig(ee.dark))),ee.contrastText&&Ae(_[j],"contrastTextChannel",ng(ig(ee.contrastText))),j==="text"&&(ac(_[j],"primary"),ac(_[j],"secondary")),j==="action"&&(ee.active&&ac(_[j],"active"),ee.selected&&ac(_[j],"selected")))})}),k=e.reduce((N,_)=>po(N,_),k);const O={prefix:s,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:Dae(k)},{vars:P,generateThemeVars:D,generateStyleSheets:H}=sae(k,O);return k.vars=P,Object.entries(k.colorSchemes[k.defaultColorScheme]).forEach(([N,_])=>{k[N]=_}),k.generateThemeVars=D,k.generateStyleSheets=H,k.generateSpacing=function(){return fU(u.spacing,aD(this))},k.getColorSchemeSelector=oae(a),k.spacing=k.generateSpacing(),k.shouldSkipGeneratingVar=o,k.unstable_sxConfig={...ey,...u==null?void 0:u.unstable_sxConfig},k.unstable_sx=function(_){return Vu({sx:_,theme:this})},k.toRuntimeSource=kU,k}function eH(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:vD({...r===!0?{}:r.palette,mode:e})})}function kS(t={},...e){const{palette:r,cssVariables:n=!1,colorSchemes:i=r?void 0:{light:!0},defaultColorScheme:s=r==null?void 0:r.mode,...o}=t,a=s||"light",l=i==null?void 0:i[a],u={...i,...r?{[a]:{...typeof l!="boolean"&&l,palette:r}}:void 0};if(n===!1){if(!("colorSchemes"in t))return AO(t,...e);let h=r;"palette"in t||u[a]&&(u[a]!==!0?h=u[a].palette:a==="dark"&&(h={mode:"dark"}));const d=AO({...t,palette:h},...e);return d.defaultColorScheme=a,d.colorSchemes=u,d.palette.mode==="light"&&(d.colorSchemes.light={...u.light!==!0&&u.light,palette:d.palette},eH(d,"dark",u.dark)),d.palette.mode==="dark"&&(d.colorSchemes.dark={...u.dark!==!0&&u.dark,palette:d.palette},eH(d,"light",u.light)),d}return!r&&!("light"in u)&&a==="light"&&(u.light=!0),Lae({...o,colorSchemes:u,defaultColorScheme:a,...typeof n!="boolean"&&n},...e)}const yD=kS();function $a(){const t=uD(yD);return t[Rl]||t}function Fae(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const xD=t=>Fae(t)&&t!=="classes",gt=Ooe({themeId:Rl,defaultTheme:yD,rootShouldForwardProp:xD});function Hae({theme:t,...e}){const r=Rl in t?t[Rl]:void 0;return I.jsx(SU,{...e,themeId:r?Rl:void 0,theme:r||t})}const Jx={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:Bae}=tae({themeId:Rl,theme:()=>kS({cssVariables:!0}),colorSchemeStorageKey:Jx.colorSchemeStorageKey,modeStorageKey:Jx.modeStorageKey,defaultColorScheme:{light:Jx.defaultLightColorScheme,dark:Jx.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:RU(t.palette,t.typography)};return e.unstable_sx=function(n){return Vu({sx:n,theme:this})},e}}),Vae=Bae;function jae({theme:t,...e}){const r=Y.useMemo(()=>{if(typeof t=="function")return t;const n=Rl in t?t[Rl]:t;return"colorSchemes"in n?null:"vars"in n?t:{...t,vars:null}},[t]);return r?I.jsx(Hae,{theme:r,...e}):I.jsx(Vae,{theme:t,...e})}function Wae(t){return I.jsx(boe,{...t,defaultTheme:yD,themeId:Rl})}function MU(t){return function(r){return I.jsx(Wae,{styles:typeof t=="function"?n=>t({theme:n,...r}):t})}}function zae(){return dU}function Ar(t){return Goe(t)}const OO=typeof MU({})=="function",Uae=(t,e)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...e&&!t.vars&&{colorScheme:t.palette.mode}}),$ae=t=>({color:(t.vars||t).palette.text.primary,...t.typography.body1,backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),DU=(t,e=!1)=>{var s,o;const r={};e&&t.colorSchemes&&typeof t.getColorSchemeSelector=="function"&&Object.entries(t.colorSchemes).forEach(([a,l])=>{var h,d;const u=t.getColorSchemeSelector(a);u.startsWith("@")?r[u]={":root":{colorScheme:(h=l.palette)==null?void 0:h.mode}}:r[u.replace(/\s*&/,"")]={colorScheme:(d=l.palette)==null?void 0:d.mode}});let n={html:Uae(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:{margin:0,...$ae(t),"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}},...r};const i=(o=(s=t.components)==null?void 0:s.MuiCssBaseline)==null?void 0:o.styleOverrides;return i&&(n=[n,i]),n},Dw="mui-ecs",Gae=t=>{const e=DU(t,!1),r=Array.isArray(e)?e[0]:e;return!t.vars&&r&&(r.html[`:root:has(${Dw})`]={colorScheme:t.palette.mode}),t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([n,i])=>{var o,a;const s=t.getColorSchemeSelector(n);s.startsWith("@")?r[s]={[`:root:not(:has(.${Dw}))`]:{colorScheme:(o=i.palette)==null?void 0:o.mode}}:r[s.replace(/\s*&/,"")]={[`&:not(:has(.${Dw}))`]:{colorScheme:(a=i.palette)==null?void 0:a.mode}}}),e},Yae=MU(OO?({theme:t,enableColorScheme:e})=>DU(t,e):({theme:t})=>Gae(t));function qae(t){const e=Ar({props:t,name:"MuiCssBaseline"}),{children:r,enableColorScheme:n=!1}=e;return I.jsxs(Y.Fragment,{children:[OO&&I.jsx(Yae,{enableColorScheme:n}),!OO&&!n&&I.jsx("span",{className:Dw,style:{display:"none"}}),r]})}function tH(...t){return t.reduce((e,r)=>r==null?e:function(...i){e.apply(this,i),r.apply(this,i)},()=>{})}const $r=Yoe;function Kae(t){return Hr("MuiSvgIcon",t)}br("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Xae=t=>{const{color:e,fontSize:r,classes:n}=t,i={root:["root",e!=="inherit"&&`color${Tt(e)}`,`fontSize${Tt(r)}`]};return Gr(i,Kae,n)},Qae=gt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${Tt(r.color)}`],e[`fontSize${Tt(r.fontSize)}`]]}})($r(({theme:t})=>{var e,r,n,i,s,o,a,l,u,h,d,m,g,y;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(i=(e=t.transitions)==null?void 0:e.create)==null?void 0:i.call(e,"fill",{duration:(n=(r=(t.vars??t).transitions)==null?void 0:r.duration)==null?void 0:n.shorter}),variants:[{props:x=>!x.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((o=(s=t.typography)==null?void 0:s.pxToRem)==null?void 0:o.call(s,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((l=(a=t.typography)==null?void 0:a.pxToRem)==null?void 0:l.call(a,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((h=(u=t.typography)==null?void 0:u.pxToRem)==null?void 0:h.call(u,35))||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,x])=>x&&x.main).map(([x])=>{var b,C;return{props:{color:x},style:{color:(C=(b=(t.vars??t).palette)==null?void 0:b[x])==null?void 0:C.main}}}),{props:{color:"action"},style:{color:(m=(d=(t.vars??t).palette)==null?void 0:d.action)==null?void 0:m.active}},{props:{color:"disabled"},style:{color:(y=(g=(t.vars??t).palette)==null?void 0:g.action)==null?void 0:y.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),_O=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiSvgIcon"}),{children:i,className:s,color:o="inherit",component:a="svg",fontSize:l="medium",htmlColor:u,inheritViewBox:h=!1,titleAccess:d,viewBox:m="0 0 24 24",...g}=n,y=Y.isValidElement(i)&&i.type==="svg",x={...n,color:o,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:h,viewBox:m,hasSvgAsChild:y},b={};h||(b.viewBox=m);const C=Xae(x);return I.jsxs(Qae,{as:a,className:St(C.root,s),focusable:"false",color:u,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:r,...b,...g,...y&&i.props,ownerState:x,children:[y?i.props.children:i,d?I.jsx("title",{children:d}):null]})});_O.muiName="SvgIcon";function rn(t,e){function r(n,i){return I.jsx(_O,{"data-testid":void 0,ref:i,...n,children:t})}return r.muiName=_O.muiName,Y.memo(Y.forwardRef(r))}function PU(t,e=166){let r;function n(...i){const s=()=>{t.apply(this,i)};clearTimeout(r),r=setTimeout(s,e)}return n.clear=()=>{clearTimeout(r)},n}function Pl(t){return t&&t.ownerDocument||document}function Dp(t){return Pl(t).defaultView||window}function rH(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let nH=0;function Zae(t){const[e,r]=Y.useState(t),n=t||e;return Y.useEffect(()=>{e==null&&(nH+=1,r(`mui-${nH}`))},[e]),n}const Jae={...bO},iH=Jae.useId;function OS(t){if(iH!==void 0){const e=iH();return t??e}return Zae(t)}function ele(t){const{controlled:e,default:r}=t,{current:n}=Y.useRef(e!==void 0),[i,s]=Y.useState(r),o=n?e:i,a=Y.useCallback(l=>{n||s(l)},[]);return[o,a]}function Ha(t){const e=Y.useRef(t);return gh(()=>{e.current=t}),Y.useRef((...r)=>(0,e.current)(...r)).current}function Ys(...t){const e=Y.useRef(void 0),r=Y.useCallback(n=>{const i=t.map(s=>{if(s==null)return null;if(typeof s=="function"){const o=s,a=o(n);return typeof a=="function"?a:()=>{o(null)}}return s.current=n,()=>{s.current=null}});return()=>{i.forEach(s=>s==null?void 0:s())}},t);return Y.useMemo(()=>t.every(n=>n==null)?null:n=>{e.current&&(e.current(),e.current=void 0),n!=null&&(e.current=r(n))},t)}function wD(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function MO(t,e){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},MO(t,e)}function IU(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,MO(t,e)}var NU=G7();const rp=KM(NU),sH={disabled:!1},cb=Kt.createContext(null);var tle=function(e){return e.scrollTop},sg="unmounted",Bf="exited",Vf="entering",Xd="entered",DO="exiting",Ga=function(t){IU(e,t);function e(n,i){var s;s=t.call(this,n,i)||this;var o=i,a=o&&!o.isMounting?n.enter:n.appear,l;return s.appearStatus=null,n.in?a?(l=Bf,s.appearStatus=Vf):l=Xd:n.unmountOnExit||n.mountOnEnter?l=sg:l=Bf,s.state={status:l},s.nextCallback=null,s}e.getDerivedStateFromProps=function(i,s){var o=i.in;return o&&s.status===sg?{status:Bf}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var s=null;if(i!==this.props){var o=this.state.status;this.props.in?o!==Vf&&o!==Xd&&(s=Vf):(o===Vf||o===Xd)&&(s=DO)}this.updateStatus(!1,s)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,s,o,a;return s=o=a=i,i!=null&&typeof i!="number"&&(s=i.exit,o=i.enter,a=i.appear!==void 0?i.appear:o),{exit:s,enter:o,appear:a}},r.updateStatus=function(i,s){if(i===void 0&&(i=!1),s!==null)if(this.cancelNextCallback(),s===Vf){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:rp.findDOMNode(this);o&&tle(o)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Bf&&this.setState({status:sg})},r.performEnter=function(i){var s=this,o=this.props.enter,a=this.context?this.context.isMounting:i,l=this.props.nodeRef?[a]:[rp.findDOMNode(this),a],u=l[0],h=l[1],d=this.getTimeouts(),m=a?d.appear:d.enter;if(!i&&!o||sH.disabled){this.safeSetState({status:Xd},function(){s.props.onEntered(u)});return}this.props.onEnter(u,h),this.safeSetState({status:Vf},function(){s.props.onEntering(u,h),s.onTransitionEnd(m,function(){s.safeSetState({status:Xd},function(){s.props.onEntered(u,h)})})})},r.performExit=function(){var i=this,s=this.props.exit,o=this.getTimeouts(),a=this.props.nodeRef?void 0:rp.findDOMNode(this);if(!s||sH.disabled){this.safeSetState({status:Bf},function(){i.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:DO},function(){i.props.onExiting(a),i.onTransitionEnd(o.exit,function(){i.safeSetState({status:Bf},function(){i.props.onExited(a)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,s){s=this.setNextCallback(s),this.setState(i,s)},r.setNextCallback=function(i){var s=this,o=!0;return this.nextCallback=function(a){o&&(o=!1,s.nextCallback=null,i(a))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},r.onTransitionEnd=function(i,s){this.setNextCallback(s);var o=this.props.nodeRef?this.props.nodeRef.current:rp.findDOMNode(this),a=i==null&&!this.props.addEndListener;if(!o||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=l[0],h=l[1];this.props.addEndListener(u,h)}i!=null&&setTimeout(this.nextCallback,i)},r.render=function(){var i=this.state.status;if(i===sg)return null;var s=this.props,o=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var a=wD(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Kt.createElement(cb.Provider,{value:null},typeof o=="function"?o(i,a):Kt.cloneElement(Kt.Children.only(o),a))},e}(Kt.Component);Ga.contextType=cb;Ga.propTypes={};function Nd(){}Ga.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Nd,onEntering:Nd,onEntered:Nd,onExit:Nd,onExiting:Nd,onExited:Nd};Ga.UNMOUNTED=sg;Ga.EXITED=Bf;Ga.ENTERING=Vf;Ga.ENTERED=Xd;Ga.EXITING=DO;function rle(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bD(t,e){var r=function(s){return e&&Y.isValidElement(s)?e(s):s},n=Object.create(null);return t&&Y.Children.map(t,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function nle(t,e){t=t||{},e=e||{};function r(h){return h in e?e[h]:t[h]}var n=Object.create(null),i=[];for(var s in t)s in e?i.length&&(n[s]=i,i=[]):i.push(s);var o,a={};for(var l in e){if(n[l])for(o=0;o<n[l].length;o++){var u=n[l][o];a[n[l][o]]=r(u)}a[l]=r(l)}for(o=0;o<i.length;o++)a[i[o]]=r(i[o]);return a}function Qf(t,e,r){return r[e]!=null?r[e]:t.props[e]}function ile(t,e){return bD(t.children,function(r){return Y.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:Qf(r,"appear",t),enter:Qf(r,"enter",t),exit:Qf(r,"exit",t)})})}function sle(t,e,r){var n=bD(t.children),i=nle(e,n);return Object.keys(i).forEach(function(s){var o=i[s];if(Y.isValidElement(o)){var a=s in e,l=s in n,u=e[s],h=Y.isValidElement(u)&&!u.props.in;l&&(!a||h)?i[s]=Y.cloneElement(o,{onExited:r.bind(null,o),in:!0,exit:Qf(o,"exit",t),enter:Qf(o,"enter",t)}):!l&&a&&!h?i[s]=Y.cloneElement(o,{in:!1}):l&&a&&Y.isValidElement(u)&&(i[s]=Y.cloneElement(o,{onExited:r.bind(null,o),in:u.props.in,exit:Qf(o,"exit",t),enter:Qf(o,"enter",t)}))}}),i}var ole=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},ale={component:"div",childFactory:function(e){return e}},SD=function(t){IU(e,t);function e(n,i){var s;s=t.call(this,n,i)||this;var o=s.handleExited.bind(rle(s));return s.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},s}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,s){var o=s.children,a=s.handleExited,l=s.firstRender;return{children:l?ile(i,a):sle(i,o,a),firstRender:!1}},r.handleExited=function(i,s){var o=bD(this.props.children);i.key in o||(i.props.onExited&&i.props.onExited(s),this.mounted&&this.setState(function(a){var l=Xg({},a.children);return delete l[i.key],{children:l}}))},r.render=function(){var i=this.props,s=i.component,o=i.childFactory,a=wD(i,["component","childFactory"]),l=this.state.contextValue,u=ole(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,s===null?Kt.createElement(cb.Provider,{value:l},u):Kt.createElement(cb.Provider,{value:l},Kt.createElement(s,a,u))},e}(Kt.Component);SD.propTypes={};SD.defaultProps=ale;const oH={};function LU(t,e){const r=Y.useRef(oH);return r.current===oH&&(r.current=t(e)),r}const lle=[];function cle(t){Y.useEffect(t,lle)}class _S{constructor(){gm(this,"currentId",null);gm(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});gm(this,"disposeEffect",()=>this.clear)}static create(){return new _S}start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}}function Zf(){const t=LU(_S.create).current;return cle(t.disposeEffect),t}const FU=t=>t.scrollTop;function Pp(t,e){const{timeout:r,easing:n,style:i={}}=t;return{duration:i.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:i.transitionTimingFunction??(typeof n=="object"?n[e.mode]:n),delay:i.transitionDelay}}function ule(t){return Hr("MuiCollapse",t)}br("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const fle=t=>{const{orientation:e,classes:r}=t,n={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return Gr(n,ule,r)},hle=gt("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.orientation],r.state==="entered"&&e.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&e.hidden]}})($r(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),dle=gt("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),ple=gt("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),tv=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiCollapse"}),{addEndListener:i,children:s,className:o,collapsedSize:a="0px",component:l,easing:u,in:h,onEnter:d,onEntered:m,onEntering:g,onExit:y,onExited:x,onExiting:b,orientation:C="vertical",style:E,timeout:R=AU.standard,TransitionComponent:k=Ga,...O}=n,P={...n,orientation:C,collapsedSize:a},D=fle(P),H=$a(),N=Zf(),_=Y.useRef(null),B=Y.useRef(),j=typeof a=="number"?`${a}px`:a,ee=C==="horizontal",oe=ee?"width":"height",re=Y.useRef(null),q=Ys(r,re),Z=V=>J=>{if(V){const ae=re.current;J===void 0?V(ae):V(ae,J)}},ve=()=>_.current?_.current[ee?"clientWidth":"clientHeight"]:0,ie=Z((V,J)=>{_.current&&ee&&(_.current.style.position="absolute"),V.style[oe]=j,d&&d(V,J)}),K=Z((V,J)=>{const ae=ve();_.current&&ee&&(_.current.style.position="");const{duration:ue,easing:pe}=Pp({style:E,timeout:R,easing:u},{mode:"enter"});if(R==="auto"){const ke=H.transitions.getAutoHeightDuration(ae);V.style.transitionDuration=`${ke}ms`,B.current=ke}else V.style.transitionDuration=typeof ue=="string"?ue:`${ue}ms`;V.style[oe]=`${ae}px`,V.style.transitionTimingFunction=pe,g&&g(V,J)}),ce=Z((V,J)=>{V.style[oe]="auto",m&&m(V,J)}),S=Z(V=>{V.style[oe]=`${ve()}px`,y&&y(V)}),A=Z(x),M=Z(V=>{const J=ve(),{duration:ae,easing:ue}=Pp({style:E,timeout:R,easing:u},{mode:"exit"});if(R==="auto"){const pe=H.transitions.getAutoHeightDuration(J);V.style.transitionDuration=`${pe}ms`,B.current=pe}else V.style.transitionDuration=typeof ae=="string"?ae:`${ae}ms`;V.style[oe]=j,V.style.transitionTimingFunction=ue,b&&b(V)}),L=V=>{R==="auto"&&N.start(B.current||0,V),i&&i(re.current,V)};return I.jsx(k,{in:h,onEnter:ie,onEntered:ce,onEntering:K,onExit:S,onExited:A,onExiting:M,addEndListener:L,nodeRef:re,timeout:R==="auto"?null:R,...O,children:(V,{ownerState:J,...ae})=>I.jsx(hle,{as:l,className:St(D.root,o,{entered:D.entered,exited:!h&&j==="0px"&&D.hidden}[V]),style:{[ee?"minWidth":"minHeight"]:j,...E},ref:q,ownerState:{...P,state:V},...ae,children:I.jsx(dle,{ownerState:{...P,state:V},className:D.wrapper,ref:_,children:I.jsx(ple,{ownerState:{...P,state:V},className:D.wrapperInner,children:s})})})})});tv&&(tv.muiSupportAuto=!0);function mle(t){return Hr("MuiPaper",t)}br("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const gle=t=>{const{square:e,elevation:r,variant:n,classes:i}=t,s={root:["root",n,!e&&"rounded",n==="elevation"&&`elevation${r}`]};return Gr(s,mle,i)},vle=gt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})($r(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Bi=Y.forwardRef(function(e,r){var g;const n=Ar({props:e,name:"MuiPaper"}),i=$a(),{className:s,component:o="div",elevation:a=1,square:l=!1,variant:u="elevation",...h}=n,d={...n,component:o,elevation:a,square:l,variant:u},m=gle(d);return I.jsx(vle,{as:o,ownerState:d,className:St(m.root,s),ref:r,...h,style:{...u==="elevation"&&{"--Paper-shadow":(i.vars||i).shadows[a],...i.vars&&{"--Paper-overlay":(g=i.vars.overlays)==null?void 0:g[a]},...!i.vars&&i.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Fi("#fff",kO(a))}, ${Fi("#fff",kO(a))})`}},...h.style}})});function yle(t){return typeof t=="string"}function HU(t,e,r){return t===void 0||yle(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function BU(t,e,r){return typeof t=="function"?t(e,r):t}function VU(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(n=>n.match(/^on[A-Z]/)&&typeof t[n]=="function"&&!e.includes(n)).forEach(n=>{r[n]=t[n]}),r}function aH(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function jU(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:s}=t;if(!e){const g=St(r==null?void 0:r.className,s,i==null?void 0:i.className,n==null?void 0:n.className),y={...r==null?void 0:r.style,...i==null?void 0:i.style,...n==null?void 0:n.style},x={...r,...i,...n};return g.length>0&&(x.className=g),Object.keys(y).length>0&&(x.style=y),{props:x,internalRef:void 0}}const o=VU({...i,...n}),a=aH(n),l=aH(i),u=e(o),h=St(u==null?void 0:u.className,r==null?void 0:r.className,s,i==null?void 0:i.className,n==null?void 0:n.className),d={...u==null?void 0:u.style,...r==null?void 0:r.style,...i==null?void 0:i.style,...n==null?void 0:n.style},m={...u,...r,...l,...a};return h.length>0&&(m.className=h),Object.keys(d).length>0&&(m.style=d),{props:m,internalRef:u.ref}}function Zr(t,e){const{className:r,elementType:n,ownerState:i,externalForwardedProps:s,internalForwardedProps:o,shouldForwardComponentProp:a=!1,...l}=e,{component:u,slots:h={[t]:void 0},slotProps:d={[t]:void 0},...m}=s,g=h[t]||n,y=BU(d[t],i),{props:{component:x,...b},internalRef:C}=jU({className:r,...l,externalForwardedProps:t==="root"?m:void 0,externalSlotProps:y}),E=Ys(C,y==null?void 0:y.ref,e.ref),R=t==="root"?x||u:x,k=HU(g,{...t==="root"&&!u&&!h[t]&&o,...t!=="root"&&!h[t]&&o,...b,...R&&!a&&{as:R},...R&&a&&{component:R},ref:E},i);return[g,k]}function Ip(t){try{return t.matches(":focus-visible")}catch{}return!1}class ub{constructor(){gm(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new ub}static use(){const e=LU(ub.create).current,[r,n]=Y.useState(!1);return e.shouldMount=r,e.setShouldMount=n,Y.useEffect(e.mountEffect,[r]),e}mount(){return this.mounted||(this.mounted=wle(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...e){this.mount().then(()=>{var r;return(r=this.ref.current)==null?void 0:r.start(...e)})}stop(...e){this.mount().then(()=>{var r;return(r=this.ref.current)==null?void 0:r.stop(...e)})}pulsate(...e){this.mount().then(()=>{var r;return(r=this.ref.current)==null?void 0:r.pulsate(...e)})}}function xle(){return ub.use()}function wle(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});return r.resolve=t,r.reject=e,r}function ble(t){const{className:e,classes:r,pulsate:n=!1,rippleX:i,rippleY:s,rippleSize:o,in:a,onExited:l,timeout:u}=t,[h,d]=Y.useState(!1),m=St(e,r.ripple,r.rippleVisible,n&&r.ripplePulsate),g={width:o,height:o,top:-(o/2)+s,left:-(o/2)+i},y=St(r.child,h&&r.childLeaving,n&&r.childPulsate);return!a&&!h&&d(!0),Y.useEffect(()=>{if(!a&&l!=null){const x=setTimeout(l,u);return()=>{clearTimeout(x)}}},[l,a,u]),I.jsx("span",{className:m,style:g,children:I.jsx("span",{className:y})})}const Uo=br("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),PO=550,Sle=80,Cle=Qv`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Tle=Qv`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Ele=Qv`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Rle=gt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Ale=gt(ble,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Uo.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Cle};
    animation-duration: ${PO}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Uo.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Uo.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Uo.childLeaving} {
    opacity: 0;
    animation-name: ${Tle};
    animation-duration: ${PO}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Uo.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Ele};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,kle=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:s={},className:o,...a}=n,[l,u]=Y.useState([]),h=Y.useRef(0),d=Y.useRef(null);Y.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);const m=Y.useRef(!1),g=Zf(),y=Y.useRef(null),x=Y.useRef(null),b=Y.useCallback(k=>{const{pulsate:O,rippleX:P,rippleY:D,rippleSize:H,cb:N}=k;u(_=>[..._,I.jsx(Ale,{classes:{ripple:St(s.ripple,Uo.ripple),rippleVisible:St(s.rippleVisible,Uo.rippleVisible),ripplePulsate:St(s.ripplePulsate,Uo.ripplePulsate),child:St(s.child,Uo.child),childLeaving:St(s.childLeaving,Uo.childLeaving),childPulsate:St(s.childPulsate,Uo.childPulsate)},timeout:PO,pulsate:O,rippleX:P,rippleY:D,rippleSize:H},h.current)]),h.current+=1,d.current=N},[s]),C=Y.useCallback((k={},O={},P=()=>{})=>{const{pulsate:D=!1,center:H=i||O.pulsate,fakeElement:N=!1}=O;if((k==null?void 0:k.type)==="mousedown"&&m.current){m.current=!1;return}(k==null?void 0:k.type)==="touchstart"&&(m.current=!0);const _=N?null:x.current,B=_?_.getBoundingClientRect():{width:0,height:0,left:0,top:0};let j,ee,oe;if(H||k===void 0||k.clientX===0&&k.clientY===0||!k.clientX&&!k.touches)j=Math.round(B.width/2),ee=Math.round(B.height/2);else{const{clientX:re,clientY:q}=k.touches&&k.touches.length>0?k.touches[0]:k;j=Math.round(re-B.left),ee=Math.round(q-B.top)}if(H)oe=Math.sqrt((2*B.width**2+B.height**2)/3),oe%2===0&&(oe+=1);else{const re=Math.max(Math.abs((_?_.clientWidth:0)-j),j)*2+2,q=Math.max(Math.abs((_?_.clientHeight:0)-ee),ee)*2+2;oe=Math.sqrt(re**2+q**2)}k!=null&&k.touches?y.current===null&&(y.current=()=>{b({pulsate:D,rippleX:j,rippleY:ee,rippleSize:oe,cb:P})},g.start(Sle,()=>{y.current&&(y.current(),y.current=null)})):b({pulsate:D,rippleX:j,rippleY:ee,rippleSize:oe,cb:P})},[i,b,g]),E=Y.useCallback(()=>{C({},{pulsate:!0})},[C]),R=Y.useCallback((k,O)=>{if(g.clear(),(k==null?void 0:k.type)==="touchend"&&y.current){y.current(),y.current=null,g.start(0,()=>{R(k,O)});return}y.current=null,u(P=>P.length>0?P.slice(1):P),d.current=O},[g]);return Y.useImperativeHandle(r,()=>({pulsate:E,start:C,stop:R}),[E,C,R]),I.jsx(Rle,{className:St(Uo.root,s.root,o),ref:x,...a,children:I.jsx(SD,{component:null,exit:!0,children:l})})});function Ole(t){return Hr("MuiButtonBase",t)}const _le=br("MuiButtonBase",["root","disabled","focusVisible"]),Mle=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:n,classes:i}=t,o=Gr({root:["root",e&&"disabled",r&&"focusVisible"]},Ole,i);return r&&n&&(o.root+=` ${n}`),o},Dle=gt("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${_le.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ty=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:s=!1,children:o,className:a,component:l="button",disabled:u=!1,disableRipple:h=!1,disableTouchRipple:d=!1,focusRipple:m=!1,focusVisibleClassName:g,LinkComponent:y="a",onBlur:x,onClick:b,onContextMenu:C,onDragLeave:E,onFocus:R,onFocusVisible:k,onKeyDown:O,onKeyUp:P,onMouseDown:D,onMouseLeave:H,onMouseUp:N,onTouchEnd:_,onTouchMove:B,onTouchStart:j,tabIndex:ee=0,TouchRippleProps:oe,touchRippleRef:re,type:q,...Z}=n,ve=Y.useRef(null),ie=xle(),K=Ys(ie.ref,re),[ce,S]=Y.useState(!1);u&&ce&&S(!1),Y.useImperativeHandle(i,()=>({focusVisible:()=>{S(!0),ve.current.focus()}}),[]);const A=ie.shouldMount&&!h&&!u;Y.useEffect(()=>{ce&&m&&!h&&ie.pulsate()},[h,m,ce,ie]);const M=lc(ie,"start",D,d),L=lc(ie,"stop",C,d),V=lc(ie,"stop",E,d),J=lc(ie,"stop",N,d),ae=lc(ie,"stop",je=>{ce&&je.preventDefault(),H&&H(je)},d),ue=lc(ie,"start",j,d),pe=lc(ie,"stop",_,d),ke=lc(ie,"stop",B,d),z=lc(ie,"stop",je=>{Ip(je.target)||S(!1),x&&x(je)},!1),Be=Ha(je=>{ve.current||(ve.current=je.currentTarget),Ip(je.target)&&(S(!0),k&&k(je)),R&&R(je)}),Fe=()=>{const je=ve.current;return l&&l!=="button"&&!(je.tagName==="A"&&je.href)},ze=Ha(je=>{m&&!je.repeat&&ce&&je.key===" "&&ie.stop(je,()=>{ie.start(je)}),je.target===je.currentTarget&&Fe()&&je.key===" "&&je.preventDefault(),O&&O(je),je.target===je.currentTarget&&Fe()&&je.key==="Enter"&&!u&&(je.preventDefault(),b&&b(je))}),Ge=Ha(je=>{m&&je.key===" "&&ce&&!je.defaultPrevented&&ie.stop(je,()=>{ie.pulsate(je)}),P&&P(je),b&&je.target===je.currentTarget&&Fe()&&je.key===" "&&!je.defaultPrevented&&b(je)});let Ee=l;Ee==="button"&&(Z.href||Z.to)&&(Ee=y);const Ue={};Ee==="button"?(Ue.type=q===void 0?"button":q,Ue.disabled=u):(!Z.href&&!Z.to&&(Ue.role="button"),u&&(Ue["aria-disabled"]=u));const st=Ys(r,ve),tt={...n,centerRipple:s,component:l,disabled:u,disableRipple:h,disableTouchRipple:d,focusRipple:m,tabIndex:ee,focusVisible:ce},at=Mle(tt);return I.jsxs(Dle,{as:Ee,className:St(at.root,a),ownerState:tt,onBlur:z,onClick:b,onContextMenu:L,onFocus:Be,onKeyDown:ze,onKeyUp:Ge,onMouseDown:M,onMouseLeave:ae,onMouseUp:J,onDragLeave:V,onTouchEnd:pe,onTouchMove:ke,onTouchStart:ue,ref:st,tabIndex:u?-1:ee,type:q,...Ue,...Z,children:[o,A?I.jsx(kle,{ref:K,center:s,...oe}):null]})});function lc(t,e,r,n=!1){return Ha(i=>(r&&r(i),n||t[e](i),!0))}function Ple(t){return typeof t.main=="string"}function Ile(t,e=[]){if(!Ple(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function vh(t=[]){return([,e])=>e&&Ile(e,t)}function Nle(t){return Hr("MuiCircularProgress",t)}br("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const du=44,IO=Qv`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,NO=Qv`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Lle=typeof IO!="string"?iD`
        animation: ${IO} 1.4s linear infinite;
      `:null,Fle=typeof NO!="string"?iD`
        animation: ${NO} 1.4s ease-in-out infinite;
      `:null,Hle=t=>{const{classes:e,variant:r,color:n,disableShrink:i}=t,s={root:["root",r,`color${Tt(n)}`],svg:["svg"],circle:["circle",`circle${Tt(r)}`,i&&"circleDisableShrink"]};return Gr(s,Nle,e)},Ble=gt("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${Tt(r.color)}`]]}})($r(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Lle||{animation:`${IO} 1.4s linear infinite`}},...Object.entries(t.palette).filter(vh()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),Vle=gt("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),jle=gt("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${Tt(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})($r(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:Fle||{animation:`${NO} 1.4s ease-in-out infinite`}}]}))),CD=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiCircularProgress"}),{className:i,color:s="primary",disableShrink:o=!1,size:a=40,style:l,thickness:u=3.6,value:h=0,variant:d="indeterminate",...m}=n,g={...n,color:s,disableShrink:o,size:a,thickness:u,value:h,variant:d},y=Hle(g),x={},b={},C={};if(d==="determinate"){const E=2*Math.PI*((du-u)/2);x.strokeDasharray=E.toFixed(3),C["aria-valuenow"]=Math.round(h),x.strokeDashoffset=`${((100-h)/100*E).toFixed(3)}px`,b.transform="rotate(-90deg)"}return I.jsx(Ble,{className:St(y.root,i),style:{width:a,height:a,...b,...l},ownerState:g,ref:r,role:"progressbar",...C,...m,children:I.jsx(Vle,{className:y.svg,ownerState:g,viewBox:`${du/2} ${du/2} ${du} ${du}`,children:I.jsx(jle,{className:y.circle,style:x,ownerState:g,cx:du,cy:du,r:(du-u)/2,fill:"none",strokeWidth:u})})})});function Wle(t){return Hr("MuiIconButton",t)}const lH=br("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),zle=t=>{const{classes:e,disabled:r,color:n,edge:i,size:s,loading:o}=t,a={root:["root",o&&"loading",r&&"disabled",n!=="default"&&`color${Tt(n)}`,i&&`edge${Tt(i)}`,`size${Tt(s)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Gr(a,Wle,e)},Ule=gt(ty,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${Tt(r.color)}`],r.edge&&e[`edge${Tt(r.edge)}`],e[`size${Tt(r.size)}`]]}})($r(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Fi(t.palette.action.active,t.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),$r(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(vh()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(vh()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.vars?`rgba(${(t.vars||t).palette[e].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Fi((t.vars||t).palette[e].main,t.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${lH.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${lH.loading}`]:{color:"transparent"}}))),$le=gt("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),Gle=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiIconButton"}),{edge:i=!1,children:s,className:o,color:a="default",disabled:l=!1,disableFocusRipple:u=!1,size:h="medium",id:d,loading:m=null,loadingIndicator:g,...y}=n,x=OS(d),b=g??I.jsx(CD,{"aria-labelledby":x,color:"inherit",size:16}),C={...n,edge:i,color:a,disabled:l,disableFocusRipple:u,loading:m,loadingIndicator:b,size:h},E=zle(C);return I.jsxs(Ule,{id:m?x:d,className:St(E.root,o),centerRipple:!0,focusRipple:!u,disabled:l||m,ref:r,...y,ownerState:C,children:[typeof m=="boolean"&&I.jsx("span",{className:E.loadingWrapper,style:{display:"contents"},children:I.jsx($le,{className:E.loadingIndicator,ownerState:C,children:m&&b})}),s]})});function Yle(t){return Hr("MuiTypography",t)}const cH=br("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),qle={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Kle=zae(),Xle=t=>{const{align:e,gutterBottom:r,noWrap:n,paragraph:i,variant:s,classes:o}=t,a={root:["root",s,t.align!=="inherit"&&`align${Tt(e)}`,r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return Gr(a,Yle,o)},Qle=gt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${Tt(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})($r(({theme:t})=>{var e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([r,n])=>r!=="inherit"&&n&&typeof n=="object").map(([r,n])=>({props:{variant:r},style:n})),...Object.entries(t.palette).filter(vh()).map(([r])=>({props:{color:r},style:{color:(t.vars||t).palette[r].main}})),...Object.entries(((e=t.palette)==null?void 0:e.text)||{}).filter(([,r])=>typeof r=="string").map(([r])=>({props:{color:`text${Tt(r)}`},style:{color:(t.vars||t).palette.text[r]}})),{props:({ownerState:r})=>r.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:r})=>r.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:r})=>r.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:r})=>r.paragraph,style:{marginBottom:16}}]}})),uH={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},pt=Y.forwardRef(function(e,r){const{color:n,...i}=Ar({props:e,name:"MuiTypography"}),s=!qle[n],o=Kle({...i,...s&&{color:n}}),{align:a="inherit",className:l,component:u,gutterBottom:h=!1,noWrap:d=!1,paragraph:m=!1,variant:g="body1",variantMapping:y=uH,...x}=o,b={...o,align:a,color:n,className:l,component:u,gutterBottom:h,noWrap:d,paragraph:m,variant:g,variantMapping:y},C=u||(m?"p":y[g]||uH[g])||"span",E=Xle(b);return I.jsx(Qle,{as:C,ref:r,className:St(E.root,l),...x,ownerState:b,style:{...a!=="inherit"&&{"--Typography-textAlign":a},...x.style}})});var zs="top",na="bottom",ia="right",Us="left",TD="auto",ry=[zs,na,ia,Us],Np="start",rv="end",Zle="clippingParents",WU="viewport",bm="popper",Jle="reference",fH=ry.reduce(function(t,e){return t.concat([e+"-"+Np,e+"-"+rv])},[]),zU=[].concat(ry,[TD]).reduce(function(t,e){return t.concat([e,e+"-"+Np,e+"-"+rv])},[]),ece="beforeRead",tce="read",rce="afterRead",nce="beforeMain",ice="main",sce="afterMain",oce="beforeWrite",ace="write",lce="afterWrite",cce=[ece,tce,rce,nce,ice,sce,oce,ace,lce];function Il(t){return t?(t.nodeName||"").toLowerCase():null}function vo(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function yh(t){var e=vo(t).Element;return t instanceof e||t instanceof Element}function Jo(t){var e=vo(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function ED(t){if(typeof ShadowRoot>"u")return!1;var e=vo(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function uce(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},s=e.elements[r];!Jo(s)||!Il(s)||(Object.assign(s.style,n),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function fce(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],s=e.attributes[n]||{},o=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),a=o.reduce(function(l,u){return l[u]="",l},{});!Jo(i)||!Il(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}const hce={name:"applyStyles",enabled:!0,phase:"write",fn:uce,effect:fce,requires:["computeStyles"]};function kl(t){return t.split("-")[0]}var oh=Math.max,fb=Math.min,Lp=Math.round;function LO(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function UU(){return!/^((?!chrome|android).)*safari/i.test(LO())}function Fp(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,s=1;e&&Jo(t)&&(i=t.offsetWidth>0&&Lp(n.width)/t.offsetWidth||1,s=t.offsetHeight>0&&Lp(n.height)/t.offsetHeight||1);var o=yh(t)?vo(t):window,a=o.visualViewport,l=!UU()&&r,u=(n.left+(l&&a?a.offsetLeft:0))/i,h=(n.top+(l&&a?a.offsetTop:0))/s,d=n.width/i,m=n.height/s;return{width:d,height:m,top:h,right:u+d,bottom:h+m,left:u,x:u,y:h}}function RD(t){var e=Fp(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function $U(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&ED(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Mc(t){return vo(t).getComputedStyle(t)}function dce(t){return["table","td","th"].indexOf(Il(t))>=0}function Ju(t){return((yh(t)?t.ownerDocument:t.document)||window.document).documentElement}function MS(t){return Il(t)==="html"?t:t.assignedSlot||t.parentNode||(ED(t)?t.host:null)||Ju(t)}function hH(t){return!Jo(t)||Mc(t).position==="fixed"?null:t.offsetParent}function pce(t){var e=/firefox/i.test(LO()),r=/Trident/i.test(LO());if(r&&Jo(t)){var n=Mc(t);if(n.position==="fixed")return null}var i=MS(t);for(ED(i)&&(i=i.host);Jo(i)&&["html","body"].indexOf(Il(i))<0;){var s=Mc(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function ny(t){for(var e=vo(t),r=hH(t);r&&dce(r)&&Mc(r).position==="static";)r=hH(r);return r&&(Il(r)==="html"||Il(r)==="body"&&Mc(r).position==="static")?e:r||pce(t)||e}function AD(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function wg(t,e,r){return oh(t,fb(e,r))}function mce(t,e,r){var n=wg(t,e,r);return n>r?r:n}function GU(){return{top:0,right:0,bottom:0,left:0}}function YU(t){return Object.assign({},GU(),t)}function qU(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var gce=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,YU(typeof e!="number"?e:qU(e,ry))};function vce(t){var e,r=t.state,n=t.name,i=t.options,s=r.elements.arrow,o=r.modifiersData.popperOffsets,a=kl(r.placement),l=AD(a),u=[Us,ia].indexOf(a)>=0,h=u?"height":"width";if(!(!s||!o)){var d=gce(i.padding,r),m=RD(s),g=l==="y"?zs:Us,y=l==="y"?na:ia,x=r.rects.reference[h]+r.rects.reference[l]-o[l]-r.rects.popper[h],b=o[l]-r.rects.reference[l],C=ny(s),E=C?l==="y"?C.clientHeight||0:C.clientWidth||0:0,R=x/2-b/2,k=d[g],O=E-m[h]-d[y],P=E/2-m[h]/2+R,D=wg(k,P,O),H=l;r.modifiersData[n]=(e={},e[H]=D,e.centerOffset=D-P,e)}}function yce(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$U(e.elements.popper,i)&&(e.elements.arrow=i))}const xce={name:"arrow",enabled:!0,phase:"main",fn:vce,effect:yce,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Hp(t){return t.split("-")[1]}var wce={top:"auto",right:"auto",bottom:"auto",left:"auto"};function bce(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:Lp(r*i)/i||0,y:Lp(n*i)/i||0}}function dH(t){var e,r=t.popper,n=t.popperRect,i=t.placement,s=t.variation,o=t.offsets,a=t.position,l=t.gpuAcceleration,u=t.adaptive,h=t.roundOffsets,d=t.isFixed,m=o.x,g=m===void 0?0:m,y=o.y,x=y===void 0?0:y,b=typeof h=="function"?h({x:g,y:x}):{x:g,y:x};g=b.x,x=b.y;var C=o.hasOwnProperty("x"),E=o.hasOwnProperty("y"),R=Us,k=zs,O=window;if(u){var P=ny(r),D="clientHeight",H="clientWidth";if(P===vo(r)&&(P=Ju(r),Mc(P).position!=="static"&&a==="absolute"&&(D="scrollHeight",H="scrollWidth")),P=P,i===zs||(i===Us||i===ia)&&s===rv){k=na;var N=d&&P===O&&O.visualViewport?O.visualViewport.height:P[D];x-=N-n.height,x*=l?1:-1}if(i===Us||(i===zs||i===na)&&s===rv){R=ia;var _=d&&P===O&&O.visualViewport?O.visualViewport.width:P[H];g-=_-n.width,g*=l?1:-1}}var B=Object.assign({position:a},u&&wce),j=h===!0?bce({x:g,y:x},vo(r)):{x:g,y:x};if(g=j.x,x=j.y,l){var ee;return Object.assign({},B,(ee={},ee[k]=E?"0":"",ee[R]=C?"0":"",ee.transform=(O.devicePixelRatio||1)<=1?"translate("+g+"px, "+x+"px)":"translate3d("+g+"px, "+x+"px, 0)",ee))}return Object.assign({},B,(e={},e[k]=E?x+"px":"",e[R]=C?g+"px":"",e.transform="",e))}function Sce(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,s=r.adaptive,o=s===void 0?!0:s,a=r.roundOffsets,l=a===void 0?!0:a,u={placement:kl(e.placement),variation:Hp(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,dH(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,dH(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Cce={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Sce,data:{}};var e1={passive:!0};function Tce(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,s=i===void 0?!0:i,o=n.resize,a=o===void 0?!0:o,l=vo(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&u.forEach(function(h){h.addEventListener("scroll",r.update,e1)}),a&&l.addEventListener("resize",r.update,e1),function(){s&&u.forEach(function(h){h.removeEventListener("scroll",r.update,e1)}),a&&l.removeEventListener("resize",r.update,e1)}}const Ece={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Tce,data:{}};var Rce={left:"right",right:"left",bottom:"top",top:"bottom"};function Pw(t){return t.replace(/left|right|bottom|top/g,function(e){return Rce[e]})}var Ace={start:"end",end:"start"};function pH(t){return t.replace(/start|end/g,function(e){return Ace[e]})}function kD(t){var e=vo(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function OD(t){return Fp(Ju(t)).left+kD(t).scrollLeft}function kce(t,e){var r=vo(t),n=Ju(t),i=r.visualViewport,s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var u=UU();(u||!u&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+OD(t),y:l}}function Oce(t){var e,r=Ju(t),n=kD(t),i=(e=t.ownerDocument)==null?void 0:e.body,s=oh(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=oh(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-n.scrollLeft+OD(t),l=-n.scrollTop;return Mc(i||r).direction==="rtl"&&(a+=oh(r.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function _D(t){var e=Mc(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function KU(t){return["html","body","#document"].indexOf(Il(t))>=0?t.ownerDocument.body:Jo(t)&&_D(t)?t:KU(MS(t))}function bg(t,e){var r;e===void 0&&(e=[]);var n=KU(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),s=vo(n),o=i?[s].concat(s.visualViewport||[],_D(n)?n:[]):n,a=e.concat(o);return i?a:a.concat(bg(MS(o)))}function FO(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function _ce(t,e){var r=Fp(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function mH(t,e,r){return e===WU?FO(kce(t,r)):yh(e)?_ce(e,r):FO(Oce(Ju(t)))}function Mce(t){var e=bg(MS(t)),r=["absolute","fixed"].indexOf(Mc(t).position)>=0,n=r&&Jo(t)?ny(t):t;return yh(n)?e.filter(function(i){return yh(i)&&$U(i,n)&&Il(i)!=="body"}):[]}function Dce(t,e,r,n){var i=e==="clippingParents"?Mce(t):[].concat(e),s=[].concat(i,[r]),o=s[0],a=s.reduce(function(l,u){var h=mH(t,u,n);return l.top=oh(h.top,l.top),l.right=fb(h.right,l.right),l.bottom=fb(h.bottom,l.bottom),l.left=oh(h.left,l.left),l},mH(t,o,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function XU(t){var e=t.reference,r=t.element,n=t.placement,i=n?kl(n):null,s=n?Hp(n):null,o=e.x+e.width/2-r.width/2,a=e.y+e.height/2-r.height/2,l;switch(i){case zs:l={x:o,y:e.y-r.height};break;case na:l={x:o,y:e.y+e.height};break;case ia:l={x:e.x+e.width,y:a};break;case Us:l={x:e.x-r.width,y:a};break;default:l={x:e.x,y:e.y}}var u=i?AD(i):null;if(u!=null){var h=u==="y"?"height":"width";switch(s){case Np:l[u]=l[u]-(e[h]/2-r[h]/2);break;case rv:l[u]=l[u]+(e[h]/2-r[h]/2);break}}return l}function nv(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,s=r.strategy,o=s===void 0?t.strategy:s,a=r.boundary,l=a===void 0?Zle:a,u=r.rootBoundary,h=u===void 0?WU:u,d=r.elementContext,m=d===void 0?bm:d,g=r.altBoundary,y=g===void 0?!1:g,x=r.padding,b=x===void 0?0:x,C=YU(typeof b!="number"?b:qU(b,ry)),E=m===bm?Jle:bm,R=t.rects.popper,k=t.elements[y?E:m],O=Dce(yh(k)?k:k.contextElement||Ju(t.elements.popper),l,h,o),P=Fp(t.elements.reference),D=XU({reference:P,element:R,placement:i}),H=FO(Object.assign({},R,D)),N=m===bm?H:P,_={top:O.top-N.top+C.top,bottom:N.bottom-O.bottom+C.bottom,left:O.left-N.left+C.left,right:N.right-O.right+C.right},B=t.modifiersData.offset;if(m===bm&&B){var j=B[i];Object.keys(_).forEach(function(ee){var oe=[ia,na].indexOf(ee)>=0?1:-1,re=[zs,na].indexOf(ee)>=0?"y":"x";_[ee]+=j[re]*oe})}return _}function Pce(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,s=r.rootBoundary,o=r.padding,a=r.flipVariations,l=r.allowedAutoPlacements,u=l===void 0?zU:l,h=Hp(n),d=h?a?fH:fH.filter(function(y){return Hp(y)===h}):ry,m=d.filter(function(y){return u.indexOf(y)>=0});m.length===0&&(m=d);var g=m.reduce(function(y,x){return y[x]=nv(t,{placement:x,boundary:i,rootBoundary:s,padding:o})[kl(x)],y},{});return Object.keys(g).sort(function(y,x){return g[y]-g[x]})}function Ice(t){if(kl(t)===TD)return[];var e=Pw(t);return[pH(t),e,pH(e)]}function Nce(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,s=i===void 0?!0:i,o=r.altAxis,a=o===void 0?!0:o,l=r.fallbackPlacements,u=r.padding,h=r.boundary,d=r.rootBoundary,m=r.altBoundary,g=r.flipVariations,y=g===void 0?!0:g,x=r.allowedAutoPlacements,b=e.options.placement,C=kl(b),E=C===b,R=l||(E||!y?[Pw(b)]:Ice(b)),k=[b].concat(R).reduce(function(M,L){return M.concat(kl(L)===TD?Pce(e,{placement:L,boundary:h,rootBoundary:d,padding:u,flipVariations:y,allowedAutoPlacements:x}):L)},[]),O=e.rects.reference,P=e.rects.popper,D=new Map,H=!0,N=k[0],_=0;_<k.length;_++){var B=k[_],j=kl(B),ee=Hp(B)===Np,oe=[zs,na].indexOf(j)>=0,re=oe?"width":"height",q=nv(e,{placement:B,boundary:h,rootBoundary:d,altBoundary:m,padding:u}),Z=oe?ee?ia:Us:ee?na:zs;O[re]>P[re]&&(Z=Pw(Z));var ve=Pw(Z),ie=[];if(s&&ie.push(q[j]<=0),a&&ie.push(q[Z]<=0,q[ve]<=0),ie.every(function(M){return M})){N=B,H=!1;break}D.set(B,ie)}if(H)for(var K=y?3:1,ce=function(L){var V=k.find(function(J){var ae=D.get(J);if(ae)return ae.slice(0,L).every(function(ue){return ue})});if(V)return N=V,"break"},S=K;S>0;S--){var A=ce(S);if(A==="break")break}e.placement!==N&&(e.modifiersData[n]._skip=!0,e.placement=N,e.reset=!0)}}const Lce={name:"flip",enabled:!0,phase:"main",fn:Nce,requiresIfExists:["offset"],data:{_skip:!1}};function gH(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function vH(t){return[zs,ia,na,Us].some(function(e){return t[e]>=0})}function Fce(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=nv(e,{elementContext:"reference"}),a=nv(e,{altBoundary:!0}),l=gH(o,n),u=gH(a,i,s),h=vH(l),d=vH(u);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:h,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}const Hce={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Fce};function Bce(t,e,r){var n=kl(t),i=[Us,zs].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[Us,ia].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}function Vce(t){var e=t.state,r=t.options,n=t.name,i=r.offset,s=i===void 0?[0,0]:i,o=zU.reduce(function(h,d){return h[d]=Bce(d,e.rects,s),h},{}),a=o[e.placement],l=a.x,u=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[n]=o}const jce={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Vce};function Wce(t){var e=t.state,r=t.name;e.modifiersData[r]=XU({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const zce={name:"popperOffsets",enabled:!0,phase:"read",fn:Wce,data:{}};function Uce(t){return t==="x"?"y":"x"}function $ce(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,s=i===void 0?!0:i,o=r.altAxis,a=o===void 0?!1:o,l=r.boundary,u=r.rootBoundary,h=r.altBoundary,d=r.padding,m=r.tether,g=m===void 0?!0:m,y=r.tetherOffset,x=y===void 0?0:y,b=nv(e,{boundary:l,rootBoundary:u,padding:d,altBoundary:h}),C=kl(e.placement),E=Hp(e.placement),R=!E,k=AD(C),O=Uce(k),P=e.modifiersData.popperOffsets,D=e.rects.reference,H=e.rects.popper,N=typeof x=="function"?x(Object.assign({},e.rects,{placement:e.placement})):x,_=typeof N=="number"?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),B=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,j={x:0,y:0};if(P){if(s){var ee,oe=k==="y"?zs:Us,re=k==="y"?na:ia,q=k==="y"?"height":"width",Z=P[k],ve=Z+b[oe],ie=Z-b[re],K=g?-H[q]/2:0,ce=E===Np?D[q]:H[q],S=E===Np?-H[q]:-D[q],A=e.elements.arrow,M=g&&A?RD(A):{width:0,height:0},L=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:GU(),V=L[oe],J=L[re],ae=wg(0,D[q],M[q]),ue=R?D[q]/2-K-ae-V-_.mainAxis:ce-ae-V-_.mainAxis,pe=R?-D[q]/2+K+ae+J+_.mainAxis:S+ae+J+_.mainAxis,ke=e.elements.arrow&&ny(e.elements.arrow),z=ke?k==="y"?ke.clientTop||0:ke.clientLeft||0:0,Be=(ee=B==null?void 0:B[k])!=null?ee:0,Fe=Z+ue-Be-z,ze=Z+pe-Be,Ge=wg(g?fb(ve,Fe):ve,Z,g?oh(ie,ze):ie);P[k]=Ge,j[k]=Ge-Z}if(a){var Ee,Ue=k==="x"?zs:Us,st=k==="x"?na:ia,tt=P[O],at=O==="y"?"height":"width",je=tt+b[Ue],er=tt-b[st],Nt=[zs,Us].indexOf(C)!==-1,jt=(Ee=B==null?void 0:B[O])!=null?Ee:0,Dt=Nt?je:tt-D[at]-H[at]-jt+_.altAxis,Et=Nt?tt+D[at]+H[at]-jt-_.altAxis:er,Ct=g&&Nt?mce(Dt,tt,Et):wg(g?Dt:je,tt,g?Et:er);P[O]=Ct,j[O]=Ct-tt}e.modifiersData[n]=j}}const Gce={name:"preventOverflow",enabled:!0,phase:"main",fn:$ce,requiresIfExists:["offset"]};function Yce(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function qce(t){return t===vo(t)||!Jo(t)?kD(t):Yce(t)}function Kce(t){var e=t.getBoundingClientRect(),r=Lp(e.width)/t.offsetWidth||1,n=Lp(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Xce(t,e,r){r===void 0&&(r=!1);var n=Jo(e),i=Jo(e)&&Kce(e),s=Ju(e),o=Fp(t,i,r),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((Il(e)!=="body"||_D(s))&&(a=qce(e)),Jo(e)?(l=Fp(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=OD(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Qce(t){var e=new Map,r=new Set,n=[];t.forEach(function(s){e.set(s.name,s)});function i(s){r.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!r.has(a)){var l=e.get(a);l&&i(l)}}),n.push(s)}return t.forEach(function(s){r.has(s.name)||i(s)}),n}function Zce(t){var e=Qce(t);return cce.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Jce(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function eue(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var yH={placement:"bottom",modifiers:[],strategy:"absolute"};function xH(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function tue(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,s=i===void 0?yH:i;return function(a,l,u){u===void 0&&(u=s);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},yH,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],m=!1,g={state:h,setOptions:function(C){var E=typeof C=="function"?C(h.options):C;x(),h.options=Object.assign({},s,h.options,E),h.scrollParents={reference:yh(a)?bg(a):a.contextElement?bg(a.contextElement):[],popper:bg(l)};var R=Zce(eue([].concat(n,h.options.modifiers)));return h.orderedModifiers=R.filter(function(k){return k.enabled}),y(),g.update()},forceUpdate:function(){if(!m){var C=h.elements,E=C.reference,R=C.popper;if(xH(E,R)){h.rects={reference:Xce(E,ny(R),h.options.strategy==="fixed"),popper:RD(R)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(_){return h.modifiersData[_.name]=Object.assign({},_.data)});for(var k=0;k<h.orderedModifiers.length;k++){if(h.reset===!0){h.reset=!1,k=-1;continue}var O=h.orderedModifiers[k],P=O.fn,D=O.options,H=D===void 0?{}:D,N=O.name;typeof P=="function"&&(h=P({state:h,options:H,name:N,instance:g})||h)}}}},update:Jce(function(){return new Promise(function(b){g.forceUpdate(),b(h)})}),destroy:function(){x(),m=!0}};if(!xH(a,l))return g;g.setOptions(u).then(function(b){!m&&u.onFirstUpdate&&u.onFirstUpdate(b)});function y(){h.orderedModifiers.forEach(function(b){var C=b.name,E=b.options,R=E===void 0?{}:E,k=b.effect;if(typeof k=="function"){var O=k({state:h,name:C,instance:g,options:R}),P=function(){};d.push(O||P)}})}function x(){d.forEach(function(b){return b()}),d=[]}return g}}var rue=[Ece,zce,Cce,hce,jce,Lce,Gce,xce,Hce],nue=tue({defaultModifiers:rue});function iv(t){var d;const{elementType:e,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:i=!1,...s}=t,o=i?{}:BU(r,n),{props:a,internalRef:l}=jU({...s,externalSlotProps:o}),u=Ys(l,o==null?void 0:o.ref,(d=t.additionalProps)==null?void 0:d.ref);return HU(e,{...a,ref:u},n)}function iy(t){var e;return parseInt(Y.version,10)>=19?((e=t==null?void 0:t.props)==null?void 0:e.ref)||null:(t==null?void 0:t.ref)||null}function iue(t){return typeof t=="function"?t():t}const QU=Y.forwardRef(function(e,r){const{children:n,container:i,disablePortal:s=!1}=e,[o,a]=Y.useState(null),l=Ys(Y.isValidElement(n)?iy(n):null,r);if(gh(()=>{s||a(iue(i)||document.body)},[i,s]),gh(()=>{if(o&&!s)return rH(r,o),()=>{rH(r,null)}},[r,o,s]),s){if(Y.isValidElement(n)){const u={ref:l};return Y.cloneElement(n,u)}return n}return o&&NU.createPortal(n,o)});function sue(t){return Hr("MuiPopper",t)}br("MuiPopper",["root"]);function oue(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function HO(t){return typeof t=="function"?t():t}function aue(t){return t.nodeType!==void 0}const lue=t=>{const{classes:e}=t;return Gr({root:["root"]},sue,e)},cue={},uue=Y.forwardRef(function(e,r){const{anchorEl:n,children:i,direction:s,disablePortal:o,modifiers:a,open:l,placement:u,popperOptions:h,popperRef:d,slotProps:m={},slots:g={},TransitionProps:y,ownerState:x,...b}=e,C=Y.useRef(null),E=Ys(C,r),R=Y.useRef(null),k=Ys(R,d),O=Y.useRef(k);gh(()=>{O.current=k},[k]),Y.useImperativeHandle(d,()=>R.current,[]);const P=oue(u,s),[D,H]=Y.useState(P),[N,_]=Y.useState(HO(n));Y.useEffect(()=>{R.current&&R.current.forceUpdate()}),Y.useEffect(()=>{n&&_(HO(n))},[n]),gh(()=>{if(!N||!l)return;const re=ve=>{H(ve.placement)};let q=[{name:"preventOverflow",options:{altBoundary:o}},{name:"flip",options:{altBoundary:o}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:ve})=>{re(ve)}}];a!=null&&(q=q.concat(a)),h&&h.modifiers!=null&&(q=q.concat(h.modifiers));const Z=nue(N,C.current,{placement:P,...h,modifiers:q});return O.current(Z),()=>{Z.destroy(),O.current(null)}},[N,o,a,l,h,P]);const B={placement:D};y!==null&&(B.TransitionProps=y);const j=lue(e),ee=g.root??"div",oe=iv({elementType:ee,externalSlotProps:m.root,externalForwardedProps:b,additionalProps:{role:"tooltip",ref:E},ownerState:e,className:j.root});return I.jsx(ee,{...oe,children:typeof i=="function"?i(B):i})}),fue=Y.forwardRef(function(e,r){const{anchorEl:n,children:i,container:s,direction:o="ltr",disablePortal:a=!1,keepMounted:l=!1,modifiers:u,open:h,placement:d="bottom",popperOptions:m=cue,popperRef:g,style:y,transition:x=!1,slotProps:b={},slots:C={},...E}=e,[R,k]=Y.useState(!0),O=()=>{k(!1)},P=()=>{k(!0)};if(!l&&!h&&(!x||R))return null;let D;if(s)D=s;else if(n){const _=HO(n);D=_&&aue(_)?Pl(_).body:Pl(null).body}const H=!h&&l&&(!x||R)?"none":void 0,N=x?{in:h,onEnter:O,onExited:P}:void 0;return I.jsx(QU,{disablePortal:a,container:D,children:I.jsx(uue,{anchorEl:n,direction:o,disablePortal:a,modifiers:u,ref:r,open:x?!R:h,placement:d,popperOptions:m,popperRef:g,slotProps:b,slots:C,...E,style:{position:"fixed",top:0,left:0,display:H,...y},TransitionProps:N,children:i})})}),hue=gt(fue,{name:"MuiPopper",slot:"Root"})({}),ZU=Y.forwardRef(function(e,r){const n=AS(),i=Ar({props:e,name:"MuiPopper"}),{anchorEl:s,component:o,components:a,componentsProps:l,container:u,disablePortal:h,keepMounted:d,modifiers:m,open:g,placement:y,popperOptions:x,popperRef:b,transition:C,slots:E,slotProps:R,...k}=i,O=(E==null?void 0:E.root)??(a==null?void 0:a.Root),P={anchorEl:s,container:u,disablePortal:h,keepMounted:d,modifiers:m,open:g,placement:y,popperOptions:x,popperRef:b,transition:C,...k};return I.jsx(hue,{as:o,direction:n?"rtl":"ltr",slots:{root:O},slotProps:R??l,...P,ref:r})});function wH(t){return typeof t=="string"}const due=rn(I.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function pue(t){return Hr("MuiAvatar",t)}br("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const mue=t=>{const{classes:e,variant:r,colorDefault:n}=t;return Gr({root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]},pue,e)},gue=gt("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],r.colorDefault&&e.colorDefault]}})($r(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),vue=gt("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),yue=gt(due,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function xue({crossOrigin:t,referrerPolicy:e,src:r,srcSet:n}){const[i,s]=Y.useState(!1);return Y.useEffect(()=>{if(!r&&!n)return;s(!1);let o=!0;const a=new Image;return a.onload=()=>{o&&s("loaded")},a.onerror=()=>{o&&s("error")},a.crossOrigin=t,a.referrerPolicy=e,a.src=r,n&&(a.srcset=n),()=>{o=!1}},[t,e,r,n]),i}const bH=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiAvatar"}),{alt:i,children:s,className:o,component:a="div",slots:l={},slotProps:u={},imgProps:h,sizes:d,src:m,srcSet:g,variant:y="circular",...x}=n;let b=null;const C={...n,component:a,variant:y},E=xue({...h,...typeof u.img=="function"?u.img(C):u.img,src:m,srcSet:g}),R=m||g,k=R&&E!=="error";C.colorDefault=!k,delete C.ownerState;const O=mue(C),[P,D]=Zr("root",{ref:r,className:St(O.root,o),elementType:gue,externalForwardedProps:{slots:l,slotProps:u,component:a,...x},ownerState:C}),[H,N]=Zr("img",{className:O.img,elementType:vue,externalForwardedProps:{slots:l,slotProps:{img:{...h,...u.img}}},additionalProps:{alt:i,src:m,srcSet:g,sizes:d},ownerState:C}),[_,B]=Zr("fallback",{className:O.fallback,elementType:yue,externalForwardedProps:{slots:l,slotProps:u},shouldForwardComponentProp:!0,ownerState:C});return k?b=I.jsx(H,{...N}):s||s===0?b=s:R&&i?b=i[0]:b=I.jsx(_,{...B}),I.jsx(P,{...D,children:b})}),wue={entering:{opacity:1},entered:{opacity:1}},BO=Y.forwardRef(function(e,r){const n=$a(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:o=!0,children:a,easing:l,in:u,onEnter:h,onEntered:d,onEntering:m,onExit:g,onExited:y,onExiting:x,style:b,timeout:C=i,TransitionComponent:E=Ga,...R}=e,k=Y.useRef(null),O=Ys(k,iy(a),r),P=oe=>re=>{if(oe){const q=k.current;re===void 0?oe(q):oe(q,re)}},D=P(m),H=P((oe,re)=>{FU(oe);const q=Pp({style:b,timeout:C,easing:l},{mode:"enter"});oe.style.webkitTransition=n.transitions.create("opacity",q),oe.style.transition=n.transitions.create("opacity",q),h&&h(oe,re)}),N=P(d),_=P(x),B=P(oe=>{const re=Pp({style:b,timeout:C,easing:l},{mode:"exit"});oe.style.webkitTransition=n.transitions.create("opacity",re),oe.style.transition=n.transitions.create("opacity",re),g&&g(oe)}),j=P(y),ee=oe=>{s&&s(k.current,oe)};return I.jsx(E,{appear:o,in:u,nodeRef:k,onEnter:H,onEntered:N,onEntering:D,onExit:B,onExited:j,onExiting:_,addEndListener:ee,timeout:C,...R,children:(oe,{ownerState:re,...q})=>Y.cloneElement(a,{style:{opacity:0,visibility:oe==="exited"&&!u?"hidden":void 0,...wue[oe],...b,...a.props.style},ref:O,...q})})});function bue(t){return Hr("MuiBackdrop",t)}br("MuiBackdrop",["root","invisible"]);const Sue=t=>{const{classes:e,invisible:r}=t;return Gr({root:["root",r&&"invisible"]},bue,e)},Cue=gt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),JU=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiBackdrop"}),{children:i,className:s,component:o="div",invisible:a=!1,open:l,components:u={},componentsProps:h={},slotProps:d={},slots:m={},TransitionComponent:g,transitionDuration:y,...x}=n,b={...n,component:o,invisible:a},C=Sue(b),E={transition:g,root:u.Root,...m},R={...h,...d},k={slots:E,slotProps:R},[O,P]=Zr("root",{elementType:Cue,externalForwardedProps:k,className:St(C.root,s),ownerState:b}),[D,H]=Zr("transition",{elementType:BO,externalForwardedProps:k,ownerState:b});return I.jsx(D,{in:l,timeout:y,...x,...H,children:I.jsx(O,{"aria-hidden":!0,...P,classes:C,ref:r,children:i})})}),Tue=br("MuiBox",["root"]),Eue=kS(),_e=Toe({themeId:Rl,defaultTheme:Eue,defaultClassName:Tue.root,generateClassName:pU.generate});function Rue(t){return Hr("MuiButton",t)}const Tf=br("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),Aue=Y.createContext({}),kue=Y.createContext(void 0),Oue=t=>{const{color:e,disableElevation:r,fullWidth:n,size:i,variant:s,loading:o,loadingPosition:a,classes:l}=t,u={root:["root",o&&"loading",s,`${s}${Tt(e)}`,`size${Tt(i)}`,`${s}Size${Tt(i)}`,`color${Tt(e)}`,r&&"disableElevation",n&&"fullWidth",o&&`loadingPosition${Tt(a)}`],startIcon:["icon","startIcon",`iconSize${Tt(i)}`],endIcon:["icon","endIcon",`iconSize${Tt(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},h=Gr(u,Rue,l);return{...l,...h}},e$=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],_ue=gt(ty,{shouldForwardProp:t=>xD(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${Tt(r.color)}`],e[`size${Tt(r.size)}`],e[`${r.variant}Size${Tt(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})($r(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Tf.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${Tf.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${Tf.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Tf.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(vh()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.vars?`rgba(${t.vars.palette[n].mainChannel} / 0.5)`:Fi(t.palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Fi(t.palette[n].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Fi(t.palette[n].main,t.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Fi(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Fi(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Tf.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Tf.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${Tf.loading}`]:{color:"transparent"}}}]}})),Mue=gt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${Tt(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...e$]})),Due=gt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${Tt(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...e$]})),Pue=gt("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),SH=gt("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Iue=Y.forwardRef(function(e,r){const n=Y.useContext(Aue),i=Y.useContext(kue),s=lb(n,e),o=Ar({props:s,name:"MuiButton"}),{children:a,color:l="primary",component:u="button",className:h,disabled:d=!1,disableElevation:m=!1,disableFocusRipple:g=!1,endIcon:y,focusVisibleClassName:x,fullWidth:b=!1,id:C,loading:E=null,loadingIndicator:R,loadingPosition:k="center",size:O="medium",startIcon:P,type:D,variant:H="text",...N}=o,_=OS(C),B=R??I.jsx(CD,{"aria-labelledby":_,color:"inherit",size:16}),j={...o,color:l,component:u,disabled:d,disableElevation:m,disableFocusRipple:g,fullWidth:b,loading:E,loadingIndicator:B,loadingPosition:k,size:O,type:D,variant:H},ee=Oue(j),oe=(P||E&&k==="start")&&I.jsx(Mue,{className:ee.startIcon,ownerState:j,children:P||I.jsx(SH,{className:ee.loadingIconPlaceholder,ownerState:j})}),re=(y||E&&k==="end")&&I.jsx(Due,{className:ee.endIcon,ownerState:j,children:y||I.jsx(SH,{className:ee.loadingIconPlaceholder,ownerState:j})}),q=i||"",Z=typeof E=="boolean"?I.jsx("span",{className:ee.loadingWrapper,style:{display:"contents"},children:E&&I.jsx(Pue,{className:ee.loadingIndicator,ownerState:j,children:B})}):null;return I.jsxs(_ue,{ownerState:j,className:St(n.className,ee.root,h,q),component:u,disabled:d||E,focusRipple:!g,focusVisibleClassName:St(ee.focusVisible,x),ref:r,type:D,id:E?_:C,...N,classes:ee,children:[oe,k!=="end"&&Z,a,k==="end"&&Z,re]})});function Nue(t){return Hr("MuiCard",t)}br("MuiCard",["root"]);const Lue=t=>{const{classes:e}=t;return Gr({root:["root"]},Nue,e)},Fue=gt(Bi,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),Iw=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiCard"}),{className:i,raised:s=!1,...o}=n,a={...n,raised:s},l=Lue(a);return I.jsx(Fue,{className:St(l.root,i),elevation:s?8:void 0,ref:r,ownerState:a,...o})});function Hue(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function Bue(t){const e=Pl(t);return e.body===t?Dp(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function Sg(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function CH(t){return parseInt(Dp(t).getComputedStyle(t).paddingRight,10)||0}function Vue(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),n=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||n}function TH(t,e,r,n,i){const s=[e,r,...n];[].forEach.call(t.children,o=>{const a=!s.includes(o),l=!Vue(o);a&&l&&Sg(o,i)})}function $E(t,e){let r=-1;return t.some((n,i)=>e(n)?(r=i,!0):!1),r}function jue(t,e){const r=[],n=t.container;if(!e.disableScrollLock){if(Bue(n)){const o=Hue(Dp(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${CH(n)+o}px`;const a=Pl(n).querySelectorAll(".mui-fixed");[].forEach.call(a,l=>{r.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${CH(l)+o}px`})}let s;if(n.parentNode instanceof DocumentFragment)s=Pl(n).body;else{const o=n.parentElement,a=Dp(n);s=(o==null?void 0:o.nodeName)==="HTML"&&a.getComputedStyle(o).overflowY==="scroll"?o:n}r.push({value:s.style.overflow,property:"overflow",el:s},{value:s.style.overflowX,property:"overflow-x",el:s},{value:s.style.overflowY,property:"overflow-y",el:s}),s.style.overflow="hidden"}return()=>{r.forEach(({value:s,el:o,property:a})=>{s?o.style.setProperty(a,s):o.style.removeProperty(a)})}}function Wue(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class zue{constructor(){this.modals=[],this.containers=[]}add(e,r){let n=this.modals.indexOf(e);if(n!==-1)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&Sg(e.modalRef,!1);const i=Wue(r);TH(r,e.mount,e.modalRef,i,!0);const s=$E(this.containers,o=>o.container===r);return s!==-1?(this.containers[s].modals.push(e),n):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:i}),n)}mount(e,r){const n=$E(this.containers,s=>s.modals.includes(e)),i=this.containers[n];i.restore||(i.restore=jue(i,r))}remove(e,r=!0){const n=this.modals.indexOf(e);if(n===-1)return n;const i=$E(this.containers,o=>o.modals.includes(e)),s=this.containers[i];if(s.modals.splice(s.modals.indexOf(e),1),this.modals.splice(n,1),s.modals.length===0)s.restore&&s.restore(),e.modalRef&&Sg(e.modalRef,r),TH(s.container,e.mount,e.modalRef,s.hiddenSiblings,!1),this.containers.splice(i,1);else{const o=s.modals[s.modals.length-1];o.modalRef&&Sg(o.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Uue=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function $ue(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Gue(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=n=>t.ownerDocument.querySelector(`input[type="radio"]${n}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function Yue(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Gue(t))}function que(t){const e=[],r=[];return Array.from(t.querySelectorAll(Uue)).forEach((n,i)=>{const s=$ue(n);s===-1||!Yue(n)||(s===0?e.push(n):r.push({documentOrder:i,tabIndex:s,node:n}))}),r.sort((n,i)=>n.tabIndex===i.tabIndex?n.documentOrder-i.documentOrder:n.tabIndex-i.tabIndex).map(n=>n.node).concat(e)}function Kue(){return!0}function Xue(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:i=!1,getTabbable:s=que,isEnabled:o=Kue,open:a}=t,l=Y.useRef(!1),u=Y.useRef(null),h=Y.useRef(null),d=Y.useRef(null),m=Y.useRef(null),g=Y.useRef(!1),y=Y.useRef(null),x=Ys(iy(e),y),b=Y.useRef(null);Y.useEffect(()=>{!a||!y.current||(g.current=!r)},[r,a]),Y.useEffect(()=>{if(!a||!y.current)return;const R=Pl(y.current);return y.current.contains(R.activeElement)||(y.current.hasAttribute("tabIndex")||y.current.setAttribute("tabIndex","-1"),g.current&&y.current.focus()),()=>{i||(d.current&&d.current.focus&&(l.current=!0,d.current.focus()),d.current=null)}},[a]),Y.useEffect(()=>{if(!a||!y.current)return;const R=Pl(y.current),k=D=>{b.current=D,!(n||!o()||D.key!=="Tab")&&R.activeElement===y.current&&D.shiftKey&&(l.current=!0,h.current&&h.current.focus())},O=()=>{var N,_;const D=y.current;if(D===null)return;if(!R.hasFocus()||!o()||l.current){l.current=!1;return}if(D.contains(R.activeElement)||n&&R.activeElement!==u.current&&R.activeElement!==h.current)return;if(R.activeElement!==m.current)m.current=null;else if(m.current!==null)return;if(!g.current)return;let H=[];if((R.activeElement===u.current||R.activeElement===h.current)&&(H=s(y.current)),H.length>0){const B=!!((N=b.current)!=null&&N.shiftKey&&((_=b.current)==null?void 0:_.key)==="Tab"),j=H[0],ee=H[H.length-1];typeof j!="string"&&typeof ee!="string"&&(B?ee.focus():j.focus())}else D.focus()};R.addEventListener("focusin",O),R.addEventListener("keydown",k,!0);const P=setInterval(()=>{R.activeElement&&R.activeElement.tagName==="BODY"&&O()},50);return()=>{clearInterval(P),R.removeEventListener("focusin",O),R.removeEventListener("keydown",k,!0)}},[r,n,i,o,a,s]);const C=R=>{d.current===null&&(d.current=R.relatedTarget),g.current=!0,m.current=R.target;const k=e.props.onFocus;k&&k(R)},E=R=>{d.current===null&&(d.current=R.relatedTarget),g.current=!0};return I.jsxs(Y.Fragment,{children:[I.jsx("div",{tabIndex:a?0:-1,onFocus:E,ref:u,"data-testid":"sentinelStart"}),Y.cloneElement(e,{ref:x,onFocus:C}),I.jsx("div",{tabIndex:a?0:-1,onFocus:E,ref:h,"data-testid":"sentinelEnd"})]})}function Que(t){return typeof t=="function"?t():t}function Zue(t){return t?t.props.hasOwnProperty("in"):!1}const EH=()=>{},t1=new zue;function Jue(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:n=!1,closeAfterTransition:i=!1,onTransitionEnter:s,onTransitionExited:o,children:a,onClose:l,open:u,rootRef:h}=t,d=Y.useRef({}),m=Y.useRef(null),g=Y.useRef(null),y=Ys(g,h),[x,b]=Y.useState(!u),C=Zue(a);let E=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(E=!1);const R=()=>Pl(m.current),k=()=>(d.current.modalRef=g.current,d.current.mount=m.current,d.current),O=()=>{t1.mount(k(),{disableScrollLock:n}),g.current&&(g.current.scrollTop=0)},P=Ha(()=>{const re=Que(e)||R().body;t1.add(k(),re),g.current&&O()}),D=()=>t1.isTopModal(k()),H=Ha(re=>{m.current=re,re&&(u&&D()?O():g.current&&Sg(g.current,E))}),N=Y.useCallback(()=>{t1.remove(k(),E)},[E]);Y.useEffect(()=>()=>{N()},[N]),Y.useEffect(()=>{u?P():(!C||!i)&&N()},[u,N,C,i,P]);const _=re=>q=>{var Z;(Z=re.onKeyDown)==null||Z.call(re,q),!(q.key!=="Escape"||q.which===229||!D())&&(r||(q.stopPropagation(),l&&l(q,"escapeKeyDown")))},B=re=>q=>{var Z;(Z=re.onClick)==null||Z.call(re,q),q.target===q.currentTarget&&l&&l(q,"backdropClick")};return{getRootProps:(re={})=>{const q=VU(t);delete q.onTransitionEnter,delete q.onTransitionExited;const Z={...q,...re};return{role:"presentation",...Z,onKeyDown:_(Z),ref:y}},getBackdropProps:(re={})=>{const q=re;return{"aria-hidden":!0,...q,onClick:B(q),open:u}},getTransitionProps:()=>{const re=()=>{b(!1),s&&s()},q=()=>{b(!0),o&&o(),i&&N()};return{onEnter:tH(re,(a==null?void 0:a.props.onEnter)??EH),onExited:tH(q,(a==null?void 0:a.props.onExited)??EH)}},rootRef:y,portalRef:H,isTopModal:D,exited:x,hasTransition:C}}function efe(t){return Hr("MuiModal",t)}br("MuiModal",["root","hidden","backdrop"]);const tfe=t=>{const{open:e,exited:r,classes:n}=t;return Gr({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},efe,n)},rfe=gt("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})($r(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),nfe=gt(JU,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),ife=Y.forwardRef(function(e,r){const n=Ar({name:"MuiModal",props:e}),{BackdropComponent:i=nfe,BackdropProps:s,classes:o,className:a,closeAfterTransition:l=!1,children:u,container:h,component:d,components:m={},componentsProps:g={},disableAutoFocus:y=!1,disableEnforceFocus:x=!1,disableEscapeKeyDown:b=!1,disablePortal:C=!1,disableRestoreFocus:E=!1,disableScrollLock:R=!1,hideBackdrop:k=!1,keepMounted:O=!1,onClose:P,onTransitionEnter:D,onTransitionExited:H,open:N,slotProps:_={},slots:B={},theme:j,...ee}=n,oe={...n,closeAfterTransition:l,disableAutoFocus:y,disableEnforceFocus:x,disableEscapeKeyDown:b,disablePortal:C,disableRestoreFocus:E,disableScrollLock:R,hideBackdrop:k,keepMounted:O},{getRootProps:re,getBackdropProps:q,getTransitionProps:Z,portalRef:ve,isTopModal:ie,exited:K,hasTransition:ce}=Jue({...oe,rootRef:r}),S={...oe,exited:K},A=tfe(S),M={};if(u.props.tabIndex===void 0&&(M.tabIndex="-1"),ce){const{onEnter:pe,onExited:ke}=Z();M.onEnter=pe,M.onExited=ke}const L={slots:{root:m.Root,backdrop:m.Backdrop,...B},slotProps:{...g,..._}},[V,J]=Zr("root",{ref:r,elementType:rfe,externalForwardedProps:{...L,...ee,component:d},getSlotProps:re,ownerState:S,className:St(a,A==null?void 0:A.root,!S.open&&S.exited&&(A==null?void 0:A.hidden))}),[ae,ue]=Zr("backdrop",{ref:s==null?void 0:s.ref,elementType:i,externalForwardedProps:L,shouldForwardComponentProp:!0,additionalProps:s,getSlotProps:pe=>q({...pe,onClick:ke=>{pe!=null&&pe.onClick&&pe.onClick(ke)}}),className:St(s==null?void 0:s.className,A==null?void 0:A.backdrop),ownerState:S});return!O&&!N&&(!ce||K)?null:I.jsx(QU,{ref:ve,container:h,disablePortal:C,children:I.jsxs(V,{...J,children:[!k&&i?I.jsx(ae,{...ue}):null,I.jsx(Xue,{disableEnforceFocus:x,disableAutoFocus:y,disableRestoreFocus:E,isEnabled:ie,open:N,children:Y.cloneElement(u,M)})]})})});function sfe(t){return Hr("MuiDialog",t)}const GE=br("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ofe=Y.createContext({}),afe=gt(JU,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),lfe=t=>{const{classes:e,scroll:r,maxWidth:n,fullWidth:i,fullScreen:s}=t,o={root:["root"],container:["container",`scroll${Tt(r)}`],paper:["paper",`paperScroll${Tt(r)}`,`paperWidth${Tt(String(n))}`,i&&"paperFullWidth",s&&"paperFullScreen"]};return Gr(o,sfe,e)},cfe=gt(ife,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),ufe=gt("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${Tt(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),ffe=gt(Bi,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${Tt(r.scroll)}`],e[`paperWidth${Tt(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})($r(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${GE.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${GE.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${GE.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),hfe=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiDialog"}),i=$a(),s={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":o,"aria-labelledby":a,"aria-modal":l=!0,BackdropComponent:u,BackdropProps:h,children:d,className:m,disableEscapeKeyDown:g=!1,fullScreen:y=!1,fullWidth:x=!1,maxWidth:b="sm",onClick:C,onClose:E,open:R,PaperComponent:k=Bi,PaperProps:O={},scroll:P="paper",slots:D={},slotProps:H={},TransitionComponent:N=BO,transitionDuration:_=s,TransitionProps:B,...j}=n,ee={...n,disableEscapeKeyDown:g,fullScreen:y,fullWidth:x,maxWidth:b,scroll:P},oe=lfe(ee),re=Y.useRef(),q=Be=>{re.current=Be.target===Be.currentTarget},Z=Be=>{C&&C(Be),re.current&&(re.current=null,E&&E(Be,"backdropClick"))},ve=OS(a),ie=Y.useMemo(()=>({titleId:ve}),[ve]),K={transition:N,...D},ce={transition:B,paper:O,backdrop:h,...H},S={slots:K,slotProps:ce},[A,M]=Zr("root",{elementType:cfe,shouldForwardComponentProp:!0,externalForwardedProps:S,ownerState:ee,className:St(oe.root,m),ref:r}),[L,V]=Zr("backdrop",{elementType:afe,shouldForwardComponentProp:!0,externalForwardedProps:S,ownerState:ee}),[J,ae]=Zr("paper",{elementType:ffe,shouldForwardComponentProp:!0,externalForwardedProps:S,ownerState:ee,className:St(oe.paper,O.className)}),[ue,pe]=Zr("container",{elementType:ufe,externalForwardedProps:S,ownerState:ee,className:oe.container}),[ke,z]=Zr("transition",{elementType:BO,externalForwardedProps:S,ownerState:ee,additionalProps:{appear:!0,in:R,timeout:_,role:"presentation"}});return I.jsx(A,{closeAfterTransition:!0,slots:{backdrop:L},slotProps:{backdrop:{transitionDuration:_,as:u,...V}},disableEscapeKeyDown:g,onClose:E,open:R,onClick:Z,...M,...j,children:I.jsx(ke,{...z,children:I.jsx(ue,{onMouseDown:q,...pe,children:I.jsx(J,{as:k,elevation:24,role:"dialog","aria-describedby":o,"aria-labelledby":ve,"aria-modal":l,...ae,children:I.jsx(ofe.Provider,{value:ie,children:d})})})})})});function dfe(t){return Hr("MuiDivider",t)}br("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const pfe=t=>{const{absolute:e,children:r,classes:n,flexItem:i,light:s,orientation:o,textAlign:a,variant:l}=t;return Gr({root:["root",e&&"absolute",l,s&&"light",o==="vertical"&&"vertical",i&&"flexItem",r&&"withChildren",r&&o==="vertical"&&"withChildrenVertical",a==="right"&&o!=="vertical"&&"textAlignRight",a==="left"&&o!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",o==="vertical"&&"wrapperVertical"]},dfe,n)},mfe=gt("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})($r(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.vars?`rgba(${t.vars.palette.dividerChannel} / 0.08)`:Fi(t.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),gfe=gt("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})($r(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),VO=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiDivider"}),{absolute:i=!1,children:s,className:o,orientation:a="horizontal",component:l=s||a==="vertical"?"div":"hr",flexItem:u=!1,light:h=!1,role:d=l!=="hr"?"separator":void 0,textAlign:m="center",variant:g="fullWidth",...y}=n,x={...n,absolute:i,component:l,flexItem:u,light:h,orientation:a,role:d,textAlign:m,variant:g},b=pfe(x);return I.jsx(mfe,{as:l,className:St(b.root,o),role:d,ref:r,ownerState:x,"aria-orientation":d==="separator"&&(l!=="hr"||a==="vertical")?a:void 0,...y,children:s?I.jsx(gfe,{className:b.wrapper,ownerState:x,children:s}):null})});VO&&(VO.muiSkipListHighlight=!0);function vfe(t){return Hr("MuiFab",t)}const RH=br("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),yfe=t=>{const{color:e,variant:r,classes:n,size:i}=t,s={root:["root",r,`size${Tt(i)}`,e==="inherit"?"colorInherit":e]},o=Gr(s,vfe,n);return{...n,...o}},xfe=gt(ty,{name:"MuiFab",slot:"Root",shouldForwardProp:t=>xD(t)||t==="classes",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`size${Tt(r.size)}`],r.color==="inherit"&&e.colorInherit,e[Tt(r.size)],e[r.color]]}})($r(({theme:t})=>{var e,r;return{...t.typography.button,minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(t.vars||t).zIndex.fab,boxShadow:(t.vars||t).shadows[6],"&:active":{boxShadow:(t.vars||t).shadows[12]},color:t.vars?t.vars.palette.grey[900]:(r=(e=t.palette).getContrastText)==null?void 0:r.call(e,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],"&:hover":{backgroundColor:(t.vars||t).palette.grey.A100,"@media (hover: none)":{backgroundColor:(t.vars||t).palette.grey[300]},textDecoration:"none"},[`&.${RH.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),$r(({theme:t})=>({variants:[...Object.entries(t.palette).filter(vh(["dark","contrastText"])).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].contrastText,backgroundColor:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:(t.vars||t).palette[e].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e].main}}}}))]})),$r(({theme:t})=>({[`&.${RH.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}))),r1=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiFab"}),{children:i,className:s,color:o="default",component:a="button",disabled:l=!1,disableFocusRipple:u=!1,focusVisibleClassName:h,size:d="large",variant:m="circular",...g}=n,y={...n,color:o,component:a,disabled:l,disableFocusRipple:u,size:d,variant:m},x=yfe(y);return I.jsx(xfe,{className:St(x.root,s),component:a,disabled:l,focusRipple:!u,focusVisibleClassName:St(x.focusVisible,h),ownerState:y,ref:r,...g,classes:x,children:i})});function jO(t){return`scale(${t}, ${t**2})`}const wfe={entering:{opacity:1,transform:jO(1)},entered:{opacity:1,transform:"none"}},YE=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),WO=Y.forwardRef(function(e,r){const{addEndListener:n,appear:i=!0,children:s,easing:o,in:a,onEnter:l,onEntered:u,onEntering:h,onExit:d,onExited:m,onExiting:g,style:y,timeout:x="auto",TransitionComponent:b=Ga,...C}=e,E=Zf(),R=Y.useRef(),k=$a(),O=Y.useRef(null),P=Ys(O,iy(s),r),D=re=>q=>{if(re){const Z=O.current;q===void 0?re(Z):re(Z,q)}},H=D(h),N=D((re,q)=>{FU(re);const{duration:Z,delay:ve,easing:ie}=Pp({style:y,timeout:x,easing:o},{mode:"enter"});let K;x==="auto"?(K=k.transitions.getAutoHeightDuration(re.clientHeight),R.current=K):K=Z,re.style.transition=[k.transitions.create("opacity",{duration:K,delay:ve}),k.transitions.create("transform",{duration:YE?K:K*.666,delay:ve,easing:ie})].join(","),l&&l(re,q)}),_=D(u),B=D(g),j=D(re=>{const{duration:q,delay:Z,easing:ve}=Pp({style:y,timeout:x,easing:o},{mode:"exit"});let ie;x==="auto"?(ie=k.transitions.getAutoHeightDuration(re.clientHeight),R.current=ie):ie=q,re.style.transition=[k.transitions.create("opacity",{duration:ie,delay:Z}),k.transitions.create("transform",{duration:YE?ie:ie*.666,delay:YE?Z:Z||ie*.333,easing:ve})].join(","),re.style.opacity=0,re.style.transform=jO(.75),d&&d(re)}),ee=D(m),oe=re=>{x==="auto"&&E.start(R.current||0,re),n&&n(O.current,re)};return I.jsx(b,{appear:i,in:a,nodeRef:O,onEnter:N,onEntered:_,onEntering:H,onExit:j,onExited:ee,onExiting:B,addEndListener:oe,timeout:x==="auto"?null:x,...C,children:(re,{ownerState:q,...Z})=>Y.cloneElement(s,{style:{opacity:0,transform:jO(.75),visibility:re==="exited"&&!a?"hidden":void 0,...wfe[re],...y,...s.props.style},ref:P,...Z})})});WO&&(WO.muiSupportAuto=!0);function bfe(t){return Hr("MuiLink",t)}const Sfe=br("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),Cfe=({theme:t,ownerState:e})=>{const r=e.color,n=Ru(t,`palette.${r}.main`,!1)||Ru(t,`palette.${r}`,!1)||e.color,i=Ru(t,`palette.${r}.mainChannel`)||Ru(t,`palette.${r}Channel`);return"vars"in t&&i?`rgba(${i} / 0.4)`:Fi(n,.4)},AH={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Tfe=t=>{const{classes:e,component:r,focusVisible:n,underline:i}=t,s={root:["root",`underline${Tt(i)}`,r==="button"&&"button",n&&"focusVisible"]};return Gr(s,bfe,e)},Efe=gt(pt,{name:"MuiLink",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`underline${Tt(r.underline)}`],r.component==="button"&&e.button]}})($r(({theme:t})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:e,ownerState:r})=>e==="always"&&r.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(t.palette).filter(vh()).map(([e])=>({props:{underline:"always",color:e},style:{"--Link-underlineColor":t.vars?`rgba(${t.vars.palette[e].mainChannel} / 0.4)`:Fi(t.palette[e].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:Fi(t.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":t.vars?`rgba(${t.vars.palette.text.secondaryChannel} / 0.4)`:Fi(t.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(t.vars||t).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Sfe.focusVisible}`]:{outline:"auto"}}}]}))),qE=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiLink"}),i=$a(),{className:s,color:o="primary",component:a="a",onBlur:l,onFocus:u,TypographyClasses:h,underline:d="always",variant:m="inherit",sx:g,...y}=n,[x,b]=Y.useState(!1),C=O=>{Ip(O.target)||b(!1),l&&l(O)},E=O=>{Ip(O.target)&&b(!0),u&&u(O)},R={...n,color:o,component:a,focusVisible:x,underline:d,variant:m},k=Tfe(R);return I.jsx(Efe,{color:o,className:St(k.root,s),classes:h,component:a,onBlur:C,onFocus:E,ref:r,ownerState:R,variant:m,...y,sx:[...AH[o]===void 0?[{color:o}]:[],...Array.isArray(g)?g:[g]],style:{...y.style,...d==="always"&&o!=="inherit"&&!AH[o]&&{"--Link-underlineColor":Cfe({theme:i,ownerState:R})}}})}),ah=Y.createContext({});function Rfe(t){return Hr("MuiList",t)}br("MuiList",["root","padding","dense","subheader"]);const Afe=t=>{const{classes:e,disablePadding:r,dense:n,subheader:i}=t;return Gr({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},Rfe,e)},kfe=gt("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),hb=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiList"}),{children:i,className:s,component:o="ul",dense:a=!1,disablePadding:l=!1,subheader:u,...h}=n,d=Y.useMemo(()=>({dense:a}),[a]),m={...n,component:o,dense:a,disablePadding:l},g=Afe(m);return I.jsx(ah.Provider,{value:d,children:I.jsxs(kfe,{as:o,className:St(g.root,s),ref:r,ownerState:m,...h,children:[u,i]})})});function Ofe(t){return Hr("MuiListItem",t)}br("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const _fe=br("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function Mfe(t){return Hr("MuiListItemSecondaryAction",t)}br("MuiListItemSecondaryAction",["root","disableGutters"]);const Dfe=t=>{const{disableGutters:e,classes:r}=t;return Gr({root:["root",e&&"disableGutters"]},Mfe,r)},Pfe=gt("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),t$=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiListItemSecondaryAction"}),{className:i,...s}=n,o=Y.useContext(ah),a={...n,disableGutters:o.disableGutters},l=Dfe(a);return I.jsx(Pfe,{className:St(l.root,i),ownerState:a,ref:r,...s})});t$.muiName="ListItemSecondaryAction";const Ife=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},Nfe=t=>{const{alignItems:e,classes:r,dense:n,disableGutters:i,disablePadding:s,divider:o,hasSecondaryAction:a}=t;return Gr({root:["root",n&&"dense",!i&&"gutters",!s&&"padding",o&&"divider",e==="flex-start"&&"alignItemsFlexStart",a&&"secondaryAction"],container:["container"]},Ofe,r)},Lfe=gt("div",{name:"MuiListItem",slot:"Root",overridesResolver:Ife})($r(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${_fe.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),Ffe=gt("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),zf=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiListItem"}),{alignItems:i="center",children:s,className:o,component:a,components:l={},componentsProps:u={},ContainerComponent:h="li",ContainerProps:{className:d,...m}={},dense:g=!1,disableGutters:y=!1,disablePadding:x=!1,divider:b=!1,secondaryAction:C,slotProps:E={},slots:R={},...k}=n,O=Y.useContext(ah),P=Y.useMemo(()=>({dense:g||O.dense||!1,alignItems:i,disableGutters:y}),[i,O.dense,g,y]),D=Y.useRef(null),H=Y.Children.toArray(s),N=H.length&&aae(H[H.length-1],["ListItemSecondaryAction"]),_={...n,alignItems:i,dense:P.dense,disableGutters:y,disablePadding:x,divider:b,hasSecondaryAction:N},B=Nfe(_),j=Ys(D,r),ee=R.root||l.Root||Lfe,oe=E.root||u.root||{},re={className:St(B.root,oe.className,o),...k};let q=a||"li";return N?(q=!re.component&&!a?"div":q,h==="li"&&(q==="li"?q="div":re.component==="li"&&(re.component="div")),I.jsx(ah.Provider,{value:P,children:I.jsxs(Ffe,{as:h,className:St(B.container,d),ref:j,ownerState:_,...m,children:[I.jsx(ee,{...oe,...!wH(ee)&&{as:q,ownerState:{..._,...oe.ownerState}},...re,children:H}),H.pop()]})})):I.jsx(ah.Provider,{value:P,children:I.jsxs(ee,{...oe,as:q,ref:j,...!wH(ee)&&{ownerState:{..._,...oe.ownerState}},...re,children:[H,C&&I.jsx(t$,{children:C})]})})});function Hfe(t){return Hr("MuiListItemIcon",t)}br("MuiListItemIcon",["root","alignItemsFlexStart"]);const Bfe=t=>{const{alignItems:e,classes:r}=t;return Gr({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Hfe,r)},Vfe=gt("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})($r(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Uf=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiListItemIcon"}),{className:i,...s}=n,o=Y.useContext(ah),a={...n,alignItems:o.alignItems},l=Bfe(a);return I.jsx(Vfe,{className:St(l.root,i),ownerState:a,ref:r,...s})});function jfe(t){return Hr("MuiListItemText",t)}const n1=br("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Wfe=t=>{const{classes:e,inset:r,primary:n,secondary:i,dense:s}=t;return Gr({root:["root",r&&"inset",s&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},jfe,e)},zfe=gt("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${n1.primary}`]:e.primary},{[`& .${n1.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${cH.root}:where(& .${n1.primary})`]:{display:"block"},[`.${cH.root}:where(& .${n1.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),$f=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiListItemText"}),{children:i,className:s,disableTypography:o=!1,inset:a=!1,primary:l,primaryTypographyProps:u,secondary:h,secondaryTypographyProps:d,slots:m={},slotProps:g={},...y}=n,{dense:x}=Y.useContext(ah);let b=l??i,C=h;const E={...n,disableTypography:o,inset:a,primary:!!b,secondary:!!C,dense:x},R=Wfe(E),k={slots:m,slotProps:{primary:u,secondary:d,...g}},[O,P]=Zr("root",{className:St(R.root,s),elementType:zfe,externalForwardedProps:{...k,...y},ownerState:E,ref:r}),[D,H]=Zr("primary",{className:R.primary,elementType:pt,externalForwardedProps:k,ownerState:E}),[N,_]=Zr("secondary",{className:R.secondary,elementType:pt,externalForwardedProps:k,ownerState:E});return b!=null&&b.type!==pt&&!o&&(b=I.jsx(D,{variant:x?"body2":"body1",component:H!=null&&H.variant?void 0:"span",...H,children:b})),C!=null&&C.type!==pt&&!o&&(C=I.jsx(N,{variant:"body2",color:"textSecondary",..._,children:C})),I.jsxs(O,{...P,children:[b,C]})});function Ufe(t){return Hr("MuiTooltip",t)}const Tn=br("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function $fe(t){return Math.round(t*1e5)/1e5}const Gfe=t=>{const{classes:e,disableInteractive:r,arrow:n,touch:i,placement:s}=t,o={popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",i&&"touch",`tooltipPlacement${Tt(s.split("-")[0])}`],arrow:["arrow"]};return Gr(o,Ufe,e)},Yfe=gt(ZU,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})($r(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Tn.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Tn.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Tn.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Tn.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Tn.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Tn.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Tn.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Tn.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),qfe=gt("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${Tt(r.placement.split("-")[0])}`]]}})($r(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:Fi(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Tn.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Tn.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Tn.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Tn.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${$fe(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Tn.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Tn.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Tn.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Tn.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Tn.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Tn.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Tn.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Tn.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Tn.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Tn.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),Kfe=gt("span",{name:"MuiTooltip",slot:"Arrow"})($r(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:Fi(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let i1=!1;const kH=new _S;let Sm={x:0,y:0};function s1(t,e){return(r,...n)=>{e&&e(r,...n),t(r,...n)}}const o1=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:s,classes:o,components:a={},componentsProps:l={},describeChild:u=!1,disableFocusListener:h=!1,disableHoverListener:d=!1,disableInteractive:m=!1,disableTouchListener:g=!1,enterDelay:y=100,enterNextDelay:x=0,enterTouchDelay:b=700,followCursor:C=!1,id:E,leaveDelay:R=0,leaveTouchDelay:k=1500,onClose:O,onOpen:P,open:D,placement:H="bottom",PopperComponent:N,PopperProps:_={},slotProps:B={},slots:j={},title:ee,TransitionComponent:oe,TransitionProps:re,...q}=n,Z=Y.isValidElement(s)?s:I.jsx("span",{children:s}),ve=$a(),ie=AS(),[K,ce]=Y.useState(),[S,A]=Y.useState(null),M=Y.useRef(!1),L=m||C,V=Zf(),J=Zf(),ae=Zf(),ue=Zf(),[pe,ke]=ele({controlled:D,default:!1});let z=pe;const Be=OS(E),Fe=Y.useRef(),ze=Ha(()=>{Fe.current!==void 0&&(document.body.style.WebkitUserSelect=Fe.current,Fe.current=void 0),ue.clear()});Y.useEffect(()=>ze,[ze]);const Ge=yt=>{kH.clear(),i1=!0,ke(!0),P&&!z&&P(yt)},Ee=Ha(yt=>{kH.start(800+R,()=>{i1=!1}),ke(!1),O&&z&&O(yt),V.start(ve.transitions.duration.shortest,()=>{M.current=!1})}),Ue=yt=>{M.current&&yt.type!=="touchstart"||(K&&K.removeAttribute("title"),J.clear(),ae.clear(),y||i1&&x?J.start(i1?x:y,()=>{Ge(yt)}):Ge(yt))},st=yt=>{J.clear(),ae.start(R,()=>{Ee(yt)})},[,tt]=Y.useState(!1),at=yt=>{Ip(yt.target)||(tt(!1),st(yt))},je=yt=>{K||ce(yt.currentTarget),Ip(yt.target)&&(tt(!0),Ue(yt))},er=yt=>{M.current=!0;const On=Z.props;On.onTouchStart&&On.onTouchStart(yt)},Nt=yt=>{er(yt),ae.clear(),V.clear(),ze(),Fe.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ue.start(b,()=>{document.body.style.WebkitUserSelect=Fe.current,Ue(yt)})},jt=yt=>{Z.props.onTouchEnd&&Z.props.onTouchEnd(yt),ze(),ae.start(k,()=>{Ee(yt)})};Y.useEffect(()=>{if(!z)return;function yt(On){On.key==="Escape"&&Ee(On)}return document.addEventListener("keydown",yt),()=>{document.removeEventListener("keydown",yt)}},[Ee,z]);const Dt=Ys(iy(Z),ce,r);!ee&&ee!==0&&(z=!1);const Et=Y.useRef(),Ct=yt=>{const On=Z.props;On.onMouseMove&&On.onMouseMove(yt),Sm={x:yt.clientX,y:yt.clientY},Et.current&&Et.current.update()},Rt={},Xe=typeof ee=="string";u?(Rt.title=!z&&Xe&&!d?ee:null,Rt["aria-describedby"]=z?Be:null):(Rt["aria-label"]=Xe?ee:null,Rt["aria-labelledby"]=z&&!Xe?Be:null);const Je={...Rt,...q,...Z.props,className:St(q.className,Z.props.className),onTouchStart:er,ref:Dt,...C?{onMouseMove:Ct}:{}},Lt={};g||(Je.onTouchStart=Nt,Je.onTouchEnd=jt),d||(Je.onMouseOver=s1(Ue,Je.onMouseOver),Je.onMouseLeave=s1(st,Je.onMouseLeave),L||(Lt.onMouseOver=Ue,Lt.onMouseLeave=st)),h||(Je.onFocus=s1(je,Je.onFocus),Je.onBlur=s1(at,Je.onBlur),L||(Lt.onFocus=je,Lt.onBlur=at));const nt={...n,isRtl:ie,arrow:i,disableInteractive:L,placement:H,PopperComponentProp:N,touch:M.current},ct=typeof B.popper=="function"?B.popper(nt):B.popper,ar=Y.useMemo(()=>{var On,We;let yt=[{name:"arrow",enabled:!!S,options:{element:S,padding:4}}];return(On=_.popperOptions)!=null&&On.modifiers&&(yt=yt.concat(_.popperOptions.modifiers)),(We=ct==null?void 0:ct.popperOptions)!=null&&We.modifiers&&(yt=yt.concat(ct.popperOptions.modifiers)),{..._.popperOptions,...ct==null?void 0:ct.popperOptions,modifiers:yt}},[S,_.popperOptions,ct==null?void 0:ct.popperOptions]),vn=Gfe(nt),Br=typeof B.transition=="function"?B.transition(nt):B.transition,qr={slots:{popper:a.Popper,transition:a.Transition??oe,tooltip:a.Tooltip,arrow:a.Arrow,...j},slotProps:{arrow:B.arrow??l.arrow,popper:{..._,...ct??l.popper},tooltip:B.tooltip??l.tooltip,transition:{...re,...Br??l.transition}}},[Wn,Ai]=Zr("popper",{elementType:Yfe,externalForwardedProps:qr,ownerState:nt,className:St(vn.popper,_==null?void 0:_.className)}),[ga,ii]=Zr("transition",{elementType:WO,externalForwardedProps:qr,ownerState:nt}),[So,Xa]=Zr("tooltip",{elementType:qfe,className:vn.tooltip,externalForwardedProps:qr,ownerState:nt}),[Or,zi]=Zr("arrow",{elementType:Kfe,className:vn.arrow,externalForwardedProps:qr,ownerState:nt,ref:A});return I.jsxs(Y.Fragment,{children:[Y.cloneElement(Z,Je),I.jsx(Wn,{as:N??ZU,placement:H,anchorEl:C?{getBoundingClientRect:()=>({top:Sm.y,left:Sm.x,right:Sm.x,bottom:Sm.y,width:0,height:0})}:K,popperRef:Et,open:K?z:!1,id:Be,transition:!0,...Lt,...Ai,popperOptions:ar,children:({TransitionProps:yt})=>I.jsx(ga,{timeout:ve.transitions.duration.shorter,...yt,...ii,children:I.jsxs(So,{...Xa,children:[ee,i?I.jsx(Or,{...zi}):null]})})})]})});function Xfe(t){return Hr("MuiTab",t)}const Do=br("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper","icon"]),Qfe=t=>{const{classes:e,textColor:r,fullWidth:n,wrapped:i,icon:s,label:o,selected:a,disabled:l}=t,u={root:["root",s&&o&&"labelIcon",`textColor${Tt(r)}`,n&&"fullWidth",i&&"wrapped",a&&"selected",l&&"disabled"],icon:["iconWrapper","icon"]};return Gr(u,Xfe,e)},Zfe=gt(ty,{name:"MuiTab",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.label&&r.icon&&e.labelIcon,e[`textColor${Tt(r.textColor)}`],r.fullWidth&&e.fullWidth,r.wrapped&&e.wrapped,{[`& .${Do.iconWrapper}`]:e.iconWrapper},{[`& .${Do.icon}`]:e.icon}]}})($r(({theme:t})=>({...t.typography.button,maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center",lineHeight:1.25,variants:[{props:({ownerState:e})=>e.label&&(e.iconPosition==="top"||e.iconPosition==="bottom"),style:{flexDirection:"column"}},{props:({ownerState:e})=>e.label&&e.iconPosition!=="top"&&e.iconPosition!=="bottom",style:{flexDirection:"row"}},{props:({ownerState:e})=>e.icon&&e.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="top",style:{[`& > .${Do.icon}`]:{marginBottom:6}}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="bottom",style:{[`& > .${Do.icon}`]:{marginTop:6}}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="start",style:{[`& > .${Do.icon}`]:{marginRight:t.spacing(1)}}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="end",style:{[`& > .${Do.icon}`]:{marginLeft:t.spacing(1)}}},{props:{textColor:"inherit"},style:{color:"inherit",opacity:.6,[`&.${Do.selected}`]:{opacity:1},[`&.${Do.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}}},{props:{textColor:"primary"},style:{color:(t.vars||t).palette.text.secondary,[`&.${Do.selected}`]:{color:(t.vars||t).palette.primary.main},[`&.${Do.disabled}`]:{color:(t.vars||t).palette.text.disabled}}},{props:{textColor:"secondary"},style:{color:(t.vars||t).palette.text.secondary,[`&.${Do.selected}`]:{color:(t.vars||t).palette.secondary.main},[`&.${Do.disabled}`]:{color:(t.vars||t).palette.text.disabled}}},{props:({ownerState:e})=>e.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"}},{props:({ownerState:e})=>e.wrapped,style:{fontSize:t.typography.pxToRem(12)}}]}))),Jfe=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiTab"}),{className:i,disabled:s=!1,disableFocusRipple:o=!1,fullWidth:a,icon:l,iconPosition:u="top",indicator:h,label:d,onChange:m,onClick:g,onFocus:y,selected:x,selectionFollowsFocus:b,textColor:C="inherit",value:E,wrapped:R=!1,...k}=n,O={...n,disabled:s,disableFocusRipple:o,selected:x,icon:!!l,iconPosition:u,label:!!d,fullWidth:a,textColor:C,wrapped:R},P=Qfe(O),D=l&&d&&Y.isValidElement(l)?Y.cloneElement(l,{className:St(P.icon,l.props.className)}):l,H=_=>{!x&&m&&m(_,E),g&&g(_)},N=_=>{b&&!x&&m&&m(_,E),y&&y(_)};return I.jsxs(Zfe,{focusRipple:!o,className:St(P.root,i),ref:r,role:"tab","aria-selected":x,disabled:s,onClick:H,onFocus:N,ownerState:O,tabIndex:x?0:-1,...k,children:[u==="top"||u==="start"?I.jsxs(Y.Fragment,{children:[D,d]}):I.jsxs(Y.Fragment,{children:[d,D]}),h]})}),ehe=rn(I.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),the=rn(I.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}));function rhe(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2}function nhe(t,e,r,n={},i=()=>{}){const{ease:s=rhe,duration:o=300}=n;let a=null;const l=e[t];let u=!1;const h=()=>{u=!0},d=m=>{if(u){i(new Error("Animation cancelled"));return}a===null&&(a=m);const g=Math.min(1,(m-a)/o);if(e[t]=s(g)*(r-l)+l,g>=1){requestAnimationFrame(()=>{i(null)});return}requestAnimationFrame(d)};return l===r?(i(new Error("Element already at target position")),h):(requestAnimationFrame(d),h)}const ihe={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function she(t){const{onChange:e,...r}=t,n=Y.useRef(),i=Y.useRef(null),s=()=>{n.current=i.current.offsetHeight-i.current.clientHeight};return gh(()=>{const o=PU(()=>{const l=n.current;s(),l!==n.current&&e(n.current)}),a=Dp(i.current);return a.addEventListener("resize",o),()=>{o.clear(),a.removeEventListener("resize",o)}},[e]),Y.useEffect(()=>{s(),e(n.current)},[e]),I.jsx("div",{style:ihe,...r,ref:i})}function ohe(t){return Hr("MuiTabScrollButton",t)}const ahe=br("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),lhe=t=>{const{classes:e,orientation:r,disabled:n}=t;return Gr({root:["root",r,n&&"disabled"]},ohe,e)},che=gt(ty,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.orientation&&e[r.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${ahe.disabled}`]:{opacity:0},variants:[{props:{orientation:"vertical"},style:{width:"100%",height:40,"& svg":{transform:"var(--TabScrollButton-svgRotate)"}}}]}),uhe=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiTabScrollButton"}),{className:i,slots:s={},slotProps:o={},direction:a,orientation:l,disabled:u,...h}=n,d=AS(),m={isRtl:d,...n},g=lhe(m),y=s.StartScrollButtonIcon??ehe,x=s.EndScrollButtonIcon??the,b=iv({elementType:y,externalSlotProps:o.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:m}),C=iv({elementType:x,externalSlotProps:o.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:m});return I.jsx(che,{component:"div",className:St(g.root,i),ref:r,role:null,ownerState:m,tabIndex:null,...h,style:{...h.style,...l==="vertical"&&{"--TabScrollButton-svgRotate":`rotate(${d?-90:90}deg)`}},children:a==="left"?I.jsx(y,{...b}):I.jsx(x,{...C})})});function fhe(t){return Hr("MuiTabs",t)}const KE=br("MuiTabs",["root","vertical","list","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),OH=(t,e)=>t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:t.firstChild,_H=(t,e)=>t===e?t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:t.lastChild,a1=(t,e,r)=>{let n=!1,i=r(t,e);for(;i;){if(i===t.firstChild){if(n)return;n=!0}const s=i.disabled||i.getAttribute("aria-disabled")==="true";if(!i.hasAttribute("tabindex")||s)i=r(t,i);else{i.focus();return}}},hhe=t=>{const{vertical:e,fixed:r,hideScrollbar:n,scrollableX:i,scrollableY:s,centered:o,scrollButtonsHideMobile:a,classes:l}=t;return Gr({root:["root",e&&"vertical"],scroller:["scroller",r&&"fixed",n&&"hideScrollbar",i&&"scrollableX",s&&"scrollableY"],list:["list","flexContainer",e&&"flexContainerVertical",e&&"vertical",o&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",a&&"scrollButtonsHideMobile"],scrollableX:[i&&"scrollableX"],hideScrollbar:[n&&"hideScrollbar"]},fhe,l)},dhe=gt("div",{name:"MuiTabs",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${KE.scrollButtons}`]:e.scrollButtons},{[`& .${KE.scrollButtons}`]:r.scrollButtonsHideMobile&&e.scrollButtonsHideMobile},e.root,r.vertical&&e.vertical]}})($r(({theme:t})=>({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex",variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:"column"}},{props:({ownerState:e})=>e.scrollButtonsHideMobile,style:{[`& .${KE.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}}}]}))),phe=gt("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.scroller,r.fixed&&e.fixed,r.hideScrollbar&&e.hideScrollbar,r.scrollableX&&e.scrollableX,r.scrollableY&&e.scrollableY]}})({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap",variants:[{props:({ownerState:t})=>t.fixed,style:{overflowX:"hidden",width:"100%"}},{props:({ownerState:t})=>t.hideScrollbar,style:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}},{props:({ownerState:t})=>t.scrollableX,style:{overflowX:"auto",overflowY:"hidden"}},{props:({ownerState:t})=>t.scrollableY,style:{overflowY:"auto",overflowX:"hidden"}}]}),mhe=gt("div",{name:"MuiTabs",slot:"List",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.list,e.flexContainer,r.vertical&&e.flexContainerVertical,r.centered&&e.centered]}})({display:"flex",variants:[{props:({ownerState:t})=>t.vertical,style:{flexDirection:"column"}},{props:({ownerState:t})=>t.centered,style:{justifyContent:"center"}}]}),ghe=gt("span",{name:"MuiTabs",slot:"Indicator"})($r(({theme:t})=>({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create(),variants:[{props:{indicatorColor:"primary"},style:{backgroundColor:(t.vars||t).palette.primary.main}},{props:{indicatorColor:"secondary"},style:{backgroundColor:(t.vars||t).palette.secondary.main}},{props:({ownerState:e})=>e.vertical,style:{height:"100%",width:2,right:0}}]}))),vhe=gt(she)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),MH={},yhe=Y.forwardRef(function(e,r){const n=Ar({props:e,name:"MuiTabs"}),i=$a(),s=AS(),{"aria-label":o,"aria-labelledby":a,action:l,centered:u=!1,children:h,className:d,component:m="div",allowScrollButtonsMobile:g=!1,indicatorColor:y="primary",onChange:x,orientation:b="horizontal",ScrollButtonComponent:C,scrollButtons:E="auto",selectionFollowsFocus:R,slots:k={},slotProps:O={},TabIndicatorProps:P={},TabScrollButtonProps:D={},textColor:H="primary",value:N,variant:_="standard",visibleScrollbar:B=!1,...j}=n,ee=_==="scrollable",oe=b==="vertical",re=oe?"scrollTop":"scrollLeft",q=oe?"top":"left",Z=oe?"bottom":"right",ve=oe?"clientHeight":"clientWidth",ie=oe?"height":"width",K={...n,component:m,allowScrollButtonsMobile:g,indicatorColor:y,orientation:b,vertical:oe,scrollButtons:E,textColor:H,variant:_,visibleScrollbar:B,fixed:!ee,hideScrollbar:ee&&!B,scrollableX:ee&&!oe,scrollableY:ee&&oe,centered:u&&!ee,scrollButtonsHideMobile:!g},ce=hhe(K),S=iv({elementType:k.StartScrollButtonIcon,externalSlotProps:O.startScrollButtonIcon,ownerState:K}),A=iv({elementType:k.EndScrollButtonIcon,externalSlotProps:O.endScrollButtonIcon,ownerState:K}),[M,L]=Y.useState(!1),[V,J]=Y.useState(MH),[ae,ue]=Y.useState(!1),[pe,ke]=Y.useState(!1),[z,Be]=Y.useState(!1),[Fe,ze]=Y.useState({overflow:"hidden",scrollbarWidth:0}),Ge=new Map,Ee=Y.useRef(null),Ue=Y.useRef(null),st={slots:k,slotProps:{indicator:P,scrollButton:D,...O}},tt=()=>{const We=Ee.current;let qe;if(We){const ht=We.getBoundingClientRect();qe={clientWidth:We.clientWidth,scrollLeft:We.scrollLeft,scrollTop:We.scrollTop,scrollWidth:We.scrollWidth,top:ht.top,bottom:ht.bottom,left:ht.left,right:ht.right}}let ut;if(We&&N!==!1){const ht=Ue.current.children;if(ht.length>0){const Ot=ht[Ge.get(N)];ut=Ot?Ot.getBoundingClientRect():null}}return{tabsMeta:qe,tabMeta:ut}},at=Ha(()=>{const{tabsMeta:We,tabMeta:qe}=tt();let ut=0,ht;oe?(ht="top",qe&&We&&(ut=qe.top-We.top+We.scrollTop)):(ht=s?"right":"left",qe&&We&&(ut=(s?-1:1)*(qe[ht]-We[ht]+We.scrollLeft)));const Ot={[ht]:ut,[ie]:qe?qe[ie]:0};if(typeof V[ht]!="number"||typeof V[ie]!="number")J(Ot);else{const hn=Math.abs(V[ht]-Ot[ht]),Ts=Math.abs(V[ie]-Ot[ie]);(hn>=1||Ts>=1)&&J(Ot)}}),je=(We,{animation:qe=!0}={})=>{qe?nhe(re,Ee.current,We,{duration:i.transitions.duration.standard}):Ee.current[re]=We},er=We=>{let qe=Ee.current[re];oe?qe+=We:qe+=We*(s?-1:1),je(qe)},Nt=()=>{const We=Ee.current[ve];let qe=0;const ut=Array.from(Ue.current.children);for(let ht=0;ht<ut.length;ht+=1){const Ot=ut[ht];if(qe+Ot[ve]>We){ht===0&&(qe=We);break}qe+=Ot[ve]}return qe},jt=()=>{er(-1*Nt())},Dt=()=>{er(Nt())},[Et,{onChange:Ct,...Rt}]=Zr("scrollbar",{className:St(ce.scrollableX,ce.hideScrollbar),elementType:vhe,shouldForwardComponentProp:!0,externalForwardedProps:st,ownerState:K}),Xe=Y.useCallback(We=>{Ct==null||Ct(We),ze({overflow:null,scrollbarWidth:We})},[Ct]),[Je,Lt]=Zr("scrollButtons",{className:St(ce.scrollButtons,D.className),elementType:uhe,externalForwardedProps:st,ownerState:K,additionalProps:{orientation:b,slots:{StartScrollButtonIcon:k.startScrollButtonIcon||k.StartScrollButtonIcon,EndScrollButtonIcon:k.endScrollButtonIcon||k.EndScrollButtonIcon},slotProps:{startScrollButtonIcon:S,endScrollButtonIcon:A}}}),nt=()=>{const We={};We.scrollbarSizeListener=ee?I.jsx(Et,{...Rt,onChange:Xe}):null;const ut=ee&&(E==="auto"&&(ae||pe)||E===!0);return We.scrollButtonStart=ut?I.jsx(Je,{direction:s?"right":"left",onClick:jt,disabled:!ae,...Lt}):null,We.scrollButtonEnd=ut?I.jsx(Je,{direction:s?"left":"right",onClick:Dt,disabled:!pe,...Lt}):null,We},ct=Ha(We=>{const{tabsMeta:qe,tabMeta:ut}=tt();if(!(!ut||!qe)){if(ut[q]<qe[q]){const ht=qe[re]+(ut[q]-qe[q]);je(ht,{animation:We})}else if(ut[Z]>qe[Z]){const ht=qe[re]+(ut[Z]-qe[Z]);je(ht,{animation:We})}}}),ar=Ha(()=>{ee&&E!==!1&&Be(!z)});Y.useEffect(()=>{const We=PU(()=>{Ee.current&&at()});let qe;const ut=hn=>{hn.forEach(Ts=>{Ts.removedNodes.forEach(W=>{qe==null||qe.unobserve(W)}),Ts.addedNodes.forEach(W=>{qe==null||qe.observe(W)})}),We(),ar()},ht=Dp(Ee.current);ht.addEventListener("resize",We);let Ot;return typeof ResizeObserver<"u"&&(qe=new ResizeObserver(We),Array.from(Ue.current.children).forEach(hn=>{qe.observe(hn)})),typeof MutationObserver<"u"&&(Ot=new MutationObserver(ut),Ot.observe(Ue.current,{childList:!0})),()=>{We.clear(),ht.removeEventListener("resize",We),Ot==null||Ot.disconnect(),qe==null||qe.disconnect()}},[at,ar]),Y.useEffect(()=>{const We=Array.from(Ue.current.children),qe=We.length;if(typeof IntersectionObserver<"u"&&qe>0&&ee&&E!==!1){const ut=We[0],ht=We[qe-1],Ot={root:Ee.current,threshold:.99},hn=X=>{ue(!X[0].isIntersecting)},Ts=new IntersectionObserver(hn,Ot);Ts.observe(ut);const W=X=>{ke(!X[0].isIntersecting)},te=new IntersectionObserver(W,Ot);return te.observe(ht),()=>{Ts.disconnect(),te.disconnect()}}},[ee,E,z,h==null?void 0:h.length]),Y.useEffect(()=>{L(!0)},[]),Y.useEffect(()=>{at()}),Y.useEffect(()=>{ct(MH!==V)},[ct,V]),Y.useImperativeHandle(l,()=>({updateIndicator:at,updateScrollButtons:ar}),[at,ar]);const[vn,Br]=Zr("indicator",{className:St(ce.indicator,P.className),elementType:ghe,externalForwardedProps:st,ownerState:K,additionalProps:{style:V}}),qr=I.jsx(vn,{...Br});let Wn=0;const Ai=Y.Children.map(h,We=>{if(!Y.isValidElement(We))return null;const qe=We.props.value===void 0?Wn:We.props.value;Ge.set(qe,Wn);const ut=qe===N;return Wn+=1,Y.cloneElement(We,{fullWidth:_==="fullWidth",indicator:ut&&!M&&qr,selected:ut,selectionFollowsFocus:R,onChange:x,textColor:H,value:qe,...Wn===1&&N===!1&&!We.props.tabIndex?{tabIndex:0}:{}})}),ga=We=>{if(We.altKey||We.shiftKey||We.ctrlKey||We.metaKey)return;const qe=Ue.current,ut=Pl(qe).activeElement;if(ut.getAttribute("role")!=="tab")return;let Ot=b==="horizontal"?"ArrowLeft":"ArrowUp",hn=b==="horizontal"?"ArrowRight":"ArrowDown";switch(b==="horizontal"&&s&&(Ot="ArrowRight",hn="ArrowLeft"),We.key){case Ot:We.preventDefault(),a1(qe,ut,_H);break;case hn:We.preventDefault(),a1(qe,ut,OH);break;case"Home":We.preventDefault(),a1(qe,null,OH);break;case"End":We.preventDefault(),a1(qe,null,_H);break}},ii=nt(),[So,Xa]=Zr("root",{ref:r,className:St(ce.root,d),elementType:dhe,externalForwardedProps:{...st,...j,component:m},ownerState:K}),[Or,zi]=Zr("scroller",{ref:Ee,className:ce.scroller,elementType:phe,externalForwardedProps:st,ownerState:K,additionalProps:{style:{overflow:Fe.overflow,[oe?`margin${s?"Left":"Right"}`:"marginBottom"]:B?void 0:-Fe.scrollbarWidth}}}),[yt,On]=Zr("list",{ref:Ue,className:St(ce.list,ce.flexContainer),elementType:mhe,externalForwardedProps:st,ownerState:K,getSlotProps:We=>({...We,onKeyDown:qe=>{var ut;ga(qe),(ut=We.onKeyDown)==null||ut.call(We,qe)}})});return I.jsxs(So,{...Xa,children:[ii.scrollButtonStart,ii.scrollbarSizeListener,I.jsxs(Or,{...zi,children:[I.jsx(yt,{"aria-label":o,"aria-labelledby":a,"aria-orientation":b==="vertical"?"vertical":null,role:"tablist",...On,children:Ai}),M&&qr]}),ii.scrollButtonEnd]})}),xhe=rn(I.jsx("path",{d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"})),whe=rn(I.jsx("path",{d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"})),bhe=rn(I.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),She=rn(I.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),Che=rn(I.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})),MD=Y.createContext({});function DD(t){const e=Y.useRef(null);return e.current===null&&(e.current=t()),e.current}const PD=typeof window<"u",r$=PD?Y.useLayoutEffect:Y.useEffect,DS=Y.createContext(null);function ID(t,e){t.indexOf(e)===-1&&t.push(e)}function ND(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const Dc=(t,e,r)=>r>e?e:r<t?t:r;let LD=()=>{};const Pc={},n$=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function i$(t){return typeof t=="object"&&t!==null}const s$=t=>/^0[^.\s]+$/u.test(t);function FD(t){let e;return()=>(e===void 0&&(e=t()),e)}const ea=t=>t,The=(t,e)=>r=>e(t(r)),sy=(...t)=>t.reduce(The),sv=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class HD{constructor(){this.subscriptions=[]}add(e){return ID(this.subscriptions,e),()=>ND(this.subscriptions,e)}notify(e,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,r,n);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ol=t=>t*1e3,_l=t=>t/1e3;function o$(t,e){return e?t*(1e3/e):0}const a$=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,Ehe=1e-7,Rhe=12;function Ahe(t,e,r,n,i){let s,o,a=0;do o=e+(r-e)/2,s=a$(o,n,i)-t,s>0?r=o:e=o;while(Math.abs(s)>Ehe&&++a<Rhe);return o}function oy(t,e,r,n){if(t===e&&r===n)return ea;const i=s=>Ahe(s,0,1,t,r);return s=>s===0||s===1?s:a$(i(s),e,n)}const l$=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,c$=t=>e=>1-t(1-e),u$=oy(.33,1.53,.69,.99),BD=c$(u$),f$=l$(BD),h$=t=>(t*=2)<1?.5*BD(t):.5*(2-Math.pow(2,-10*(t-1))),VD=t=>1-Math.sin(Math.acos(t)),d$=c$(VD),p$=l$(VD),khe=oy(.42,0,1,1),Ohe=oy(0,0,.58,1),m$=oy(.42,0,.58,1),_he=t=>Array.isArray(t)&&typeof t[0]!="number",g$=t=>Array.isArray(t)&&typeof t[0]=="number",Mhe={linear:ea,easeIn:khe,easeInOut:m$,easeOut:Ohe,circIn:VD,circInOut:p$,circOut:d$,backIn:BD,backInOut:f$,backOut:u$,anticipate:h$},Dhe=t=>typeof t=="string",DH=t=>{if(g$(t)){LD(t.length===4);const[e,r,n,i]=t;return oy(e,r,n,i)}else if(Dhe(t))return Mhe[t];return t},l1=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],PH={value:null};function Phe(t,e){let r=new Set,n=new Set,i=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function u(d){o.has(d)&&(h.schedule(d),t()),l++,d(a)}const h={schedule:(d,m=!1,g=!1)=>{const x=g&&i?r:n;return m&&o.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),o.delete(d)},process:d=>{if(a=d,i){s=!0;return}i=!0,[r,n]=[n,r],r.forEach(u),e&&PH.value&&PH.value.frameloop[e].push(l),l=0,r.clear(),i=!1,s&&(s=!1,h.process(d))}};return h}const Ihe=40;function v$(t,e){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,o=l1.reduce((R,k)=>(R[k]=Phe(s,e?k:void 0),R),{}),{setup:a,read:l,resolveKeyframes:u,preUpdate:h,update:d,preRender:m,render:g,postRender:y}=o,x=()=>{const R=Pc.useManualTiming?i.timestamp:performance.now();r=!1,Pc.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(R-i.timestamp,Ihe),1)),i.timestamp=R,i.isProcessing=!0,a.process(i),l.process(i),u.process(i),h.process(i),d.process(i),m.process(i),g.process(i),y.process(i),i.isProcessing=!1,r&&e&&(n=!1,t(x))},b=()=>{r=!0,n=!0,i.isProcessing||t(x)};return{schedule:l1.reduce((R,k)=>{const O=o[k];return R[k]=(P,D=!1,H=!1)=>(r||b(),O.schedule(P,D,H)),R},{}),cancel:R=>{for(let k=0;k<l1.length;k++)o[l1[k]].cancel(R)},state:i,steps:o}}const{schedule:gn,cancel:Wu,state:Di,steps:XE}=v$(typeof requestAnimationFrame<"u"?requestAnimationFrame:ea,!0);let Nw;function Nhe(){Nw=void 0}const Vs={now:()=>(Nw===void 0&&Vs.set(Di.isProcessing||Pc.useManualTiming?Di.timestamp:performance.now()),Nw),set:t=>{Nw=t,queueMicrotask(Nhe)}},y$=t=>e=>typeof e=="string"&&e.startsWith(t),jD=y$("--"),Lhe=y$("var(--"),WD=t=>Lhe(t)?Fhe.test(t.split("/*")[0].trim()):!1,Fhe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,i0={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},ov={...i0,transform:t=>Dc(0,1,t)},c1={...i0,default:1},Cg=t=>Math.round(t*1e5)/1e5,zD=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Hhe(t){return t==null}const Bhe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,UD=(t,e)=>r=>!!(typeof r=="string"&&Bhe.test(r)&&r.startsWith(t)||e&&!Hhe(r)&&Object.prototype.hasOwnProperty.call(r,e)),x$=(t,e,r)=>n=>{if(typeof n!="string")return n;const[i,s,o,a]=n.match(zD);return{[t]:parseFloat(i),[e]:parseFloat(s),[r]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Vhe=t=>Dc(0,255,t),QE={...i0,transform:t=>Math.round(Vhe(t))},Jf={test:UD("rgb","red"),parse:x$("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+QE.transform(t)+", "+QE.transform(e)+", "+QE.transform(r)+", "+Cg(ov.transform(n))+")"};function jhe(t){let e="",r="",n="",i="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,r+=r,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const zO={test:UD("#"),parse:jhe,transform:Jf.transform},ay=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),xu=ay("deg"),Ml=ay("%"),wt=ay("px"),Whe=ay("vh"),zhe=ay("vw"),IH={...Ml,parse:t=>Ml.parse(t)/100,transform:t=>Ml.transform(t*100)},np={test:UD("hsl","hue"),parse:x$("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Ml.transform(Cg(e))+", "+Ml.transform(Cg(r))+", "+Cg(ov.transform(n))+")"},Zn={test:t=>Jf.test(t)||zO.test(t)||np.test(t),parse:t=>Jf.test(t)?Jf.parse(t):np.test(t)?np.parse(t):zO.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Jf.transform(t):np.transform(t),getAnimatableNone:t=>{const e=Zn.parse(t);return e.alpha=0,Zn.transform(e)}},Uhe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function $he(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(zD))==null?void 0:e.length)||0)+(((r=t.match(Uhe))==null?void 0:r.length)||0)>0}const w$="number",b$="color",Ghe="var",Yhe="var(",NH="${}",qhe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function av(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},i=[];let s=0;const a=e.replace(qhe,l=>(Zn.test(l)?(n.color.push(s),i.push(b$),r.push(Zn.parse(l))):l.startsWith(Yhe)?(n.var.push(s),i.push(Ghe),r.push(l)):(n.number.push(s),i.push(w$),r.push(parseFloat(l))),++s,NH)).split(NH);return{values:r,split:a,indexes:n,types:i}}function S$(t){return av(t).values}function C$(t){const{split:e,types:r}=av(t),n=e.length;return i=>{let s="";for(let o=0;o<n;o++)if(s+=e[o],i[o]!==void 0){const a=r[o];a===w$?s+=Cg(i[o]):a===b$?s+=Zn.transform(i[o]):s+=i[o]}return s}}const Khe=t=>typeof t=="number"?0:Zn.test(t)?Zn.getAnimatableNone(t):t;function Xhe(t){const e=S$(t);return C$(t)(e.map(Khe))}const zu={test:$he,parse:S$,createTransformer:C$,getAnimatableNone:Xhe};function ZE(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Qhe({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let i=0,s=0,o=0;if(!e)i=s=o=r;else{const a=r<.5?r*(1+e):r+e-r*e,l=2*r-a;i=ZE(l,a,t+1/3),s=ZE(l,a,t),o=ZE(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:n}}function db(t,e){return r=>r>0?e:t}const mn=(t,e,r)=>t+(e-t)*r,JE=(t,e,r)=>{const n=t*t,i=r*(e*e-n)+n;return i<0?0:Math.sqrt(i)},Zhe=[zO,Jf,np],Jhe=t=>Zhe.find(e=>e.test(t));function LH(t){const e=Jhe(t);if(!e)return!1;let r=e.parse(t);return e===np&&(r=Qhe(r)),r}const FH=(t,e)=>{const r=LH(t),n=LH(e);if(!r||!n)return db(t,e);const i={...r};return s=>(i.red=JE(r.red,n.red,s),i.green=JE(r.green,n.green,s),i.blue=JE(r.blue,n.blue,s),i.alpha=mn(r.alpha,n.alpha,s),Jf.transform(i))},UO=new Set(["none","hidden"]);function ede(t,e){return UO.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function tde(t,e){return r=>mn(t,e,r)}function $D(t){return typeof t=="number"?tde:typeof t=="string"?WD(t)?db:Zn.test(t)?FH:ide:Array.isArray(t)?T$:typeof t=="object"?Zn.test(t)?FH:rde:db}function T$(t,e){const r=[...t],n=r.length,i=t.map((s,o)=>$D(s)(s,e[o]));return s=>{for(let o=0;o<n;o++)r[o]=i[o](s);return r}}function rde(t,e){const r={...t,...e},n={};for(const i in r)t[i]!==void 0&&e[i]!==void 0&&(n[i]=$D(t[i])(t[i],e[i]));return i=>{for(const s in n)r[s]=n[s](i);return r}}function nde(t,e){const r=[],n={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const s=e.types[i],o=t.indexes[s][n[s]],a=t.values[o]??0;r[i]=a,n[s]++}return r}const ide=(t,e)=>{const r=zu.createTransformer(e),n=av(t),i=av(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?UO.has(t)&&!i.values.length||UO.has(e)&&!n.values.length?ede(t,e):sy(T$(nde(n,i),i.values),r):db(t,e)};function E$(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?mn(t,e,r):$D(t)(t,e)}const sde=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>gn.update(e,r),stop:()=>Wu(e),now:()=>Di.isProcessing?Di.timestamp:Vs.now()}},R$=(t,e,r=10)=>{let n="";const i=Math.max(Math.round(e/r),2);for(let s=0;s<i;s++)n+=Math.round(t(s/(i-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},pb=2e4;function GD(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<pb;)e+=r,n=t.next(e);return e>=pb?1/0:e}function ode(t,e=100,r){const n=r({...t,keyframes:[0,e]}),i=Math.min(GD(n),pb);return{type:"keyframes",ease:s=>n.next(i*s).value/e,duration:_l(i)}}const ade=5;function A$(t,e,r){const n=Math.max(e-ade,0);return o$(r-t(n),e-n)}const En={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},eR=.001;function lde({duration:t=En.duration,bounce:e=En.bounce,velocity:r=En.velocity,mass:n=En.mass}){let i,s,o=1-e;o=Dc(En.minDamping,En.maxDamping,o),t=Dc(En.minDuration,En.maxDuration,_l(t)),o<1?(i=u=>{const h=u*o,d=h*t,m=h-r,g=$O(u,o),y=Math.exp(-d);return eR-m/g*y},s=u=>{const d=u*o*t,m=d*r+r,g=Math.pow(o,2)*Math.pow(u,2)*t,y=Math.exp(-d),x=$O(Math.pow(u,2),o);return(-i(u)+eR>0?-1:1)*((m-g)*y)/x}):(i=u=>{const h=Math.exp(-u*t),d=(u-r)*t+1;return-eR+h*d},s=u=>{const h=Math.exp(-u*t),d=(r-u)*(t*t);return h*d});const a=5/t,l=ude(i,s,a);if(t=Ol(t),isNaN(l))return{stiffness:En.stiffness,damping:En.damping,duration:t};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:o*2*Math.sqrt(n*u),duration:t}}}const cde=12;function ude(t,e,r){let n=r;for(let i=1;i<cde;i++)n=n-t(n)/e(n);return n}function $O(t,e){return t*Math.sqrt(1-e*e)}const fde=["duration","bounce"],hde=["stiffness","damping","mass"];function HH(t,e){return e.some(r=>t[r]!==void 0)}function dde(t){let e={velocity:En.velocity,stiffness:En.stiffness,damping:En.damping,mass:En.mass,isResolvedFromDuration:!1,...t};if(!HH(t,hde)&&HH(t,fde))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),i=n*n,s=2*Dc(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:En.mass,stiffness:i,damping:s}}else{const r=lde(t);e={...e,...r,mass:En.mass},e.isResolvedFromDuration=!0}return e}function mb(t=En.visualDuration,e=En.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=r;const s=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:u,mass:h,duration:d,velocity:m,isResolvedFromDuration:g}=dde({...r,velocity:-_l(r.velocity||0)}),y=m||0,x=u/(2*Math.sqrt(l*h)),b=o-s,C=_l(Math.sqrt(l/h)),E=Math.abs(b)<5;n||(n=E?En.restSpeed.granular:En.restSpeed.default),i||(i=E?En.restDelta.granular:En.restDelta.default);let R;if(x<1){const O=$O(C,x);R=P=>{const D=Math.exp(-x*C*P);return o-D*((y+x*C*b)/O*Math.sin(O*P)+b*Math.cos(O*P))}}else if(x===1)R=O=>o-Math.exp(-C*O)*(b+(y+C*b)*O);else{const O=C*Math.sqrt(x*x-1);R=P=>{const D=Math.exp(-x*C*P),H=Math.min(O*P,300);return o-D*((y+x*C*b)*Math.sinh(H)+O*b*Math.cosh(H))/O}}const k={calculatedDuration:g&&d||null,next:O=>{const P=R(O);if(g)a.done=O>=d;else{let D=O===0?y:0;x<1&&(D=O===0?Ol(y):A$(R,O,P));const H=Math.abs(D)<=n,N=Math.abs(o-P)<=i;a.done=H&&N}return a.value=a.done?o:P,a},toString:()=>{const O=Math.min(GD(k),pb),P=R$(D=>k.next(O*D).value,O,30);return O+"ms "+P},toTransition:()=>{}};return k}mb.applyToOptions=t=>{const e=ode(t,100,mb);return t.ease=e.ease,t.duration=Ol(e.duration),t.type="keyframes",t};function GO({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:u=.5,restSpeed:h}){const d=t[0],m={done:!1,value:d},g=H=>a!==void 0&&H<a||l!==void 0&&H>l,y=H=>a===void 0?l:l===void 0||Math.abs(a-H)<Math.abs(l-H)?a:l;let x=r*e;const b=d+x,C=o===void 0?b:o(b);C!==b&&(x=C-d);const E=H=>-x*Math.exp(-H/n),R=H=>C+E(H),k=H=>{const N=E(H),_=R(H);m.done=Math.abs(N)<=u,m.value=m.done?C:_};let O,P;const D=H=>{g(m.value)&&(O=H,P=mb({keyframes:[m.value,y(m.value)],velocity:A$(R,H,m.value),damping:i,stiffness:s,restDelta:u,restSpeed:h}))};return D(0),{calculatedDuration:null,next:H=>{let N=!1;return!P&&O===void 0&&(N=!0,k(H),D(H)),O!==void 0&&H>=O?P.next(H-O):(!N&&k(H),m)}}}function pde(t,e,r){const n=[],i=r||Pc.mix||E$,s=t.length-1;for(let o=0;o<s;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ea:e;a=sy(l,a)}n.push(a)}return n}function mde(t,e,{clamp:r=!0,ease:n,mixer:i}={}){const s=t.length;if(LD(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=pde(e,n,i),l=a.length,u=h=>{if(o&&h<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(h<t[d+1]);d++);const m=sv(t[d],t[d+1],h);return a[d](m)};return r?h=>u(Dc(t[0],t[s-1],h)):u}function gde(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const i=sv(0,e,n);t.push(mn(r,1,i))}}function vde(t){const e=[0];return gde(e,t.length-1),e}function yde(t,e){return t.map(r=>r*e)}function xde(t,e){return t.map(()=>e||m$).splice(0,t.length-1)}function Tg({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const i=_he(n)?n.map(DH):DH(n),s={done:!1,value:e[0]},o=yde(r&&r.length===e.length?r:vde(e),t),a=mde(o,e,{ease:Array.isArray(i)?i:xde(e,i)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}const wde=t=>t!==null;function YD(t,{repeat:e,repeatType:r="loop"},n,i=1){const s=t.filter(wde),a=i<0||e&&r!=="loop"&&e%2===1?0:s.length-1;return!a||n===void 0?s[a]:n}const bde={decay:GO,inertia:GO,tween:Tg,keyframes:Tg,spring:mb};function k$(t){typeof t.type=="string"&&(t.type=bde[t.type])}class qD{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const Sde=t=>t/100;class KD extends qD{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,i;const{motionValue:r}=this.options;r&&r.updatedAt!==Vs.now()&&this.tick(Vs.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(n=this.options).onStop)==null||i.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;k$(e);const{type:r=Tg,repeat:n=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=e;let{keyframes:a}=e;const l=r||Tg;l!==Tg&&typeof a[0]!="number"&&(this.mixKeyframes=sy(Sde,E$(a[0],a[1])),a=[0,100]);const u=l({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=GD(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=u}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:i,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:h,repeat:d,repeatType:m,repeatDelay:g,type:y,onUpdate:x,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),E=this.playbackSpeed>=0?C<0:C>i;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let R=this.currentTime,k=n;if(d){const H=Math.min(this.currentTime,i)/a;let N=Math.floor(H),_=H%1;!_&&H>=1&&(_=1),_===1&&N--,N=Math.min(N,d+1),!!(N%2)&&(m==="reverse"?(_=1-_,g&&(_-=g/a)):m==="mirror"&&(k=o)),R=Dc(0,1,_)*a}const O=E?{done:!1,value:h[0]}:k.next(R);s&&(O.value=s(O.value));let{done:P}=O;!E&&l!==null&&(P=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return D&&y!==GO&&(O.value=YD(h,this.options,b,this.speed)),x&&x(O.value),D&&this.finish(),O}then(e,r){return this.finished.then(e,r)}get duration(){return _l(this.calculatedDuration)}get time(){return _l(this.currentTime)}set time(e){var r;e=Ol(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Vs.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=_l(this.currentTime))}play(){var i,s;if(this.isStopped)return;const{driver:e=sde,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(s=(i=this.options).onPlay)==null||s.call(i);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Vs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function Cde(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const eh=t=>t*180/Math.PI,YO=t=>{const e=eh(Math.atan2(t[1],t[0]));return qO(e)},Tde={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:YO,rotateZ:YO,skewX:t=>eh(Math.atan(t[1])),skewY:t=>eh(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},qO=t=>(t=t%360,t<0&&(t+=360),t),BH=YO,VH=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),jH=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Ede={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:VH,scaleY:jH,scale:t=>(VH(t)+jH(t))/2,rotateX:t=>qO(eh(Math.atan2(t[6],t[5]))),rotateY:t=>qO(eh(Math.atan2(-t[2],t[0]))),rotateZ:BH,rotate:BH,skewX:t=>eh(Math.atan(t[4])),skewY:t=>eh(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function KO(t){return t.includes("scale")?1:0}function XO(t,e){if(!t||t==="none")return KO(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(r)n=Ede,i=r;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Tde,i=a}if(!i)return KO(e);const s=n[e],o=i[1].split(",").map(Ade);return typeof s=="function"?s(o):o[s]}const Rde=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return XO(r,e)};function Ade(t){return parseFloat(t.trim())}const s0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],o0=new Set(s0),WH=t=>t===i0||t===wt,kde=new Set(["x","y","z"]),Ode=s0.filter(t=>!kde.has(t));function _de(t){const e=[];return Ode.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const lh={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>XO(e,"x"),y:(t,{transform:e})=>XO(e,"y")};lh.translateX=lh.x;lh.translateY=lh.y;const ch=new Set;let QO=!1,ZO=!1,JO=!1;function O$(){if(ZO){const t=Array.from(ch).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const i=_de(n);i.length&&(r.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=r.get(n);i&&i.forEach(([s,o])=>{var a;(a=n.getValue(s))==null||a.set(o)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}ZO=!1,QO=!1,ch.forEach(t=>t.complete(JO)),ch.clear()}function _$(){ch.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(ZO=!0)})}function Mde(){JO=!0,_$(),O$(),JO=!1}class XD{constructor(e,r,n,i,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(ch.add(this),QO||(QO=!0,gn.read(_$),gn.resolveKeyframes(O$))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:i}=this;if(e[0]===null){const s=i==null?void 0:i.get(),o=e[e.length-1];if(s!==void 0)e[0]=s;else if(n&&r){const a=n.readValue(r,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),i&&s===void 0&&i.set(e[0])}Cde(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ch.delete(this)}cancel(){this.state==="scheduled"&&(ch.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Dde=t=>t.startsWith("--");function Pde(t,e,r){Dde(e)?t.style.setProperty(e,r):t.style[e]=r}const Ide=FD(()=>window.ScrollTimeline!==void 0),Nde={};function Lde(t,e){const r=FD(t);return()=>Nde[e]??r()}const M$=Lde(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),og=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,zH={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:og([0,.65,.55,1]),circOut:og([.55,0,1,.45]),backIn:og([.31,.01,.66,-.59]),backOut:og([.33,1.53,.69,.99])};function D$(t,e){if(t)return typeof t=="function"?M$()?R$(t,e):"ease-out":g$(t)?og(t):Array.isArray(t)?t.map(r=>D$(r,e)||zH.easeOut):zH[t]}function Fde(t,e,r,{delay:n=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:l}={},u=void 0){const h={[e]:r};l&&(h.offset=l);const d=D$(a,i);Array.isArray(d)&&(h.easing=d);const m={delay:n,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return u&&(m.pseudoElement=u),t.animate(h,m)}function P$(t){return typeof t=="function"&&"applyToOptions"in t}function Hde({type:t,...e}){return P$(t)&&M$()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Bde extends qD{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:i,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=e,LD(typeof e.type!="string");const u=Hde(e);this.animation=Fde(r,n,i,u,s),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const h=YD(i,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(h):Pde(r,n,h),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return _l(Number(e))}get time(){return _l(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ol(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&Ide()?(this.animation.timeline=e,ea):r(this)}}const I$={anticipate:h$,backInOut:f$,circInOut:p$};function Vde(t){return t in I$}function jde(t){typeof t.ease=="string"&&Vde(t.ease)&&(t.ease=I$[t.ease])}const UH=10;class Wde extends Bde{constructor(e){jde(e),k$(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:i,element:s,...o}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const a=new KD({...o,autoplay:!1}),l=Ol(this.finishedTime??this.time);r.setWithVelocity(a.sample(l-UH).value,a.sample(l).value,UH),a.stop()}}const $H=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(zu.test(t)||t==="0")&&!t.startsWith("url("));function zde(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function Ude(t,e,r,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=t[t.length-1],o=$H(i,e),a=$H(s,e);return!o||!a?!1:zde(t)||(r==="spring"||P$(r))&&n}function QD(t){return i$(t)&&"offsetHeight"in t}const $de=new Set(["opacity","clipPath","filter","transform"]),Gde=FD(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Yde(t){var u;const{motionValue:e,name:r,repeatDelay:n,repeatType:i,damping:s,type:o}=t;if(!QD((u=e==null?void 0:e.owner)==null?void 0:u.current))return!1;const{onUpdate:a,transformTemplate:l}=e.owner.getProps();return Gde()&&r&&$de.has(r)&&(r!=="transform"||!l)&&!a&&!n&&i!=="mirror"&&s!==0&&o!=="inertia"}const qde=40;class Kde extends qD{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:l,motionValue:u,element:h,...d}){var y;super(),this.stop=()=>{var x,b;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(b=this.keyframeResolver)==null||b.cancel()},this.createdAt=Vs.now();const m={autoplay:e,delay:r,type:n,repeat:i,repeatDelay:s,repeatType:o,name:l,motionValue:u,element:h,...d},g=(h==null?void 0:h.KeyframeResolver)||XD;this.keyframeResolver=new g(a,(x,b,C)=>this.onKeyframesResolved(x,b,m,!C),l,u,h),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(e,r,n,i){this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:l,isHandoff:u,onUpdate:h}=n;this.resolvedAt=Vs.now(),Ude(e,s,o,a)||((Pc.instantAnimations||!l)&&(h==null||h(YD(e,n,r))),e[0]=e[e.length-1],n.duration=0,n.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>qde?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},g=!u&&Yde(m)?new Wde({...m,element:m.motionValue.owner.current}):new KD(m);g.finished.then(()=>this.notifyFinished()).catch(ea),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),Mde()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Xde=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Qde(t){const e=Xde.exec(t);if(!e)return[,];const[,r,n,i]=e;return[`--${r??n}`,i]}function N$(t,e,r=1){const[n,i]=Qde(t);if(!n)return;const s=window.getComputedStyle(e).getPropertyValue(n);if(s){const o=s.trim();return n$(o)?parseFloat(o):o}return WD(i)?N$(i,e,r+1):i}function ZD(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const L$=new Set(["width","height","top","left","right","bottom",...s0]),Zde={test:t=>t==="auto",parse:t=>t},F$=t=>e=>e.test(t),H$=[i0,wt,Ml,xu,zhe,Whe,Zde],GH=t=>H$.find(F$(t));function Jde(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||s$(t):!0}const epe=new Set(["brightness","contrast","saturate","opacity"]);function tpe(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(zD)||[];if(!n)return t;const i=r.replace(n,"");let s=epe.has(e)?1:0;return n!==r&&(s*=100),e+"("+s+i+")"}const rpe=/\b([a-z-]*)\(.*?\)/gu,e_={...zu,getAnimatableNone:t=>{const e=t.match(rpe);return e?e.map(tpe).join(" "):t}},YH={...i0,transform:Math.round},npe={rotate:xu,rotateX:xu,rotateY:xu,rotateZ:xu,scale:c1,scaleX:c1,scaleY:c1,scaleZ:c1,skew:xu,skewX:xu,skewY:xu,distance:wt,translateX:wt,translateY:wt,translateZ:wt,x:wt,y:wt,z:wt,perspective:wt,transformPerspective:wt,opacity:ov,originX:IH,originY:IH,originZ:wt},JD={borderWidth:wt,borderTopWidth:wt,borderRightWidth:wt,borderBottomWidth:wt,borderLeftWidth:wt,borderRadius:wt,radius:wt,borderTopLeftRadius:wt,borderTopRightRadius:wt,borderBottomRightRadius:wt,borderBottomLeftRadius:wt,width:wt,maxWidth:wt,height:wt,maxHeight:wt,top:wt,right:wt,bottom:wt,left:wt,padding:wt,paddingTop:wt,paddingRight:wt,paddingBottom:wt,paddingLeft:wt,margin:wt,marginTop:wt,marginRight:wt,marginBottom:wt,marginLeft:wt,backgroundPositionX:wt,backgroundPositionY:wt,...npe,zIndex:YH,fillOpacity:ov,strokeOpacity:ov,numOctaves:YH},ipe={...JD,color:Zn,backgroundColor:Zn,outlineColor:Zn,fill:Zn,stroke:Zn,borderColor:Zn,borderTopColor:Zn,borderRightColor:Zn,borderBottomColor:Zn,borderLeftColor:Zn,filter:e_,WebkitFilter:e_},B$=t=>ipe[t];function V$(t,e){let r=B$(t);return r!==e_&&(r=zu),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const spe=new Set(["auto","none","0"]);function ope(t,e,r){let n=0,i;for(;n<t.length&&!i;){const s=t[n];typeof s=="string"&&!spe.has(s)&&av(s).values.length&&(i=t[n]),n++}if(i&&r)for(const s of e)t[s]=V$(r,i)}class ape extends XD{constructor(e,r,n,i,s){super(e,r,n,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),WD(u))){const h=N$(u,r.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!L$.has(n)||e.length!==2)return;const[i,s]=e,o=GH(i),a=GH(s);if(o!==a)if(WH(o)&&WH(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else lh[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let i=0;i<e.length;i++)(e[i]===null||Jde(e[i]))&&n.push(i);n.length&&ope(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=lh[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const i=r[r.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var a;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const i=e.getValue(r);i&&i.jump(this.measuredOrigin,!1);const s=n.length-1,o=n[s];n[s]=lh[r](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function lpe(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const i=(r==null?void 0:r[t])??n.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const j$=(t,e)=>e&&typeof t=="number"?e.transform(t):t,qH=30,cpe=t=>!isNaN(parseFloat(t));class upe{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{var o,a;const s=Vs.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty();i&&((a=this.events.renderRequest)==null||a.notify(this.current))},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Vs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=cpe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new HD);const n=this.events[e].add(r);return e==="change"?()=>{n(),gn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Vs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>qH)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,qH);return o$(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bp(t,e){return new upe(t,e)}const{schedule:eP}=v$(queueMicrotask,!1),_a={x:!1,y:!1};function W$(){return _a.x||_a.y}function fpe(t){return t==="x"||t==="y"?_a[t]?null:(_a[t]=!0,()=>{_a[t]=!1}):_a.x||_a.y?null:(_a.x=_a.y=!0,()=>{_a.x=_a.y=!1})}function z$(t,e){const r=lpe(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[r,i,()=>n.abort()]}function KH(t){return!(t.pointerType==="touch"||W$())}function hpe(t,e,r={}){const[n,i,s]=z$(t,r),o=a=>{if(!KH(a))return;const{target:l}=a,u=e(l,a);if(typeof u!="function"||!l)return;const h=d=>{KH(d)&&(u(d),l.removeEventListener("pointerleave",h))};l.addEventListener("pointerleave",h,i)};return n.forEach(a=>{a.addEventListener("pointerenter",o,i)}),s}const U$=(t,e)=>e?t===e?!0:U$(t,e.parentElement):!1,tP=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,dpe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function ppe(t){return dpe.has(t.tagName)||t.tabIndex!==-1}const Lw=new WeakSet;function XH(t){return e=>{e.key==="Enter"&&t(e)}}function tR(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const mpe=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=XH(()=>{if(Lw.has(r))return;tR(r,"down");const i=XH(()=>{tR(r,"up")}),s=()=>tR(r,"cancel");r.addEventListener("keyup",i,e),r.addEventListener("blur",s,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function QH(t){return tP(t)&&!W$()}function gpe(t,e,r={}){const[n,i,s]=z$(t,r),o=a=>{const l=a.currentTarget;if(!QH(a))return;Lw.add(l);const u=e(l,a),h=(g,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",m),Lw.has(l)&&Lw.delete(l),QH(g)&&typeof u=="function"&&u(g,{success:y})},d=g=>{h(g,l===window||l===document||r.useGlobalTarget||U$(l,g.target))},m=g=>{h(g,!1)};window.addEventListener("pointerup",d,i),window.addEventListener("pointercancel",m,i)};return n.forEach(a=>{(r.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),QD(a)&&(a.addEventListener("focus",u=>mpe(u,i)),!ppe(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function $$(t){return i$(t)&&"ownerSVGElement"in t}function vpe(t){return $$(t)&&t.tagName==="svg"}const ts=t=>!!(t&&t.getVelocity),ype=[...H$,Zn,zu],xpe=t=>ype.find(F$(t)),rP=Y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class wpe extends Y.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,i=QD(n)&&n.offsetWidth||0,s=this.props.sizeRef.current;s.height=r.offsetHeight||0,s.width=r.offsetWidth||0,s.top=r.offsetTop,s.left=r.offsetLeft,s.right=i-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function bpe({children:t,isPresent:e,anchorX:r}){const n=Y.useId(),i=Y.useRef(null),s=Y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=Y.useContext(rP);return Y.useInsertionEffect(()=>{const{width:a,height:l,top:u,left:h,right:d}=s.current;if(e||!i.current||!a||!l)return;const m=r==="left"?`left: ${h}`:`right: ${d}`;i.current.dataset.motionPopId=n;const g=document.createElement("style");return o&&(g.nonce=o),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${l}px !important;
            ${m}px !important;
            top: ${u}px !important;
          }
        `),()=>{document.head.contains(g)&&document.head.removeChild(g)}},[e]),I.jsx(wpe,{isPresent:e,childRef:i,sizeRef:s,children:Y.cloneElement(t,{ref:i})})}const Spe=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:s,mode:o,anchorX:a})=>{const l=DD(Cpe),u=Y.useId();let h=!0,d=Y.useMemo(()=>(h=!1,{id:u,initial:e,isPresent:r,custom:i,onExitComplete:m=>{l.set(m,!0);for(const g of l.values())if(!g)return;n&&n()},register:m=>(l.set(m,!1),()=>l.delete(m))}),[r,l,n]);return s&&h&&(d={...d}),Y.useMemo(()=>{l.forEach((m,g)=>l.set(g,!1))},[r]),Y.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(t=I.jsx(bpe,{isPresent:r,anchorX:a,children:t})),I.jsx(DS.Provider,{value:d,children:t})};function Cpe(){return new Map}function G$(t=!0){const e=Y.useContext(DS);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:i}=e,s=Y.useId();Y.useEffect(()=>{if(t)return i(s)},[t]);const o=Y.useCallback(()=>t&&n&&n(s),[s,n,t]);return!r&&n?[!1,o]:[!0]}const u1=t=>t.key||"";function ZH(t){const e=[];return Y.Children.forEach(t,r=>{Y.isValidElement(r)&&e.push(r)}),e}const Tpe=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1,anchorX:a="left"})=>{const[l,u]=G$(o),h=Y.useMemo(()=>ZH(t),[t]),d=o&&!l?[]:h.map(u1),m=Y.useRef(!0),g=Y.useRef(h),y=DD(()=>new Map),[x,b]=Y.useState(h),[C,E]=Y.useState(h);r$(()=>{m.current=!1,g.current=h;for(let O=0;O<C.length;O++){const P=u1(C[O]);d.includes(P)?y.delete(P):y.get(P)!==!0&&y.set(P,!1)}},[C,d.length,d.join("-")]);const R=[];if(h!==x){let O=[...h];for(let P=0;P<C.length;P++){const D=C[P],H=u1(D);d.includes(H)||(O.splice(P,0,D),R.push(D))}return s==="wait"&&R.length&&(O=R),E(ZH(O)),b(h),null}const{forceRender:k}=Y.useContext(MD);return I.jsx(I.Fragment,{children:C.map(O=>{const P=u1(O),D=o&&!l?!1:h===C||d.includes(P),H=()=>{if(y.has(P))y.set(P,!0);else return;let N=!0;y.forEach(_=>{_||(N=!1)}),N&&(k==null||k(),E(g.current),o&&(u==null||u()),n&&n())};return I.jsx(Spe,{isPresent:D,initial:!m.current||r?void 0:!1,custom:e,presenceAffectsLayout:i,mode:s,onExitComplete:D?void 0:H,anchorX:a,children:O},P)})})},Y$=Y.createContext({strict:!1}),JH={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Vp={};for(const t in JH)Vp[t]={isEnabled:e=>JH[t].some(r=>!!e[r])};function Epe(t){for(const e in t)Vp[e]={...Vp[e],...t[e]}}const Rpe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function gb(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Rpe.has(t)}let q$=t=>!gb(t);function Ape(t){typeof t=="function"&&(q$=e=>e.startsWith("on")?!gb(e):t(e))}try{Ape(require("@emotion/is-prop-valid").default)}catch{}function kpe(t,e,r){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(q$(i)||r===!0&&gb(i)||!e&&!gb(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function Ope(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...n)=>t(...n);return new Proxy(r,{get:(n,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const PS=Y.createContext({});function IS(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function lv(t){return typeof t=="string"||Array.isArray(t)}const nP=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],iP=["initial",...nP];function NS(t){return IS(t.animate)||iP.some(e=>lv(t[e]))}function K$(t){return!!(NS(t)||t.variants)}function _pe(t,e){if(NS(t)){const{initial:r,animate:n}=t;return{initial:r===!1||lv(r)?r:void 0,animate:lv(n)?n:void 0}}return t.inherit!==!1?e:{}}function Mpe(t){const{initial:e,animate:r}=_pe(t,Y.useContext(PS));return Y.useMemo(()=>({initial:e,animate:r}),[eB(e),eB(r)])}function eB(t){return Array.isArray(t)?t.join(" "):t}const Dpe=Symbol.for("motionComponentSymbol");function ip(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Ppe(t,e,r){return Y.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):ip(r)&&(r.current=n))},[e])}const sP=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ipe="framerAppearId",X$="data-"+sP(Ipe),Q$=Y.createContext({});function Npe(t,e,r,n,i){var x,b;const{visualElement:s}=Y.useContext(PS),o=Y.useContext(Y$),a=Y.useContext(DS),l=Y.useContext(rP).reducedMotion,u=Y.useRef(null);n=n||o.renderer,!u.current&&n&&(u.current=n(t,{visualState:e,parent:s,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const h=u.current,d=Y.useContext(Q$);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&Lpe(u.current,r,i,d);const m=Y.useRef(!1);Y.useInsertionEffect(()=>{h&&m.current&&h.update(r,a)});const g=r[X$],y=Y.useRef(!!g&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,g))&&((b=window.MotionHasOptimisedAnimation)==null?void 0:b.call(window,g)));return r$(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),eP.render(h.render),y.current&&h.animationState&&h.animationState.animateChanges())}),Y.useEffect(()=>{h&&(!y.current&&h.animationState&&h.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)==null||C.call(window,g)}),y.current=!1))}),h}function Lpe(t,e,r,n){const{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:u,layoutCrossfade:h}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:Z$(t.parent)),t.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&ip(a),visualElement:t,animationType:typeof s=="string"?s:"both",initialPromotionConfig:n,crossfade:h,layoutScroll:l,layoutRoot:u})}function Z$(t){if(t)return t.options.allowProjection!==!1?t.projection:Z$(t.parent)}function Fpe({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:i}){t&&Epe(t);function s(a,l){let u;const h={...Y.useContext(rP),...a,layoutId:Hpe(a)},{isStatic:d}=h,m=Mpe(a),g=n(a,d);if(!d&&PD){Bpe();const y=Vpe(h);u=y.MeasureLayout,m.visualElement=Npe(i,g,h,e,y.ProjectionNode)}return I.jsxs(PS.Provider,{value:m,children:[u&&m.visualElement?I.jsx(u,{visualElement:m.visualElement,...h}):null,r(i,a,Ppe(g,m.visualElement,l),g,d,m.visualElement)]})}s.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const o=Y.forwardRef(s);return o[Dpe]=i,o}function Hpe({layoutId:t}){const e=Y.useContext(MD).id;return e&&t!==void 0?e+"-"+t:t}function Bpe(t,e){Y.useContext(Y$).strict}function Vpe(t){const{drag:e,layout:r}=Vp;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const cv={};function jpe(t){for(const e in t)cv[e]=t[e],jD(e)&&(cv[e].isCSSVariable=!0)}function J$(t,{layout:e,layoutId:r}){return o0.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!cv[t]||t==="opacity")}const Wpe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zpe=s0.length;function Upe(t,e,r){let n="",i=!0;for(let s=0;s<zpe;s++){const o=s0[s],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||r){const u=j$(a,JD[o]);if(!l){i=!1;const h=Wpe[o]||o;n+=`${h}(${u}) `}r&&(e[o]=u)}}return n=n.trim(),r?n=r(e,i?"":n):i&&(n="none"),n}function oP(t,e,r){const{style:n,vars:i,transformOrigin:s}=t;let o=!1,a=!1;for(const l in e){const u=e[l];if(o0.has(l)){o=!0;continue}else if(jD(l)){i[l]=u;continue}else{const h=j$(u,JD[l]);l.startsWith("origin")?(a=!0,s[l]=h):n[l]=h}}if(e.transform||(o||r?n.transform=Upe(e,t.transform,r):n.transform&&(n.transform="none")),a){const{originX:l="50%",originY:u="50%",originZ:h=0}=s;n.transformOrigin=`${l} ${u} ${h}`}}const aP=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function eG(t,e,r){for(const n in e)!ts(e[n])&&!J$(n,r)&&(t[n]=e[n])}function $pe({transformTemplate:t},e){return Y.useMemo(()=>{const r=aP();return oP(r,e,t),Object.assign({},r.vars,r.style)},[e])}function Gpe(t,e){const r=t.style||{},n={};return eG(n,r,t),Object.assign(n,$pe(t,e)),n}function Ype(t,e){const r={},n=Gpe(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const qpe={offset:"stroke-dashoffset",array:"stroke-dasharray"},Kpe={offset:"strokeDashoffset",array:"strokeDasharray"};function Xpe(t,e,r=1,n=0,i=!0){t.pathLength=1;const s=i?qpe:Kpe;t[s.offset]=wt.transform(-n);const o=wt.transform(e),a=wt.transform(r);t[s.array]=`${o} ${a}`}function tG(t,{attrX:e,attrY:r,attrScale:n,pathLength:i,pathSpacing:s=1,pathOffset:o=0,...a},l,u,h){if(oP(t,a,u),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:m}=t;d.transform&&(m.transform=d.transform,delete d.transform),(m.transform||d.transformOrigin)&&(m.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),m.transform&&(m.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),r!==void 0&&(d.y=r),n!==void 0&&(d.scale=n),i!==void 0&&Xpe(d,i,s,o,!1)}const rG=()=>({...aP(),attrs:{}}),nG=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Qpe(t,e,r,n){const i=Y.useMemo(()=>{const s=rG();return tG(s,e,nG(n),t.transformTemplate,t.style),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};eG(s,t.style,t),i.style={...s,...i.style}}return i}const Zpe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function lP(t){return typeof t!="string"||t.includes("-")?!1:!!(Zpe.indexOf(t)>-1||/[A-Z]/u.test(t))}function Jpe(t=!1){return(r,n,i,{latestValues:s},o)=>{const l=(lP(r)?Qpe:Ype)(n,s,o,r),u=kpe(n,typeof r=="string",t),h=r!==Y.Fragment?{...u,...l,ref:i}:{},{children:d}=n,m=Y.useMemo(()=>ts(d)?d.get():d,[d]);return Y.createElement(r,{...h,children:m})}}function tB(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function cP(t,e,r,n){if(typeof e=="function"){const[i,s]=tB(n);e=e(r!==void 0?r:t.custom,i,s)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,s]=tB(n);e=e(r!==void 0?r:t.custom,i,s)}return e}function Fw(t){return ts(t)?t.get():t}function e0e({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,i){return{latestValues:t0e(r,n,i,t),renderState:e()}}const iG=t=>(e,r)=>{const n=Y.useContext(PS),i=Y.useContext(DS),s=()=>e0e(t,e,n,i);return r?s():DD(s)};function t0e(t,e,r,n){const i={},s=n(t,{});for(const m in s)i[m]=Fw(s[m]);let{initial:o,animate:a}=t;const l=NS(t),u=K$(t);e&&u&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=r?r.initial===!1:!1;h=h||o===!1;const d=h?a:o;if(d&&typeof d!="boolean"&&!IS(d)){const m=Array.isArray(d)?d:[d];for(let g=0;g<m.length;g++){const y=cP(t,m[g]);if(y){const{transitionEnd:x,transition:b,...C}=y;for(const E in C){let R=C[E];if(Array.isArray(R)){const k=h?R.length-1:0;R=R[k]}R!==null&&(i[E]=R)}for(const E in x)i[E]=x[E]}}}return i}function uP(t,e,r){var s;const{style:n}=t,i={};for(const o in n)(ts(n[o])||e.style&&ts(e.style[o])||J$(o,t)||((s=r==null?void 0:r.getValue(o))==null?void 0:s.liveStyle)!==void 0)&&(i[o]=n[o]);return i}const r0e={useVisualState:iG({scrapeMotionValuesFromProps:uP,createRenderState:aP})};function sG(t,e,r){const n=uP(t,e,r);for(const i in t)if(ts(t[i])||ts(e[i])){const s=s0.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[s]=t[i]}return n}const n0e={useVisualState:iG({scrapeMotionValuesFromProps:sG,createRenderState:rG})};function i0e(t,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...lP(n)?n0e:r0e,preloadedFeatures:t,useRender:Jpe(i),createVisualElement:e,Component:n};return Fpe(o)}}function uv(t,e,r){const n=t.getProps();return cP(n,e,r!==void 0?r:n.custom,t)}const t_=t=>Array.isArray(t);function s0e(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Bp(r))}function o0e(t){return t_(t)?t[t.length-1]||0:t}function a0e(t,e){const r=uv(t,e);let{transitionEnd:n={},transition:i={},...s}=r||{};s={...s,...n};for(const o in s){const a=o0e(s[o]);s0e(t,o,a)}}function l0e(t){return!!(ts(t)&&t.add)}function r_(t,e){const r=t.getValue("willChange");if(l0e(r))return r.add(e);if(!r&&Pc.WillChange){const n=new Pc.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function oG(t){return t.props[X$]}const c0e=t=>t!==null;function u0e(t,{repeat:e,repeatType:r="loop"},n){const i=t.filter(c0e),s=e&&r!=="loop"&&e%2===1?0:i.length-1;return i[s]}const f0e={type:"spring",stiffness:500,damping:25,restSpeed:10},h0e=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),d0e={type:"keyframes",duration:.8},p0e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},m0e=(t,{keyframes:e})=>e.length>2?d0e:o0.has(t)?t.startsWith("scale")?h0e(e[1]):f0e:p0e;function g0e({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const fP=(t,e,r,n={},i,s)=>o=>{const a=ZD(n,t)||{},l=a.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Ol(l);const h={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:s?void 0:i};g0e(a)||Object.assign(h,m0e(t,h)),h.duration&&(h.duration=Ol(h.duration)),h.repeatDelay&&(h.repeatDelay=Ol(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let d=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(d=!0)),(Pc.instantAnimations||Pc.skipAnimations)&&(d=!0,h.duration=0,h.delay=0),h.allowFlatten=!a.type&&!a.ease,d&&!s&&e.get()!==void 0){const m=u0e(h.keyframes,a);if(m!==void 0){gn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return a.isSync?new KD(h):new Kde(h)};function v0e({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function aG(t,e,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=e;n&&(s=n);const l=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in a){const d=t.getValue(h,t.latestValues[h]??null),m=a[h];if(m===void 0||u&&v0e(u,h))continue;const g={delay:r,...ZD(s||{},h)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(m)&&m===y&&!g.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const C=oG(t);if(C){const E=window.MotionHandoffAnimation(C,h,gn);E!==null&&(g.startTime=E,x=!0)}}r_(t,h),d.start(fP(h,d,m,t.shouldReduceMotion&&L$.has(h)?{type:!1}:g,t,x));const b=d.animation;b&&l.push(b)}return o&&Promise.all(l).then(()=>{gn.update(()=>{o&&a0e(t,o)})}),l}function n_(t,e,r={}){var l;const n=uv(t,e,r.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const s=n?()=>Promise.all(aG(t,n,r)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:m}=i;return y0e(t,e,h+u,d,m,r)}:()=>Promise.resolve(),{when:a}=i;if(a){const[u,h]=a==="beforeChildren"?[s,o]:[o,s];return u().then(()=>h())}else return Promise.all([s(),o(r.delay)])}function y0e(t,e,r=0,n=0,i=1,s){const o=[],a=(t.variantChildren.size-1)*n,l=i===1?(u=0)=>u*n:(u=0)=>a-u*n;return Array.from(t.variantChildren).sort(x0e).forEach((u,h)=>{u.notify("AnimationStart",e),o.push(n_(u,e,{...s,delay:r+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function x0e(t,e){return t.sortNodePosition(e)}function w0e(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(s=>n_(t,s,r));n=Promise.all(i)}else if(typeof e=="string")n=n_(t,e,r);else{const i=typeof e=="function"?uv(t,e,r.custom):e;n=Promise.all(aG(t,i,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function lG(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const b0e=iP.length;function cG(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?cG(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<b0e;r++){const n=iP[r],i=t.props[n];(lv(i)||i===!1)&&(e[n]=i)}return e}const S0e=[...nP].reverse(),C0e=nP.length;function T0e(t){return e=>Promise.all(e.map(({animation:r,options:n})=>w0e(t,r,n)))}function E0e(t){let e=T0e(t),r=rB(),n=!0;const i=l=>(u,h)=>{var m;const d=uv(t,h,l==="exit"?(m=t.presenceContext)==null?void 0:m.custom:void 0);if(d){const{transition:g,transitionEnd:y,...x}=d;u={...u,...x,...y}}return u};function s(l){e=l(t)}function o(l){const{props:u}=t,h=cG(t.parent)||{},d=[],m=new Set;let g={},y=1/0;for(let b=0;b<C0e;b++){const C=S0e[b],E=r[C],R=u[C]!==void 0?u[C]:h[C],k=lv(R),O=C===l?E.isActive:null;O===!1&&(y=b);let P=R===h[C]&&R!==u[C]&&k;if(P&&n&&t.manuallyAnimateOnMount&&(P=!1),E.protectedKeys={...g},!E.isActive&&O===null||!R&&!E.prevProp||IS(R)||typeof R=="boolean")continue;const D=R0e(E.prevProp,R);let H=D||C===l&&E.isActive&&!P&&k||b>y&&k,N=!1;const _=Array.isArray(R)?R:[R];let B=_.reduce(i(C),{});O===!1&&(B={});const{prevResolvedValues:j={}}=E,ee={...j,...B},oe=Z=>{H=!0,m.has(Z)&&(N=!0,m.delete(Z)),E.needsAnimating[Z]=!0;const ve=t.getValue(Z);ve&&(ve.liveStyle=!1)};for(const Z in ee){const ve=B[Z],ie=j[Z];if(g.hasOwnProperty(Z))continue;let K=!1;t_(ve)&&t_(ie)?K=!lG(ve,ie):K=ve!==ie,K?ve!=null?oe(Z):m.add(Z):ve!==void 0&&m.has(Z)?oe(Z):E.protectedKeys[Z]=!0}E.prevProp=R,E.prevResolvedValues=B,E.isActive&&(g={...g,...B}),n&&t.blockInitialAnimation&&(H=!1),H&&(!(P&&D)||N)&&d.push(..._.map(Z=>({animation:Z,options:{type:C}})))}if(m.size){const b={};if(typeof u.initial!="boolean"){const C=uv(t,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(b.transition=C.transition)}m.forEach(C=>{const E=t.getBaseTarget(C),R=t.getValue(C);R&&(R.liveStyle=!0),b[C]=E??null}),d.push({animation:b})}let x=!!d.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(x=!1),n=!1,x?e(d):Promise.resolve()}function a(l,u){var d;if(r[l].isActive===u)return Promise.resolve();(d=t.variantChildren)==null||d.forEach(m=>{var g;return(g=m.animationState)==null?void 0:g.setActive(l,u)}),r[l].isActive=u;const h=o(l);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>r,reset:()=>{r=rB(),n=!0}}}function R0e(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!lG(e,t):!1}function Ef(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rB(){return{animate:Ef(!0),whileInView:Ef(),whileHover:Ef(),whileTap:Ef(),whileDrag:Ef(),whileFocus:Ef(),exit:Ef()}}class ef{constructor(e){this.isMounted=!1,this.node=e}update(){}}class A0e extends ef{constructor(e){super(e),e.animationState||(e.animationState=E0e(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();IS(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let k0e=0;class O0e extends ef{constructor(){super(...arguments),this.id=k0e++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);r&&!e&&i.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const _0e={animation:{Feature:A0e},exit:{Feature:O0e}};function fv(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function ly(t){return{point:{x:t.pageX,y:t.pageY}}}const M0e=t=>e=>tP(e)&&t(e,ly(e));function Eg(t,e,r,n){return fv(t,e,M0e(r),n)}function uG({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function D0e({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function P0e(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const fG=1e-4,I0e=1-fG,N0e=1+fG,hG=.01,L0e=0-hG,F0e=0+hG;function ms(t){return t.max-t.min}function H0e(t,e,r){return Math.abs(t-e)<=r}function nB(t,e,r,n=.5){t.origin=n,t.originPoint=mn(e.min,e.max,t.origin),t.scale=ms(r)/ms(e),t.translate=mn(r.min,r.max,t.origin)-t.originPoint,(t.scale>=I0e&&t.scale<=N0e||isNaN(t.scale))&&(t.scale=1),(t.translate>=L0e&&t.translate<=F0e||isNaN(t.translate))&&(t.translate=0)}function Rg(t,e,r,n){nB(t.x,e.x,r.x,n?n.originX:void 0),nB(t.y,e.y,r.y,n?n.originY:void 0)}function iB(t,e,r){t.min=r.min+e.min,t.max=t.min+ms(e)}function B0e(t,e,r){iB(t.x,e.x,r.x),iB(t.y,e.y,r.y)}function sB(t,e,r){t.min=e.min-r.min,t.max=t.min+ms(e)}function Ag(t,e,r){sB(t.x,e.x,r.x),sB(t.y,e.y,r.y)}const oB=()=>({translate:0,scale:1,origin:0,originPoint:0}),sp=()=>({x:oB(),y:oB()}),aB=()=>({min:0,max:0}),In=()=>({x:aB(),y:aB()});function jo(t){return[t("x"),t("y")]}function rR(t){return t===void 0||t===1}function i_({scale:t,scaleX:e,scaleY:r}){return!rR(t)||!rR(e)||!rR(r)}function jf(t){return i_(t)||dG(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function dG(t){return lB(t.x)||lB(t.y)}function lB(t){return t&&t!=="0%"}function vb(t,e,r){const n=t-r,i=e*n;return r+i}function cB(t,e,r,n,i){return i!==void 0&&(t=vb(t,i,n)),vb(t,r,n)+e}function s_(t,e=0,r=1,n,i){t.min=cB(t.min,e,r,n,i),t.max=cB(t.max,e,r,n,i)}function pG(t,{x:e,y:r}){s_(t.x,e.translate,e.scale,e.originPoint),s_(t.y,r.translate,r.scale,r.originPoint)}const uB=.999999999999,fB=1.0000000000001;function V0e(t,e,r,n=!1){const i=r.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=r[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ap(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,pG(t,o)),n&&jf(s.latestValues)&&ap(t,s.latestValues))}e.x<fB&&e.x>uB&&(e.x=1),e.y<fB&&e.y>uB&&(e.y=1)}function op(t,e){t.min=t.min+e,t.max=t.max+e}function hB(t,e,r,n,i=.5){const s=mn(t.min,t.max,i);s_(t,e,r,s,n)}function ap(t,e){hB(t.x,e.x,e.scaleX,e.scale,e.originX),hB(t.y,e.y,e.scaleY,e.scale,e.originY)}function mG(t,e){return uG(P0e(t.getBoundingClientRect(),e))}function j0e(t,e,r){const n=mG(t,r),{scroll:i}=e;return i&&(op(n.x,i.offset.x),op(n.y,i.offset.y)),n}const gG=({current:t})=>t?t.ownerDocument.defaultView:null,dB=(t,e)=>Math.abs(t-e);function W0e(t,e){const r=dB(t.x,e.x),n=dB(t.y,e.y);return Math.sqrt(r**2+n**2)}class vG{constructor(e,r,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=iR(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=W0e(d.offset,{x:0,y:0})>=3;if(!m&&!g)return;const{point:y}=d,{timestamp:x}=Di;this.history.push({...y,timestamp:x});const{onStart:b,onMove:C}=this.handlers;m||(b&&b(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,d)},this.handlePointerMove=(d,m)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=nR(m,this.transformPagePoint),gn.update(this.updatePoint,!0)},this.handlePointerUp=(d,m)=>{this.end();const{onEnd:g,onSessionEnd:y,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=iR(d.type==="pointercancel"?this.lastMoveEventInfo:nR(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(d,b),y&&y(d,b)},!tP(e))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=n,this.contextWindow=i||window;const o=ly(e),a=nR(o,this.transformPagePoint),{point:l}=a,{timestamp:u}=Di;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=r;h&&h(e,iR(a,this.history)),this.removeListeners=sy(Eg(this.contextWindow,"pointermove",this.handlePointerMove),Eg(this.contextWindow,"pointerup",this.handlePointerUp),Eg(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Wu(this.updatePoint)}}function nR(t,e){return e?{point:e(t.point)}:t}function pB(t,e){return{x:t.x-e.x,y:t.y-e.y}}function iR({point:t},e){return{point:t,delta:pB(t,yG(e)),offset:pB(t,z0e(e)),velocity:U0e(e,.1)}}function z0e(t){return t[0]}function yG(t){return t[t.length-1]}function U0e(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const i=yG(t);for(;r>=0&&(n=t[r],!(i.timestamp-n.timestamp>Ol(e)));)r--;if(!n)return{x:0,y:0};const s=_l(i.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-n.x)/s,y:(i.y-n.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function $0e(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?mn(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?mn(r,t,n.max):Math.min(t,r)),t}function mB(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function G0e(t,{top:e,left:r,bottom:n,right:i}){return{x:mB(t.x,r,i),y:mB(t.y,e,n)}}function gB(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function Y0e(t,e){return{x:gB(t.x,e.x),y:gB(t.y,e.y)}}function q0e(t,e){let r=.5;const n=ms(t),i=ms(e);return i>n?r=sv(e.min,e.max-n,t.min):n>i&&(r=sv(t.min,t.max-i,e.min)),Dc(0,1,r)}function K0e(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const o_=.35;function X0e(t=o_){return t===!1?t=0:t===!0&&(t=o_),{x:vB(t,"left","right"),y:vB(t,"top","bottom")}}function vB(t,e,r){return{min:yB(t,e),max:yB(t,r)}}function yB(t,e){return typeof t=="number"?t:t[e]||0}const Q0e=new WeakMap;class Z0e{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=In(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(ly(h).point)},s=(h,d)=>{const{drag:m,dragPropagation:g,onDragStart:y}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=fpe(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),jo(b=>{let C=this.getAxisMotionValue(b).get()||0;if(Ml.test(C)){const{projection:E}=this.visualElement;if(E&&E.layout){const R=E.layout.layoutBox[b];R&&(C=ms(R)*(parseFloat(C)/100))}}this.originPoint[b]=C}),y&&gn.postRender(()=>y(h,d)),r_(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(h,d)=>{const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:y,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:b}=d;if(g&&this.currentDirection===null){this.currentDirection=J0e(b),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,b),this.updateAxis("y",d.point,b),this.visualElement.render(),x&&x(h,d)},a=(h,d)=>this.stop(h,d),l=()=>jo(h=>{var d;return this.getAnimationState(h)==="paused"&&((d=this.getAxisMotionValue(h).animation)==null?void 0:d.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new vG(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:gG(this.visualElement)})}stop(e,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&gn.postRender(()=>s(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:i}=this.getProps();if(!n||!f1(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=$0e(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,i=this.constraints;e&&ip(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=G0e(n.layoutBox,e):this.constraints=!1,this.elastic=X0e(r),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&jo(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=K0e(n.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!ip(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=j0e(n,i.root,this.visualElement.getTransformPagePoint());let o=Y0e(i.layout.layoutBox,s);if(r){const a=r(D0e(o));this.hasMutatedConstraints=!!a,a&&(o=uG(a))}return o}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=jo(h=>{if(!f1(h,r,this.currentDirection))return;let d=l&&l[h]||{};o&&(d={min:0,max:0});const m=i?200:1e6,g=i?40:1e7,y={type:"inertia",velocity:n?e[h]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(h,y)});return Promise.all(u).then(a)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return r_(this.visualElement,e),n.start(fP(e,n,0,r,this.visualElement,!1))}stopAnimation(){jo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){jo(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[r];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){jo(r=>{const{drag:n}=this.getProps();if(!f1(r,n,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(r);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[r];s.set(e[r]-mn(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!ip(r)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};jo(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=q0e({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),jo(o=>{if(!f1(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:u}=this.constraints[o];a.set(mn(l,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;Q0e.set(this.visualElement,this);const e=this.visualElement.current,r=Eg(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();ip(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),gn.read(n);const o=fv(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(jo(h=>{const d=this.getAxisMotionValue(h);d&&(this.originPoint[h]+=l[h].translate,d.set(d.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),r(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=o_,dragMomentum:a=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function f1(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function J0e(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class eme extends ef{constructor(e){super(e),this.removeGroupControls=ea,this.removeListeners=ea,this.controls=new Z0e(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ea}unmount(){this.removeGroupControls(),this.removeListeners()}}const xB=t=>(e,r)=>{t&&gn.postRender(()=>t(e,r))};class tme extends ef{constructor(){super(...arguments),this.removePointerDownListener=ea}onPointerDown(e){this.session=new vG(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:gG(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:xB(e),onStart:xB(r),onMove:n,onEnd:(s,o)=>{delete this.session,i&&gn.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=Eg(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Hw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function wB(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Cm={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(wt.test(t))t=parseFloat(t);else return t;const r=wB(t,e.target.x),n=wB(t,e.target.y);return`${r}% ${n}%`}},rme={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,i=zu.parse(t);if(i.length>5)return n;const s=zu.createTransformer(t),o=typeof i[0]!="number"?1:0,a=r.x.scale*e.x,l=r.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const u=mn(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),s(i)}};class nme extends Y.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:s}=e;jpe(ime),s&&(r.group&&r.group.add(s),n&&n.register&&i&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Hw.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:i,isPresent:s}=this.props,{projection:o}=n;return o&&(o.isPresent=s,i||e.layoutDependency!==r||r===void 0||e.isPresent!==s?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||gn.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),eP.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function xG(t){const[e,r]=G$(),n=Y.useContext(MD);return I.jsx(nme,{...t,layoutGroup:n,switchLayoutGroup:Y.useContext(Q$),isPresent:e,safeToRemove:r})}const ime={borderRadius:{...Cm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Cm,borderTopRightRadius:Cm,borderBottomLeftRadius:Cm,borderBottomRightRadius:Cm,boxShadow:rme};function sme(t,e,r){const n=ts(t)?t:Bp(t);return n.start(fP("",n,e,r)),n.animation}const ome=(t,e)=>t.depth-e.depth;class ame{constructor(){this.children=[],this.isDirty=!1}add(e){ID(this.children,e),this.isDirty=!0}remove(e){ND(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ome),this.isDirty=!1,this.children.forEach(e)}}function lme(t,e){const r=Vs.now(),n=({timestamp:i})=>{const s=i-r;s>=e&&(Wu(n),t(s-e))};return gn.setup(n,!0),()=>Wu(n)}const wG=["TopLeft","TopRight","BottomLeft","BottomRight"],cme=wG.length,bB=t=>typeof t=="string"?parseFloat(t):t,SB=t=>typeof t=="number"||wt.test(t);function ume(t,e,r,n,i,s){i?(t.opacity=mn(0,r.opacity??1,fme(n)),t.opacityExit=mn(e.opacity??1,0,hme(n))):s&&(t.opacity=mn(e.opacity??1,r.opacity??1,n));for(let o=0;o<cme;o++){const a=`border${wG[o]}Radius`;let l=CB(e,a),u=CB(r,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||SB(l)===SB(u)?(t[a]=Math.max(mn(bB(l),bB(u),n),0),(Ml.test(u)||Ml.test(l))&&(t[a]+="%")):t[a]=u}(e.rotate||r.rotate)&&(t.rotate=mn(e.rotate||0,r.rotate||0,n))}function CB(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const fme=bG(0,.5,d$),hme=bG(.5,.95,ea);function bG(t,e,r){return n=>n<t?0:n>e?1:r(sv(t,e,n))}function TB(t,e){t.min=e.min,t.max=e.max}function Po(t,e){TB(t.x,e.x),TB(t.y,e.y)}function EB(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function RB(t,e,r,n,i){return t-=e,t=vb(t,1/r,n),i!==void 0&&(t=vb(t,1/i,n)),t}function dme(t,e=0,r=1,n=.5,i,s=t,o=t){if(Ml.test(e)&&(e=parseFloat(e),e=mn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=mn(s.min,s.max,n);t===s&&(a-=e),t.min=RB(t.min,e,r,a,i),t.max=RB(t.max,e,r,a,i)}function AB(t,e,[r,n,i],s,o){dme(t,e[r],e[n],e[i],e.scale,s,o)}const pme=["x","scaleX","originX"],mme=["y","scaleY","originY"];function kB(t,e,r,n){AB(t.x,e,pme,r?r.x:void 0,n?n.x:void 0),AB(t.y,e,mme,r?r.y:void 0,n?n.y:void 0)}function OB(t){return t.translate===0&&t.scale===1}function SG(t){return OB(t.x)&&OB(t.y)}function _B(t,e){return t.min===e.min&&t.max===e.max}function gme(t,e){return _B(t.x,e.x)&&_B(t.y,e.y)}function MB(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function CG(t,e){return MB(t.x,e.x)&&MB(t.y,e.y)}function DB(t){return ms(t.x)/ms(t.y)}function PB(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class vme{constructor(){this.members=[]}add(e){ID(this.members,e),e.scheduleRender()}remove(e){if(ND(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(i=>e===i);if(r===0)return!1;let n;for(let i=r;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function yme(t,e,r){let n="";const i=t.x.translate/e.x,s=t.y.translate/e.y,o=(r==null?void 0:r.z)||0;if((i||s||o)&&(n=`translate3d(${i}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:u,rotate:h,rotateX:d,rotateY:m,skewX:g,skewY:y}=r;u&&(n=`perspective(${u}px) ${n}`),h&&(n+=`rotate(${h}deg) `),d&&(n+=`rotateX(${d}deg) `),m&&(n+=`rotateY(${m}deg) `),g&&(n+=`skewX(${g}deg) `),y&&(n+=`skewY(${y}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const sR=["","X","Y","Z"],xme={visibility:"hidden"},wme=1e3;let bme=0;function oR(t,e,r,n){const{latestValues:i}=e;i[t]&&(r[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function TG(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=oG(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:i,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",gn,!(i||s))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&TG(n)}function EG({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=bme++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Tme),this.nodes.forEach(Ome),this.nodes.forEach(_me),this.nodes.forEach(Eme)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new ame)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new HD),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=$$(o)&&!vpe(o),this.instance=o;const{layoutId:a,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let h;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=lme(d,250),Hw.hasAnimatedSinceResize&&(Hw.hasAnimatedSinceResize=!1,this.nodes.forEach(NB))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&u&&(a||l)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeLayoutChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||u.getDefaultTransition()||Nme,{onLayoutAnimationStart:x,onLayoutAnimationComplete:b}=u.getProps(),C=!this.targetLayout||!CG(this.targetLayout,g),E=!d&&m;if(this.options.layoutRoot||this.resumeFrom||E||d&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...ZD(y,"layout"),onPlay:x,onComplete:b};(u.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(h,E)}else d||NB(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Wu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Mme),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&TG(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const d=this.path[h];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(IB);return}this.isUpdating||this.nodes.forEach(Ame),this.isUpdating=!1,this.nodes.forEach(kme),this.nodes.forEach(Sme),this.nodes.forEach(Cme),this.clearAllSnapshots();const a=Vs.now();Di.delta=Dc(0,1e3/60,a-Di.timestamp),Di.timestamp=a,Di.isProcessing=!0,XE.update.process(Di),XE.preRender.process(Di),XE.render.process(Di),Di.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,eP.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Rme),this.sharedNodes.forEach(Dme)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ms(this.snapshot.measuredBox.x)&&!ms(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=In(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!SG(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;o&&this.instance&&(a||jf(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Lme(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:o}=this.options;if(!o)return In();const a=o.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Fme))){const{scroll:h}=this.root;h&&(op(a.x,h.offset.x),op(a.y,h.offset.y))}return a}removeElementScroll(o){var l;const a=In();if(Po(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:d,options:m}=h;h!==this.root&&d&&m.layoutScroll&&(d.wasRoot&&Po(a,o),op(a.x,d.offset.x),op(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const l=In();Po(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&ap(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),jf(h.latestValues)&&ap(l,h.latestValues)}return jf(this.latestValues)&&ap(l,this.latestValues),l}removeTransform(o){const a=In();Po(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!jf(u.latestValues))continue;i_(u.latestValues)&&u.updateSnapshot();const h=In(),d=u.measurePageBox();Po(h,d),kB(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return jf(this.latestValues)&&kB(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Di.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var m;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=Di.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=In(),this.relativeTargetOrigin=In(),Ag(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),Po(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=In(),this.targetWithTransforms=In()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),B0e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Po(this.target,this.layout.layoutBox),pG(this.target,this.targetDelta)):Po(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=In(),this.relativeTargetOrigin=In(),Ag(this.relativeTargetOrigin,this.target,g.target),Po(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||i_(this.parent.latestValues)||dG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Di.timestamp&&(l=!1),l)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Po(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,m=this.treeScale.y;V0e(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=In());const{target:g}=o;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(EB(this.prevProjectionDelta.x,this.projectionDelta.x),EB(this.prevProjectionDelta.y,this.projectionDelta.y)),Rg(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==m||!PB(this.projectionDelta.x,this.prevProjectionDelta.x)||!PB(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=sp(),this.projectionDelta=sp(),this.projectionDeltaWithTransform=sp()}setAnimationOrigin(o,a=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},d=sp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=In(),g=l?l.source:void 0,y=this.layout?this.layout.source:void 0,x=g!==y,b=this.getStack(),C=!b||b.members.length<=1,E=!!(x&&!C&&this.options.crossfade===!0&&!this.path.some(Ime));this.animationProgress=0;let R;this.mixTargetDelta=k=>{const O=k/1e3;LB(d.x,o.x,O),LB(d.y,o.y,O),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ag(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Pme(this.relativeTarget,this.relativeTargetOrigin,m,O),R&&gme(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=In()),Po(R,this.relativeTarget)),x&&(this.animationValues=h,ume(h,u,this.latestValues,O,E,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,u;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(Wu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gn.update(()=>{Hw.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Bp(0)),this.currentAnimation=sme(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),o.onUpdate&&o.onUpdate(h)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(wme),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:h}=o;if(!(!a||!l||!u)){if(this!==o&&this.layout&&u&&RG(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||In();const d=ms(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const m=ms(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+m}Po(a,l),ap(a,h),Rg(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new vme),this.sharedNodes.get(o).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const u={};l.z&&oR("z",o,u,this.animationValues);for(let h=0;h<sR.length;h++)oR(`rotate${sR[h]}`,o,u,this.animationValues),oR(`skew${sR[h]}`,o,u,this.animationValues);o.render();for(const h in u)o.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);o.scheduleRender()}getProjectionStyles(o){if(!this.instance||this.isSVG)return;if(!this.isVisible)return xme;const a={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,a.opacity="",a.pointerEvents=Fw(o==null?void 0:o.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none",a;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=Fw(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!jf(this.latestValues)&&(g.transform=l?l({},""):"none",this.hasProjected=!1),g}const h=u.animationValues||u.latestValues;this.applyTransformsToTarget(),a.transform=yme(this.projectionDeltaWithTransform,this.treeScale,h),l&&(a.transform=l(h,a.transform));const{x:d,y:m}=this.projectionDelta;a.transformOrigin=`${d.origin*100}% ${m.origin*100}% 0`,u.animationValues?a.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:a.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const g in cv){if(h[g]===void 0)continue;const{correct:y,applyTo:x,isCSSVariable:b}=cv[g],C=a.transform==="none"?h[g]:y(h[g],u);if(x){const E=x.length;for(let R=0;R<E;R++)a[x[R]]=C}else b?this.options.visualElement.renderState.vars[g]=C:a[g]=C}return this.options.layoutId&&(a.pointerEvents=u===this?Fw(o==null?void 0:o.pointerEvents)||"":"none"),a}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(IB),this.root.sharedNodes.clear()}}}function Sme(t){t.updateLayout()}function Cme(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:s}=t.options,o=e.source!==t.layout.source;s==="size"?jo(d=>{const m=o?e.measuredBox[d]:e.layoutBox[d],g=ms(m);m.min=n[d].min,m.max=m.min+g}):RG(s,e.layoutBox,n)&&jo(d=>{const m=o?e.measuredBox[d]:e.layoutBox[d],g=ms(n[d]);m.max=m.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+g)});const a=sp();Rg(a,n,e.layoutBox);const l=sp();o?Rg(l,t.applyTransform(i,!0),e.measuredBox):Rg(l,n,e.layoutBox);const u=!SG(a);let h=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:m,layout:g}=d;if(m&&g){const y=In();Ag(y,e.layoutBox,m.layoutBox);const x=In();Ag(x,n,g.layoutBox),CG(y,x)||(h=!0),d.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=y,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function Tme(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Eme(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Rme(t){t.clearSnapshot()}function IB(t){t.clearMeasurements()}function Ame(t){t.isLayoutDirty=!1}function kme(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function NB(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Ome(t){t.resolveTargetDelta()}function _me(t){t.calcProjection()}function Mme(t){t.resetSkewAndRotation()}function Dme(t){t.removeLeadSnapshot()}function LB(t,e,r){t.translate=mn(e.translate,0,r),t.scale=mn(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function FB(t,e,r,n){t.min=mn(e.min,r.min,n),t.max=mn(e.max,r.max,n)}function Pme(t,e,r,n){FB(t.x,e.x,r.x,n),FB(t.y,e.y,r.y,n)}function Ime(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Nme={duration:.45,ease:[.4,0,.1,1]},HB=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),BB=HB("applewebkit/")&&!HB("chrome/")?Math.round:ea;function VB(t){t.min=BB(t.min),t.max=BB(t.max)}function Lme(t){VB(t.x),VB(t.y)}function RG(t,e,r){return t==="position"||t==="preserve-aspect"&&!H0e(DB(e),DB(r),.2)}function Fme(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const Hme=EG({attachResizeListener:(t,e)=>fv(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),aR={current:void 0},AG=EG({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!aR.current){const t=new Hme({});t.mount(window),t.setOptions({layoutScroll:!0}),aR.current=t}return aR.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Bme={pan:{Feature:tme},drag:{Feature:eme,ProjectionNode:AG,MeasureLayout:xG}};function jB(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const i="onHover"+r,s=n[i];s&&gn.postRender(()=>s(e,ly(e)))}class Vme extends ef{mount(){const{current:e}=this.node;e&&(this.unmount=hpe(e,(r,n)=>(jB(this.node,n,"Start"),i=>jB(this.node,i,"End"))))}unmount(){}}class jme extends ef{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=sy(fv(this.node.current,"focus",()=>this.onFocus()),fv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function WB(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const i="onTap"+(r==="End"?"":r),s=n[i];s&&gn.postRender(()=>s(e,ly(e)))}class Wme extends ef{mount(){const{current:e}=this.node;e&&(this.unmount=gpe(e,(r,n)=>(WB(this.node,n,"Start"),(i,{success:s})=>WB(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const a_=new WeakMap,lR=new WeakMap,zme=t=>{const e=a_.get(t.target);e&&e(t)},Ume=t=>{t.forEach(zme)};function $me({root:t,...e}){const r=t||document;lR.has(r)||lR.set(r,{});const n=lR.get(r),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(Ume,{root:t,...e})),n[i]}function Gme(t,e,r){const n=$me(e);return a_.set(t,r),n.observe(t),()=>{a_.delete(t),n.unobserve(t)}}const Yme={some:0,all:1};class qme extends ef{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:s}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:Yme[i]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:d}=this.node.getProps(),m=u?h:d;m&&m(l)};return Gme(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(Kme(e,r))&&this.startObserver()}unmount(){}}function Kme({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const Xme={inView:{Feature:qme},tap:{Feature:Wme},focus:{Feature:jme},hover:{Feature:Vme}},Qme={layout:{ProjectionNode:AG,MeasureLayout:xG}},l_={current:null},kG={current:!1};function Zme(){if(kG.current=!0,!!PD)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>l_.current=t.matches;t.addListener(e),e()}else l_.current=!1}const Jme=new WeakMap;function ege(t,e,r){for(const n in e){const i=e[n],s=r[n];if(ts(i))t.addValue(n,i);else if(ts(s))t.addValue(n,Bp(i,{owner:t}));else if(s!==i)if(t.hasValue(n)){const o=t.getValue(n);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(n);t.addValue(n,Bp(o!==void 0?o:i,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const zB=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tge{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=XD,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Vs.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,gn.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=NS(r),this.isVariantNode=K$(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...d}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in d){const g=d[m];l[m]!==void 0&&ts(g)&&g.set(l[m],!1)}}mount(e){this.current=e,Jme.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),kG.current||Zme(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:l_.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Wu(this.notifyUpdate),Wu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=o0.has(e);n&&this.onBindTransform&&this.onBindTransform();const i=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&gn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{i(),s(),o&&o(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Vp){const r=Vp[e];if(!r)continue;const{isEnabled:n,Feature:i}=r;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):In()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<zB.length;n++){const i=zB[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=e[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=ege(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Bp(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(n$(n)||s$(n))?n=parseFloat(n):!xpe(n)&&zu.test(r)&&(n=V$(e,r)),this.setBaseTarget(e,ts(n)?n.get():n)),ts(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var s;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const o=cP(this.props,r,(s=this.presenceContext)==null?void 0:s.custom);o&&(n=o[e])}if(r&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!ts(i)?i:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new HD),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class OG extends tge{constructor(){super(...arguments),this.KeyframeResolver=ape}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ts(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function _G(t,{style:e,vars:r},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const s in r)t.style.setProperty(s,r[s])}function rge(t){return window.getComputedStyle(t)}class nge extends OG{constructor(){super(...arguments),this.type="html",this.renderInstance=_G}readValueFromInstance(e,r){var n;if(o0.has(r))return(n=this.projection)!=null&&n.isProjecting?KO(r):Rde(e,r);{const i=rge(e),s=(jD(r)?i.getPropertyValue(r):i[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:r}){return mG(e,r)}build(e,r,n){oP(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return uP(e,r,n)}}const MG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function ige(t,e,r,n){_G(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(MG.has(i)?i:sP(i),e.attrs[i])}class sge extends OG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=In}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(o0.has(r)){const n=B$(r);return n&&n.default||0}return r=MG.has(r)?r:sP(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return sG(e,r,n)}build(e,r,n){tG(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,i){ige(e,r,n,i)}mount(e){this.isSVGTag=nG(e.tagName),super.mount(e)}}const oge=(t,e)=>lP(t)?new sge(e):new nge(e,{allowProjection:t!==Y.Fragment}),age=i0e({..._0e,...Xme,...Bme,...Qme},oge),ti=Ope(age),lge=({children:t,totalSlides:e,currentSlide:r,onNextSlide:n,onPrevSlide:i,onGoToSlide:s})=>{const o=$a(),[a,l]=Y.useState(!1),u=(r+1)/e*100;Y.useEffect(()=>{const d=m=>{m.key==="ArrowDown"||m.key==="ArrowRight"||m.key===" "?n():m.key==="ArrowUp"||m.key==="ArrowLeft"?i():m.key==="f"&&h()};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[n,i]);const h=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),l(!1)):(document.documentElement.requestFullscreen().catch(d=>{console.error(`Error attempting to enable fullscreen: ${d.message}`)}),l(!0))};return I.jsxs(_e,{sx:{position:"relative",height:"100vh",width:"100vw",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",background:"radial-gradient(circle at 30% 107%, rgba(253, 252, 251, 0.6) 0%, rgba(226, 226, 226, 0.8) 95%)"},children:[I.jsx(_e,{sx:{position:"absolute",bottom:"-15%",left:"-5%",width:"500px",height:"500px",borderRadius:"50%",background:`radial-gradient(circle at center, ${o.palette.primary.light}22, ${o.palette.primary.main}05)`,filter:"blur(80px)",zIndex:0}}),I.jsx(_e,{sx:{position:"absolute",top:"-10%",right:"-5%",width:"400px",height:"400px",borderRadius:"50%",background:`radial-gradient(circle at center, ${o.palette.secondary.light}22, ${o.palette.secondary.main}05)`,filter:"blur(80px)",zIndex:0}}),I.jsxs(_e,{sx:{width:"1600px",height:"900px",maxWidth:"90vw",maxHeight:"90vh",position:"relative",borderRadius:"16px",boxShadow:"0 25px 70px rgba(0,0,0,0.07), 0 15px 25px rgba(0,0,0,0.03)",overflow:"hidden",bgcolor:"#fff",display:"flex",flexDirection:"column",zIndex:2,padding:{xs:"20px",sm:"25px",md:"30px"}},children:[I.jsx(_e,{className:"progress-bar",sx:{width:`${u}%`}}),I.jsx(Tpe,{mode:"wait",children:I.jsx(ti.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.02},transition:{type:"spring",stiffness:300,damping:30,duration:.4},style:{flex:1,position:"relative",paddingBottom:"30px"},children:t},r)}),I.jsxs(_e,{sx:{position:"absolute",bottom:"10px",left:"50%",transform:"translateX(-50%)",display:"flex",flexDirection:"column",alignItems:"center",gap:1,zIndex:1e3},children:[r===0&&I.jsx(_e,{sx:{opacity:.8,py:1,px:2.5,mb:1,borderRadius:"50px",backgroundColor:"rgba(255,255,255,0.5)",backdropFilter:"blur(8px)",boxShadow:"0 2px 10px rgba(0,0,0,0.03)"},children:I.jsx(pt,{variant:"body2",sx:{fontWeight:500},children:"Use arrow keys or navigation buttons to move between slides"})}),I.jsxs(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:3},children:[I.jsx(o1,{title:"Go to home slide",arrow:!0,children:I.jsx(ti.div,{whileHover:{scale:1.15},whileTap:{scale:.92},children:I.jsx(r1,{color:"primary",onClick:()=>s(0),size:"medium",sx:{backgroundColor:"#4A4A4A",color:"white",boxShadow:"0 6px 14px rgba(0, 0, 0, 0.3)","&:hover":{backgroundColor:"#333333"}},children:I.jsx(Che,{fontSize:"medium"})})})}),I.jsx(o1,{title:"Previous slide",arrow:!0,children:I.jsx(ti.div,{whileHover:{scale:1.15},whileTap:{scale:.92},children:I.jsx(r1,{color:"primary",onClick:i,disabled:r===0,size:"medium",sx:{opacity:r===0?.4:1,backgroundColor:o.palette.primary.main,color:"white",boxShadow:"0 6px 14px rgba(120, 82, 169, 0.3)","&:hover":{backgroundColor:o.palette.primary.dark}},children:I.jsx(She,{fontSize:"medium"})})})}),I.jsx(_e,{sx:{px:3,py:1,borderRadius:"30px",backgroundColor:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",minWidth:"80px",textAlign:"center"},children:I.jsxs(pt,{variant:"body2",sx:{fontWeight:500},children:[r+1," / ",e]})}),I.jsx(o1,{title:"Next slide",arrow:!0,children:I.jsx(ti.div,{whileHover:{scale:1.15},whileTap:{scale:.92},children:I.jsx(r1,{color:"primary",onClick:n,disabled:r===e-1,size:"medium",sx:{opacity:r===e-1?.4:1,backgroundColor:o.palette.secondary.main,color:"white",boxShadow:"0 6px 14px rgba(0, 176, 185, 0.3)","&:hover":{backgroundColor:o.palette.secondary.dark}},children:I.jsx(bhe,{fontSize:"medium"})})})}),I.jsx(o1,{title:"Toggle fullscreen",arrow:!0,children:I.jsx(ti.div,{whileHover:{scale:1.15},whileTap:{scale:.92},children:I.jsx(r1,{size:"small",onClick:h,sx:{backgroundColor:"#4A4A4A",color:"white",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)","&:hover":{backgroundColor:"#333333"}},children:a?I.jsx(whe,{fontSize:"small"}):I.jsx(xhe,{fontSize:"small"})})})})]})]})]}),I.jsx(_e,{className:"nav-dots",children:Array.from({length:e}).map((d,m)=>I.jsx(_e,{className:`nav-dot ${m===r?"active":""}`,onClick:()=>s(m),role:"button",tabIndex:0,"aria-label":`Go to slide ${m+1}`,sx:{transform:m===r?"scale(1.3)":"scale(1)",transition:"transform 0.3s ease"}},m))})]})},cge={hidden:{opacity:0,y:30},visible:t=>({opacity:1,y:0,transition:{delay:t*.12,duration:.7,ease:[.25,.1,.25,1]}})},uge={hidden:{opacity:0,y:-30},visible:{opacity:1,y:0,transition:{duration:.8,ease:[.25,.1,.25,1]}}},fge={hidden:{width:"0%"},visible:{width:"100%",transition:{duration:1.2,ease:[.25,1,.5,1]}}},qs=({title:t,children:e,className:r="",variant:n="default",background:i,overlay:s=!1})=>{const o=$a(),a=()=>i||(n==="title"?`radial-gradient(circle at 80% 80%, ${o.palette.primary.main}15, transparent 25%),
              radial-gradient(circle at 20% 20%, ${o.palette.secondary.main}10, transparent 30%)`:"transparent");return I.jsxs(_e,{className:`slide ${r}`,sx:{height:"100%",background:a(),backgroundSize:"cover",backgroundPosition:"center",position:"relative",overflow:"hidden"},children:[n==="title"&&I.jsxs(I.Fragment,{children:[I.jsx(_e,{sx:{position:"absolute",bottom:"-5%",right:"-5%",width:"300px",height:"300px",background:`linear-gradient(45deg, ${o.palette.primary.main}10, ${o.palette.primary.light}20)`,borderRadius:"50%",filter:"blur(40px)",zIndex:0}}),I.jsx(_e,{sx:{position:"absolute",top:"10%",left:"5%",width:"20px",height:"20px",background:o.palette.primary.main,borderRadius:"50%",opacity:.5}}),I.jsx(_e,{sx:{position:"absolute",bottom:"20%",left:"10%",width:"10px",height:"10px",background:o.palette.secondary.main,borderRadius:"50%",opacity:.6}})]}),s&&I.jsx(_e,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",zIndex:1}}),I.jsxs(ti.div,{className:"slide-content",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.12,delayChildren:.1}}},style:{height:"100%",padding:"48px 0 80px 0",position:"relative",zIndex:2,display:"flex",flexDirection:"column",maxWidth:"1200px",margin:"0 auto",width:"100%"},children:[t&&I.jsx(ti.div,{variants:uge,children:I.jsxs(pt,{variant:n==="title"?"h1":"h3",component:"h2",className:"slide-title",gutterBottom:!0,sx:{fontWeight:n==="title"?800:700,position:"relative",display:"inline-block",color:n==="title"?o.palette.primary.main:"inherit",pb:n==="title"?1:2,...n==="title"&&{backgroundImage:`linear-gradient(135deg, ${o.palette.primary.main}, ${o.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",textShadow:"0 2px 10px rgba(0,0,0,0.05)"}},children:[t,n!=="title"&&I.jsx(ti.div,{variants:fge,style:{position:"absolute",height:"4px",bottom:"0",left:"0",background:`linear-gradient(to right, ${o.palette.primary.main}, ${o.palette.secondary.main})`,borderRadius:"2px"}})]})}),I.jsx(_e,{sx:{mt:t?n==="title"?4:3:0,flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:n==="title"?"center":"stretch"},children:Kt.Children.map(e,(l,u)=>I.jsx(ti.div,{variants:cge,custom:u+1,style:{height:n==="title"?"auto":"100%"},children:l}))}),n==="title"&&I.jsx(_e,{sx:{position:"absolute",bottom:"20px",right:"20px",opacity:.6},children:I.jsxs(pt,{variant:"caption",sx:{letterSpacing:"1px"},children:["AstraZeneca  ",new Date().getFullYear()]})})]})]})},DG=rn(I.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"})),h1=({name:t,role:e,email:r,theme:n})=>I.jsx(_e,{sx:{width:"max-content",minWidth:160,height:80,perspective:"1000px",mb:.5},children:I.jsx(Iw,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",background:"rgba(255,255,255,0.85)",backdropFilter:"blur(8px)",p:1.5},children:I.jsxs(_e,{sx:{textAlign:"center"},children:[I.jsx(pt,{variant:"subtitle1",sx:{fontWeight:600,fontSize:"0.9rem",mb:.3},children:t}),e&&I.jsx(pt,{variant:"caption",sx:{display:"block",color:n.palette.text.secondary,mb:.3},children:e}),r&&I.jsxs(_e,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:.5},children:[I.jsx(DG,{sx:{fontSize:"0.7rem",mr:.5,color:n.palette.text.secondary}}),I.jsx(pt,{variant:"caption",sx:{color:n.palette.text.secondary,fontStyle:"italic",fontSize:"0.65rem",whiteSpace:"nowrap"},children:r})]})]})})}),hge=({theme:t})=>I.jsx(qs,{variant:"title",children:I.jsxs(_e,{sx:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",height:"100%",position:"relative"},children:[I.jsx(_e,{sx:{position:"absolute",width:"400px",height:"400px",borderRadius:"50%",background:`radial-gradient(circle at center, ${t.palette.primary.main}0A, ${t.palette.primary.main}01)`,top:"10%",left:"5%",filter:"blur(60px)",opacity:.8,zIndex:0}}),I.jsx(_e,{sx:{position:"absolute",width:"300px",height:"300px",borderRadius:"50%",background:`radial-gradient(circle at center, ${t.palette.secondary.main}0A, ${t.palette.secondary.main}01)`,bottom:"5%",right:"5%",filter:"blur(60px)",opacity:.8,zIndex:0}}),I.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",width:"100%",px:6,pt:4,position:"relative",zIndex:2},children:[I.jsx(_e,{component:"img",src:"/ogemsharing/images/AZ_SYMBOL_RGB.png",alt:"AstraZeneca Logo",sx:{height:80,objectFit:"contain"}}),I.jsx(_e,{component:"img",src:"/ogemsharing/images/diamond.png",alt:"Diamond Logo",sx:{height:70,objectFit:"contain"}})]}),I.jsx(_e,{sx:{pt:6}}),I.jsx(ti.div,{initial:{y:40,opacity:0},animate:{y:0,opacity:1},transition:{duration:1,delay:.5,type:"spring",stiffness:100},style:{position:"relative",zIndex:2},children:I.jsxs(pt,{variant:"h1",component:"h1",sx:{fontSize:{xs:"2.8rem",sm:"4rem",md:"4.2rem"},fontWeight:800,mb:3,backgroundImage:`linear-gradient(135deg, ${t.palette.primary.main}, ${t.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",textShadow:"0 2px 10px rgba(0,0,0,0.05)",letterSpacing:"-0.02em"},children:["T",I.jsx("span",{style:{color:"#e0e0e0",WebkitTextFillColor:"#e0e0e0"},children:"L"}),I.jsx("span",{style:{color:"#e0e0e0",WebkitTextFillColor:"#e0e0e0"},children:"F"})," ","Generation via Efficient Macros (O-GEM) for efficacy"]})}),I.jsxs(ti.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:1.1},children:[I.jsx(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2.5,mb:1},children:I.jsxs(_e,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",gap:2,flexWrap:"wrap"},children:[I.jsx(_e,{sx:{width:"max-content",px:1,whiteSpace:"nowrap"},children:I.jsx(h1,{name:"Lanlan Zhao",email:"lanlan.zhao1@astrazeneca.com",theme:t})}),I.jsx(_e,{sx:{width:"max-content",px:1,whiteSpace:"nowrap"},children:I.jsx(h1,{name:"Patrick Zhang",email:"patrick.zhang@astrazeneca.com",theme:t})}),I.jsx(_e,{sx:{width:"max-content",px:1,whiteSpace:"nowrap"},children:I.jsx(h1,{name:"Zongfeng Lei",email:"zongfeng.lei@astrazeneca.com",theme:t})}),I.jsx(_e,{sx:{width:"max-content",px:1,whiteSpace:"nowrap"},children:I.jsx(h1,{name:"Han Wang",email:"han.wang9@astrazeneca.com",theme:t})})]})}),I.jsx(pt,{variant:"body2",sx:{color:t.palette.text.secondary,mt:2,fontWeight:500},children:"June 16, 2025"})]}),I.jsx(_e,{sx:{mt:"auto",mb:2}})]})},"title"),Tm=rn(I.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),dge=rn([I.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"},"0"),I.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"},"1")]),pge=rn(I.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14M7 9h5v1H7z"})),c_=rn(I.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),pu=160,d1=2.2,mge=({theme:t})=>{const[e,r]=Y.useState(!1),[n,i]=Y.useState({x:0,y:0}),[s,o]=Y.useState({width:1,height:1,naturalWidth:1,naturalHeight:1}),[a,l]=Y.useState(!1),u=Y.useRef(null),h=Y.useRef(null),d=b=>{if(!u.current||!h.current)return;const C=h.current.getBoundingClientRect(),E=b.clientX-C.left,R=b.clientY-C.top,k=Math.max(0,Math.min(E,C.width)),O=Math.max(0,Math.min(R,C.height));i({x:k,y:O})},m=b=>{const C=b.currentTarget;o({width:C.width,height:C.height,naturalWidth:C.naturalWidth,naturalHeight:C.naturalHeight})},g=()=>{if(!u.current||!h.current)return{bgX:0,bgY:0};const b=h.current.getBoundingClientRect(),C=s.naturalWidth/b.width,E=s.naturalHeight/b.height,R=(n.x*C-pu/2*C+pu/2*d1)*-1,k=(n.y*E-pu/2*E+pu/2*d1)*-1;return{bgX:R,bgY:k}},{bgX:y,bgY:x}=g();return I.jsx(qs,{title:"Recapture overview - Safety TLF Generation Process",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:4,alignItems:"flex-start",justifyContent:"center",width:"100%"},children:[I.jsxs(Bi,{elevation:3,sx:{p:3,minWidth:350,maxWidth:500,flex:1,background:"#faf8f6",display:"flex",flexDirection:"column",gap:2},children:[I.jsx(pt,{variant:"h6",sx:{fontWeight:700,mb:2,color:t.palette.primary.main},children:"TLF Environment Setup"}),I.jsxs(hb,{dense:!0,children:[I.jsxs(zf,{children:[I.jsx(Uf,{children:I.jsx(Tm,{color:"primary"})}),I.jsx($f,{primary:"Copy O-GEM to study folder"})]}),I.jsxs(zf,{children:[I.jsx(Uf,{children:I.jsx(Tm,{color:"primary"})}),I.jsx($f,{primary:I.jsxs("span",{children:["Update ",I.jsx("b",{children:"localsetup.sas"})," (run before every TLF) and "," ",I.jsxs("span",{style:{color:t.palette.primary.primary,textDecoration:"underline",cursor:"pointer",fontWeight:600},onClick:()=>l(b=>!b),children:[I.jsx("b",{children:"m_u_popn"}),I.jsx(c_,{sx:{fontSize:"1.1em",verticalAlign:"middle",transform:a?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})]})]})})]}),I.jsx(tv,{in:a,timeout:"auto",unmountOnExit:!0,children:I.jsx(_e,{sx:{pl:6,pr:2,pb:1},children:I.jsxs(pt,{variant:"body2",sx:{color:t.palette.text.secondary},children:[I.jsx("b",{children:"m_u_popn"})," is used to create dummy treatment group to fit the table header with the calculation of big N for each group."]})})}),I.jsxs(zf,{children:[I.jsx(Uf,{children:I.jsx(Tm,{color:"primary"})}),I.jsx($f,{primary:I.jsxs("span",{children:["Convert ",I.jsx("b",{children:"TOC file"})," to metadata as ",I.jsx("b",{children:"TLF.TITLES"})]})})]})]}),I.jsx(VO,{sx:{my:2}}),I.jsx(pt,{variant:"h6",sx:{fontWeight:700,mb:2,color:t.palette.secondary.main},children:"Output Generation"}),I.jsxs(hb,{dense:!0,children:[I.jsxs(zf,{children:[I.jsx(Uf,{children:I.jsx(Tm,{color:"secondary"})}),I.jsx($f,{primary:I.jsxs("span",{children:["TLF generation codes (",I.jsx("b",{children:".sas"}),") automatic creation"]})})]}),I.jsxs(zf,{children:[I.jsx(Uf,{children:I.jsx(Tm,{color:"secondary"})}),I.jsx($f,{primary:"TLF codes modification and execution"})]})]})]}),I.jsxs(_e,{sx:{flex:1,minWidth:320,maxWidth:600,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[I.jsx(Gle,{onClick:()=>r(b=>!b),sx:{position:"absolute",top:12,right:12,zIndex:10,background:"#fff",boxShadow:2},size:"large",children:e?I.jsx(pge,{}):I.jsx(dge,{})}),I.jsxs(_e,{ref:h,sx:{position:"relative",width:"100%",maxWidth:540,borderRadius:2,boxShadow:"0 4px 24px rgba(0,0,0,0.08)"},onMouseMove:e?d:void 0,onMouseLeave:e?()=>i({x:-9999,y:-9999}):void 0,children:[I.jsx("img",{ref:u,src:"/ogemsharing/images/tlf-process-flow.png",alt:"TLF Process Flow",style:{width:"100%",borderRadius:12,display:"block"},onLoad:m}),e&&I.jsx(_e,{sx:{pointerEvents:"none",position:"absolute",top:n.y-pu/2,left:n.x-pu/2,width:pu,height:pu,borderRadius:"50%",boxShadow:"0 2px 12px rgba(0,0,0,0.18)",border:"2.5px solid #fff",background:"url(/ogemsharing/images/tlf-process-flow.png) no-repeat",backgroundSize:`${s.width*d1}px ${s.height*d1}px`,backgroundPosition:`${y}px ${x}px`,zIndex:9,transition:"top 0.05s, left 0.05s"}})]})]})]})},"overview-tlf-process")};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var PG=1252,gge=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},dP=function(t){gge.indexOf(t)!=-1&&(PG=hP[0]=t)};function vge(){dP(1252)}var Na=function(t){dP(t)};function IG(){Na(1200),vge()}function UB(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function yge(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function NG(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var ag=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?yge(t.slice(2)):e==254&&r==255?NG(t.slice(2)):e==65279?t.slice(1):t},p1=function(e){return String.fromCharCode(e)},$B=function(e){return String.fromCharCode(e)},hv,Au="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function GB(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,i=t.charCodeAt(u++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=Au.charAt(s)+Au.charAt(o)+Au.charAt(a)+Au.charAt(l);return e}function yo(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Au.indexOf(t.charAt(u++)),o=Au.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=Au.indexOf(t.charAt(u++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=Au.indexOf(t.charAt(u++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Nh=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Uu(t){return Zt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function YB(t){return Zt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ia=function(e){return Zt?Nh(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Lh(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function pP(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return pP(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Tu=Zt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Nh(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function xge(t){for(var e=[],r=0,n=t.length+250,i=Uu(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Uu(65535),n=65530)}return e.push(i.slice(0,r)),Tu(e)}var vs=/\u0000/g,lg=/[\u0001-\u0006]/g;function vp(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function La(t,e){var r=""+t;return r.length>=e?r:Rn("0",e-r.length)+r}function mP(t,e){var r=""+t;return r.length>=e?r:Rn(" ",e-r.length)+r}function yb(t,e){var r=""+t;return r.length>=e?r:r+Rn(" ",e-r.length)}function wge(t,e){var r=""+Math.round(t);return r.length>=e?r:Rn("0",e-r.length)+r}function bge(t,e){var r=""+t;return r.length>=e?r:Rn("0",e-r.length)+r}var qB=Math.pow(2,32);function Ld(t,e){if(t>qB||t<-qB)return wge(t,e);var r=Math.round(t);return bge(r,e)}function xb(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var KB=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cR=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Sge(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var _t={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},XB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Cge={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wb(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,u=0,h=0,d=Math.floor(i);u<e&&(d=Math.floor(i),a=d*o+s,h=d*u+l,!(i-d<5e-8));)i=1/(i-d),s=o,o=a,l=u,u=h;if(h>e&&(u>e?(h=l,a=s):(h=u,a=o)),!r)return[0,n*a,h];var m=Math.floor(n*a/h);return[m,n*a-m*h,h]}function th(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Oge(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var LG=new Date(1899,11,31,0,0,0),Tge=LG.getTime(),Ege=new Date(1900,2,1,0,0,0);function FG(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Ege&&(r+=24*60*60*1e3),(r-(Tge+(t.getTimezoneOffset()-LG.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function gP(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Rge(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Age(t){var e=t<0?12:11,r=gP(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function kge(t){var e=gP(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function dv(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Age(t):e===10?r=t.toFixed(10).substr(0,12):r=kge(t),gP(Rge(r.toUpperCase()))}function xh(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):dv(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return sa(14,FG(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Oge(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function _ge(t,e,r,n){var i="",s=0,o=0,a=r.y,l,u=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return cR[r.m-1][1];case 5:return cR[r.m-1][0];default:return cR[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return KB[r.q][0];default:return KB[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?La(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=La(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=a,u=1;break}var h=u>0?La(l,u):"";return h}function ku(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var HG=/%/g;function Mge(t,e,r){var n=e.replace(HG,""),i=e.length-n.length;return Ec(t,n,r*Math.pow(10,2*i))+Rn("%",i)}function Dge(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ec(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function BG(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+BG(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var VG=/# (\?+)( ?)\/( ?)(\d+)/;function Pge(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?Rn(" ",t[1].length+1+t[4].length):mP(o,t[1].length)+t[2]+"/"+t[3]+La(a,t[4].length))}function Ige(t,e,r){return r+(e===0?"":""+e)+Rn(" ",t[1].length+2+t[4].length)}var jG=/^#*0*\.([0#]+)/,WG=/\).*[0#]/,zG=/\(###\) ###\\?-####/;function hs(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function QB(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function ZB(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Nge(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Lge(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Vo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(WG)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vo("n",n,r):"("+Vo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Dge(t,e,r);if(e.indexOf("%")!==-1)return Mge(t,e,r);if(e.indexOf("E")!==-1)return BG(e,r);if(e.charCodeAt(0)===36)return"$"+Vo(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ld(l,e.length);if(e.match(/^[#?]+$/))return i=Ld(r,0),i==="0"&&(i=""),i.length>e.length?i:hs(e.substr(0,e.length-i.length))+i;if(s=e.match(VG))return Pge(s,l,u);if(e.match(/^#+0+$/))return u+Ld(l,e.length-e.indexOf("0"));if(s=e.match(jG))return i=QB(r,s[1].length).replace(/^([^\.]+)$/,"$1."+hs(s[1])).replace(/\.$/,"."+hs(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Rn("0",hs(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+QB(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ku(Ld(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vo(t,e,-r):ku(""+(Math.floor(r)+Nge(r,s[1].length)))+"."+La(ZB(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Vo(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=vp(Vo(t,e.replace(/[\\-]/g,""),r)),o=0,vp(vp(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(zG))return i=Vo(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=wb(l,Math.pow(10,o)-1,!1),i=""+u,h=Ec("n",s[1],a[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=yb(a[2],o),h.length<s[4].length&&(h=hs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=wb(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?mP(a[1],o)+s[2]+"/"+s[3]+yb(a[2],o):Rn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ld(r,0),e.length<=i.length?i:hs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=e.indexOf(".")-o,m=e.length-i.length-d;return hs(e.substr(0,d)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=ZB(r,s[1].length),r<0?"-"+Vo(t,e,-r):ku(Lge(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?La(0,3-y.length):"")+y})+"."+La(o,s[1].length);switch(e){case"###,##0.00":return Vo(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=ku(Ld(l,0));return g!=="0"?u+g:"";case"###,###.00":return Vo(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vo(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Fge(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ec(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Hge(t,e,r){var n=e.replace(HG,""),i=e.length-n.length;return Ec(t,n,r*Math.pow(10,2*i))+Rn("%",i)}function UG(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+UG(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(WG)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hl("n",n,r):"("+hl("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Fge(t,e,r);if(e.indexOf("%")!==-1)return Hge(t,e,r);if(e.indexOf("E")!==-1)return UG(e,r);if(e.charCodeAt(0)===36)return"$"+hl(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+La(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:hs(e.substr(0,e.length-i.length))+i;if(s=e.match(VG))return Ige(s,l,u);if(e.match(/^#+0+$/))return u+La(l,e.length-e.indexOf("0"));if(s=e.match(jG))return i=(""+r).replace(/^([^\.]+)$/,"$1."+hs(s[1])).replace(/\.$/,"."+hs(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Rn("0",hs(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ku(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hl(t,e,-r):ku(""+r)+"."+Rn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return hl(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=vp(hl(t,e.replace(/[\\-]/g,""),r)),o=0,vp(vp(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(zG))return i=hl(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=wb(l,Math.pow(10,o)-1,!1),i=""+u,h=Ec("n",s[1],a[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=yb(a[2],o),h.length<s[4].length&&(h=hs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=wb(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?mP(a[1],o)+s[2]+"/"+s[3]+yb(a[2],o):Rn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:hs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=e.indexOf(".")-o,m=e.length-i.length-d;return hs(e.substr(0,d)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hl(t,e,-r):ku(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?La(0,3-y.length):"")+y})+"."+La(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=ku(""+l);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return hl(t,e.slice(0,e.lastIndexOf(".")),r)+hs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ec(t,e,r){return(r|0)===r?hl(t,e,r):Vo(t,e,r)}function Bge(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var $G=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function a0(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":xb(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match($G))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Vge(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",u,h,d,m="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!xb(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(d=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=t.charAt(++o),y=g==="("||g===")"?g:"t";i[i.length]={t:y,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=th(e,r,t.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=th(e,r),u==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=m),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var x={t:a,v:a};if(u==null&&(u=th(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",m="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,m="h"):t.substr(o,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",o+=5,m="h"):(x.t="t",++o),u==null&&x.t==="T")return"";i[i.length]=x,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($G)){if(u==null&&(u=th(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",a0(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var b=0,C=0,E;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=m,l="h",b<1&&(b=1);break;case"s":(E=i[o].v.match(/\.0+$/))&&(C=Math.max(C,E[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var R="",k;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=_ge(i[o].t.charCodeAt(0),i[o].v,u,C),i[o].t="t";break;case"n":case"?":for(k=o+1;i[k]!=null&&((a=i[k].t)==="?"||a==="D"||(a===" "||a==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[o].v+=i[k].v,i[k]={v:"",t:";"},++k;R+=i[o].v,o=k-1;break;case"G":i[o].t="t",i[o].v=xh(e,r);break}var O="",P,D;if(R.length>0){R.charCodeAt(0)==40?(P=e<0&&R.charCodeAt(0)===45?-e:e,D=Ec("n",R,P)):(P=e<0&&n>1?-e:e,D=Ec("n",R,P),P<0&&i[0]&&i[0].t=="t"&&(D=D.substr(1),i[0].v="-"+i[0].v)),k=D.length-1;var H=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){H=o;break}var N=i.length;if(H===i.length&&D.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(k>=i[o].v.length-1?(k-=i[o].v.length,i[o].v=D.substr(k+1,i[o].v.length)):k<0?i[o].v="":(i[o].v=D.substr(0,k+1),k=-1),i[o].t="t",N=o);k>=0&&N<i.length&&(i[N].v=D.substr(0,k+1)+i[N].v)}else if(H!==i.length&&D.indexOf("E")===-1){for(k=D.indexOf(".")-1,o=H;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===H?i[o].v.indexOf(".")-1:i[o].v.length-1,O=i[o].v.substr(h+1);h>=0;--h)k>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(O=D.charAt(k--)+O);i[o].v=O,i[o].t="t",N=o}for(k>=0&&N<i.length&&(i[N].v=D.substr(0,k+1)+i[N].v),k=D.indexOf(".")+1,o=H;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==H)){for(h=i[o].v.indexOf(".")>-1&&o===H?i[o].v.indexOf(".")+1:0,O=i[o].v.substr(0,h);h<i[o].v.length;++h)k<D.length&&(O+=D.charAt(k++));i[o].v=O,i[o].t="t",N=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(P=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Ec(i[o].t,i[o].v,P),i[o].t="t");var _="";for(o=0;o!==i.length;++o)i[o]!=null&&(_+=i[o].v);return _}var JB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function e5(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function jge(t,e){var r=Bge(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(JB),a=r[1].match(JB);return e5(e,o)?[n,r[0]]:e5(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function sa(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:_t)[t],n==null&&(n=r.table&&r.table[XB[t]]||_t[XB[t]]),n==null&&(n=Cge[t]||"General");break}if(xb(n,0))return xh(e,r);e instanceof Date&&(e=FG(e,r.date1904));var i=jge(n,e);if(xb(i[1]))return xh(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Vge(i[1],e,r,i[0])}function uh(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(_t[r]==null){e<0&&(e=r);continue}if(_t[r]==t){e=r;break}}e<0&&(e=391)}return _t[e]=t,e}function GG(){_t=Sge()}var Wge={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},YG=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function zge(t){var e=typeof t=="number"?_t[t]:t;return e=e.replace(YG,"(\\d+)"),new RegExp("^"+e+"$")}function Uge(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(YG)||[]).forEach(function(d,m){var g=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:n==-1&&i==-1&&s==-1?h:u+"T"+h}var $ge=function(){var t={};t.version="1.2.0";function e(){for(var D=0,H=new Array(256),N=0;N!=256;++N)D=N,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,H[N]=D;return typeof Int32Array<"u"?new Int32Array(H):H}var r=e();function n(D){var H=0,N=0,_=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(_=0;_!=256;++_)B[_]=D[_];for(_=0;_!=256;++_)for(N=D[_],H=256+_;H<4096;H+=256)N=B[H]=N>>>8^D[N&255];var j=[];for(_=1;_!=16;++_)j[_-1]=typeof Int32Array<"u"?B.subarray(_*256,_*256+256):B.slice(_*256,_*256+256);return j}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],h=i[5],d=i[6],m=i[7],g=i[8],y=i[9],x=i[10],b=i[11],C=i[12],E=i[13],R=i[14];function k(D,H){for(var N=H^-1,_=0,B=D.length;_<B;)N=N>>>8^r[(N^D.charCodeAt(_++))&255];return~N}function O(D,H){for(var N=H^-1,_=D.length-15,B=0;B<_;)N=R[D[B++]^N&255]^E[D[B++]^N>>8&255]^C[D[B++]^N>>16&255]^b[D[B++]^N>>>24]^x[D[B++]]^y[D[B++]]^g[D[B++]]^m[D[B++]]^d[D[B++]]^h[D[B++]]^u[D[B++]]^l[D[B++]]^a[D[B++]]^o[D[B++]]^s[D[B++]]^r[D[B++]];for(_+=15;B<_;)N=N>>>8^r[(N^D[B++])&255];return~N}function P(D,H){for(var N=H^-1,_=0,B=D.length,j=0,ee=0;_<B;)j=D.charCodeAt(_++),j<128?N=N>>>8^r[(N^j)&255]:j<2048?(N=N>>>8^r[(N^(192|j>>6&31))&255],N=N>>>8^r[(N^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,ee=D.charCodeAt(_++)&1023,N=N>>>8^r[(N^(240|j>>8&7))&255],N=N>>>8^r[(N^(128|j>>2&63))&255],N=N>>>8^r[(N^(128|ee>>6&15|(j&3)<<4))&255],N=N>>>8^r[(N^(128|ee&63))&255]):(N=N>>>8^r[(N^(224|j>>12&15))&255],N=N>>>8^r[(N^(128|j>>6&63))&255],N=N>>>8^r[(N^(128|j&63))&255]);return~N}return t.table=r,t.bstr=k,t.buf=O,t.str=P,t}(),ir=function(){var e={};e.version="1.2.1";function r(W,te){for(var X=W.split("/"),Q=te.split("/"),ne=0,se=0,xe=Math.min(X.length,Q.length);ne<xe;++ne){if(se=X[ne].length-Q[ne].length)return se;if(X[ne]!=Q[ne])return X[ne]<Q[ne]?-1:1}return X.length-Q.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var te=W.lastIndexOf("/");return te===-1?W:W.slice(0,te+1)}function i(W){if(W.charAt(W.length-1)=="/")return i(W.slice(0,-1));var te=W.lastIndexOf("/");return te===-1?W:W.slice(te+1)}function s(W,te){typeof te=="string"&&(te=new Date(te));var X=te.getHours();X=X<<6|te.getMinutes(),X=X<<5|te.getSeconds()>>>1,W.write_shift(2,X);var Q=te.getFullYear()-1980;Q=Q<<4|te.getMonth()+1,Q=Q<<5|te.getDate(),W.write_shift(2,Q)}function o(W){var te=W.read_shift(2)&65535,X=W.read_shift(2)&65535,Q=new Date,ne=X&31;X>>>=5;var se=X&15;X>>>=4,Q.setMilliseconds(0),Q.setFullYear(X+1980),Q.setMonth(se-1),Q.setDate(ne);var xe=te&31;te>>>=5;var Re=te&63;return te>>>=6,Q.setHours(te),Q.setMinutes(Re),Q.setSeconds(xe<<1),Q}function a(W){Ni(W,0);for(var te={},X=0;W.l<=W.length-4;){var Q=W.read_shift(2),ne=W.read_shift(2),se=W.l+ne,xe={};switch(Q){case 21589:X=W.read_shift(1),X&1&&(xe.mtime=W.read_shift(4)),ne>5&&(X&2&&(xe.atime=W.read_shift(4)),X&4&&(xe.ctime=W.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}W.l=se,te[Q]=xe}return te}var l;function u(){return l||(l={})}function h(W,te){if(W[0]==80&&W[1]==75)return Ai(W,te);if((W[0]|32)==109&&(W[1]|32)==105)return We(W,te);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var X=3,Q=512,ne=0,se=0,xe=0,Re=0,ge=0,fe=[],G=W.slice(0,512);Ni(G,0);var de=d(G);switch(X=de[0],X){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(de[1]==0)return Ai(W,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}Q!==512&&(G=W.slice(0,Q),Ni(G,28));var Ce=W.slice(0,Q);m(G,X);var Ne=G.read_shift(4,"i");if(X===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);G.l+=4,xe=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),Re=G.read_shift(4,"i"),ne=G.read_shift(4,"i"),ge=G.read_shift(4,"i"),se=G.read_shift(4,"i");for(var Ie=-1,Le=0;Le<109&&(Ie=G.read_shift(4,"i"),!(Ie<0));++Le)fe[Le]=Ie;var it=g(W,Q);b(ge,se,it,Q,fe);var Wt=E(it,xe,fe,Q);Wt[xe].name="!Directory",ne>0&&Re!==ee&&(Wt[Re].name="!MiniFAT"),Wt[fe[0]].name="!FAT",Wt.fat_addrs=fe,Wt.ssz=Q;var tr={},vr=[],Vr=[],va=[];R(xe,Wt,it,vr,ne,tr,Vr,Re),y(Vr,va,vr),vr.shift();var ls={FileIndex:Vr,FullPaths:va};return te&&te.raw&&(ls.raw={header:Ce,sectors:it}),ls}function d(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(oe,"Header Signature: "),W.l+=16;var te=W.read_shift(2,"u");return[W.read_shift(2,"u"),te]}function m(W,te){var X=9;switch(W.l+=2,X=W.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function g(W,te){for(var X=Math.ceil(W.length/te)-1,Q=[],ne=1;ne<X;++ne)Q[ne-1]=W.slice(ne*te,(ne+1)*te);return Q[X-1]=W.slice(X*te),Q}function y(W,te,X){for(var Q=0,ne=0,se=0,xe=0,Re=0,ge=X.length,fe=[],G=[];Q<ge;++Q)fe[Q]=G[Q]=Q,te[Q]=X[Q];for(;Re<G.length;++Re)Q=G[Re],ne=W[Q].L,se=W[Q].R,xe=W[Q].C,fe[Q]===Q&&(ne!==-1&&fe[ne]!==ne&&(fe[Q]=fe[ne]),se!==-1&&fe[se]!==se&&(fe[Q]=fe[se])),xe!==-1&&(fe[xe]=Q),ne!==-1&&Q!=fe[Q]&&(fe[ne]=fe[Q],G.lastIndexOf(ne)<Re&&G.push(ne)),se!==-1&&Q!=fe[Q]&&(fe[se]=fe[Q],G.lastIndexOf(se)<Re&&G.push(se));for(Q=1;Q<ge;++Q)fe[Q]===Q&&(se!==-1&&fe[se]!==se?fe[Q]=fe[se]:ne!==-1&&fe[ne]!==ne&&(fe[Q]=fe[ne]));for(Q=1;Q<ge;++Q)if(W[Q].type!==0){if(Re=Q,Re!=fe[Re])do Re=fe[Re],te[Q]=te[Re]+"/"+te[Q];while(Re!==0&&fe[Re]!==-1&&Re!=fe[Re]);fe[Q]=-1}for(te[0]+="/",Q=1;Q<ge;++Q)W[Q].type!==2&&(te[Q]+="/")}function x(W,te,X){for(var Q=W.start,ne=W.size,se=[],xe=Q;X&&ne>0&&xe>=0;)se.push(te.slice(xe*j,xe*j+j)),ne-=j,xe=Gf(X,xe*4);return se.length===0?li(0):Tu(se).slice(0,W.size)}function b(W,te,X,Q,ne){var se=ee;if(W===ee){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var xe=X[W],Re=(Q>>>2)-1;if(!xe)return;for(var ge=0;ge<Re&&(se=Gf(xe,ge*4))!==ee;++ge)ne.push(se);b(Gf(xe,Q-4),te-1,X,Q,ne)}}function C(W,te,X,Q,ne){var se=[],xe=[];ne||(ne=[]);var Re=Q-1,ge=0,fe=0;for(ge=te;ge>=0;){ne[ge]=!0,se[se.length]=ge,xe.push(W[ge]);var G=X[Math.floor(ge*4/Q)];if(fe=ge*4&Re,Q<4+fe)throw new Error("FAT boundary crossed: "+ge+" 4 "+Q);if(!W[G])break;ge=Gf(W[G],fe)}return{nodes:se,data:u5([xe])}}function E(W,te,X,Q){var ne=W.length,se=[],xe=[],Re=[],ge=[],fe=Q-1,G=0,de=0,Ce=0,Ne=0;for(G=0;G<ne;++G)if(Re=[],Ce=G+te,Ce>=ne&&(Ce-=ne),!xe[Ce]){ge=[];var Ie=[];for(de=Ce;de>=0;){Ie[de]=!0,xe[de]=!0,Re[Re.length]=de,ge.push(W[de]);var Le=X[Math.floor(de*4/Q)];if(Ne=de*4&fe,Q<4+Ne)throw new Error("FAT boundary crossed: "+de+" 4 "+Q);if(!W[Le]||(de=Gf(W[Le],Ne),Ie[de]))break}se[Ce]={nodes:Re,data:u5([ge])}}return se}function R(W,te,X,Q,ne,se,xe,Re){for(var ge=0,fe=Q.length?2:0,G=te[W].data,de=0,Ce=0,Ne;de<G.length;de+=128){var Ie=G.slice(de,de+128);Ni(Ie,64),Ce=Ie.read_shift(2),Ne=bP(Ie,0,Ce-fe),Q.push(Ne);var Le={name:Ne,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},it=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);it!==0&&(Le.ct=k(Ie,Ie.l-8));var Wt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Wt!==0&&(Le.mt=k(Ie,Ie.l-8)),Le.start=Ie.read_shift(4,"i"),Le.size=Ie.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=ee,Le.name=""),Le.type===5?(ge=Le.start,ne>0&&ge!==ee&&(te[ge].name="!StreamData")):Le.size>=4096?(Le.storage="fat",te[Le.start]===void 0&&(te[Le.start]=C(X,Le.start,te.fat_addrs,te.ssz)),te[Le.start].name=Le.name,Le.content=te[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:ge!==ee&&Le.start!==ee&&te[ge]&&(Le.content=x(Le,te[ge].data,(te[Re]||{}).data))),Le.content&&Ni(Le.content,0),se[Ne]=Le,xe.push(Le)}}function k(W,te){return new Date((ao(W,te+4)/1e7*Math.pow(2,32)+ao(W,te)/1e7-11644473600)*1e3)}function O(W,te){return u(),h(l.readFileSync(W),te)}function P(W,te){var X=te&&te.type;switch(X||Zt&&Buffer.isBuffer(W)&&(X="buffer"),X||"base64"){case"file":return O(W,te);case"base64":return h(Ia(yo(W)),te);case"binary":return h(Ia(W),te)}return h(W,te)}function D(W,te){var X=te||{},Q=X.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=Q+"/",W.FileIndex[0]={name:Q,type:5}),X.CLSID&&(W.FileIndex[0].clsid=X.CLSID),H(W)}function H(W){var te="Sh33tJ5";if(!ir.find(W,"/"+te)){var X=li(4);X[0]=55,X[1]=X[3]=50,X[2]=54,W.FileIndex.push({name:te,type:2,content:X,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+te),N(W)}}function N(W,te){D(W);for(var X=!1,Q=!1,ne=W.FullPaths.length-1;ne>=0;--ne){var se=W.FileIndex[ne];switch(se.type){case 0:Q?X=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(se.R*se.L*se.C)&&(X=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!te)){var xe=new Date(1987,1,19),Re=0,ge=Object.create?Object.create(null):{},fe=[];for(ne=0;ne<W.FullPaths.length;++ne)ge[W.FullPaths[ne]]=!0,W.FileIndex[ne].type!==0&&fe.push([W.FullPaths[ne],W.FileIndex[ne]]);for(ne=0;ne<fe.length;++ne){var G=n(fe[ne][0]);Q=ge[G],Q||(fe.push([G,{name:i(G).replace("/",""),type:1,clsid:q,ct:xe,mt:xe,content:null}]),ge[G]=!0)}for(fe.sort(function(Ne,Ie){return r(Ne[0],Ie[0])}),W.FullPaths=[],W.FileIndex=[],ne=0;ne<fe.length;++ne)W.FullPaths[ne]=fe[ne][0],W.FileIndex[ne]=fe[ne][1];for(ne=0;ne<fe.length;++ne){var de=W.FileIndex[ne],Ce=W.FullPaths[ne];if(de.name=i(Ce).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||q,ne===0)de.C=fe.length>1?1:-1,de.size=0,de.type=5;else if(Ce.slice(-1)=="/"){for(Re=ne+1;Re<fe.length&&n(W.FullPaths[Re])!=Ce;++Re);for(de.C=Re>=fe.length?-1:Re,Re=ne+1;Re<fe.length&&n(W.FullPaths[Re])!=n(Ce);++Re);de.R=Re>=fe.length?-1:Re,de.type=1}else n(W.FullPaths[ne+1]||"")==n(Ce)&&(de.R=ne+1),de.type=2}}}function _(W,te){var X=te||{};if(X.fileType=="mad")return qe(W,X);switch(N(W),X.fileType){case"zip":return ii(W,X)}var Q=function(Ne){for(var Ie=0,Le=0,it=0;it<Ne.FileIndex.length;++it){var Wt=Ne.FileIndex[it];if(Wt.content){var tr=Wt.content.length;tr>0&&(tr<4096?Ie+=tr+63>>6:Le+=tr+511>>9)}}for(var vr=Ne.FullPaths.length+3>>2,Vr=Ie+7>>3,va=Ie+127>>7,ls=Vr+Le+vr+va,ya=ls+127>>7,af=ya<=109?0:Math.ceil((ya-109)/127);ls+ya+af+127>>7>ya;)af=++ya<=109?0:Math.ceil((ya-109)/127);var xa=[1,af,ya,va,vr,Le,Ie,0];return Ne.FileIndex[0].size=Ie<<6,xa[7]=(Ne.FileIndex[0].start=xa[0]+xa[1]+xa[2]+xa[3]+xa[4]+xa[5])+(xa[6]+7>>3),xa}(W),ne=li(Q[7]<<9),se=0,xe=0;{for(se=0;se<8;++se)ne.write_shift(1,re[se]);for(se=0;se<8;++se)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),se=0;se<3;++se)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,Q[2]),ne.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:ee),ne.write_shift(4,Q[3]),ne.write_shift(-4,Q[1]?Q[0]-1:ee),ne.write_shift(4,Q[1]),se=0;se<109;++se)ne.write_shift(-4,se<Q[2]?Q[1]+se:-1)}if(Q[1])for(xe=0;xe<Q[1];++xe){for(;se<236+xe*127;++se)ne.write_shift(-4,se<Q[2]?Q[1]+se:-1);ne.write_shift(-4,xe===Q[1]-1?ee:xe+1)}var Re=function(Ne){for(xe+=Ne;se<xe-1;++se)ne.write_shift(-4,se+1);Ne&&(++se,ne.write_shift(-4,ee))};for(xe=se=0,xe+=Q[1];se<xe;++se)ne.write_shift(-4,Z.DIFSECT);for(xe+=Q[2];se<xe;++se)ne.write_shift(-4,Z.FATSECT);Re(Q[3]),Re(Q[4]);for(var ge=0,fe=0,G=W.FileIndex[0];ge<W.FileIndex.length;++ge)G=W.FileIndex[ge],G.content&&(fe=G.content.length,!(fe<4096)&&(G.start=xe,Re(fe+511>>9)));for(Re(Q[6]+7>>3);ne.l&511;)ne.write_shift(-4,Z.ENDOFCHAIN);for(xe=se=0,ge=0;ge<W.FileIndex.length;++ge)G=W.FileIndex[ge],G.content&&(fe=G.content.length,!(!fe||fe>=4096)&&(G.start=xe,Re(fe+63>>6)));for(;ne.l&511;)ne.write_shift(-4,Z.ENDOFCHAIN);for(se=0;se<Q[4]<<2;++se){var de=W.FullPaths[se];if(!de||de.length===0){for(ge=0;ge<17;++ge)ne.write_shift(4,0);for(ge=0;ge<3;++ge)ne.write_shift(4,-1);for(ge=0;ge<12;++ge)ne.write_shift(4,0);continue}G=W.FileIndex[se],se===0&&(G.start=G.size?G.start-1:ee);var Ce=se===0&&X.root||G.name;if(fe=2*(Ce.length+1),ne.write_shift(64,Ce,"utf16le"),ne.write_shift(2,fe),ne.write_shift(1,G.type),ne.write_shift(1,G.color),ne.write_shift(-4,G.L),ne.write_shift(-4,G.R),ne.write_shift(-4,G.C),G.clsid)ne.write_shift(16,G.clsid,"hex");else for(ge=0;ge<4;++ge)ne.write_shift(4,0);ne.write_shift(4,G.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,G.start),ne.write_shift(4,G.size),ne.write_shift(4,0)}for(se=1;se<W.FileIndex.length;++se)if(G=W.FileIndex[se],G.size>=4096)if(ne.l=G.start+1<<9,Zt&&Buffer.isBuffer(G.content))G.content.copy(ne,ne.l,0,G.size),ne.l+=G.size+511&-512;else{for(ge=0;ge<G.size;++ge)ne.write_shift(1,G.content[ge]);for(;ge&511;++ge)ne.write_shift(1,0)}for(se=1;se<W.FileIndex.length;++se)if(G=W.FileIndex[se],G.size>0&&G.size<4096)if(Zt&&Buffer.isBuffer(G.content))G.content.copy(ne,ne.l,0,G.size),ne.l+=G.size+63&-64;else{for(ge=0;ge<G.size;++ge)ne.write_shift(1,G.content[ge]);for(;ge&63;++ge)ne.write_shift(1,0)}if(Zt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function B(W,te){var X=W.FullPaths.map(function(ge){return ge.toUpperCase()}),Q=X.map(function(ge){var fe=ge.split("/");return fe[fe.length-(ge.slice(-1)=="/"?2:1)]}),ne=!1;te.charCodeAt(0)===47?(ne=!0,te=X[0].slice(0,-1)+te):ne=te.indexOf("/")!==-1;var se=te.toUpperCase(),xe=ne===!0?X.indexOf(se):Q.indexOf(se);if(xe!==-1)return W.FileIndex[xe];var Re=!se.match(lg);for(se=se.replace(vs,""),Re&&(se=se.replace(lg,"!")),xe=0;xe<X.length;++xe)if((Re?X[xe].replace(lg,"!"):X[xe]).replace(vs,"")==se||(Re?Q[xe].replace(lg,"!"):Q[xe]).replace(vs,"")==se)return W.FileIndex[xe];return null}var j=64,ee=-2,oe="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(W,te,X){u();var Q=_(W,X);l.writeFileSync(te,Q)}function ie(W){for(var te=new Array(W.length),X=0;X<W.length;++X)te[X]=String.fromCharCode(W[X]);return te.join("")}function K(W,te){var X=_(W,te);switch(te&&te.type||"buffer"){case"file":return u(),l.writeFileSync(te.filename,X),X;case"binary":return typeof X=="string"?X:ie(X);case"base64":return GB(typeof X=="string"?X:ie(X));case"buffer":if(Zt)return Buffer.isBuffer(X)?X:Nh(X);case"array":return typeof X=="string"?Ia(X):X}return X}var ce;function S(W){try{var te=W.InflateRaw,X=new te;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)ce=W;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function A(W,te){if(!ce)return qr(W,te);var X=ce.InflateRaw,Q=new X,ne=Q._processChunk(W.slice(W.l),Q._finishFlushFlag);return W.l+=Q.bytesRead,ne}function M(W){return ce?ce.deflateRawSync(W):Xe(W)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(W){var te=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(te>>16|te>>8|te)&255}for(var ue=typeof Uint8Array<"u",pe=ue?new Uint8Array(256):[],ke=0;ke<256;++ke)pe[ke]=ae(ke);function z(W,te){var X=pe[W&255];return te<=8?X>>>8-te:(X=X<<8|pe[W>>8&255],te<=16?X>>>16-te:(X=X<<8|pe[W>>16&255],X>>>24-te))}function Be(W,te){var X=te&7,Q=te>>>3;return(W[Q]|(X<=6?0:W[Q+1]<<8))>>>X&3}function Fe(W,te){var X=te&7,Q=te>>>3;return(W[Q]|(X<=5?0:W[Q+1]<<8))>>>X&7}function ze(W,te){var X=te&7,Q=te>>>3;return(W[Q]|(X<=4?0:W[Q+1]<<8))>>>X&15}function Ge(W,te){var X=te&7,Q=te>>>3;return(W[Q]|(X<=3?0:W[Q+1]<<8))>>>X&31}function Ee(W,te){var X=te&7,Q=te>>>3;return(W[Q]|(X<=1?0:W[Q+1]<<8))>>>X&127}function Ue(W,te,X){var Q=te&7,ne=te>>>3,se=(1<<X)-1,xe=W[ne]>>>Q;return X<8-Q||(xe|=W[ne+1]<<8-Q,X<16-Q)||(xe|=W[ne+2]<<16-Q,X<24-Q)||(xe|=W[ne+3]<<24-Q),xe&se}function st(W,te,X){var Q=te&7,ne=te>>>3;return Q<=5?W[ne]|=(X&7)<<Q:(W[ne]|=X<<Q&255,W[ne+1]=(X&7)>>8-Q),te+3}function tt(W,te,X){var Q=te&7,ne=te>>>3;return X=(X&1)<<Q,W[ne]|=X,te+1}function at(W,te,X){var Q=te&7,ne=te>>>3;return X<<=Q,W[ne]|=X&255,X>>>=8,W[ne+1]=X,te+8}function je(W,te,X){var Q=te&7,ne=te>>>3;return X<<=Q,W[ne]|=X&255,X>>>=8,W[ne+1]=X&255,W[ne+2]=X>>>8,te+16}function er(W,te){var X=W.length,Q=2*X>te?2*X:te+5,ne=0;if(X>=te)return W;if(Zt){var se=YB(Q);if(W.copy)W.copy(se);else for(;ne<W.length;++ne)se[ne]=W[ne];return se}else if(ue){var xe=new Uint8Array(Q);if(xe.set)xe.set(W);else for(;ne<X;++ne)xe[ne]=W[ne];return xe}return W.length=Q,W}function Nt(W){for(var te=new Array(W),X=0;X<W;++X)te[X]=0;return te}function jt(W,te,X){var Q=1,ne=0,se=0,xe=0,Re=0,ge=W.length,fe=ue?new Uint16Array(32):Nt(32);for(se=0;se<32;++se)fe[se]=0;for(se=ge;se<X;++se)W[se]=0;ge=W.length;var G=ue?new Uint16Array(ge):Nt(ge);for(se=0;se<ge;++se)fe[ne=W[se]]++,Q<ne&&(Q=ne),G[se]=0;for(fe[0]=0,se=1;se<=Q;++se)fe[se+16]=Re=Re+fe[se-1]<<1;for(se=0;se<ge;++se)Re=W[se],Re!=0&&(G[se]=fe[Re+16]++);var de=0;for(se=0;se<ge;++se)if(de=W[se],de!=0)for(Re=z(G[se],Q)>>Q-de,xe=(1<<Q+4-de)-1;xe>=0;--xe)te[Re|xe<<de]=de&15|se<<4;return Q}var Dt=ue?new Uint16Array(512):Nt(512),Et=ue?new Uint16Array(32):Nt(32);if(!ue){for(var Ct=0;Ct<512;++Ct)Dt[Ct]=0;for(Ct=0;Ct<32;++Ct)Et[Ct]=0}(function(){for(var W=[],te=0;te<32;te++)W.push(5);jt(W,Et,32);var X=[];for(te=0;te<=143;te++)X.push(8);for(;te<=255;te++)X.push(9);for(;te<=279;te++)X.push(7);for(;te<=287;te++)X.push(8);jt(X,Dt,288)})();var Rt=function(){for(var te=ue?new Uint8Array(32768):[],X=0,Q=0;X<J.length-1;++X)for(;Q<J[X+1];++Q)te[Q]=X;for(;Q<32768;++Q)te[Q]=29;var ne=ue?new Uint8Array(259):[];for(X=0,Q=0;X<V.length-1;++X)for(;Q<V[X+1];++Q)ne[Q]=X;function se(Re,ge){for(var fe=0;fe<Re.length;){var G=Math.min(65535,Re.length-fe),de=fe+G==Re.length;for(ge.write_shift(1,+de),ge.write_shift(2,G),ge.write_shift(2,~G&65535);G-- >0;)ge[ge.l++]=Re[fe++]}return ge.l}function xe(Re,ge){for(var fe=0,G=0,de=ue?new Uint16Array(32768):[];G<Re.length;){var Ce=Math.min(65535,Re.length-G);if(Ce<10){for(fe=st(ge,fe,+(G+Ce==Re.length)),fe&7&&(fe+=8-(fe&7)),ge.l=fe/8|0,ge.write_shift(2,Ce),ge.write_shift(2,~Ce&65535);Ce-- >0;)ge[ge.l++]=Re[G++];fe=ge.l*8;continue}fe=st(ge,fe,+(G+Ce==Re.length)+2);for(var Ne=0;Ce-- >0;){var Ie=Re[G];Ne=(Ne<<5^Ie)&32767;var Le=-1,it=0;if((Le=de[Ne])&&(Le|=G&-32768,Le>G&&(Le-=32768),Le<G))for(;Re[Le+it]==Re[G+it]&&it<250;)++it;if(it>2){Ie=ne[it],Ie<=22?fe=at(ge,fe,pe[Ie+1]>>1)-1:(at(ge,fe,3),fe+=5,at(ge,fe,pe[Ie-23]>>5),fe+=3);var Wt=Ie<8?0:Ie-4>>2;Wt>0&&(je(ge,fe,it-V[Ie]),fe+=Wt),Ie=te[G-Le],fe=at(ge,fe,pe[Ie]>>3),fe-=3;var tr=Ie<4?0:Ie-2>>1;tr>0&&(je(ge,fe,G-Le-J[Ie]),fe+=tr);for(var vr=0;vr<it;++vr)de[Ne]=G&32767,Ne=(Ne<<5^Re[G])&32767,++G;Ce-=it-1}else Ie<=143?Ie=Ie+48:fe=tt(ge,fe,1),fe=at(ge,fe,pe[Ie]),de[Ne]=G&32767,++G}fe=at(ge,fe,0)-1}return ge.l=(fe+7)/8|0,ge.l}return function(ge,fe){return ge.length<8?se(ge,fe):xe(ge,fe)}}();function Xe(W){var te=li(50+Math.floor(W.length*1.1)),X=Rt(W,te);return te.slice(0,X)}var Je=ue?new Uint16Array(32768):Nt(32768),Lt=ue?new Uint16Array(32768):Nt(32768),nt=ue?new Uint16Array(128):Nt(128),ct=1,ar=1;function vn(W,te){var X=Ge(W,te)+257;te+=5;var Q=Ge(W,te)+1;te+=5;var ne=ze(W,te)+4;te+=4;for(var se=0,xe=ue?new Uint8Array(19):Nt(19),Re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,fe=ue?new Uint8Array(8):Nt(8),G=ue?new Uint8Array(8):Nt(8),de=xe.length,Ce=0;Ce<ne;++Ce)xe[L[Ce]]=se=Fe(W,te),ge<se&&(ge=se),fe[se]++,te+=3;var Ne=0;for(fe[0]=0,Ce=1;Ce<=ge;++Ce)G[Ce]=Ne=Ne+fe[Ce-1]<<1;for(Ce=0;Ce<de;++Ce)(Ne=xe[Ce])!=0&&(Re[Ce]=G[Ne]++);var Ie=0;for(Ce=0;Ce<de;++Ce)if(Ie=xe[Ce],Ie!=0){Ne=pe[Re[Ce]]>>8-Ie;for(var Le=(1<<7-Ie)-1;Le>=0;--Le)nt[Ne|Le<<Ie]=Ie&7|Ce<<3}var it=[];for(ge=1;it.length<X+Q;)switch(Ne=nt[Ee(W,te)],te+=Ne&7,Ne>>>=3){case 16:for(se=3+Be(W,te),te+=2,Ne=it[it.length-1];se-- >0;)it.push(Ne);break;case 17:for(se=3+Fe(W,te),te+=3;se-- >0;)it.push(0);break;case 18:for(se=11+Ee(W,te),te+=7;se-- >0;)it.push(0);break;default:it.push(Ne),ge<Ne&&(ge=Ne);break}var Wt=it.slice(0,X),tr=it.slice(X);for(Ce=X;Ce<286;++Ce)Wt[Ce]=0;for(Ce=Q;Ce<30;++Ce)tr[Ce]=0;return ct=jt(Wt,Je,286),ar=jt(tr,Lt,30),te}function Br(W,te){if(W[0]==3&&!(W[1]&3))return[Uu(te),2];for(var X=0,Q=0,ne=YB(te||1<<18),se=0,xe=ne.length>>>0,Re=0,ge=0;(Q&1)==0;){if(Q=Fe(W,X),X+=3,Q>>>1)Q>>1==1?(Re=9,ge=5):(X=vn(W,X),Re=ct,ge=ar);else{X&7&&(X+=8-(X&7));var fe=W[X>>>3]|W[(X>>>3)+1]<<8;if(X+=32,fe>0)for(!te&&xe<se+fe&&(ne=er(ne,se+fe),xe=ne.length);fe-- >0;)ne[se++]=W[X>>>3],X+=8;continue}for(;;){!te&&xe<se+32767&&(ne=er(ne,se+32767),xe=ne.length);var G=Ue(W,X,Re),de=Q>>>1==1?Dt[G]:Je[G];if(X+=de&15,de>>>=4,(de>>>8&255)===0)ne[se++]=de;else{if(de==256)break;de-=257;var Ce=de<8?0:de-4>>2;Ce>5&&(Ce=0);var Ne=se+V[de];Ce>0&&(Ne+=Ue(W,X,Ce),X+=Ce),G=Ue(W,X,ge),de=Q>>>1==1?Et[G]:Lt[G],X+=de&15,de>>>=4;var Ie=de<4?0:de-2>>1,Le=J[de];for(Ie>0&&(Le+=Ue(W,X,Ie),X+=Ie),!te&&xe<Ne&&(ne=er(ne,Ne+100),xe=ne.length);se<Ne;)ne[se]=ne[se-Le],++se}}}return te?[ne,X+7>>>3]:[ne.slice(0,se),X+7>>>3]}function qr(W,te){var X=W.slice(W.l||0),Q=Br(X,te);return W.l+=Q[1],Q[0]}function Wn(W,te){if(W)typeof console<"u"&&console.error(te);else throw new Error(te)}function Ai(W,te){var X=W;Ni(X,0);var Q=[],ne=[],se={FileIndex:Q,FullPaths:ne};D(se,{root:te.root});for(var xe=X.length-4;(X[xe]!=80||X[xe+1]!=75||X[xe+2]!=5||X[xe+3]!=6)&&xe>=0;)--xe;X.l=xe+4,X.l+=4;var Re=X.read_shift(2);X.l+=6;var ge=X.read_shift(4);for(X.l=ge,xe=0;xe<Re;++xe){X.l+=20;var fe=X.read_shift(4),G=X.read_shift(4),de=X.read_shift(2),Ce=X.read_shift(2),Ne=X.read_shift(2);X.l+=8;var Ie=X.read_shift(4),Le=a(X.slice(X.l+de,X.l+de+Ce));X.l+=de+Ce+Ne;var it=X.l;X.l=Ie+4,ga(X,fe,G,se,Le),X.l=it}return se}function ga(W,te,X,Q,ne){W.l+=2;var se=W.read_shift(2),xe=W.read_shift(2),Re=o(W);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var ge=W.read_shift(4),fe=W.read_shift(4),G=W.read_shift(4),de=W.read_shift(2),Ce=W.read_shift(2),Ne="",Ie=0;Ie<de;++Ie)Ne+=String.fromCharCode(W[W.l++]);if(Ce){var Le=a(W.slice(W.l,W.l+Ce));(Le[21589]||{}).mt&&(Re=Le[21589].mt),((ne||{})[21589]||{}).mt&&(Re=ne[21589].mt)}W.l+=Ce;var it=W.slice(W.l,W.l+fe);switch(xe){case 8:it=A(W,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var Wt=!1;se&8&&(ge=W.read_shift(4),ge==134695760&&(ge=W.read_shift(4),Wt=!0),fe=W.read_shift(4),G=W.read_shift(4)),fe!=te&&Wn(Wt,"Bad compressed size: "+te+" != "+fe),G!=X&&Wn(Wt,"Bad uncompressed size: "+X+" != "+G),ht(Q,Ne,it,{unsafe:!0,mt:Re})}function ii(W,te){var X=te||{},Q=[],ne=[],se=li(1),xe=X.compression?8:0,Re=0,ge=0,fe=0,G=0,de=0,Ce=W.FullPaths[0],Ne=Ce,Ie=W.FileIndex[0],Le=[],it=0;for(ge=1;ge<W.FullPaths.length;++ge)if(Ne=W.FullPaths[ge].slice(Ce.length),Ie=W.FileIndex[ge],!(!Ie.size||!Ie.content||Ne=="Sh33tJ5")){var Wt=G,tr=li(Ne.length);for(fe=0;fe<Ne.length;++fe)tr.write_shift(1,Ne.charCodeAt(fe)&127);tr=tr.slice(0,tr.l),Le[de]=$ge.buf(Ie.content,0);var vr=Ie.content;xe==8&&(vr=M(vr)),se=li(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Re),se.write_shift(2,xe),Ie.mt?s(se,Ie.mt):se.write_shift(4,0),se.write_shift(-4,Le[de]),se.write_shift(4,vr.length),se.write_shift(4,Ie.content.length),se.write_shift(2,tr.length),se.write_shift(2,0),G+=se.length,Q.push(se),G+=tr.length,Q.push(tr),G+=vr.length,Q.push(vr),se=li(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Re),se.write_shift(2,xe),se.write_shift(4,0),se.write_shift(-4,Le[de]),se.write_shift(4,vr.length),se.write_shift(4,Ie.content.length),se.write_shift(2,tr.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Wt),it+=se.l,ne.push(se),it+=tr.length,ne.push(tr),++de}return se=li(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,de),se.write_shift(2,de),se.write_shift(4,it),se.write_shift(4,G),se.write_shift(2,0),Tu([Tu(Q),Tu(ne),se])}var So={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Xa(W,te){if(W.ctype)return W.ctype;var X=W.name||"",Q=X.match(/\.([^\.]+)$/);return Q&&So[Q[1]]||te&&(Q=(X=te).match(/[\.\\]([^\.\\])+$/),Q&&So[Q[1]])?So[Q[1]]:"application/octet-stream"}function Or(W){for(var te=GB(W),X=[],Q=0;Q<te.length;Q+=76)X.push(te.slice(Q,Q+76));return X.join(`\r
`)+`\r
`}function zi(W){var te=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var G=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],Q=te.split(`\r
`),ne=0;ne<Q.length;++ne){var se=Q[ne];if(se.length==0){X.push("");continue}for(var xe=0;xe<se.length;){var Re=76,ge=se.slice(xe,xe+Re);ge.charAt(Re-1)=="="?Re--:ge.charAt(Re-2)=="="?Re-=2:ge.charAt(Re-3)=="="&&(Re-=3),ge=se.slice(xe,xe+Re),xe+=Re,xe<se.length&&(ge+="="),X.push(ge)}}return X.join(`\r
`)}function yt(W){for(var te=[],X=0;X<W.length;++X){for(var Q=W[X];X<=W.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+W[++X];te.push(Q)}for(var ne=0;ne<te.length;++ne)te[ne]=te[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return Ia(te.join(`\r
`))}function On(W,te,X){for(var Q="",ne="",se="",xe,Re=0;Re<10;++Re){var ge=te[Re];if(!ge||ge.match(/^\s*$/))break;var fe=ge.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":Q=fe[2].trim();break;case"content-type":se=fe[2].trim();break;case"content-transfer-encoding":ne=fe[2].trim();break}}switch(++Re,ne.toLowerCase()){case"base64":xe=Ia(yo(te.slice(Re).join("")));break;case"quoted-printable":xe=yt(te.slice(Re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var G=ht(W,Q.slice(X.length),xe,{unsafe:!0});se&&(G.ctype=se)}function We(W,te){if(ie(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=te&&te.root||"",Q=(Zt&&Buffer.isBuffer(W)?W.toString("binary"):ie(W)).split(`\r
`),ne=0,se="";for(ne=0;ne<Q.length;++ne)if(se=Q[ne],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),X||(X=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),se.slice(0,X.length)!=X););var xe=(Q[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var Re="--"+(xe[1]||""),ge=[],fe=[],G={FileIndex:ge,FullPaths:fe};D(G);var de,Ce=0;for(ne=0;ne<Q.length;++ne){var Ne=Q[ne];Ne!==Re&&Ne!==Re+"--"||(Ce++&&On(G,Q.slice(de,ne),X),de=ne)}return G}function qe(W,te){var X=te||{},Q=X.boundary||"SheetJS";Q="------="+Q;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],se=W.FullPaths[0],xe=se,Re=W.FileIndex[0],ge=1;ge<W.FullPaths.length;++ge)if(xe=W.FullPaths[ge].slice(se.length),Re=W.FileIndex[ge],!(!Re.size||!Re.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var fe=Re.content,G=Zt&&Buffer.isBuffer(fe)?fe.toString("binary"):ie(fe),de=0,Ce=Math.min(1024,G.length),Ne=0,Ie=0;Ie<=Ce;++Ie)(Ne=G.charCodeAt(Ie))>=32&&Ne<128&&++de;var Le=de>=Ce*4/5;ne.push(Q),ne.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+xe),ne.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),ne.push("Content-Type: "+Xa(Re,xe)),ne.push(""),ne.push(Le?zi(G):Or(G))}return ne.push(Q+`--\r
`),ne.join(`\r
`)}function ut(W){var te={};return D(te,W),te}function ht(W,te,X,Q){var ne=Q&&Q.unsafe;ne||D(W);var se=!ne&&ir.find(W,te);if(!se){var xe=W.FullPaths[0];te.slice(0,xe.length)==xe?xe=te:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+te).replace("//","/")),se={name:i(te),type:2},W.FileIndex.push(se),W.FullPaths.push(xe),ne||ir.utils.cfb_gc(W)}return se.content=X,se.size=X?X.length:0,Q&&(Q.CLSID&&(se.clsid=Q.CLSID),Q.mt&&(se.mt=Q.mt),Q.ct&&(se.ct=Q.ct)),se}function Ot(W,te){D(W);var X=ir.find(W,te);if(X){for(var Q=0;Q<W.FileIndex.length;++Q)if(W.FileIndex[Q]==X)return W.FileIndex.splice(Q,1),W.FullPaths.splice(Q,1),!0}return!1}function hn(W,te,X){D(W);var Q=ir.find(W,te);if(Q){for(var ne=0;ne<W.FileIndex.length;++ne)if(W.FileIndex[ne]==Q)return W.FileIndex[ne].name=i(X),W.FullPaths[ne]=X,!0}return!1}function Ts(W){N(W,!0)}return e.find=B,e.read=P,e.parse=h,e.write=K,e.writeFile=ve,e.utils={cfb_new:ut,cfb_add:ht,cfb_del:Ot,cfb_mov:hn,cfb_gc:Ts,ReadShift:kg,CheckField:mY,prep_blob:Ni,bconcat:Tu,use_zlib:S,_deflateRaw:Xe,_inflateRaw:qr,consts:Z},e}();function Gge(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Nl(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function vP(t){for(var e=[],r=Nl(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var bb=new Date(1899,11,30,0,0,0);function ws(t,e){var r=t.getTime(),n=bb.getTime()+(t.getTimezoneOffset()-bb.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var qG=new Date,Yge=bb.getTime()+(qG.getTimezoneOffset()-bb.getTimezoneOffset())*6e4,t5=qG.getTimezoneOffset();function LS(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Yge),e.getTimezoneOffset()!==t5&&e.setTime(e.getTime()+(e.getTimezoneOffset()-t5)*6e4),e}function qge(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var r5=new Date("2017-02-19T19:06:09.000Z"),KG=isNaN(r5.getFullYear())?new Date("2/19/17"):r5,Kge=KG.getFullYear()==2017;function Si(t,e){var r=new Date(t);if(Kge)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(KG.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function wh(t,e){if(Zt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ug(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ug(NG(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ug(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ug(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Vi(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Vi(t[r]));return e}function Rn(t,e){for(var r="";r.length<e;)r+=t;return r}function Ba(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var Xge=["january","february","march","april","may","june","july","august","september","october","november","december"];function jp(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Xge.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Qge=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}}();function XG(t){return t?t.content&&t.type?wh(t.content,!0):t.data?ag(t.data):t.asNodeBuffer&&Zt?ag(t.asNodeBuffer().toString("binary")):t.asBinary?ag(t.asBinary()):t._data&&t._data.getContent?ag(wh(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function QG(t){if(!t)return null;if(t.data)return UB(t.data);if(t.asNodeBuffer&&Zt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?UB(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Zge(t){return t&&t.name.slice(-4)===".bin"?QG(t):XG(t)}function Wo(t,e){for(var r=t.FullPaths||Nl(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function yP(t,e){var r=Wo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function qn(t,e,r){if(!r)return Zge(yP(t,e));if(!e)return null;try{return qn(t,e)}catch{return null}}function co(t,e,r){if(!r)return XG(yP(t,e));if(!e)return null;try{return co(t,e)}catch{return null}}function Jge(t,e,r){return QG(yP(t,e))}function n5(t){for(var e=t.FullPaths||Nl(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function eve(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Zt?n=Nh(r):n=xge(r),ir.utils.cfb_add(t,e,n)}ir.utils.cfb_add(t,e,r)}else t.file(e,r)}function ZG(t,e){switch(e.type){case"base64":return ir.read(t,{type:"base64"});case"binary":return ir.read(t,{type:"binary"});case"buffer":case"array":return ir.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function cg(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var JG=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,tve=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,i5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,rve=/<[^>]*>/g,os=JG.match(i5)?i5:rve,nve=/<\w*:/,ive=/<(\/?)\w+:/;function bt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(tve),a=0,l="",u=0,h="",d="",m=1;if(o)for(u=0;u!=o.length;++u){for(d=o[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(h=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(m=(i=d.charCodeAt(s+1))==34||i==39?1:0,l=d.slice(s+1+m,d.length-m),a=0;a!=h.length&&h.charCodeAt(a)!==58;++a);if(a===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=l,n[h.toLowerCase()]=l;else{var g=(a===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(a+1);if(n[g]&&h.slice(a-3,a)=="ext")continue;n[g]=l,n[g.toLowerCase()]=l}}return n}function Bl(t){return t.replace(ive,"<$1")}var eY={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},sve=vP(eY),ur=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(a,l){return eY[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(e,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),ove=/[&<>'"]/g,ave=/[\u0000-\u001f]/g;function xP(t){var e=t+"";return e.replace(ove,function(r){return sve[r]}).replace(/\n/g,"<br/>").replace(ave,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var s5=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function ln(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function uR(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function o5(t){var e=Uu(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function a5(t){return Nh(t,"binary").toString("utf8")}var m1="foo bar baz",Ur=Zt&&(a5(m1)==uR(m1)&&a5||o5(m1)==uR(m1)&&o5)||uR,ug=Zt?function(t){return Nh(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},pv=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),tY=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),lve=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),cve=/<\/?(?:vt:)?variant>/g,uve=/<(?:vt:)([^>]*)>([\s\S]*)</;function l5(t,e){var r=bt(t),n=t.match(lve(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(cve,"").match(uve);o&&i.push({v:Ur(o[2]),t:o[1]})}),i}var fve=/(^\s|\s$|\n)/;function hve(t){return Nl(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function dve(t,e,r){return"<"+t+(r!=null?hve(r):"")+(e!=null?(e.match(fve)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function wP(t){if(Zt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ur(Lh(pP(t)));throw new Error("Bad input format: expected Buffer or string")}var mv=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pve={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},mve=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function gve(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function vve(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var c5=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},u5=Zt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Nh(e)})):c5(t)}:c5,f5=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Sc(t,i)));return n.join("").replace(vs,"")},bP=Zt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(vs,""):f5(t,e,r)}:f5,h5=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},rY=Zt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):h5(t,e,r)}:h5,d5=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Qd(t,i)));return n.join("")},cy=Zt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):d5(e,r,n)}:d5,nY=function(t,e){var r=ao(t,e);return r>0?cy(t,e+4,e+4+r-1):""},iY=nY,sY=function(t,e){var r=ao(t,e);return r>0?cy(t,e+4,e+4+r-1):""},oY=sY,aY=function(t,e){var r=2*ao(t,e);return r>0?cy(t,e+4,e+4+r-1):""},lY=aY,cY=function(e,r){var n=ao(e,r);return n>0?bP(e,r+4,r+4+n):""},uY=cY,fY=function(t,e){var r=ao(t,e);return r>0?cy(t,e+4,e+4+r):""},hY=fY,dY=function(t,e){return gve(t,e)},Sb=dY,pY=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Zt&&(iY=function(e,r){if(!Buffer.isBuffer(e))return nY(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},oY=function(e,r){if(!Buffer.isBuffer(e))return sY(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},lY=function(e,r){if(!Buffer.isBuffer(e))return aY(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},uY=function(e,r){if(!Buffer.isBuffer(e))return cY(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},hY=function(e,r){if(!Buffer.isBuffer(e))return fY(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Sb=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):dY(e,r)},pY=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Qd=function(t,e){return t[e]},Sc=function(t,e){return t[e+1]*256+t[e]},yve=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ao=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Gf=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},xve=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function kg(t,e){var r="",n,i,s=[],o,a,l,u;switch(e){case"dbcs":if(u=this.l,Zt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Sc(this,u)),u+=2;t*=2;break;case"utf8":r=cy(this,this.l,this.l+t);break;case"utf16le":t*=2,r=bP(this,this.l,this.l+t);break;case"wstr":return kg.call(this,t,"dbcs");case"lpstr-ansi":r=iY(this,this.l),t=4+ao(this,this.l);break;case"lpstr-cp":r=oY(this,this.l),t=4+ao(this,this.l);break;case"lpwstr":r=lY(this,this.l),t=4+2*ao(this,this.l);break;case"lpp4":t=4+ao(this,this.l),r=uY(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ao(this,this.l),r=hY(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Qd(this,this.l+t++))!==0;)s.push(p1(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Sc(this,this.l+t))!==0;)s.push(p1(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Qd(this,u),this.l=u+1,a=kg.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(p1(Sc(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Qd(this,u),this.l=u+1,a=kg.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(p1(Qd(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Qd(this,this.l),this.l++,n;case 2:return n=(e==="i"?yve:Sc)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Gf:xve)(this,this.l),this.l+=4,n):(i=ao(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Sb(this,this.l):i=Sb([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=rY(this,this.l,t);break}}return this.l+=t,r}var wve=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},bve=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Sve=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Cve(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)Sve(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,wve(this,e,this.l);break;case 8:if(n=8,r==="f"){vve(this,e,this.l);break}case 16:break;case-4:n=4,bve(this,e,this.l);break}return this.l+=n,this}function mY(t,e){var r=rY(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Ni(t,e){t.l=e,t.read_shift=kg,t.chk=mY,t.write_shift=Cve}function ss(t,e){t.l+=e}function li(t){var e=Uu(t);return Ni(e,0),e}function Bc(t,e,r){if(t){var n,i,s;Ni(t,t.l||0);for(var o=t.length,a=0,l=0;t.l<o;){a=t.read_shift(1),a&128&&(a=(a&127)+((t.read_shift(1)&127)<<7));var u=kb[a]||kb[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var h=u.f&&u.f(t,s,r);if(t.l=l,e(h,u,a))return}}}function u_(){var t=[],e=Zt?256:2048,r=function(u){var h=li(u);return Ni(h,0),h},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},o=function(){return i(),Tu(t)},a=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function Og(t,e,r){var n=Vi(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function p5(t,e,r){var n=Vi(t);return n.s=Og(n.s,e.s,r),n.e=Og(n.e,e.s,r),n}function _g(t,e){if(t.cRel&&t.c<0)for(t=Vi(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Vi(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=At(t);return!t.cRel&&t.cRel!=null&&(r=Rve(r)),!t.rRel&&t.rRel!=null&&(r=Tve(r)),r}function fR(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ui(t.s.c)+":"+(t.e.cRel?"":"$")+ui(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ji(t.s.r)+":"+(t.e.rRel?"":"$")+ji(t.e.r):_g(t.s,e.biff)+":"+_g(t.e,e.biff)}function SP(t){return parseInt(Eve(t),10)-1}function ji(t){return""+(t+1)}function Tve(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Eve(t){return t.replace(/\$(\d+)$/,"$1")}function CP(t){for(var e=Ave(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function ui(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Rve(t){return t.replace(/^([A-Z])/,"$$$1")}function Ave(t){return t.replace(/^\$([A-Z])/,"$1")}function kve(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gs(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function At(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function l0(t){var e=t.indexOf(":");return e==-1?{s:gs(t),e:gs(t)}:{s:gs(t.slice(0,e)),e:gs(t.slice(e+1))}}function sr(t,e){return typeof e>"u"||typeof e=="number"?sr(t.s,t.e):(typeof t!="string"&&(t=At(t)),typeof e!="string"&&(e=At(e)),t==e?t:t+":"+e)}function An(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function m5(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=sa(t.z,r?ws(e):e)}catch{}try{return t.w=sa((t.XF||{}).numFmtId||(r?14:0),r?ws(e):e)}catch{return""+e}}function Ic(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Bh[t.v]||t.v:e==null?m5(t,t.v):m5(t,e))}function tf(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function gY(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?gs(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=An(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(u.e.r=o=h.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[d].length;++m)if(!(typeof e[d][m]>"u")){var g={v:e[d][m]},y=o+d,x=a+m;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[d][m]&&typeof e[d][m]=="object"&&!Array.isArray(e[d][m])&&!(e[d][m]instanceof Date))g=e[d][m];else if(Array.isArray(g.v)&&(g.f=e[d][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||_t[14],n.cellDates?(g.t="d",g.w=sa(g.z,ws(g.v))):(g.t="n",g.v=ws(g.v),g.w=sa(g.z,g.v))):g.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(g.z=s[y][x].z),s[y][x]=g;else{var b=At({c:x,r:y});s[b]&&s[b].z&&(g.z=s[b].z),s[b]=g}}}return u.s.c<1e7&&(s["!ref"]=sr(u)),s}function c0(t,e){return gY(null,t,e)}function Ove(t){return t.read_shift(4,"i")}function ns(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function _ve(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function TP(t,e){var r=t.l,n=t.read_shift(1),i=ns(t),s=[],o={t:i,h:i};if((n&1)!==0){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(_ve(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}var Mve=TP;function ca(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Fh(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var Dve=ns;function EP(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var Pve=ns,f_=EP;function RP(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Sb([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Gf(e,0)>>2;return r?i/100:i}function vY(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Hh=vY;function Ji(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ive(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=fh[i];u&&(e.rgb=vv(u));break;case 2:e.rgb=vv([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Nve(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function yY(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Lve(t){return yY(t,1)}function Fve(t){return yY(t,2)}var AP=2,Is=3,g1=11,g5=12,Cb=19,v1=64,Hve=65,Bve=71,Vve=4108,jve=4126,xi=80,xY=81,Wve=[xi,xY],zve={1:{n:"CodePage",t:AP},2:{n:"Category",t:xi},3:{n:"PresentationFormat",t:xi},4:{n:"ByteCount",t:Is},5:{n:"LineCount",t:Is},6:{n:"ParagraphCount",t:Is},7:{n:"SlideCount",t:Is},8:{n:"NoteCount",t:Is},9:{n:"HiddenCount",t:Is},10:{n:"MultimediaClipCount",t:Is},11:{n:"ScaleCrop",t:g1},12:{n:"HeadingPairs",t:Vve},13:{n:"TitlesOfParts",t:jve},14:{n:"Manager",t:xi},15:{n:"Company",t:xi},16:{n:"LinksUpToDate",t:g1},17:{n:"CharacterCount",t:Is},19:{n:"SharedDoc",t:g1},22:{n:"HyperlinksChanged",t:g1},23:{n:"AppVersion",t:Is,p:"version"},24:{n:"DigSig",t:Hve},26:{n:"ContentType",t:xi},27:{n:"ContentStatus",t:xi},28:{n:"Language",t:xi},29:{n:"Version",t:xi},255:{},2147483648:{n:"Locale",t:Cb},2147483651:{n:"Behavior",t:Cb},1919054434:{}},Uve={1:{n:"CodePage",t:AP},2:{n:"Title",t:xi},3:{n:"Subject",t:xi},4:{n:"Author",t:xi},5:{n:"Keywords",t:xi},6:{n:"Comments",t:xi},7:{n:"Template",t:xi},8:{n:"LastAuthor",t:xi},9:{n:"RevNumber",t:xi},10:{n:"EditTime",t:v1},11:{n:"LastPrinted",t:v1},12:{n:"CreatedDate",t:v1},13:{n:"ModifiedDate",t:v1},14:{n:"PageCount",t:Is},15:{n:"WordCount",t:Is},16:{n:"CharCount",t:Is},17:{n:"Thumbnail",t:Bve},18:{n:"Application",t:xi},19:{n:"DocSecurity",t:Is},255:{},2147483648:{n:"Locale",t:Cb},2147483651:{n:"Behavior",t:Cb},1919054434:{}},v5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},$ve=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Gve(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Yve=Gve([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fh=Vi(Yve),Bh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},wY={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},y5={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function qve(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Kve(t){var e=qve();if(!t||!t.match)return e;var r={};if((t.match(os)||[]).forEach(function(n){var i=bt(n);switch(i[0].replace(nve,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[y5[i.ContentType]]!==void 0&&e[y5[i.ContentType]].push(i.PartName);break}}),e.xmlns!==pve.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var lp={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function h_(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Mg(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(os)||[]).forEach(function(i){var s=bt(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:cg(s.Target,e);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}var Xve="application/vnd.oasis.opendocument.spreadsheet";function Qve(t,e){for(var r=wP(t),n,i;n=mv.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=bt(n[0],!1),i.path=="/"&&i.type!==Xve)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Dg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Zve=function(){for(var t=new Array(Dg.length),e=0;e<Dg.length;++e){var r=Dg[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function bY(t){var e={};t=Ur(t);for(var r=0;r<Dg.length;++r){var n=Dg[r],i=t.match(Zve[r]);i!=null&&i.length>0&&(e[n[1]]=ur(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Si(e[n[1]]))}return e}var Jve=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function SY(t,e,r,n){var i=[];if(typeof t=="string")i=l5(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(h){return{v:h}}));var o=typeof e=="string"?l5(e,n).map(function(h){return h.v}):e,a=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function eye(t,e,r){var n={};return e||(e={}),t=Ur(t),Jve.forEach(function(i){var s=(t.match(pv(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=ur(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&SY(n.HeadingPairs,n.TitlesOfParts,e,r),e}var tye=/<[^>]+>[^<]*/g;function rye(t,e){var r={},n="",i=t.match(tye);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=bt(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ur(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),h=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=ur(h);break;case"bool":r[n]=ln(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Si(h);break;case"cy":case"error":r[n]=ur(h);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}var nye={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},hR;function iye(t,e,r){hR||(hR=vP(nye)),e=hR[e]||e,t[e]=r}function kP(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function CY(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function TY(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function EY(t,e,r){return e===31?TY(t):CY(t,e,r)}function d_(t,e,r){return EY(t,e,r===!1?0:4)}function sye(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return EY(t,e,0)}function oye(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(vs,""),t.l-i&2&&(t.l+=2)}return r}function aye(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(vs,"");return r}function lye(t){var e=t.l,r=Tb(t,xY);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Tb(t,Is);return[r,n]}function cye(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(lye(t));return r}function x5(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(vs,"").replace(lg,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function RY(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function uye(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Tb(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==g5&&n!==e&&Wve.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===g5?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return CY(t,n,4).replace(vs,"");case 31:return TY(t);case 64:return kP(t);case 65:return RY(t);case 71:return uye(t);case 80:return d_(t,n,!s.raw).replace(vs,"");case 81:return sye(t,n).replace(vs,"");case 4108:return cye(t);case 4126:case 4127:return n==4127?oye(t):aye(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function w5(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0,a=0,l=-1,u={};for(o=0;o!=i;++o){var h=t.read_shift(4),d=t.read_shift(4);s[o]=[h,d+r]}s.sort(function(E,R){return E[1]-R[1]});var m={};for(o=0;o!=i;++o){if(t.l!==s[o][1]){var g=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],g=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],g=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(g=!1,t.l=s[o][1]),g)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var y=e[s[o][0]];if(m[y.n]=Tb(t,y.t,{raw:!0}),y.p==="version"&&(m[y.n]=String(m[y.n]>>16)+"."+("0000"+String(m[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(m[y.n]){case 0:m[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Na(a=m[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[y.n])}}else if(s[o][0]===1){if(a=m.CodePage=Tb(t,AP),Na(a),l!==-1){var x=t.l;t.l=s[l][1],u=x5(t,a),t.l=x}}else if(s[o][0]===0){if(a===0){l=o,t.l=s[o+1][1];continue}u=x5(t,a)}else{var b=u[s[o][0]],C;switch(t[t.l]){case 65:t.l+=4,C=RY(t);break;case 30:t.l+=4,C=d_(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,C=d_(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,C=t.read_shift(4,"i");break;case 19:t.l+=4,C=t.read_shift(4);break;case 5:t.l+=4,C=t.read_shift(8,"f");break;case 11:t.l+=4,C=Pn(t,4);break;case 64:t.l+=4,C=Si(kP(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[b]=C}}return t.l=r+n,m}function b5(t,e,r){var n=t.content;if(!n)return{};Ni(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==ir.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var d=w5(n,e),m={SystemIdentifier:u};for(var g in d)m[g]=d[g];if(m.FMTID=s,i===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=w5(n,null)}catch{}for(g in y)m[g]=y[g];return m.FMTID=[s,o],m}function mu(t,e){return t.read_shift(e),null}function fye(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Pn(t,e){return t.read_shift(e)===1}function Kn(t){return t.read_shift(2,"u")}function AY(t,e){return fye(t,e,Kn)}function hye(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function uy(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function dye(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,a,l={};i&&(o=t.read_shift(2)),n&&(a=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",h=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*o),n&&(t.l+=a),l.t=h,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function bh(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function fy(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):bh(t,n,r)}function Vh(t,e,r){if(r.biff>5)return fy(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function pye(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function mye(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(vs,"");return n&&(t.l+=24),i}function gye(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(vs,"");return r+o}function vye(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return mye(t);case"0303000000000000c000000000000046":return gye(t);default:throw new Error("Unsupported Moniker "+r)}}function y1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(vs,""):"";return r}function yye(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,o,a,l,u="",h,d;i&16&&(s=y1(t,r-t.l)),i&128&&(o=y1(t,r-t.l)),(i&257)===257&&(a=y1(t,r-t.l)),(i&257)===1&&(l=vye(t,r-t.l)),i&8&&(u=y1(t,r-t.l)),i&32&&(h=t.read_shift(16)),i&64&&(d=kP(t)),t.l=r;var m=o||a||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return h&&(g.guid=h),d&&(g.time=d),s&&(g.Tooltip=s),g}function kY(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function OY(t,e){var r=kY(t);return r[3]=0,r}function Vl(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function xye(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function wye(t,e,r){return e===0?"":Vh(t,e,r)}function bye(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function _Y(t){var e=t.read_shift(2),r=RP(t);return[e,r]}function Sye(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=uy(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function FS(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function MY(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var Cye=MY;function DY(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Tye(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Eye(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Gi(t){t.l+=2,t.l+=t.read_shift(2)}var Rye={0:Gi,4:Gi,5:Gi,6:Gi,7:Eye,8:Gi,9:Gi,10:Gi,11:Gi,12:Gi,13:Tye,14:Gi,15:Gi,16:Gi,17:Gi,18:Gi,19:Gi,20:Gi,21:DY};function Aye(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(Rye[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function x1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function kye(t,e){return e===0||t.read_shift(2),1200}function Oye(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Vh(t,0,r);return t.read_shift(e+n-t.l),i}function _ye(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Mye(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=uy(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Dye(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0;o!=i&&t.l<r;++o)s.push(dye(t));return s.Count=n,s.Unique=i,s}function Pye(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function Iye(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function Nye(t){var e=xye(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function Lye(t){return t.read_shift(2),t.read_shift(4)}function S5(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Fye(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:l,TabRatio:u}}function Hye(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Bye(){}function Vye(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=uy(t,0,r),n}function jye(t){var e=Vl(t);return e.isst=t.read_shift(4),e}function Wye(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Vl(t);r.biff==2&&t.l++;var s=fy(t,n-t.l,r);return i.val=s,i}function zye(t,e,r){var n=t.read_shift(2),i=Vh(t,0,r);return[n,i]}var Uye=Vh;function C5(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),o=t.read_shift(i),a=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function $ye(t){var e=t.read_shift(2),r=t.read_shift(2),n=_Y(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Gye(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(_Y(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function Yye(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function qye(t,e,r,n){var i={},s=t.read_shift(4),o=t.read_shift(4),a=t.read_shift(4),l=t.read_shift(2);return i.patternType=$ve[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function Kye(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=qye(t,e,n.fStyle,r),n}function Xye(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function T5(t,e,r){var n=Vl(t);(r.biff==2||e==9)&&++t.l;var i=hye(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function Qye(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vl(t),i=Ji(t);return n.val=i,n}var E5=wye;function Zye(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=bh(t,s),a=[];n>t.l;)a.push(fy(t));return[s,i,o,a]}function R5(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Sye(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var Jye=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function A5(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),a=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=bh(t,o,r);i&32&&(u=Jye[u.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var d=n==t.l||a===0||!(h>0)?[]:Ibe(t,h,r,a);return{chKey:s,Name:u,itab:l,rgce:d}}function PY(t,e,r){if(r.biff<8)return exe(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(bye(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function exe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=uy(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function txe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=bh(t,n,r),o=bh(t,i,r);return[s,o]}function rxe(t,e,r){var n=MY(t);t.l++;var i=t.read_shift(1);return e-=8,[Nbe(t,e,r),i,n]}function k5(t,e,r){var n=Cye(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Dbe(t,e,r)]}function nxe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function ixe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=Vh(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},a,o,s]}}function sxe(t,e,r){return ixe(t,e,r)}function oxe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(FS(t));return r}function axe(t,e,r){if(r&&r.biff<8)return cxe(t,e,r);var n=DY(t),i=Aye(t,e-22,n[1]);return{cmo:n,ft:i}}var lxe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function cxe(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((lxe[n]||ss)(t,e,r)),{cmo:[i,n,s],ft:o}}function uxe(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=pye(t,6,r);var a=t.read_shift(2);t.read_shift(2),Kn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var h=t[t.l],d=bh(t,t.lens[u+1]-t.lens[u]-1);if(i+=d,i.length>=(h?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function fxe(t,e){var r=FS(t);t.l+=16;var n=yye(t,e-24);return[r,n]}function hxe(t,e){t.read_shift(2);var r=FS(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(vs,""),[r,n]}function dxe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=v5[r]||r,r=t.read_shift(2),e[1]=v5[r]||r,e}function pxe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OY(t));return r}function mxe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OY(t));return r}function gxe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function IY(t,e,r){if(!r.cellStyles)return ss(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function vxe(t,e){var r={};return e<32||(t.l+=16,r.header=Ji(t),r.footer=Ji(t),t.l+=2),r}function yxe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var xxe=Vl,wxe=AY,bxe=fy;function Sxe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function Cxe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vl(t);++t.l;var i=Vh(t,e-7,r);return n.t="str",n.val=i,n}function Txe(t){var e=Vl(t);++t.l;var r=Ji(t);return e.t="n",e.val=r,e}function Exe(t){var e=Vl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Rxe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Axe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function kxe(t,e,r){var n=t.l+e,i=Vl(t),s=t.read_shift(2),o=bh(t,s,r);return t.l=n,i.t="str",i.val=o,i}var Oxe=[2,3,48,49,131,139,140,245],O5=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=vP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var u=[],h=Uu(1);switch(l.type){case"base64":h=Ia(yo(a));break;case"binary":h=Ia(a);break;case"buffer":case"array":h=a;break}Ni(h,0);var d=h.read_shift(1),m=!!(d&136),g=!1,y=!1;switch(d){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,b=521;d==2&&(x=h.read_shift(2)),h.l+=3,d!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(b=h.read_shift(2));var C=h.read_shift(2),E=l.codepage||1252;d!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(E=t[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var R=[],k={},O=Math.min(h.length,d==2?521:b-10-(g?264:0)),P=y?32:11;h.l<O&&h[h.l]!=13;)switch(k={},k.name=hv.utils.decode(E,h.slice(h.l,h.l+P)).replace(/[\u0000\r\n].*$/g,""),h.l+=P,k.type=String.fromCharCode(h.read_shift(1)),d!=2&&!y&&(k.offset=h.read_shift(4)),k.len=h.read_shift(1),d==2&&(k.offset=h.read_shift(2)),k.dec=h.read_shift(1),k.name.length&&R.push(k),d!=2&&(h.l+=y?13:14),k.type){case"B":(!g||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(h[h.l]!==13&&(h.l=b-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=b;var D=0,H=0;for(u[0]=[],H=0;H!=R.length;++H)u[0][H]=R[H].name;for(;x-- >0;){if(h[h.l]===42){h.l+=C;continue}for(++h.l,u[++D]=[],H=0,H=0;H!=R.length;++H){var N=h.slice(h.l,h.l+R[H].len);h.l+=R[H].len,Ni(N,0);var _=hv.utils.decode(E,N);switch(R[H].type){case"C":_.trim().length&&(u[D][H]=_.replace(/\s+$/,""));break;case"D":_.length===8?u[D][H]=new Date(+_.slice(0,4),+_.slice(4,6)-1,+_.slice(6,8)):u[D][H]=_;break;case"F":u[D][H]=parseFloat(_.trim());break;case"+":case"I":u[D][H]=y?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(_.trim().toUpperCase()){case"Y":case"T":u[D][H]=!0;break;case"N":case"F":u[D][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+_+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[D][H]="##MEMO##"+(y?parseInt(_.trim(),10):N.read_shift(4));break;case"N":_=_.replace(/\u0000/g,"").trim(),_&&_!="."&&(u[D][H]=+_||0);break;case"@":u[D][H]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":u[D][H]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":u[D][H]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[D][H]=-N.read_shift(-8,"f");break;case"B":if(g&&R[H].len==8){u[D][H]=N.read_shift(8,"f");break}case"G":case"P":N.l+=R[H].len;break;case"0":if(R[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[H].type)}}}if(d!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=R,u}function n(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=c0(r(a,u),u);return h["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,h}function i(a,l){try{return tf(n(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&Na(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=u_(),d=w_(a,{header:1,raw:!0,cellDates:!0}),m=d[0],g=d.slice(1),y=a["!cols"]||[],x=0,b=0,C=0,E=1;for(x=0;x<m.length;++x){if(((y[x]||{}).DBF||{}).name){m[x]=y[x].DBF.name,++C;continue}if(m[x]!=null){if(++C,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(b=0;b<1024;++b)if(m.indexOf(m[x]+"_"+b)==-1){m[x]+="_"+b;break}}}}var R=An(a["!ref"]),k=[],O=[],P=[];for(x=0;x<=R.e.c-R.s.c;++x){var D="",H="",N=0,_=[];for(b=0;b<g.length;++b)g[b][x]!=null&&_.push(g[b][x]);if(_.length==0||m[x]==null){k[x]="?";continue}for(b=0;b<_.length;++b){switch(typeof _[b]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=_[b]instanceof Date?"D":"C";break;default:H="C"}N=Math.max(N,String(_[b]).length),D=D&&D!=H?"C":H}N>250&&(N=250),H=((y[x]||{}).DBF||{}).type,H=="C"&&y[x].DBF.len>N&&(N=y[x].DBF.len),D=="B"&&H=="N"&&(D="N",P[x]=y[x].DBF.dec,N=y[x].DBF.len),O[x]=D=="C"||H=="N"?N:s[D]||0,E+=O[x],k[x]=D}var B=h.next(32);for(B.write_shift(4,318902576),B.write_shift(4,g.length),B.write_shift(2,296+32*C),B.write_shift(2,E),x=0;x<4;++x)B.write_shift(4,0);for(B.write_shift(4,0|(+e[PG]||3)<<8),x=0,b=0;x<m.length;++x)if(m[x]!=null){var j=h.next(32),ee=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,ee,"sbcs"),j.write_shift(1,k[x]=="?"?"C":k[x],"sbcs"),j.write_shift(4,b),j.write_shift(1,O[x]||s[k[x]]||0),j.write_shift(1,P[x]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),b+=O[x]||s[k[x]]||0}var oe=h.next(264);for(oe.write_shift(4,13),x=0;x<65;++x)oe.write_shift(4,0);for(x=0;x<g.length;++x){var re=h.next(E);for(re.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(k[b]){case"L":re.write_shift(1,g[x][b]==null?63:g[x][b]?84:70);break;case"B":re.write_shift(8,g[x][b]||0,"f");break;case"N":var q="0";for(typeof g[x][b]=="number"&&(q=g[x][b].toFixed(P[b]||0)),C=0;C<O[b]-q.length;++C)re.write_shift(1,32);re.write_shift(1,q,"sbcs");break;case"D":g[x][b]?(re.write_shift(4,("0000"+g[x][b].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(g[x][b].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+g[x][b].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(g[x][b]!=null?g[x][b]:"").slice(0,O[b]);for(re.write_shift(1,Z,"sbcs"),C=0;C<O[b]-Z.length;++C)re.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),_xe=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Nl(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,g){var y=t[g];return typeof y=="number"?$B(y):y},n=function(m,g,y){var x=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?m:$B(x)};t["|"]=254;function i(m,g){switch(g.type){case"base64":return s(yo(m),g);case"binary":return s(m,g);case"buffer":return s(Zt&&Buffer.isBuffer(m)?m.toString("binary"):Lh(m),g);case"array":return s(wh(m),g)}throw new Error("Unrecognized type "+g.type)}function s(m,g){var y=m.split(/[\n\r]+/),x=-1,b=-1,C=0,E=0,R=[],k=[],O=null,P={},D=[],H=[],N=[],_=0,B;for(+g.codepage>=0&&Na(+g.codepage);C!==y.length;++C){_=0;var j=y[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ee=j.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),oe=ee[0],re;if(j.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&k.push(j.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,Z=!1,ve=!1,ie=!1,K=-1,ce=-1;for(E=1;E<ee.length;++E)switch(ee[E].charAt(0)){case"A":break;case"X":b=parseInt(ee[E].slice(1))-1,Z=!0;break;case"Y":for(x=parseInt(ee[E].slice(1))-1,Z||(b=0),B=R.length;B<=x;++B)R[B]=[];break;case"K":re=ee[E].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Ba(re))?isNaN(jp(re).getDate())||(re=Si(re)):(re=Ba(re),O!==null&&a0(O)&&(re=LS(re))),q=!0;break;case"E":ie=!0;var S=yp(ee[E].slice(1),{r:x,c:b});R[x][b]=[R[x][b],S];break;case"S":ve=!0,R[x][b]=[R[x][b],"S5S"];break;case"G":break;case"R":K=parseInt(ee[E].slice(1))-1;break;case"C":ce=parseInt(ee[E].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+j)}if(q&&(R[x][b]&&R[x][b].length==2?R[x][b][0]=re:R[x][b]=re,O=null),ve){if(ie)throw new Error("SYLK shared formula cannot have own formula");var A=K>-1&&R[K][ce];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");R[x][b][1]=UY(A[1],{r:x-K,c:b-ce})}break;case"F":var M=0;for(E=1;E<ee.length;++E)switch(ee[E].charAt(0)){case"X":b=parseInt(ee[E].slice(1))-1,++M;break;case"Y":for(x=parseInt(ee[E].slice(1))-1,B=R.length;B<=x;++B)R[B]=[];break;case"M":_=parseInt(ee[E].slice(1))/20;break;case"F":break;case"G":break;case"P":O=k[parseInt(ee[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=ee[E].slice(1).split(" "),B=parseInt(N[0],10);B<=parseInt(N[1],10);++B)_=parseInt(N[2],10),H[B-1]=_===0?{hidden:!0}:{wch:_},Wp(H[B-1]);break;case"C":b=parseInt(ee[E].slice(1))-1,H[b]||(H[b]={});break;case"R":x=parseInt(ee[E].slice(1))-1,D[x]||(D[x]={}),_>0?(D[x].hpt=_,D[x].hpx=yv(_)):_===0&&(D[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+j)}M<1&&(O=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+j)}}return D.length>0&&(P["!rows"]=D),H.length>0&&(P["!cols"]=H),g&&g.sheetRows&&(R=R.slice(0,g.sheetRows)),[R,P]}function o(m,g){var y=i(m,g),x=y[0],b=y[1],C=c0(x,g);return Nl(b).forEach(function(E){C[E]=b[E]}),C}function a(m,g){return tf(o(m,g),g)}function l(m,g,y,x){var b="C;Y"+(y+1)+";X"+(x+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+gwe(m.f,{r:y,c:x}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function u(m,g){g.forEach(function(y,x){var b="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Rb(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Ab(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function h(m,g){g.forEach(function(y,x){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*jY(y.hpx)+";"),b.length>2&&m.push(b+"R"+(x+1))})}function d(m,g){var y=["ID;PWXL;N;E"],x=[],b=An(m["!ref"]),C,E=Array.isArray(m),R=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),m["!cols"]&&u(y,m["!cols"]),m["!rows"]&&h(y,m["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var k=b.s.r;k<=b.e.r;++k)for(var O=b.s.c;O<=b.e.c;++O){var P=At({r:k,c:O});C=E?(m[k]||[])[O]:m[P],!(!C||C.v==null&&(!C.f||C.F))&&x.push(l(C,m,k,O))}return y.join(R)+R+x.join(R)+R+"E"+R}return{to_workbook:a,to_sheet:o,from_sheet:d}}(),Mxe=function(){function t(s,o){switch(o.type){case"base64":return e(yo(s),o);case"binary":return e(s,o);case"buffer":return e(Zt&&Buffer.isBuffer(s)?s.toString("binary"):Lh(s),o);case"array":return e(wh(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,u=-1,h=0,d=[];h!==a.length;++h){if(a[h].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var m=a[h].trim().split(","),g=m[0],y=m[1];++h;for(var x=a[h]||"";(x.match(/["]/g)||[]).length&1&&h<a.length-1;)x+=`
`+a[++h];switch(x=x.trim(),+g){case-1:if(x==="BOT"){d[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[l][u]=!0:x==="FALSE"?d[l][u]=!1:isNaN(Ba(y))?isNaN(jp(y).getDate())?d[l][u]=y:d[l][u]=Si(y):d[l][u]=Ba(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(s,o){return c0(t(s,o),o)}function n(s,o){return tf(r(s,o),o)}var i=function(){var s=function(l,u,h,d,m){l.push(u),l.push(h+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},o=function(l,u,h,d){l.push(u+","+h),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],h=An(l["!ref"]),d,m=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){o(u,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var x=At({r:g,c:y});if(d=m?(l[g]||[])[y]:l[x],!d){o(u,1,0,"");continue}switch(d.t){case"n":var b=d.w;!b&&d.v!=null&&(b=d.v),b==null?d.f&&!d.F?o(u,1,0,"="+d.f):o(u,1,0,""):o(u,0,b,"V");break;case"b":o(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=sa(d.z||_t[14],ws(Si(d.v)))),o(u,0,d.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var C=`\r
`,E=u.join(C);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Dxe=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var g=d.split(`
`),y=-1,x=-1,b=0,C=[];b!==g.length;++b){var E=g[b].trim().split(":");if(E[0]==="cell"){var R=gs(E[1]);if(C.length<=R.r)for(y=C.length;y<=R.r;++y)C[y]||(C[y]=[]);switch(y=R.r,x=R.c,E[2]){case"t":C[y][x]=t(E[3]);break;case"v":C[y][x]=+E[3];break;case"vtf":var k=E[E.length-1];case"vtc":switch(E[3]){case"nl":C[y][x]=!!+E[4];break;default:C[y][x]=+E[4];break}E[2]=="vtf"&&(C[y][x]=[C[y][x],k])}}}return m&&m.sheetRows&&(C=C.slice(0,m.sheetRows)),C}function n(d,m){return c0(r(d,m),m)}function i(d,m){return tf(n(d,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var m=[],g=[],y,x="",b=l0(d["!ref"]),C=Array.isArray(d),E=b.s.r;E<=b.e.r;++E)for(var R=b.s.c;R<=b.e.c;++R)if(x=At({r:E,c:R}),y=C?(d[E]||[])[R]:d[x],!(!y||y.v==null||y.t==="z")){switch(g=["cell",x,"t"],y.t){case"s":case"str":g.push(e(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=e(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var k=ws(Si(y.v));g[2]="vtc",g[3]="nd",g[4]=""+k,g[5]=y.w||sa(y.z||_t[14],k);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(d){return[s,o,a,o,u(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),gv=function(){function t(h,d,m,g,y){y.raw?d[m][g]=h:h===""||(h==="TRUE"?d[m][g]=!0:h==="FALSE"?d[m][g]=!1:isNaN(Ba(h))?isNaN(jp(h).getDate())?d[m][g]=h:d[m][g]=Si(h):d[m][g]=Ba(h))}function e(h,d){var m=d||{},g=[];if(!h||h.length===0)return g;for(var y=h.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var b=10,C=0,E=0;E<=x;++E)C=y[E].indexOf(" "),C==-1?C=y[E].length:C++,b=Math.max(b,C);for(E=0;E<=x;++E){g[E]=[];var R=0;for(t(y[E].slice(0,b).trim(),g,E,R,m),R=1;R<=(y[E].length-b)/10+1;++R)t(y[E].slice(b+(R-1)*10,b+R*10).trim(),g,E,R,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var d={},m=!1,g=0,y=0;g<h.length;++g)(y=h.charCodeAt(g))==34?m=!m:!m&&y in r&&(d[y]=(d[y]||0)+1);y=[];for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&y.push([d[g],g]);if(!y.length){d=n;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&y.push([d[g],g])}return y.sort(function(x,b){return x[0]-b[0]||n[x[1]]-n[b[1]]}),r[y.pop()[1]]||44}function s(h,d){var m=d||{},g="",y=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=i(h.slice(0,1024)):m&&m.FS?g=m.FS:g=i(h.slice(0,1024));var b=0,C=0,E=0,R=0,k=0,O=g.charCodeAt(0),P=!1,D=0,H=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var N=m.dateNF!=null?zge(m.dateNF):null;function _(){var B=h.slice(R,k),j={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)j.t="z";else if(m.raw)j.t="s",j.v=B;else if(B.trim().length===0)j.t="s",j.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(j.t="s",j.v=B.slice(2,-1).replace(/""/g,'"')):ywe(B)?(j.t="n",j.f=B.slice(1)):(j.t="s",j.v=B);else if(B=="TRUE")j.t="b",j.v=!0;else if(B=="FALSE")j.t="b",j.v=!1;else if(!isNaN(E=Ba(B)))j.t="n",m.cellText!==!1&&(j.w=B),j.v=E;else if(!isNaN(jp(B).getDate())||N&&B.match(N)){j.z=m.dateNF||_t[14];var ee=0;N&&B.match(N)&&(B=Uge(B,m.dateNF,B.match(N)||[]),ee=1),m.cellDates?(j.t="d",j.v=Si(B,ee)):(j.t="n",j.v=ws(Si(B,ee))),m.cellText!==!1&&(j.w=sa(j.z,j.v instanceof Date?ws(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=B;if(j.t=="z"||(m.dense?(y[b]||(y[b]=[]),y[b][C]=j):y[At({c:C,r:b})]=j),R=k+1,H=h.charCodeAt(R),x.e.c<C&&(x.e.c=C),x.e.r<b&&(x.e.r=b),D==O)++C;else if(C=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;k<h.length;++k)switch(D=h.charCodeAt(k)){case 34:H===34&&(P=!P);break;case O:case 10:case 13:if(!P&&_())break e;break}return k-R>0&&_(),y["!ref"]=sr(x),y}function o(h,d){return!(d&&d.PRN)||d.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,d):c0(e(h,d),d)}function a(h,d){var m="",g=d.type=="string"?[0,0,0,0]:LP(h,d);switch(d.type){case"base64":m=yo(h);break;case"binary":m=h;break;case"buffer":d.codepage==65001?m=h.toString("utf8"):d.codepage&&typeof hv<"u"||(m=Zt&&Buffer.isBuffer(h)?h.toString("binary"):Lh(h));break;case"array":m=wh(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+d.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=Ur(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=Ur(m):d.type=="binary"&&typeof hv<"u",m.slice(0,19)=="socialcalc:version:"?Dxe.to_sheet(d.type=="string"?m:Ur(m),d):o(m,d)}function l(h,d){return tf(a(h,d),d)}function u(h){for(var d=[],m=An(h["!ref"]),g,y=Array.isArray(h),x=m.s.r;x<=m.e.r;++x){for(var b=[],C=m.s.c;C<=m.e.c;++C){var E=At({r:x,c:C});if(g=y?(h[x]||[])[C]:h[E],!g||g.v==null){b.push("          ");continue}for(var R=(g.w||(Ic(g),g.w)||"").slice(0,10);R.length<10;)R+=" ";b.push(R+(C===0?" ":""))}d.push(b.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}();function Pxe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=_xe.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return gv.to_workbook(t,e)}}var Pg=function(){function t(S,A,M){if(S){Ni(S,S.l||0);for(var L=M.Enum||K;S.l<S.length;){var V=S.read_shift(2),J=L[V]||L[65535],ae=S.read_shift(2),ue=S.l+ae,pe=J.f&&J.f(S,ae,M);if(S.l=ue,A(pe,J,V))return}}}function e(S,A){switch(A.type){case"base64":return r(Ia(yo(S)),A);case"binary":return r(Ia(S),A);case"buffer":case"array":return r(S,A)}throw"Unsupported type "+A.type}function r(S,A){if(!S)return S;var M=A||{},L=M.dense?[]:{},V="Sheet1",J="",ae=0,ue={},pe=[],ke=[],z={s:{r:0,c:0},e:{r:0,c:0}},Be=M.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)M.Enum=K,t(S,function(Ee,Ue,st){switch(st){case 0:M.vers=Ee,Ee>=4096&&(M.qpro=!0);break;case 6:z=Ee;break;case 204:Ee&&(J=Ee);break;case 222:J=Ee;break;case 15:case 51:M.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:st==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=M.dateNF||_t[14],M.cellDates&&(Ee[1].t="d",Ee[1].v=LS(Ee[1].v))),M.qpro&&Ee[3]>ae&&(L["!ref"]=sr(z),ue[V]=L,pe.push(V),L=M.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ae=Ee[3],V=J||"Sheet"+(ae+1),J="");var tt=M.dense?(L[Ee[0].r]||[])[Ee[0].c]:L[At(Ee[0])];if(tt){tt.t=Ee[1].t,tt.v=Ee[1].v,Ee[1].z!=null&&(tt.z=Ee[1].z),Ee[1].f!=null&&(tt.f=Ee[1].f);break}M.dense?(L[Ee[0].r]||(L[Ee[0].r]=[]),L[Ee[0].r][Ee[0].c]=Ee[1]):L[At(Ee[0])]=Ee[1];break}},M);else if(S[2]==26||S[2]==14)M.Enum=ce,S[2]==14&&(M.qpro=!0,S.l=0),t(S,function(Ee,Ue,st){switch(st){case 204:V=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>ae&&(L["!ref"]=sr(z),ue[V]=L,pe.push(V),L=M.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ae=Ee[3],V="Sheet"+(ae+1)),Be>0&&Ee[0].r>=Be)break;M.dense?(L[Ee[0].r]||(L[Ee[0].r]=[]),L[Ee[0].r][Ee[0].c]=Ee[1]):L[At(Ee[0])]=Ee[1],z.e.c<Ee[0].c&&(z.e.c=Ee[0].c),z.e.r<Ee[0].r&&(z.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(ke[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:ke[Ee[0]]=Ee[1],Ee[0]==ae&&(V=Ee[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(L["!ref"]=sr(z),ue[J||V]=L,pe.push(J||V),!ke.length)return{SheetNames:pe,Sheets:ue};for(var Fe={},ze=[],Ge=0;Ge<ke.length;++Ge)ue[pe[Ge]]?(ze.push(ke[Ge]||pe[Ge]),Fe[ke[Ge]]=ue[ke[Ge]]||ue[pe[Ge]]):(ze.push(ke[Ge]),Fe[ke[Ge]]={"!ref":"A1"});return{SheetNames:ze,Sheets:Fe}}function n(S,A){var M=A||{};if(+M.codepage>=0&&Na(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var L=u_(),V=An(S["!ref"]),J=Array.isArray(S),ae=[];Ta(L,0,s(1030)),Ta(L,6,l(V));for(var ue=Math.min(V.e.r,8191),pe=V.s.r;pe<=ue;++pe)for(var ke=ji(pe),z=V.s.c;z<=V.e.c;++z){pe===V.s.r&&(ae[z]=ui(z));var Be=ae[z]+ke,Fe=J?(S[pe]||[])[z]:S[Be];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?Ta(L,13,g(pe,z,Fe.v)):Ta(L,14,x(pe,z,Fe.v));else{var ze=Ic(Fe);Ta(L,15,d(pe,z,ze.slice(0,239)))}}return Ta(L,1),L.end()}function i(S,A){var M=A||{};if(+M.codepage>=0&&Na(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var L=u_();Ta(L,0,o(S));for(var V=0,J=0;V<S.SheetNames.length;++V)(S.Sheets[S.SheetNames[V]]||{})["!ref"]&&Ta(L,27,ie(S.SheetNames[V],J++));var ae=0;for(V=0;V<S.SheetNames.length;++V){var ue=S.Sheets[S.SheetNames[V]];if(!(!ue||!ue["!ref"])){for(var pe=An(ue["!ref"]),ke=Array.isArray(ue),z=[],Be=Math.min(pe.e.r,8191),Fe=pe.s.r;Fe<=Be;++Fe)for(var ze=ji(Fe),Ge=pe.s.c;Ge<=pe.e.c;++Ge){Fe===pe.s.r&&(z[Ge]=ui(Ge));var Ee=z[Ge]+ze,Ue=ke?(ue[Fe]||[])[Ge]:ue[Ee];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Ta(L,23,_(Fe,Ge,ae,Ue.v));else{var st=Ic(Ue);Ta(L,22,D(Fe,Ge,ae,st.slice(0,239)))}}++ae}}return Ta(L,1),L.end()}function s(S){var A=li(2);return A.write_shift(2,S),A}function o(S){var A=li(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var M=0,L=0,V=0,J=0;J<S.SheetNames.length;++J){var ae=S.SheetNames[J],ue=S.Sheets[ae];if(!(!ue||!ue["!ref"])){++V;var pe=l0(ue["!ref"]);M<pe.e.r&&(M=pe.e.r),L<pe.e.c&&(L=pe.e.c)}}return M>8191&&(M=8191),A.write_shift(2,M),A.write_shift(1,V),A.write_shift(1,L),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function a(S,A,M){var L={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&M.qpro?(L.s.c=S.read_shift(1),S.l++,L.s.r=S.read_shift(2),L.e.c=S.read_shift(1),S.l++,L.e.r=S.read_shift(2),L):(L.s.c=S.read_shift(2),L.s.r=S.read_shift(2),A==12&&M.qpro&&(S.l+=2),L.e.c=S.read_shift(2),L.e.r=S.read_shift(2),A==12&&M.qpro&&(S.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(S){var A=li(8);return A.write_shift(2,S.s.c),A.write_shift(2,S.s.r),A.write_shift(2,S.e.c),A.write_shift(2,S.e.r),A}function u(S,A,M){var L=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(L[0].c=S.read_shift(1),L[3]=S.read_shift(1),L[0].r=S.read_shift(2),S.l+=2):(L[2]=S.read_shift(1),L[0].c=S.read_shift(2),L[0].r=S.read_shift(2)),L}function h(S,A,M){var L=S.l+A,V=u(S,A,M);if(V[1].t="s",M.vers==20768){S.l++;var J=S.read_shift(1);return V[1].v=S.read_shift(J,"utf8"),V}return M.qpro&&S.l++,V[1].v=S.read_shift(L-S.l,"cstr"),V}function d(S,A,M){var L=li(7+M.length);L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,S),L.write_shift(1,39);for(var V=0;V<L.length;++V){var J=M.charCodeAt(V);L.write_shift(1,J>=128?95:J)}return L.write_shift(1,0),L}function m(S,A,M){var L=u(S,A,M);return L[1].v=S.read_shift(2,"i"),L}function g(S,A,M){var L=li(7);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,S),L.write_shift(2,M,"i"),L}function y(S,A,M){var L=u(S,A,M);return L[1].v=S.read_shift(8,"f"),L}function x(S,A,M){var L=li(13);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,S),L.write_shift(8,M,"f"),L}function b(S,A,M){var L=S.l+A,V=u(S,A,M);if(V[1].v=S.read_shift(8,"f"),M.qpro)S.l=L;else{var J=S.read_shift(2);k(S.slice(S.l,S.l+J),V),S.l+=J}return V}function C(S,A,M){var L=A&32768;return A&=-32769,A=(L?S:0)+(A>=8192?A-16384:A),(L?"":"$")+(M?ui(A):ji(A))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(S,A){Ni(S,0);for(var M=[],L=0,V="",J="",ae="",ue="";S.l<S.length;){var pe=S[S.l++];switch(pe){case 0:M.push(S.read_shift(8,"f"));break;case 1:J=C(A[0].c,S.read_shift(2),!0),V=C(A[0].r,S.read_shift(2),!1),M.push(J+V);break;case 2:{var ke=C(A[0].c,S.read_shift(2),!0),z=C(A[0].r,S.read_shift(2),!1);J=C(A[0].c,S.read_shift(2),!0),V=C(A[0].r,S.read_shift(2),!1),M.push(ke+z+":"+J+V)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(S.read_shift(2));break;case 6:{for(var Be="";pe=S[S.l++];)Be+=String.fromCharCode(pe);M.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ue=M.pop(),ae=M.pop(),M.push(["AND","OR"][pe-20]+"("+ae+","+ue+")");break;default:if(pe<32&&R[pe])ue=M.pop(),ae=M.pop(),M.push(ae+R[pe]+ue);else if(E[pe]){if(L=E[pe][1],L==69&&(L=S[S.l++]),L>M.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+M.join("|")+"|");return}var Fe=M.slice(-L);M.length-=L,M.push(E[pe][0]+"("+Fe.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}M.length==1?A[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function O(S){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=S.read_shift(2),A[3]=S[S.l++],A[0].c=S[S.l++],A}function P(S,A){var M=O(S);return M[1].t="s",M[1].v=S.read_shift(A-4,"cstr"),M}function D(S,A,M,L){var V=li(6+L.length);V.write_shift(2,S),V.write_shift(1,M),V.write_shift(1,A),V.write_shift(1,39);for(var J=0;J<L.length;++J){var ae=L.charCodeAt(J);V.write_shift(1,ae>=128?95:ae)}return V.write_shift(1,0),V}function H(S,A){var M=O(S);M[1].v=S.read_shift(2);var L=M[1].v>>1;if(M[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return M[1].v=L,M}function N(S,A){var M=O(S),L=S.read_shift(4),V=S.read_shift(4),J=S.read_shift(2);if(J==65535)return L===0&&V===3221225472?(M[1].t="e",M[1].v=15):L===0&&V===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ae=J&32768;return J=(J&32767)-16446,M[1].v=(1-ae*2)*(V*Math.pow(2,J+32)+L*Math.pow(2,J)),M}function _(S,A,M,L){var V=li(14);if(V.write_shift(2,S),V.write_shift(1,M),V.write_shift(1,A),L==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var J=0,ae=0,ue=0,pe=0;return L<0&&(J=1,L=-L),ae=Math.log2(L)|0,L/=Math.pow(2,ae-31),pe=L>>>0,(pe&2147483648)==0&&(L/=2,++ae,pe=L>>>0),L-=pe,pe|=2147483648,pe>>>=0,L*=Math.pow(2,32),ue=L>>>0,V.write_shift(4,ue),V.write_shift(4,pe),ae+=16383+(J?32768:0),V.write_shift(2,ae),V}function B(S,A){var M=N(S);return S.l+=A-14,M}function j(S,A){var M=O(S),L=S.read_shift(4);return M[1].v=L>>6,M}function ee(S,A){var M=O(S),L=S.read_shift(8,"f");return M[1].v=L,M}function oe(S,A){var M=ee(S);return S.l+=A-10,M}function re(S,A){return S[S.l+A-1]==0?S.read_shift(A,"cstr"):""}function q(S,A){var M=S[S.l++];M>A-1&&(M=A-1);for(var L="";L.length<M;)L+=String.fromCharCode(S[S.l++]);return L}function Z(S,A,M){if(!(!M.qpro||A<21)){var L=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var V=S.read_shift(A-21,"cstr");return[L,V]}}function ve(S,A){for(var M={},L=S.l+A;S.l<L;){var V=S.read_shift(2);if(V==14e3){for(M[V]=[0,""],M[V][0]=S.read_shift(2);S[S.l];)M[V][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return M}function ie(S,A){var M=li(5+S.length);M.write_shift(2,14e3),M.write_shift(2,A);for(var L=0;L<S.length;++L){var V=S.charCodeAt(L);M[M.l++]=V>127?95:V}return M[M.l++]=0,M}var K={0:{n:"BOF",f:Kn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function Ixe(t){var e={},r=t.match(os),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=bt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=hP[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var Nxe=function(){var t=pv("t"),e=pv("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var a={t:"s",v:ur(o[1])},l=s.match(e);return l&&(a.s=Ixe(l[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}}(),Lxe=function(){var e=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Fxe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Hxe=/<(?:\w+:)?r>/,Bxe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function OP(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ur(Ur(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ur(t),r&&(n.h=xP(n.t))):t.match(Hxe)&&(n.r=Ur(t),n.t=ur(Ur((t.replace(Bxe,"").match(Fxe)||[]).join("").replace(os,""))),r&&(n.h=Lxe(Nxe(n.r)))),n):{t:""}}var Vxe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jxe=/<(?:\w+:)?(?:si|sstItem)>/g,Wxe=/<\/(?:\w+:)?(?:si|sstItem)>/;function zxe(t,e){var r=[],n="";if(!t)return r;var i=t.match(Vxe);if(i){n=i[2].replace(jxe,"").split(Wxe);for(var s=0;s!=n.length;++s){var o=OP(n[s].trim(),e);o!=null&&(r[r.length]=o)}i=bt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function Uxe(t){return[t.read_shift(4),t.read_shift(4)]}function $xe(t,e){var r=[],n=!1;return Bc(t,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function NY(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Rc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Gxe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Rc(t,4),e.U=Rc(t,4),e.W=Rc(t,4),e}function Yxe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function qxe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Yxe(t));return e}function Kxe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Xxe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Rc(t,4),e.U=Rc(t,4),e.W=Rc(t,4),e}function Qxe(t){var e=Xxe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function LY(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function FY(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Zxe(t){var e=Rc(t);switch(e.Minor){case 2:return[e.Minor,Jxe(t)];case 3:return[e.Minor,e1e()];case 4:return[e.Minor,t1e(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Jxe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=LY(t,r),i=FY(t,t.length-t.l);return{t:"Std",h:n,v:i}}function e1e(){throw new Error("File is password-protected: ECMA-376 Extensible")}function t1e(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(os,function(s){var o=bt(s);switch(Bl(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function r1e(t,e){var r={},n=r.EncryptionVersionInfo=Rc(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=LY(t,i),e-=i,r.EncryptionVerifier=FY(t,e),r}function n1e(t){var e={},r=e.EncryptionVersionInfo=Rc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function i1e(t){var e=0,r,n=NY(t),i=n.length+1,s,o,a,l,u;for(r=Uu(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=(e&16384)===0?0:1,l=e<<1&32767,u=a|l,e=u^o;return e^52811}var HY=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=e[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var h=o[u],d=0;d!=7;++d)h&64&&(a^=r[l]),h*=2,--l;return a};return function(o){for(var a=NY(o),l=s(a),u=a.length,h=Uu(16),d=0;d!=16;++d)h[d]=0;var m,g,y;for((u&1)===1&&(m=l>>8,h[u]=i(t[0],m),--u,m=l&255,g=a[a.length-1],h[u]=i(g,m));u>0;)--u,m=l>>8,h[u]=i(a[u],m),--u,m=l&255,h[u]=i(a[u],m);for(u=15,y=15-a.length;y>0;)m=l>>8,h[u]=i(t[y],m),--u,--y,m=l&255,h[u]=i(a[u],m),--u,--y;return h}}(),s1e=function(t,e,r,n,i){i||(i=e),n||(n=HY(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},o1e=function(t){var e=0,r=HY(t);return function(n){var i=s1e("",n,e,r);return e=i[1],i[0]}};function a1e(t,e,r,n){var i={key:Kn(t),verificationBytes:Kn(t)};return r.password&&(i.verifier=i1e(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=o1e(r.password)),i}function l1e(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=n1e(t):n.Data=r1e(t,e),n}function c1e(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?l1e(t,e-2,n):a1e(t,r.biff>=8?e:e-2,r,n),n}var u1e=function(){function t(i,s){switch(s.type){case"base64":return e(yo(i),s);case"binary":return e(i,s);case"buffer":return e(Zt&&Buffer.isBuffer(i)?i.toString("binary"):Lh(i),s);case"array":return e(wh(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,d){Array.isArray(a)&&(a[d]=[]);for(var m=/\\\w+\b/g,g=0,y,x=-1;y=m.exec(h);){switch(y[0]){case"\\cell":var b=h.slice(g,m.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++x,b.length){var C={v:b,t:"s"};Array.isArray(a)?a[d][x]=C:a[At({r:d,c:x})]=C}break}g=m.lastIndex}x>u.e.c&&(u.e.c=x)}),a["!ref"]=sr(u),a}function r(i,s){return tf(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=An(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var d=At({r:u,c:h});a=l?(i[u]||[])[h]:i[d],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(Ic(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function f1e(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function vv(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function h1e(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),o=i-s;if(o===0)return[0,0,e];var a=0,l=0,u=i+s;switch(l=o/(u>1?2-u:u),i){case e:a=((r-n)/o+6)%6;break;case r:a=(n-e)/o+2;break;case n:a=(e-r)/o+4;break}return[a/6,l,u/2]}function d1e(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*e,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function Eb(t,e){if(e===0)return t;var r=h1e(f1e(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),vv(d1e(r))}var BY=6,p1e=15,m1e=1,ds=BY;function Rb(t){return Math.floor((t+Math.round(128/ds)/256)*ds)}function Ab(t){return Math.floor((t-5)/ds*100+.5)/100}function p_(t){return Math.round((t*ds+5)/ds*256)/256}function dR(t){return p_(Ab(Rb(t)))}function _P(t){var e=Math.abs(t-dR(t)),r=ds;if(e>.005)for(ds=m1e;ds<p1e;++ds)Math.abs(t-dR(t))<=e&&(e=Math.abs(t-dR(t)),r=ds);ds=r}function Wp(t){t.width?(t.wpx=Rb(t.width),t.wch=Ab(t.wpx),t.MDW=ds):t.wpx?(t.wch=Ab(t.wpx),t.width=p_(t.wch),t.MDW=ds):typeof t.wch=="number"&&(t.width=p_(t.wch),t.wpx=Rb(t.width),t.MDW=ds),t.customWidth&&delete t.customWidth}var g1e=96,VY=g1e;function jY(t){return t*96/VY}function yv(t){return t*VY/96}var v1e={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function y1e(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(os)||[]).forEach(function(o){var a=bt(o);switch(Bl(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=ln(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=ln(a.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function x1e(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(os)||[]).forEach(function(o){var a=bt(o);switch(Bl(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function w1e(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(os)||[]).forEach(function(o){var a=bt(o);switch(Bl(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=Ur(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?ln(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?ln(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?ln(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?ln(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?ln(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?ln(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?ln(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=hP[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=ln(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=fh[i.color.index];i.color.index==81&&(l=fh[1]),l||(l=fh[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Eb(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function b1e(t,e,r){e.NumberFmt=[];for(var n=Nl(_t),i=0;i<n.length;++i)e.NumberFmt[n[i]]=_t[n[i]];var s=t[0].match(os);if(s)for(i=0;i<s.length;++i){var o=bt(s[i]);switch(Bl(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=ur(Ur(o.formatCode)),l=parseInt(o.numFmtId,10);if(e.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=a}uh(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var w1=["numFmtId","fillId","fontId","borderId","xfId"],b1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function S1e(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(os)||[]).forEach(function(s){var o=bt(s),a=0;switch(Bl(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<w1.length;++a)n[w1[a]]&&(n[w1[a]]=parseInt(n[w1[a]],10));for(a=0;a<b1.length;++a)n[b1[a]]&&(n[b1[a]]=ln(n[b1[a]]));if(e.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[a]){n.numFmtId=a;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=ln(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var C1e=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,u){var h={};if(!a)return h;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=a.match(e))&&b1e(d,h,u),(d=a.match(i))&&w1e(d,h,l,u),(d=a.match(n))&&x1e(d,h,l,u),(d=a.match(s))&&y1e(d,h,l,u),(d=a.match(r))&&S1e(d,h,u),h}}();function T1e(t,e){var r=t.read_shift(2),n=ns(t);return[r,n]}function E1e(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Nve(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Ive(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ns(t),n}var R1e=ss;function A1e(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var k1e=ss;function O1e(t,e,r){var n={};n.NumberFmt=[];for(var i in _t)n.NumberFmt[i]=_t[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Bc(t,function(l,u,h){switch(h){case 44:n.NumberFmt[l[0]]=l[1],uh(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Eb(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(h);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var _1e=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function M1e(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(os)||[]).forEach(function(i){var s=bt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[_1e.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function D1e(){}function P1e(){}var I1e=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,N1e=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,L1e=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function F1e(t,e,r){e.themeElements={};var n;[["clrScheme",I1e,M1e],["fontScheme",N1e,D1e],["fmtScheme",L1e,P1e]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var H1e=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function WY(t,e){(!t||t.length===0)&&(t=B1e());var r,n={};if(!(r=t.match(H1e)))throw new Error("themeElements not found in theme");return F1e(r[0],n,e),n.raw=t,n}function B1e(t,e){var r=[JG];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function V1e(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=ZG(s,{type:"array"})}catch{return}var a=co(o,"theme/theme/theme1.xml",!0);if(a)return WY(a,r)}}function j1e(t){return t.read_shift(4)}function W1e(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=z1e(t,4);break;case 2:e.xclrValue=kY(t);break;case 3:e.xclrValue=j1e(t);break;case 4:t.l+=4;break}return t.l+=8,e}function z1e(t,e){return ss(t,e)}function U1e(t,e){return ss(t,e)}function $1e(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=W1e(t);break;case 6:n[1]=U1e(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function G1e(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push($1e(t,r-t.l));return{ixfe:n,ext:s}}function Y1e(t,e){e.forEach(function(r){r[0]})}function q1e(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ns(t)}}function K1e(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function X1e(t){return t.l+=4,t.read_shift(4)!=0}function Q1e(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return Bc(t,function(l,u,h){switch(h){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){a==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):a==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:s.push(h),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function Z1e(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,o;return t.replace(os,function(a){var l=bt(a);switch(Bl(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function J1e(t){var e=[];if(!t)return e;var r=1;return(t.match(os)||[]).forEach(function(n){var i=bt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function ewe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=At(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function twe(t,e,r){var n=[];return Bc(t,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function rwe(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Bc(t,function(a,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function nwe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function _5(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(o){var a=gs(o.ref);if(i?(t[a.r]||(t[a.r]=[]),s=t[a.r][a.c]):s=t[o.ref],!s){s={t:"z"},i?t[a.r][a.c]=s:t[o.ref]=s;var l=An(t["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var u=sr(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(h.a==n[d].id){h.a=n[d].name||h.a;break}}s.c.push(h)})}function iwe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=bt(a[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},h=gs(l.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&OP(d[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function swe(t,e){var r=[],n=!1,i={},s=0;return t.replace(os,function(a,l){var u=bt(a);switch(Bl(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+a.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return a}),r}function owe(t,e){var r=[],n=!1;return t.replace(os,function(s){var o=bt(s);switch(Bl(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function awe(t){var e={};e.iauthor=t.read_shift(4);var r=Hh(t);return e.rfx=r.s,e.ref=At(r.s),t.l+=16,e}var lwe=ns;function cwe(t,e){var r=[],n=[],i={},s=!1;return Bc(t,function(a,l,u){switch(u){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var uwe="application/vnd.ms-office.vbaProject";function fwe(t){var e=ir.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ir.utils.cfb_add(e,i,t.FileIndex[n].content)}}),ir.write(e)}function hwe(){return{"!type":"dialog"}}function dwe(){return{"!type":"dialog"}}function pwe(){return{"!type":"macro"}}function mwe(){return{"!type":"macro"}}var yp=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return a?h+=e.c:--h,l?u+=e.r:--u,i+(a?"":"$")+ui(h)+(l?"":"$")+ji(u)}return function(i,s){return e=s,i.replace(t,r)}}(),zY=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gwe=function(){return function(e,r){return e.replace(zY,function(n,i,s,o,a,l){var u=CP(o)-(s?0:r.c),h=SP(l)-(a?0:r.r),d=h==0?"":a?h+1:"["+h+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+d+"C"+m})}}();function UY(t,e){return t.replace(zY,function(r,n,i,s,o,a){return n+(i=="$"?i+s:ui(CP(s)+e.c))+(o=="$"?o+a:ji(SP(a)+e.r))})}function vwe(t,e,r){var n=l0(e),i=n.s,s=gs(r),o={r:s.r-i.r,c:s.c-i.c};return UY(t,o)}function ywe(t){return t.length!=1}function M5(t){return t.replace(/_xlfn\./g,"")}function $n(t){t.l+=1}function $u(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function $Y(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return GY(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=$u(t),a=$u(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function GY(t){var e=$u(t),r=$u(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function xwe(t,e,r){if(r.biff<8)return GY(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=$u(t),o=$u(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function YY(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return wwe(t);var n=t.read_shift(r&&r.biff==12?4:2),i=$u(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function wwe(t){var e=$u(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function bwe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Swe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Cwe(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function Cwe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function Twe(t,e,r){var n=(t[t.l++]&96)>>5,i=$Y(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Ewe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=$Y(t,s,r);return[n,i,o]}function Rwe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Awe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function kwe(t,e,r){var n=(t[t.l++]&96)>>5,i=xwe(t,e-1,r);return[n,i]}function Owe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function D5(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function _we(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Mwe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Dwe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Pwe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Iwe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function qY(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Nwe(t){return t.read_shift(2),qY(t)}function Lwe(t){return t.read_shift(2),qY(t)}function Fwe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=YY(t,0,r);return[n,i]}function Hwe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Swe(t,0,r);return[n,i]}function Bwe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=YY(t,0,r);return[n,i,s]}function Vwe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[jbe[i],QY[i],n]}function jwe(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Wwe(t);return[i,(s[0]===0?QY:Vbe)[s[1]]]}function Wwe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function zwe(t,e,r){t.l+=r&&r.biff==2?3:4}function Uwe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function $we(t){return t.l++,Bh[t.read_shift(1)]}function Gwe(t){return t.l++,t.read_shift(2)}function Ywe(t){return t.l++,t.read_shift(1)!==0}function qwe(t){return t.l++,Ji(t)}function Kwe(t,e,r){return t.l++,uy(t,e-1,r)}function Xwe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Pn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Bh[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ji(t);break;case 2:r[1]=Vh(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Qwe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Hh:FS)(t));return i}function Zwe(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=Xwe(t,r.biff);return o}function Jwe(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function ebe(t,e,r){if(r.biff==5)return tbe(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function tbe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function rbe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function nbe(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function ibe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function sbe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var obe=ss,abe=ss,lbe=ss;function hy(t,e,r){return t.l+=2,[bwe(t)]}function MP(t){return t.l+=6,[]}var cbe=hy,ube=MP,fbe=MP,hbe=hy;function KY(t){return t.l+=2,[Kn(t),t.read_shift(2)&1]}var dbe=hy,pbe=KY,mbe=MP,gbe=hy,vbe=hy,ybe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xbe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=ybe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function wbe(t){return t.l+=2,[t.read_shift(4)]}function bbe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Sbe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Cbe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Tbe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Ebe(t){return t.l+=4,[0,0]}var P5={1:{n:"PtgExp",f:Uwe},2:{n:"PtgTbl",f:lbe},3:{n:"PtgAdd",f:$n},4:{n:"PtgSub",f:$n},5:{n:"PtgMul",f:$n},6:{n:"PtgDiv",f:$n},7:{n:"PtgPower",f:$n},8:{n:"PtgConcat",f:$n},9:{n:"PtgLt",f:$n},10:{n:"PtgLe",f:$n},11:{n:"PtgEq",f:$n},12:{n:"PtgGe",f:$n},13:{n:"PtgGt",f:$n},14:{n:"PtgNe",f:$n},15:{n:"PtgIsect",f:$n},16:{n:"PtgUnion",f:$n},17:{n:"PtgRange",f:$n},18:{n:"PtgUplus",f:$n},19:{n:"PtgUminus",f:$n},20:{n:"PtgPercent",f:$n},21:{n:"PtgParen",f:$n},22:{n:"PtgMissArg",f:$n},23:{n:"PtgStr",f:Kwe},26:{n:"PtgSheet",f:bbe},27:{n:"PtgEndSheet",f:Sbe},28:{n:"PtgErr",f:$we},29:{n:"PtgBool",f:Ywe},30:{n:"PtgInt",f:Gwe},31:{n:"PtgNum",f:qwe},32:{n:"PtgArray",f:Owe},33:{n:"PtgFunc",f:Vwe},34:{n:"PtgFuncVar",f:jwe},35:{n:"PtgName",f:Jwe},36:{n:"PtgRef",f:Fwe},37:{n:"PtgArea",f:Twe},38:{n:"PtgMemArea",f:rbe},39:{n:"PtgMemErr",f:obe},40:{n:"PtgMemNoMem",f:abe},41:{n:"PtgMemFunc",f:nbe},42:{n:"PtgRefErr",f:ibe},43:{n:"PtgAreaErr",f:Rwe},44:{n:"PtgRefN",f:Hwe},45:{n:"PtgAreaN",f:kwe},46:{n:"PtgMemAreaN",f:Cbe},47:{n:"PtgMemNoMemN",f:Tbe},57:{n:"PtgNameX",f:ebe},58:{n:"PtgRef3d",f:Bwe},59:{n:"PtgArea3d",f:Ewe},60:{n:"PtgRefErr3d",f:sbe},61:{n:"PtgAreaErr3d",f:Awe},255:{}},Rbe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Abe={1:{n:"PtgElfLel",f:KY},2:{n:"PtgElfRw",f:gbe},3:{n:"PtgElfCol",f:cbe},6:{n:"PtgElfRwV",f:vbe},7:{n:"PtgElfColV",f:hbe},10:{n:"PtgElfRadical",f:dbe},11:{n:"PtgElfRadicalS",f:mbe},13:{n:"PtgElfColS",f:ube},15:{n:"PtgElfColSV",f:fbe},16:{n:"PtgElfRadicalLel",f:pbe},25:{n:"PtgList",f:xbe},29:{n:"PtgSxName",f:wbe},255:{}},kbe={0:{n:"PtgAttrNoop",f:Ebe},1:{n:"PtgAttrSemi",f:Iwe},2:{n:"PtgAttrIf",f:Dwe},4:{n:"PtgAttrChoose",f:_we},8:{n:"PtgAttrGoto",f:Mwe},16:{n:"PtgAttrSum",f:zwe},32:{n:"PtgAttrBaxcel",f:D5},33:{n:"PtgAttrBaxcel",f:D5},64:{n:"PtgAttrSpace",f:Nwe},65:{n:"PtgAttrSpaceSemi",f:Lwe},128:{n:"PtgAttrIfError",f:Pwe},255:{}};function dy(t,e,r,n){if(n.biff<8)return ss(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Zwe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Qwe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&s.push(ss(t,e)),s}function py(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=P5[s]||P5[Rbe[s]],(s===24||s===25)&&(i=(s===24?Abe:kbe)[t[t.l+1]]),!i||!i.f?ss(t,e):o.push([i.n,i.f(t,e,r)]);return o}function Obe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var _be={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Mbe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function XY(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function I5(t,e,r){var n=XY(t,e,r);return n=="#REF"?n:Mbe(n,r)}function Qi(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,u,h,d=0,m=0,g,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,b="",C=0,E=t[0].length;C<E;++C){var R=t[0][C];switch(R[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),x>=0){switch(t[0][x][1][0]){case 0:b=Rn(" ",t[0][x][1][1]);break;case 1:b=Rn("\r",t[0][x][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+b,x=-1}a.push(u+_be[R[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Og(R[1][1],o,i),a.push(_g(h,s));break;case"PtgRefN":h=r?Og(R[1][1],r,i):R[1][1],a.push(_g(h,s));break;case"PtgRef3d":d=R[1][1],h=Og(R[1][2],o,i),y=I5(n,d,i),a.push(y+"!"+_g(h,s));break;case"PtgFunc":case"PtgFuncVar":var k=R[1][0],O=R[1][1];k||(k=0),k&=127;var P=k==0?[]:a.slice(-k);a.length-=k,O==="User"&&(O=P.shift()),a.push(O+"("+P.join(",")+")");break;case"PtgBool":a.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(R[1]);break;case"PtgNum":a.push(String(R[1]));break;case"PtgStr":a.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(R[1]);break;case"PtgAreaN":g=p5(R[1][1],r?{s:r}:o,i),a.push(fR(g,i));break;case"PtgArea":g=p5(R[1][1],o,i),a.push(fR(g,i));break;case"PtgArea3d":d=R[1][1],g=R[1][2],y=I5(n,d,i),a.push(y+"!"+fR(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=R[1][2];var D=(n.names||[])[m-1]||(n[0]||[])[m],H=D?D.Name:"SH33TJSNAME"+String(m);H&&H.slice(0,6)=="_xlfn."&&!i.xlfn&&(H=H.slice(6)),a.push(H);break;case"PtgNameX":var N=R[1][1];m=R[1][2];var _;if(i.biff<=5)N<0&&(N=-N),n[N]&&(_=n[N][m]);else{var B="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][m]&&n[N][m].itab>0&&(B=n.SheetNames[n[N][m].itab-1]+"!"):B=n.SheetNames[m-1]+"!"),n[N]&&n[N][m])B+=n[N][m].Name;else if(n[0]&&n[0][m])B+=n[0][m].Name;else{var j=(XY(n,N,i)||"").split(";;");j[m-1]?B=j[m-1]:B+="SH33TJSERRX"}a.push(B);break}_||(_={Name:"SH33TJSERRY"}),a.push(_.Name);break;case"PtgParen":var ee="(",oe=")";if(x>=0){switch(b="",t[0][x][1][0]){case 2:ee=Rn(" ",t[0][x][1][1])+ee;break;case 3:ee=Rn("\r",t[0][x][1][1])+ee;break;case 4:oe=Rn(" ",t[0][x][1][1])+oe;break;case 5:oe=Rn("\r",t[0][x][1][1])+oe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}a.push(ee+a.pop()+oe);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":h={c:R[1][1],r:R[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[At(h)]){var q=n.sharedf[At(h)];a.push(Qi(q,o,re,n,i))}else{var Z=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){a.push(Qi(u[1],o,re,n,i)),Z=!0;break}Z||a.push(R[1])}break;case"PtgArray":a.push("{"+Obe(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ve.indexOf(t[0][C][0])==-1){R=t[0][x];var ie=!0;switch(R[1][0]){case 4:ie=!1;case 0:b=Rn(" ",R[1][1]);break;case 5:ie=!1;case 1:b=Rn("\r",R[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}a.push((ie?b:"")+a.pop()+(ie?"":b)),x=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function Dbe(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],ss(t,e-2)];var a=py(t,o,r);return e!==o+i&&(s=dy(t,e-o-i,a,r)),t.l=n,[a,s]}function Pbe(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],ss(t,e-2)];var a=py(t,o,r);return e!==o+i&&(s=dy(t,e-o-i,a,r)),t.l=n,[a,s]}function Ibe(t,e,r,n){var i=t.l+e,s=py(t,n,r),o;return i!==t.l&&(o=dy(t,i-t.l,s,r)),[s,o]}function Nbe(t,e,r){var n=t.l+e,i,s=t.read_shift(2),o=py(t,s,r);return s==65535?[[],ss(t,e-2)]:(e!==s+2&&(i=dy(t,n-s-2,o,r)),[o,i])}function Lbe(t){var e;if(Sc(t,t.l+6)!==65535)return[Ji(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function pR(t,e,r){var n=t.l+e,i=Vl(t);r.biff==2&&++t.l;var s=Lbe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var a=Pbe(t,n-t.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function HS(t,e,r){var n=t.read_shift(4),i=py(t,n,r),s=t.read_shift(4),o=s>0?dy(t,s,i,r):null;return[i,o]}var Fbe=HS,BS=HS,Hbe=HS,Bbe=HS,Vbe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},QY={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jbe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N5(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function mR(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ig={},xp={};function Ng(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ZY(t,e,r,n,i,s){try{n.cellNF&&(t.z=_t[e])}catch(a){if(n.WTF)throw a}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Si(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(_t[e]==null&&uh(Wge[e]||"General",e),t.t==="e")t.w=t.w||Bh[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=dv(t.v);else if(t.t==="d"){var o=ws(t.v);(o|0)===o?t.w=o.toString(10):t.w=dv(o)}else{if(t.v===void 0)return"";t.w=xh(t.v,xp)}else t.t==="d"?t.w=sa(e,ws(t.v),xp):t.w=sa(e,t.v,xp)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Eb(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Eb(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function Wbe(t,e){var r=An(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=sr(r))}var zbe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ube=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$be=/<(?:\w:)?hyperlink [^>]*>/mg,Gbe=/"(\w*:\w*)"/,Ybe=/<(?:\w:)?col\b[^>]*[\/]?>/g,qbe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Kbe=/<(?:\w:)?pageMargins[^>]*\/>/g,JY=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Xbe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Qbe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Zbe(t,e,r,n,i,s,o){if(!t)return t;n||(n={"!id":{}});var a=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",d=t.match(Ube);d?(u=t.slice(0,d.index),h=t.slice(d.index+d[0].length)):u=h=t;var m=u.match(JY);m?DP(m[0],a,i,r):(m=u.match(Xbe))&&Jbe(m[0],m[1]||"",a,i,r);var g=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=u.slice(g,g+50).match(Gbe);y&&Wbe(a,y[1])}var x=u.match(Qbe);x&&x[1]&&sSe(x[1],i);var b=[];if(e.cellStyles){var C=u.match(Ybe);C&&rSe(b,C)}d&&oSe(d[1],a,e,l,s,o);var E=h.match(qbe);E&&(a["!autofilter"]=nSe(E[0]));var R=[],k=h.match(zbe);if(k)for(g=0;g!=k.length;++g)R[g]=An(k[g].slice(k[g].indexOf('"')+1));var O=h.match($be);O&&eSe(a,O,n);var P=h.match(Kbe);if(P&&(a["!margins"]=tSe(bt(P[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=sr(l)),e.sheetRows>0&&a["!ref"]){var D=An(a["!ref"]);e.sheetRows<=+D.e.r&&(D.e.r=e.sheetRows-1,D.e.r>l.e.r&&(D.e.r=l.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>l.e.c&&(D.e.c=l.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),a["!fullref"]=a["!ref"],a["!ref"]=sr(D))}return b.length>0&&(a["!cols"]=b),R.length>0&&(a["!merges"]=R),a}function DP(t,e,r,n){var i=bt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=ur(Ur(i.codeName)))}function Jbe(t,e,r,n,i){DP(t.slice(0,t.indexOf(">")),r,n,i)}function eSe(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=bt(Ur(e[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ur(s.location))):(s.Target="#"+ur(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=An(s.ref),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var h=At({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=s)}}}function tSe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function rSe(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=bt(e[n],!0);i.hidden&&(i.hidden=ln(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,_P(i.width)),Wp(i);s<=o;)t[s++]=Vi(i)}}function nSe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var iSe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function sSe(t,e){e.Views||(e.Views=[{}]),(t.match(iSe)||[]).forEach(function(r,n){var i=bt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),ln(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var oSe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=pv("v"),o=pv("f");return function(l,u,h,d,m,g){for(var y=0,x="",b=[],C=[],E=0,R=0,k=0,O="",P,D,H=0,N=0,_,B,j=0,ee=0,oe=Array.isArray(g.CellXf),re,q=[],Z=[],ve=Array.isArray(u),ie=[],K={},ce=!1,S=!!h.sheetStubs,A=l.split(e),M=0,L=A.length;M!=L;++M){x=A[M].trim();var V=x.length;if(V!==0){var J=0;e:for(y=0;y<V;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(D=bt(x.slice(J,y),!0),H=D.r!=null?parseInt(D.r,10):H+1,N=-1,h.sheetRows&&h.sheetRows<H)continue;K={},ce=!1,D.ht&&(ce=!0,K.hpt=parseFloat(D.ht),K.hpx=yv(K.hpt)),D.hidden=="1"&&(ce=!0,K.hidden=!0),D.outlineLevel!=null&&(ce=!0,K.level=+D.outlineLevel),ce&&(ie[H-1]=K)}break;case"<":J=y;break}if(J>=y)break;if(D=bt(x.slice(J,y),!0),H=D.r!=null?parseInt(D.r,10):H+1,N=-1,!(h.sheetRows&&h.sheetRows<H)){d.s.r>H-1&&(d.s.r=H-1),d.e.r<H-1&&(d.e.r=H-1),h&&h.cellStyles&&(K={},ce=!1,D.ht&&(ce=!0,K.hpt=parseFloat(D.ht),K.hpx=yv(K.hpt)),D.hidden=="1"&&(ce=!0,K.hidden=!0),D.outlineLevel!=null&&(ce=!0,K.level=+D.outlineLevel),ce&&(ie[H-1]=K)),b=x.slice(y).split(t);for(var ae=0;ae!=b.length&&b[ae].trim().charAt(0)=="<";++ae);for(b=b.slice(ae),y=0;y!=b.length;++y)if(x=b[y].trim(),x.length!==0){if(C=x.match(r),E=y,R=0,k=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,C!=null&&C.length===2){for(E=0,O=C[1],R=0;R!=O.length&&!((k=O.charCodeAt(R)-64)<1||k>26);++R)E=26*E+k;--E,N=E}else++N;for(R=0;R!=x.length&&x.charCodeAt(R)!==62;++R);if(++R,D=bt(x.slice(0,R),!0),D.r||(D.r=At({r:H-1,c:N})),O=x.slice(R),P={t:""},(C=O.match(s))!=null&&C[1]!==""&&(P.v=ur(C[1])),h.cellFormula){if((C=O.match(o))!=null&&C[1]!==""){if(P.f=ur(Ur(C[1])).replace(/\r\n/g,`
`),h.xlfn||(P.f=M5(P.f)),C[0].indexOf('t="array"')>-1)P.F=(O.match(i)||[])[1],P.F.indexOf(":")>-1&&q.push([An(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){B=bt(C[0]);var ue=ur(Ur(C[1]));h.xlfn||(ue=M5(ue)),Z[parseInt(B.si,10)]=[B,ue,D.r]}}else(C=O.match(/<f[^>]*\/>/))&&(B=bt(C[0]),Z[B.si]&&(P.f=vwe(Z[B.si][1],Z[B.si][2],D.r)));var pe=gs(D.r);for(R=0;R<q.length;++R)pe.r>=q[R][0].s.r&&pe.r<=q[R][0].e.r&&pe.c>=q[R][0].s.c&&pe.c<=q[R][0].e.c&&(P.F=q[R][1])}if(D.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(S)P.t="z";else continue;else P.t=D.t||"n";switch(d.s.c>N&&(d.s.c=N),d.e.c<N&&(d.e.c=N),P.t){case"n":if(P.v==""||P.v==null){if(!S)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!S)continue;P.t="z"}else _=Ig[parseInt(P.v,10)],P.v=_.t,P.r=_.r,h.cellHTML&&(P.h=_.h);break;case"str":P.t="s",P.v=P.v!=null?Ur(P.v):"",h.cellHTML&&(P.h=xP(P.v));break;case"inlineStr":C=O.match(n),P.t="s",C!=null&&(_=OP(C[1]))?(P.v=_.t,h.cellHTML&&(P.h=_.h)):P.v="";break;case"b":P.v=ln(P.v);break;case"d":h.cellDates?P.v=Si(P.v,1):(P.v=ws(Si(P.v,1)),P.t="n");break;case"e":(!h||h.cellText!==!1)&&(P.w=P.v),P.v=wY[P.v];break}if(j=ee=0,re=null,oe&&D.s!==void 0&&(re=g.CellXf[D.s],re!=null&&(re.numFmtId!=null&&(j=re.numFmtId),h.cellStyles&&re.fillId!=null&&(ee=re.fillId))),ZY(P,j,ee,h,m,g),h.cellDates&&oe&&P.t=="n"&&a0(_t[j])&&(P.t="d",P.v=LS(P.v)),D.cm&&h.xlmeta){var ke=(h.xlmeta.Cell||[])[+D.cm-1];ke&&ke.type=="XLDAPR"&&(P.D=!0)}if(ve){var z=gs(D.r);u[z.r]||(u[z.r]=[]),u[z.r][z.c]=P}else u[D.r]=P}}}}ie.length>0&&(u["!rows"]=ie)}}();function aSe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var lSe=Hh;function cSe(){}function uSe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Dve(t),r}function fSe(t){var e=ca(t);return[e]}function hSe(t){var e=Fh(t);return[e]}function dSe(t){var e=ca(t),r=t.read_shift(1);return[e,r,"b"]}function pSe(t){var e=Fh(t),r=t.read_shift(1);return[e,r,"b"]}function mSe(t){var e=ca(t),r=t.read_shift(1);return[e,r,"e"]}function gSe(t){var e=Fh(t),r=t.read_shift(1);return[e,r,"e"]}function vSe(t){var e=ca(t),r=t.read_shift(4);return[e,r,"s"]}function ySe(t){var e=Fh(t),r=t.read_shift(4);return[e,r,"s"]}function xSe(t){var e=ca(t),r=Ji(t);return[e,r,"n"]}function eq(t){var e=Fh(t),r=Ji(t);return[e,r,"n"]}function wSe(t){var e=ca(t),r=RP(t);return[e,r,"n"]}function bSe(t){var e=Fh(t),r=RP(t);return[e,r,"n"]}function SSe(t){var e=ca(t),r=TP(t);return[e,r,"is"]}function CSe(t){var e=ca(t),r=ns(t);return[e,r,"str"]}function TSe(t){var e=Fh(t),r=ns(t);return[e,r,"str"]}function ESe(t,e,r){var n=t.l+e,i=ca(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=BS(t,n-t.l,r);o[3]=Qi(a,null,i,r.supbooks,r)}else t.l=n;return o}function RSe(t,e,r){var n=t.l+e,i=ca(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=BS(t,n-t.l,r);o[3]=Qi(a,null,i,r.supbooks,r)}else t.l=n;return o}function ASe(t,e,r){var n=t.l+e,i=ca(t);i.r=r["!row"];var s=Ji(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=BS(t,n-t.l,r);o[3]=Qi(a,null,i,r.supbooks,r)}else t.l=n;return o}function kSe(t,e,r){var n=t.l+e,i=ca(t);i.r=r["!row"];var s=ns(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=BS(t,n-t.l,r);o[3]=Qi(a,null,i,r.supbooks,r)}else t.l=n;return o}var OSe=Hh;function _Se(t,e){var r=t.l+e,n=Hh(t),i=EP(t),s=ns(t),o=ns(t),a=ns(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function MSe(){}function DSe(t,e,r){var n=t.l+e,i=vY(t),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=Fbe(t,n-t.l,r);o[1]=a}else t.l=n;return o}function PSe(t,e,r){var n=t.l+e,i=Hh(t),s=[i];if(r.cellFormula){var o=Bbe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}var ISe=["left","right","top","bottom","header","footer"];function NSe(t){var e={};return ISe.forEach(function(r){e[r]=Ji(t)}),e}function LSe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function FSe(){}function HSe(){}function BSe(t,e,r,n,i,s,o){if(!t)return t;var a=e||{};n||(n={"!id":{}});var l=a.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,g,y,x,b,C,E,R,k,O,P=[];a.biff=12,a["!row"]=0;var D=0,H=!1,N=[],_={},B=a.supbooks||i.supbooks||[[]];if(B.sharedf=_,B.arrayf=N,B.SheetNames=i.SheetNames||i.Sheets.map(function(ve){return ve.name}),!a.supbooks&&(a.supbooks=B,i.Names))for(var j=0;j<i.Names.length;++j)B[0][j+1]=i.Names[j];var ee=[],oe=[],re=!1;kb[16]={n:"BrtShortReal",f:eq};var q;if(Bc(t,function(ie,K,ce){if(!m)switch(ce){case 148:u=ie;break;case 0:g=ie,a.sheetRows&&a.sheetRows<=g.r&&(m=!0),k=ji(b=g.r),a["!row"]=g.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=yv(ie.hpt)),oe[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ie[2]},ie[2]){case"n":y.v=ie[1];break;case"s":R=Ig[ie[1]],y.v=R.t,y.r=R.r;break;case"b":y.v=!!ie[1];break;case"e":y.v=ie[1],a.cellText!==!1&&(y.w=Bh[y.v]);break;case"str":y.t="s",y.v=ie[1];break;case"is":y.t="s",y.v=ie[1].t;break}if((x=o.CellXf[ie[0].iStyleRef])&&ZY(y,x.numFmtId,null,a,s,o),C=ie[0].c==-1?C+1:ie[0].c,a.dense?(l[b]||(l[b]=[]),l[b][C]=y):l[ui(C)+k]=y,a.cellFormula){for(H=!1,D=0;D<N.length;++D){var S=N[D];g.r>=S[0].s.r&&g.r<=S[0].e.r&&C>=S[0].s.c&&C<=S[0].e.c&&(y.F=sr(S[0]),H=!0)}!H&&ie.length>3&&(y.f=ie[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>C&&(h.s.c=C),h.e.r<g.r&&(h.e.r=g.r),h.e.c<C&&(h.e.c=C),a.cellDates&&x&&y.t=="n"&&a0(_t[x.numFmtId])){var A=th(y.v);A&&(y.t="d",y.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}q&&(q.type=="XLDAPR"&&(y.D=!0),q=void 0);break;case 1:case 12:if(!a.sheetStubs||d)break;y={t:"z",v:void 0},C=ie[0].c==-1?C+1:ie[0].c,a.dense?(l[b]||(l[b]=[]),l[b][C]=y):l[ui(C)+k]=y,h.s.r>g.r&&(h.s.r=g.r),h.s.c>C&&(h.s.c=C),h.e.r<g.r&&(h.e.r=g.r),h.e.c<C&&(h.e.c=C),q&&(q.type=="XLDAPR"&&(y.D=!0),q=void 0);break;case 176:P.push(ie);break;case 49:q=((a.xlmeta||{}).Cell||[])[ie-1];break;case 494:var M=n["!id"][ie.relId];for(M?(ie.Target=M.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=M):ie.relId==""&&(ie.Target="#"+ie.loc),b=ie.rfx.s.r;b<=ie.rfx.e.r;++b)for(C=ie.rfx.s.c;C<=ie.rfx.e.c;++C)a.dense?(l[b]||(l[b]=[]),l[b][C]||(l[b][C]={t:"z",v:void 0}),l[b][C].l=ie):(E=At({c:C,r:b}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=ie);break;case 426:if(!a.cellFormula)break;N.push(ie),O=a.dense?l[b][C]:l[ui(C)+k],O.f=Qi(ie[1],h,{r:g.r,c:C},B,a),O.F=sr(ie[0]);break;case 427:if(!a.cellFormula)break;_[At(ie[0].s)]=ie[1],O=a.dense?l[b][C]:l[ui(C)+k],O.f=Qi(ie[1],h,{r:g.r,c:C},B,a);break;case 60:if(!a.cellStyles)break;for(;ie.e>=ie.s;)ee[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},re||(re=!0,_P(ie.w/256)),Wp(ee[ie.e+1]);break;case 161:l["!autofilter"]={ref:sr(ie)};break;case 476:l["!margins"]=ie;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ie.name&&(i.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(l["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!K.T){if(!d||a.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=sr(u||h)),a.sheetRows&&l["!ref"]){var Z=An(l["!ref"]);a.sheetRows<=+Z.e.r&&(Z.e.r=a.sheetRows-1,Z.e.r>h.e.r&&(Z.e.r=h.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>h.e.c&&(Z.e.c=h.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),l["!fullref"]=l["!ref"],l["!ref"]=sr(Z))}return P.length>0&&(l["!merges"]=P),ee.length>0&&(l["!cols"]=ee),oe.length>0&&(l["!rows"]=oe),l}function VSe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=ur((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function jSe(t,e,r,n,i,s){var o=s||{"!type":"chart"};if(!t)return s;var a=0,l=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=VSe(d);h.s.r=h.s.c=0,h.e.c=a,u=ui(a),m[0].forEach(function(g,y){o[u+ji(y)]={t:"n",v:g,z:m[1]},l=y}),h.e.r<l&&(h.e.r=l),++a}),a>0&&(o["!ref"]=sr(h)),o}function WSe(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=t.match(JY);return a&&DP(a[0],s,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function zSe(t,e){t.l+=10;var r=ns(t);return{name:r}}function USe(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Bc(t,function(l,u,h){switch(h){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var tq=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$Se=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],GSe=[],YSe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function L5(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ln(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function F5(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ln(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function rq(t){F5(t.WBProps,tq),F5(t.CalcPr,YSe),L5(t.WBView,$Se),L5(t.Sheets,GSe),xp.date1904=ln(t.WBProps.date1904)}var qSe="][*?/\\".split("");function KSe(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return qSe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var XSe=/<\w+:workbook/;function QSe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(t.replace(os,function(l,u){var h=bt(l);switch(Bl(h[0])){case"<?xml":break;case"<workbook":l.match(XSe)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":tq.forEach(function(d){if(h[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=ln(h[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(h[d[0]],10);break;default:r.WBProps[d[0]]=h[d[0]]}}),h.codeName&&(r.WBProps.CodeName=Ur(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=ur(Ur(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ur(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),ln(h.hidden||"0")&&(s.Hidden=!0),o=u+l.length;break;case"</definedName>":s.Ref=ur(Ur(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return l}),mve.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return rq(r),r}function ZSe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=f_(t),r.name=ns(t),r}function JSe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?ns(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function eCe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function tCe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=Pve(t),o=Hbe(t,0,r),a=EP(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function rCe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],kb[16]={n:"BrtFRTArchID$",f:eCe},Bc(t,function(l,u,h){switch(h){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Qi(l.Ptg,null,null,o,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,l]):o[0]=[h,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),rq(r),r.Names=s,r.supbooks=o,r}function nCe(t,e,r){return e.slice(-4)===".bin"?rCe(t,r):QSe(t,r)}function iCe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?BSe(t,n,r,i,s,o,a):Zbe(t,n,r,i,s,o,a)}function sCe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?USe(t,n,r,i,s):WSe(t,n,r,i,s)}function oCe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?pwe():mwe()}function aCe(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?hwe():dwe()}function lCe(t,e,r,n){return e.slice(-4)===".bin"?O1e(t,r,n):C1e(t,r,n)}function cCe(t,e,r){return WY(t,r)}function uCe(t,e,r){return e.slice(-4)===".bin"?$xe(t,r):zxe(t,r)}function fCe(t,e,r){return e.slice(-4)===".bin"?cwe(t,r):iwe(t,r)}function hCe(t,e,r){return e.slice(-4)===".bin"?twe(t):J1e(t)}function dCe(t,e,r,n){return r.slice(-4)===".bin"?rwe(t,e,r,n):void 0}function pCe(t,e,r){return e.slice(-4)===".bin"?Q1e(t,e,r):Z1e(t,e,r)}var nq=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,iq=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ca(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(nq),s,o,a,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(iq),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function mCe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(nq),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(iq),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Lg;function gCe(t,e){var r=Lg[t]||ur(t);return r==="General"?xh(e):sa(r,e)}function vCe(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ln(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Si(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ur(e)]=i}function yCe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Bh[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=dv(t.v):t.w=xh(t.v):t.w=gCe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Lg[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&a0(n)){var i=th(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function xCe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=v1e[n.Pattern]||n.Pattern)}t[e.ID]=e}function wCe(t,e,r,n,i,s,o,a,l,u){var h="General",d=n.StyleID,m={};u=u||{};var g=[],y=0;for(d===void 0&&a&&(d=a.StyleID),d===void 0&&o&&(d=o.StyleID);s[d]!==void 0&&(s[d].nf&&(h=s[d].nf),s[d].Interior&&g.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ln(t);break;case"String":n.t="s",n.r=s5(ur(t)),n.v=t.indexOf("<")>-1?ur(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Si(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ur(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=wY[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=s5(e||t));break}if(yCe(n,h,u),u.cellFormula!==!1)if(n.Formula){var x=ur(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=yp(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=yp("RC:RC",i):n.ArrayRange&&(n.F=yp(n.ArrayRange,i),l.push([An(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(g.forEach(function(b){!m.patternType&&b.patternType&&(m.patternType=b.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function bCe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function gR(t,e){var r=e||{};GG();var n=ag(wP(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ur(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Vi(r);return o.type="string",gv.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){i.indexOf("<"+Ue)>=0&&(s=!0)}),s)return _Ce(n,r);Lg={"General Number":"General","General Date":_t[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":_t[15],"Short Date":_t[14],"Long Time":_t[19],"Medium Time":_t[18],"Short Time":_t[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:_t[2],Standard:_t[4],Percent:_t[10],Scientific:_t[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],u,h={},d=[],m=r.dense?[]:{},g="",y={},x={},b=Ca('<Data ss:Type="String">'),C=0,E=0,R=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},P={},D="",H=0,N=[],_={},B={},j=0,ee=[],oe=[],re={},q=[],Z,ve=!1,ie=[],K=[],ce={},S=0,A=0,M={Sheets:[],WBProps:{date1904:!1}},L={};mv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";a=mv.exec(n);)switch(a[3]=(V=a[3]).toLowerCase()){case"data":if(V=="data"){if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?wCe(n.slice(C,a.index),D,b,l[l.length-1][0]=="comment"?re:y,{c:E,r:R},O,q[E],x,ie,r):(D="",b=Ca(a[0]),C=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(oe.length>0&&(y.c=oe),(!r.sheetRows||r.sheetRows>R)&&y.v!==void 0&&(r.dense?(m[R]||(m[R]=[]),m[R][E]=y):m[ui(E)+ji(R)]=y),y.HRef&&(y.l={Target:ur(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(S=E+(parseInt(y.MergeAcross,10)|0),A=R+(parseInt(y.MergeDown,10)|0),N.push({s:{c:E,r:R},e:{c:S,r:A}})),!r.sheetStubs)y.MergeAcross?E=S+1:++E;else if(y.MergeAcross||y.MergeDown){for(var J=E;J<=S;++J)for(var ae=R;ae<=A;++ae)(J>E||ae>R)&&(r.dense?(m[ae]||(m[ae]=[]),m[ae][J]={t:"z"}):m[ui(J)+ji(ae)]={t:"z"});E=S+1}else++E;else y=mCe(a[0]),y.Index&&(E=+y.Index-1),E<k.s.c&&(k.s.c=E),E>k.e.c&&(k.e.c=E),a[0].slice(-2)==="/>"&&++E,oe=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(R<k.s.r&&(k.s.r=R),R>k.e.r&&(k.e.r=R),a[0].slice(-2)==="/>"&&(x=Ca(a[0]),x.Index&&(R=+x.Index-1)),E=0,++R):(x=Ca(a[0]),x.Index&&(R=+x.Index-1),ce={},(x.AutoFitHeight=="0"||x.Height)&&(ce.hpx=parseInt(x.Height,10),ce.hpt=jY(ce.hpx),K[R]=ce),x.Hidden=="1"&&(ce.hidden=!0,K[R]=ce));break;case"worksheet":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"));d.push(g),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(m["!ref"]=sr(k),r.sheetRows&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=sr(k))),N.length&&(m["!merges"]=N),q.length>0&&(m["!cols"]=q),K.length>0&&(m["!rows"]=K),h[g]=m}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},R=E=0,l.push([a[3],!1]),u=Ca(a[0]),g=ur(u.Name),m=r.dense?[]:{},N=[],ie=[],K=[],L={name:g,Hidden:0},M.Sheets.push(L);break;case"table":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),q=[],ve=!1}break;case"style":a[1]==="/"?xCe(O,P,r):P=Ca(a[0]);break;case"numberformat":P.nf=ur(Ca(a[0]).Format||"General"),Lg[P.nf]&&(P.nf=Lg[P.nf]);for(var ue=0;ue!=392&&_t[ue]!=P.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(_t[ue]==null){uh(P.nf,ue);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Z=Ca(a[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!ve&&Z.wpx>10){ve=!0,ds=BY;for(var pe=0;pe<q.length;++pe)q[pe]&&Wp(q[pe])}ve&&Wp(Z),q[Z.Index-1||q.length]=Z;for(var ke=0;ke<+Z.Span;++ke)q[q.length]=Vi(Z);break;case"namedrange":if(a[1]==="/")break;M.Names||(M.Names=[]);var z=bt(a[0]),Be={Name:z.Name,Ref:yp(z.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(Be.Sheet=M.Sheets.length-1),M.Names.push(Be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?D+=n.slice(H,a.index):H=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Ca(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?iye(_,V,n.slice(j,a.index)):j=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"));bCe(re),oe.push(re)}else l.push([a[3],!1]),u=Ca(a[0]),re={a:u.Author};break;case"autofilter":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var Fe=Ca(a[0]);m["!autofilter"]={ref:yp(Fe.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return z5(n,r);var ze=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ze=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ze=!1}break;case"excelworkbook":switch(a[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ze=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:ze=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(j,a.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else j=a.index+a[0].length;break;case"header":m["!margins"]||Ng(m["!margins"]={},"xlml"),isNaN(+bt(a[0]).Margin)||(m["!margins"].header=+bt(a[0]).Margin);break;case"footer":m["!margins"]||Ng(m["!margins"]={},"xlml"),isNaN(+bt(a[0]).Margin)||(m["!margins"].footer=+bt(a[0]).Margin);break;case"pagemargins":var Ge=bt(a[0]);m["!margins"]||Ng(m["!margins"]={},"xlml"),isNaN(+Ge.Top)||(m["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(m["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(m["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(m["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ze=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ze=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ze=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ze=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ze=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ze=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ze=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ze=!1}break;case"smarttags":break;default:ze=!1;break}if(ze||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?vCe(B,V,ee,n.slice(j,a.index)):(ee=a,j=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var Ee={};return!r.bookSheets&&!r.bookProps&&(Ee.Sheets=h),Ee.SheetNames=d,Ee.Workbook=M,Ee.SSF=Vi(_t),Ee.Props=_,Ee.Custprops=B,Ee}function m_(t,e){switch(NP(e=e||{}),e.type||"base64"){case"base64":return gR(yo(t),e);case"binary":case"buffer":case"file":return gR(t,e);case"array":return gR(Lh(t),e)}}function SCe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Lve(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=Fve(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var CCe=[60,1084,2066,2165,2175];function TCe(t,e,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=Sc(r,r.l),u=g_[l],h=0;u!=null&&CCe.indexOf(l)>-1;)s=Sc(r,r.l+2),h=r.l+4,l==2066?h+=4:(l==2165||l==2175)&&(h+=12),a=r.slice(h,r.l+4+s),o.push(a),r.l+=4+s,u=g_[l=Sc(r,r.l)];var d=Tu(o);Ni(d,0);var m=0;d.lens=[];for(var g=0;g<o.length;++g)d.lens.push(m),m+=o[g].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,i)}function nl(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=_t[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Bh[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=dv(t.v):t.w=xh(t.v):t.w=sa(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&a0(_t[n]||String(n))){var i=th(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function S1(t,e,r){return{v:t,ixfe:e,t:r}}function ECe(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},o={},a=null,l=[],u="",h={},d,m="",g,y,x,b,C={},E=[],R,k,O=[],P=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},H={},N=function(Xe){return Xe<8?fh[Xe]:Xe<64&&P[Xe-8]||fh[Xe]},_=function(Xe,Je,Lt){var nt=Je.XF.data;if(!(!nt||!nt.patternType||!Lt||!Lt.cellStyles)){Je.s={},Je.s.patternType=nt.patternType;var ct;(ct=vv(N(nt.icvFore)))&&(Je.s.fgColor={rgb:ct}),(ct=vv(N(nt.icvBack)))&&(Je.s.bgColor={rgb:ct})}},B=function(Xe,Je,Lt){if(!(ce>1)&&!(Lt.sheetRows&&Xe.r>=Lt.sheetRows)){if(Lt.cellStyles&&Je.XF&&Je.XF.data&&_(Xe,Je,Lt),delete Je.ixfe,delete Je.XF,d=Xe,m=At(Xe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<o.s.r&&(o.s.r=Xe.r),Xe.c<o.s.c&&(o.s.c=Xe.c),Xe.r+1>o.e.r&&(o.e.r=Xe.r+1),Xe.c+1>o.e.c&&(o.e.c=Xe.c+1),Lt.cellFormula&&Je.f){for(var nt=0;nt<E.length;++nt)if(!(E[nt][0].s.c>Xe.c||E[nt][0].s.r>Xe.r)&&!(E[nt][0].e.c<Xe.c||E[nt][0].e.r<Xe.r)){Je.F=sr(E[nt][0]),(E[nt][0].s.c!=Xe.c||E[nt][0].s.r!=Xe.r)&&delete Je.f,Je.f&&(Je.f=""+Qi(E[nt][1],o,Xe,ie,j));break}}Lt.dense?(i[Xe.r]||(i[Xe.r]=[]),i[Xe.r][Xe.c]=Je):i[m]=Je}},j={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(j.password=e.password);var ee,oe=[],re=[],q=[],Z=[],ve=!1,ie=[];ie.SheetNames=j.snames,ie.sharedf=j.sharedf,ie.arrayf=j.arrayf,ie.names=[],ie.XTI=[];var K=0,ce=0,S=0,A=[],M=[],L;j.codepage=1200,Na(1200);for(var V=!1;t.l<t.length-1;){var J=t.l,ae=t.read_shift(2);if(ae===0&&K===10)break;var ue=t.l===t.length?0:t.read_shift(2),pe=g_[ae];if(pe&&pe.f){if(e.bookSheets&&K===133&&ae!==133)break;if(K=ae,pe.r===2||pe.r==12){var ke=t.read_shift(2);if(ue-=2,!j.enc&&ke!==ae&&((ke&255)<<8|ke>>8)!==ae)throw new Error("rt mismatch: "+ke+"!="+ae);pe.r==12&&(t.l+=10,ue-=10)}var z={};if(ae===10?z=pe.f(t,ue,j):z=TCe(ae,pe,t,ue,j),ce==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(ae){case 34:r.opts.Date1904=D.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(t.l=0),j.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=z;break;case 66:var Be=Number(z);switch(Be){case 21010:Be=1200;break;case 32768:Be=1e4;break;case 32769:Be=1252;break}Na(j.codepage=Be),V=!0;break;case 317:j.rrtabid=z;break;case 25:j.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:j.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(i["!type"]="dialog"),z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:O.push(z);break;case 430:ie.push([z]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(z);break;case 24:case 536:L={Name:z.Name,Ref:Qi(z.rgce,o,null,ie,j)},z.itab>0&&(L.Sheet=z.itab-1),ie.names.push(L),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(M[z.itab-1]={ref:sr(z.rgce[0][0][1][2])});break;case 22:j.ExternCount=z;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(z),ie.XTI=ie.XTI.concat(z);break;case 2196:if(j.biff<8)break;L!=null&&(L.Comment=z[1]);break;case 18:i["!protect"]=z;break;case 19:z!==0&&j.WTF&&console.error("Password verifier: "+z);break;case 133:s[z.pos]=z,j.snames.push(z.name);break;case 10:{if(--ce)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=sr(o),e.sheetRows&&e.sheetRows<=o.e.r){var Fe=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=sr(o),o.e.r=Fe}o.e.r++,o.e.c++}oe.length>0&&(i["!merges"]=oe),re.length>0&&(i["!objects"]=re),q.length>0&&(i["!cols"]=q),Z.length>0&&(i["!rows"]=Z),D.Sheets.push(H)}u===""?h=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),j.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(j.biff=5,V=!0,Na(j.codepage=28591)),j.biff==8&&z.BIFFVer==0&&z.dt==16&&(j.biff=2),ce++)break;if(i=e.dense?[]:{},j.biff<8&&!V&&(V=!0,Na(j.codepage=e.codepage||1252)),j.biff<5||z.BIFFVer==0&&z.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ze={pos:t.l-ue,name:u};s[ze.pos]=ze,j.snames.push(u)}else u=(s[J]||{name:""}).name;z.dt==32&&(i["!type"]="chart"),z.dt==64&&(i["!type"]="macro"),oe=[],re=[],j.arrayf=E=[],q=[],Z=[],ve=!1,H={Hidden:(s[J]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[z.r]||[])[z.c]:i[At({c:z.c,r:z.r})])&&++z.c,R={ixfe:z.ixfe,XF:O[z.ixfe]||{},v:z.val,t:"n"},S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:z.c,r:z.r},R,e);break;case 5:case 517:R={ixfe:z.ixfe,XF:O[z.ixfe],v:z.val,t:z.t},S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:z.c,r:z.r},R,e);break;case 638:R={ixfe:z.ixfe,XF:O[z.ixfe],v:z.rknum,t:"n"},S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:z.c,r:z.r},R,e);break;case 189:for(var Ge=z.c;Ge<=z.C;++Ge){var Ee=z.rkrec[Ge-z.c][0];R={ixfe:Ee,XF:O[Ee],v:z.rkrec[Ge-z.c][1],t:"n"},S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:Ge,r:z.r},R,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){a=z;break}if(R=S1(z.val,z.cell.ixfe,z.tt),R.XF=O[R.ixfe],e.cellFormula){var Ue=z.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var st=Ue[0][0][1][0],tt=Ue[0][0][1][1],at=At({r:st,c:tt});C[at]?R.f=""+Qi(z.formula,o,z.cell,ie,j):R.F=((e.dense?(i[st]||[])[tt]:i[at])||{}).F}else R.f=""+Qi(z.formula,o,z.cell,ie,j)}S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B(z.cell,R,e),a=z}break;case 7:case 519:if(a)a.val=z,R=S1(z,a.cell.ixfe,"s"),R.XF=O[R.ixfe],e.cellFormula&&(R.f=""+Qi(a.formula,o,a.cell,ie,j)),S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B(a.cell,R,e),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(z);var je=At(z[0].s);if(g=e.dense?(i[z[0].s.r]||[])[z[0].s.c]:i[je],e.cellFormula&&g){if(!a||!je||!g)break;g.f=""+Qi(z[1],o,z[0],ie,j),g.F=sr(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!a)break;C[At(a.cell)]=z[0],g=e.dense?(i[a.cell.r]||[])[a.cell.c]:i[At(a.cell)],(g||{}).f=""+Qi(z[0],o,d,ie,j)}}break;case 253:R=S1(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(R.h=l[z.isst].h),R.XF=O[R.ixfe],S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:z.c,r:z.r},R,e);break;case 513:e.sheetStubs&&(R={ixfe:z.ixfe,XF:O[z.ixfe],t:"z"},S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:z.c,r:z.r},R,e));break;case 190:if(e.sheetStubs)for(var er=z.c;er<=z.C;++er){var Nt=z.ixfe[er-z.c];R={ixfe:Nt,XF:O[Nt],t:"z"},S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:er,r:z.r},R,e)}break;case 214:case 516:case 4:R=S1(z.val,z.ixfe,"s"),R.XF=O[R.ixfe],S>0&&(R.z=A[R.ixfe>>8&63]),nl(R,e,r.opts.Date1904),B({c:z.c,r:z.r},R,e);break;case 0:case 512:ce===1&&(o=z);break;case 252:l=z;break;case 1054:if(j.biff==4){A[S++]=z[1];for(var jt=0;jt<S+163&&_t[jt]!=z[1];++jt);jt>=163&&uh(z[1],S+163)}else uh(z[1],z[0]);break;case 30:{A[S++]=z;for(var Dt=0;Dt<S+163&&_t[Dt]!=z;++Dt);Dt>=163&&uh(z,S+163)}break;case 229:oe=oe.concat(z);break;case 93:re[z.cmo[0]]=j.lastobj=z;break;case 438:j.lastobj.TxO=z;break;case 127:j.lastobj.ImData=z;break;case 440:for(b=z[0].s.r;b<=z[0].e.r;++b)for(x=z[0].s.c;x<=z[0].e.c;++x)g=e.dense?(i[b]||[])[x]:i[At({c:x,r:b})],g&&(g.l=z[1]);break;case 2048:for(b=z[0].s.r;b<=z[0].e.r;++b)for(x=z[0].s.c;x<=z[0].e.c;++x)g=e.dense?(i[b]||[])[x]:i[At({c:x,r:b})],g&&g.l&&(g.l.Tooltip=z[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;g=e.dense?(i[z[0].r]||[])[z[0].c]:i[At(z[0])];var Et=re[z[2]];g||(e.dense?(i[z[0].r]||(i[z[0].r]=[]),g=i[z[0].r][z[0].c]={t:"z"}):g=i[At(z[0])]={t:"z"},o.e.r=Math.max(o.e.r,z[0].r),o.s.r=Math.min(o.s.r,z[0].r),o.e.c=Math.max(o.e.c,z[0].c),o.s.c=Math.min(o.s.c,z[0].c)),g.c||(g.c=[]),y={a:z[1],t:Et.TxO.t},g.c.push(y)}break;case 2173:Y1e(O[z.ixfe],z.ext);break;case 125:{if(!j.cellStyles)break;for(;z.e>=z.s;)q[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ve||(ve=!0,_P(z.w/256)),Wp(q[z.e+1])}break;case 520:{var Ct={};z.level!=null&&(Z[z.r]=Ct,Ct.level=z.level),z.hidden&&(Z[z.r]=Ct,Ct.hidden=!0),z.hpt&&(Z[z.r]=Ct,Ct.hpt=z.hpt,Ct.hpx=yv(z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ng(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=z;break;case 161:i["!margins"]||Ng(i["!margins"]={}),i["!margins"].header=z.header,i["!margins"].footer=z.footer;break;case 574:z.RTL&&(D.Views[0].RTL=!0);break;case 146:P=z;break;case 2198:ee=z;break;case 140:k=z;break;case 442:u?H.CodeName=z||H.name:D.WBProps.CodeName=z||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),t.l+=ue}return r.SheetNames=Nl(s).sort(function(Rt,Xe){return Number(Rt)-Number(Xe)}).map(function(Rt){return s[Rt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&M.forEach(function(Rt,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=Rt}),r.Strings=l,r.SSF=Vi(_t),j.enc&&(r.Encryption=j.enc),ee&&(r.Themes=ee),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),ie.names.length>0&&(D.Names=ie.names),r.Workbook=D,r}var H5={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function RCe(t,e,r){var n=ir.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=b5(n,zve,H5.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var o=ir.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var a=b5(o,Uve,H5.SI);for(var l in a)e[l]==null&&(e[l]=a[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(SY(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function sq(t,e){e||(e={}),NP(e),IG(),e.codepage&&dP(e.codepage);var r,n;if(t.FullPaths){if(ir.find(t,"/encryption"))throw new Error("File is password-protected");r=ir.find(t,"!CompObj"),n=ir.find(t,"/Workbook")||ir.find(t,"/Book")}else{switch(e.type){case"base64":t=Ia(yo(t));break;case"binary":t=Ia(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ni(t,0),n={content:t}}var i,s;if(r&&SCe(r),e.bookProps&&!e.bookSheets)i={};else{var o=Zt?"buffer":"array";if(n&&n.content)i=ECe(n.content,e);else if((s=ir.find(t,"PerfectOffice_MAIN"))&&s.content)i=Pg.to_workbook(s.content,(e.type=o,e));else if((s=ir.find(t,"NativeContent_MAIN"))&&s.content)i=Pg.to_workbook(s.content,(e.type=o,e));else throw(s=ir.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ir.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=fwe(t))}var a={};return t.FullPaths&&RCe(t,a,e),i.Props=i.Custprops=a,e.bookFiles&&(i.cfb=t),i}var kb={0:{f:aSe},1:{f:fSe},2:{f:wSe},3:{f:mSe},4:{f:dSe},5:{f:xSe},6:{f:CSe},7:{f:vSe},8:{f:kSe},9:{f:ASe},10:{f:ESe},11:{f:RSe},12:{f:hSe},13:{f:bSe},14:{f:gSe},15:{f:pSe},16:{f:eq},17:{f:TSe},18:{f:ySe},19:{f:TP},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tCe},40:{},42:{},43:{f:E1e},44:{f:T1e},45:{f:R1e},46:{f:k1e},47:{f:A1e},48:{},49:{f:Ove},50:{},51:{f:K1e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:IY},62:{f:SSe},63:{f:ewe},64:{f:FSe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ss,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:LSe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uSe},148:{f:lSe,p:16},151:{f:MSe},152:{},153:{f:JSe},154:{},155:{},156:{f:ZSe},157:{},158:{},159:{T:1,f:Uxe},160:{T:-1},161:{T:1,f:Hh},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:OSe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:q1e},336:{T:-1},337:{f:X1e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:f_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:PY},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DSe},427:{f:PSe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:NSe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cSe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_Se},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:f_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lwe},633:{T:1},634:{T:-1},635:{T:1,f:awe},636:{T:-1},637:{f:Mve},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zSe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:HSe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},g_={6:{f:pR},10:{f:mu},12:{f:Kn},13:{f:Kn},14:{f:Pn},15:{f:Pn},16:{f:Ji},17:{f:Pn},18:{f:Pn},19:{f:Kn},20:{f:E5},21:{f:E5},23:{f:PY},24:{f:A5},25:{f:Pn},26:{},27:{},28:{f:sxe},29:{},34:{f:Pn},35:{f:R5},38:{f:Ji},39:{f:Ji},40:{f:Ji},41:{f:Ji},42:{f:Pn},43:{f:Pn},47:{f:c1e},49:{f:Vye},51:{f:Kn},60:{},61:{f:Fye},64:{f:Pn},65:{f:Bye},66:{f:Kn},77:{},80:{},81:{},82:{},85:{f:Kn},89:{},90:{},91:{},92:{f:Oye},93:{f:axe},94:{},95:{f:Pn},96:{},97:{},99:{f:Pn},125:{f:IY},128:{f:Xye},129:{f:_ye},130:{f:Kn},131:{f:Pn},132:{f:Pn},133:{f:Mye},134:{},140:{f:dxe},141:{f:Kn},144:{},146:{f:mxe},151:{},152:{},153:{},154:{},155:{},156:{f:Kn},157:{},158:{},160:{f:wxe},161:{f:vxe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Gye},190:{f:Yye},193:{f:mu},197:{},198:{},199:{},200:{},201:{},202:{f:Pn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kn},220:{},221:{f:Pn},222:{},224:{f:Kye},225:{f:kye},226:{f:mu},227:{},229:{f:oxe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Dye},253:{f:jye},255:{f:Pye},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:AY},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pn},353:{f:mu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Zye},431:{f:Pn},432:{},433:{},434:{},437:{},438:{f:uxe},439:{f:Pn},440:{f:fxe},441:{},442:{f:fy},443:{},444:{f:Kn},445:{},446:{},448:{f:mu},449:{f:Lye,r:2},450:{f:mu},512:{f:C5},513:{f:xxe},515:{f:Qye},516:{f:Wye},517:{f:T5},519:{f:bxe},520:{f:Iye},523:{},545:{f:k5},549:{f:S5},566:{},574:{f:Hye},638:{f:$ye},659:{},1048:{},1054:{f:zye},1084:{},1212:{f:rxe},2048:{f:hxe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:x1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:mu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:gxe,r:12},2173:{f:G1e,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:txe,r:12},2197:{},2198:{f:V1e,r:12},2199:{},2200:{},2201:{},2202:{f:nxe,r:12},2203:{f:mu},2204:{},2205:{},2206:{},2207:{},2211:{f:Nye},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:yxe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:pxe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:C5},1:{},2:{f:Exe},3:{f:Txe},4:{f:Cxe},5:{f:T5},7:{f:Rxe},8:{},9:{f:x1},11:{},22:{f:Kn},30:{f:Uye},31:{},32:{},33:{f:k5},36:{},37:{f:S5},50:{f:Axe},62:{},52:{},67:{},68:{f:Kn},69:{},86:{},126:{},127:{f:Sxe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kxe},223:{},234:{},354:{},421:{},518:{f:pR},521:{f:x1},536:{f:A5},547:{f:R5},561:{},579:{},1030:{f:pR},1033:{f:x1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ta(t,e,r,n){var i=e;if(!isNaN(i)){var s=(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&pY(r)&&t.push(r)}}function B5(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=i.index,a=s&&s.index||t.length,l=Qge(t.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,d=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<l.length;++o){var x=l[o].trim(),b=x.slice(0,3).toLowerCase();if(b=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0;continue}if(!(b!="<td"&&b!="<th")){var C=x.split(/<\/t[dh]>/i);for(a=0;a<C.length;++a){var E=C[a].trim();if(E.match(/<t[dh]/i)){for(var R=E,k=0;R.charAt(0)=="<"&&(k=R.indexOf(">"))>-1;)R=R.slice(k+1);for(var O=0;O<y.length;++O){var P=y[O];P.s.c==h&&P.s.r<u&&u<=P.e.r&&(h=P.e.c+1,O=-1)}var D=bt(E.slice(0,E.indexOf(">")));m=D.colspan?+D.colspan:1,((d=+D.rowspan)>1||m>1)&&y.push({s:{r:u,c:h},e:{r:u+(d||1)-1,c:h+m-1}});var H=D.t||D["data-t"]||"";if(!R.length){h+=m;continue}if(R=tY(R),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!R.length){h+=m;continue}var N={t:"s",v:R};r.raw||!R.trim().length||H=="s"||(R==="TRUE"?N={t:"b",v:!0}:R==="FALSE"?N={t:"b",v:!1}:isNaN(Ba(R))?isNaN(jp(R).getDate())||(N={t:"d",v:Si(R)},r.cellDates||(N={t:"n",v:ws(N.v)}),N.z=r.dateNF||_t[14]):N={t:"n",v:Ba(R)}),r.dense?(n[u]||(n[u]=[]),n[u][h]=N):n[At({r:u,c:h})]=N,h+=m}}}}return n["!ref"]=sr(g),y.length&&(n["!merges"]=y),n}function ACe(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var h=At({r,c:o}),d=n.dense?(t[r]||[])[o]:t[h],m=d&&d.v!=null&&(d.h||xP(d.w||(Ic(d),d.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(g["data-t"]=d&&d.t||"z",d.v!=null&&(g["data-v"]=d.v),d.z!=null&&(g["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+h,s.push(dve("td",m,g))}}var y="<tr>";return y+s.join("")+"</tr>"}var kCe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',OCe="</body></html>";function _Ce(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return tf(B5(r[0],e),e);var n=FP();return r.forEach(function(i,s){HP(n,B5(i,e),"Sheet"+(s+1))}),n}function MCe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function DCe(t,e){var r=e||{},n=r.header!=null?r.header:kCe,i=r.footer!=null?r.footer:OCe,s=[n],o=l0(t["!ref"]);r.dense=Array.isArray(t),s.push(MCe(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(ACe(t,o,a,r));return s.push("</table>"+i),s.join("")}function oq(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?gs(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var h=l0(t["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var d=[],m=0,g=t["!rows"]||(t["!rows"]=[]),y=0,x=0,b=0,C=0,E=0,R=0;for(t["!cols"]||(t["!cols"]=[]);y<a.length&&x<l;++y){var k=a[y];if(V5(k)){if(n.display)continue;g[x]={hidden:!0}}var O=k.children;for(b=C=0;b<O.length;++b){var P=O[b];if(!(n.display&&V5(P))){var D=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):tY(P.innerHTML),H=P.getAttribute("data-z")||P.getAttribute("z");for(m=0;m<d.length;++m){var N=d[m];N.s.c==C+s&&N.s.r<x+i&&x+i<=N.e.r&&(C=N.e.c+1-s,m=-1)}R=+P.getAttribute("colspan")||1,((E=+P.getAttribute("rowspan")||1)>1||R>1)&&d.push({s:{r:x+i,c:C+s},e:{r:x+i+(E||1)-1,c:C+s+(R||1)-1}});var _={t:"s",v:D},B=P.getAttribute("data-t")||P.getAttribute("t")||"";D!=null&&(D.length==0?_.t=B||"z":n.raw||D.trim().length==0||B=="s"||(D==="TRUE"?_={t:"b",v:!0}:D==="FALSE"?_={t:"b",v:!1}:isNaN(Ba(D))?isNaN(jp(D).getDate())||(_={t:"d",v:Si(D)},n.cellDates||(_={t:"n",v:ws(_.v)}),_.z=n.dateNF||_t[14]):_={t:"n",v:Ba(D)})),_.z===void 0&&H!=null&&(_.z=H);var j="",ee=P.getElementsByTagName("A");if(ee&&ee.length)for(var oe=0;oe<ee.length&&!(ee[oe].hasAttribute("href")&&(j=ee[oe].getAttribute("href"),j.charAt(0)!="#"));++oe);j&&j.charAt(0)!="#"&&(_.l={Target:j}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][C+s]=_):t[At({c:C+s,r:x+i})]=_,u.e.c<C+s&&(u.e.c=C+s),C+=R}}++x}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=sr(u),x>=l&&(t["!fullref"]=sr((u.e.r=a.length-y+x-1+i,u))),t}function aq(t,e){var r=e||{},n=r.dense?[]:{};return oq(n,t,e)}function PCe(t,e){return tf(aq(t,e),e)}function V5(t){var e="",r=ICe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function ICe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function NCe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ur(e.replace(/<[^>]*>/g,""));return[r]}var j5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function lq(t,e){var r=e||{},n=wP(t),i=[],s,o,a={name:""},l="",u=0,h,d,m={},g=[],y=r.dense?[]:{},x,b,C={value:""},E="",R=0,k=[],O=-1,P=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},H=0,N={},_=[],B={},j=0,ee=0,oe=[],re=1,q=1,Z=[],ve={Names:[]},ie={},K=["",""],ce=[],S={},A="",M=0,L=!1,V=!1,J=0;for(mv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=mv.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?y["!ref"]=sr(D):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=D.e.r&&(y["!fullref"]=y["!ref"],D.e.r=r.sheetRows-1,y["!ref"]=sr(D)),_.length&&(y["!merges"]=_),oe.length&&(y["!rows"]=oe),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),m[h.name]=y,V=!1):x[0].charAt(x[0].length-2)!=="/"&&(h=bt(x[0],!1),O=P=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,y=r.dense?[]:{},_=[],oe=[],V=!0);break;case"table-row-group":x[1]==="/"?--H:++H;break;case"table-row":case"":if(x[1]==="/"){O+=re,re=1;break}if(d=bt(x[0],!1),d.?O=d.-1:O==-1&&(O=0),re=+d["number-rows-repeated"]||1,re<10)for(J=0;J<re;++J)H>0&&(oe[O+J]={level:H});P=-1;break;case"covered-table-cell":x[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(y[O]||(y[O]=[]),y[O][P]={t:"z"}):y[At({r:O,c:P})]={t:"z"}),E="",k=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++P,C=bt(x[0],!1),q=parseInt(C["number-columns-repeated"]||"1",10),b={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(b.f=N5(ur(C.formula))),(C.||C["value-type"])=="string"&&(b.t="s",b.v=ur(C["string-value"]||""),r.dense?(y[O]||(y[O]=[]),y[O][P]=b):y[At({r:O,c:P})]=b),P+=q-1;else if(x[1]!=="/"){++P,E="",R=0,k=[],q=1;var ae=re?O+re-1:O;if(P>D.e.c&&(D.e.c=P),P<D.s.c&&(D.s.c=P),O<D.s.r&&(D.s.r=O),ae>D.e.r&&(D.e.r=ae),C=bt(x[0],!1),ce=[],S={},b={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=ur(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(j=parseInt(C["number-matrix-rows-spanned"],10)||0,ee=parseInt(C["number-matrix-columns-spanned"],10)||0,B={s:{r:O,c:P},e:{r:O+j-1,c:P+ee-1}},b.F=sr(B),Z.push([B,b.F])),C.formula)b.f=N5(C.formula);else for(J=0;J<Z.length;++J)O>=Z[J][0].s.r&&O<=Z[J][0].e.r&&P>=Z[J][0].s.c&&P<=Z[J][0].e.c&&(b.F=Z[J][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(j=parseInt(C["number-rows-spanned"],10)||0,ee=parseInt(C["number-columns-spanned"],10)||0,B={s:{r:O,c:P},e:{r:O+j-1,c:P+ee-1}},_.push(B)),C["number-columns-repeated"]&&(q=parseInt(C["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=ln(C["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(C.value);break;case"percentage":b.t="n",b.v=parseFloat(C.value);break;case"currency":b.t="n",b.v=parseFloat(C.value);break;case"date":b.t="d",b.v=Si(C["date-value"]),r.cellDates||(b.t="n",b.v=ws(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=qge(C["time-value"])/86400,r.cellDates&&(b.t="d",b.v=LS(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(C.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",C["string-value"]!=null&&(E=ur(C["string-value"]),k=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(L=!1,b.t==="s"&&(b.v=E||"",k.length&&(b.R=k),L=R==0),ie.Target&&(b.l=ie),ce.length>0&&(b.c=ce,ce=[]),E&&r.cellText!==!1&&(b.w=E),L&&(b.t="z",delete b.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var ue=0;ue<re;++ue){if(q=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(y[O+ue]||(y[O+ue]=[]),y[O+ue][P]=ue==0?b:Vi(b);--q>0;)y[O+ue][P+q]=Vi(b);else for(y[At({r:O+ue,c:P})]=b;--q>0;)y[At({r:O+ue,c:P+q})]=Vi(b);D.e.c<=P&&(D.e.c=P)}q=parseInt(C["number-columns-repeated"]||"1",10),P+=q-1,q=0,b={},E="",k=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;S.t=E,k.length&&(S.R=k),S.a=A,ce.push(S)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);A="",M=0,E="",R=0,k=[];break;case"creator":x[1]==="/"?A=n.slice(M,x.index):M=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);E="",R=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(N[a.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",a=bt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=bt(x[0],!1),l+=j5[x[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=bt(x[0],!1),l+=j5[x[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":o=bt(x[0],!1),K=mR(o["cell-range-address"]);var pe={Name:o.name,Ref:K[0]+"!"+K[1]};V&&(pe.Sheet=g.length),ve.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!C||!C["string-value"])){var ke=NCe(n.slice(R,x.index));E=(E.length>0?E+`
`:"")+ke[0]}else bt(x[0],!1),R=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{K=mR(bt(x[0])["target-range-address"]),m[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(ie=bt(x[0],!1),!ie.href)break;ie.Target=ur(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(K=mR(ie.Target.slice(1)),ie.Target="#"+K[0]+"!"+K[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var z={Sheets:m,SheetNames:g,Workbook:ve};return r.bookSheets&&delete z.Sheets,z}function W5(t,e){e=e||{},Wo(t,"META-INF/manifest.xml")&&Qve(qn(t,"META-INF/manifest.xml"),e);var r=co(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=lq(Ur(r),e);return Wo(t,"meta.xml")&&(n.Props=bY(qn(t,"meta.xml"))),n}function z5(t,e){return lq(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function PP(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function v_(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ur(Lh(t))}function y_(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function U5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function LCe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function xv(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function di(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function rs(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=xv(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=xv(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:a,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function IP(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function FCe(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=xv(t,n),s=rs(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:di(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=rs(a.data),u=di(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=di(s[3][0].data)>>>0>0),r.push(o)}return r}function HCe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=xv(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[y_(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var h=y_(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function BCe(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(HCe(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return y_(e)}function VCe(t,e,r,n){var i=PP(t),s=i.getUint32(4,!0),o=(n>1?12:8)+U5(s&(n>1?3470:398))*4,a=-1,l=-1,u=NaN,h=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=U5(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:r[a]};else if(l>-1)d={t:"s",v:e[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function jCe(t,e,r){var n=PP(t),i=n.getUint32(8,!0),s=12,o=-1,a=-1,l=NaN,u=NaN,h=new Date(2001,0,1);i&1&&(l=LCe(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[a]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return d}function WCe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return VCe(t,e,r,t[0]);case 5:return jCe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Lu(t){var e=rs(t);return xv(e[1][0].data)}function $5(t,e){var r=rs(e.data),n=di(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=rs(o.data),l=di(a[1][0].data)>>>0;switch(n){case 1:s[l]=v_(a[3][0].data);break;case 8:{var u=t[Lu(a[9][0].data)][0],h=rs(u.data),d=t[Lu(h[1][0].data)][0],m=di(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=rs(d.data);s[l]=g[3].map(function(y){return v_(y.data)}).join("")}break}}),s}function zCe(t,e){var r,n,i,s,o,a,l,u,h,d,m,g,y,x,b=rs(t),C=di(b[1][0].data)>>>0,E=di(b[2][0].data)>>>0,R=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&di(b[8][0].data)>0||!1,k,O;if((s=(i=b[7])==null?void 0:i[0])!=null&&s.data&&e!=0)k=(a=(o=b[7])==null?void 0:o[0])==null?void 0:a.data,O=(u=(l=b[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(h=b[4])==null?void 0:h[0])!=null&&d.data&&e!=1)k=(g=(m=b[4])==null?void 0:m[0])==null?void 0:g.data,O=(x=(y=b[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var P=R?4:1,D=PP(k),H=[],N=0;N<k.length/2;++N){var _=D.getUint16(N*2,!0);_<65535&&H.push([N,_])}if(H.length!=E)throw"Expected ".concat(E," cells, found ").concat(H.length);var B=[];for(N=0;N<H.length-1;++N)B[H[N][0]]=O.subarray(H[N][1]*P,H[N+1][1]*P);return H.length>=1&&(B[H[H.length-1][0]]=O.subarray(H[H.length-1][1]*P)),{R:C,cells:B}}function UCe(t,e){var r,n=rs(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?di(n[7][0].data)>>>0>0?1:0:-1,s=IP(n[5],function(o){return zCe(o,i)});return{nrows:di(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,u){if(o[a.R][u])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(u));o[a.R][u]=l}),o},[])}}function $Ce(t,e,r){var n,i=rs(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(di(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(di(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=sr(s);var o=rs(i[4][0].data),a=$5(t,t[Lu(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?$5(t,t[Lu(o[17][0].data)][0]):[],u=rs(o[3][0].data),h=0;u[1].forEach(function(d){var m=rs(d.data),g=t[Lu(m[2][0].data)][0],y=di(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=UCe(t,g);x.data.forEach(function(b,C){b.forEach(function(E,R){var k=At({r:h+C,c:R}),O=WCe(E,a,l);O&&(r[k]=O)})}),h+=x.nrows})}function GCe(t,e){var r=rs(e.data),n={"!ref":"A1"},i=t[Lu(r[2][0].data)],s=di(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return $Ce(t,i[0],n),n}function YCe(t,e){var r,n=rs(e.data),i={name:(r=n[1])!=null&&r[0]?v_(n[1][0].data):"",sheets:[]},s=IP(n[2],Lu);return s.forEach(function(o){t[o].forEach(function(a){var l=di(a.meta[1][0].data);l==6e3&&i.sheets.push(GCe(t,a))})}),i}function qCe(t,e){var r=FP(),n=rs(e.data),i=IP(n[1],Lu);if(i.forEach(function(s){t[s].forEach(function(o){var a=di(o.meta[1][0].data);if(a==2){var l=YCe(t,o);l.sheets.forEach(function(u,h){HP(r,u,h==0?l.name:l.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function vR(t){var e,r,n,i,s={},o=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=BCe(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var h;try{h=FCe(u)}catch(d){return console.log("## "+(d.message||d))}h.forEach(function(d){s[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&di(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(l){s[l].forEach(function(u){var h=di(u.meta[1][0].data)>>>0;if(h==1)if(!a)a=u;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return qCe(s,a)}function KCe(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function NP(t){KCe([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function XCe(t){return lp.WS.indexOf(t)>-1?"sheet":t==lp.CS?"chart":t==lp.DS?"dialog":t==lp.MS?"macro":t&&t.length?t:"sheet"}function QCe(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,XCe(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function ZCe(t,e,r,n,i,s,o,a,l,u,h,d){try{s[n]=Mg(co(t,r,!0),e);var m=qn(t,e),g;switch(a){case"sheet":g=iCe(m,e,i,l,s[n],u,h,d);break;case"chart":if(g=sCe(m,e,i,l,s[n],u,h,d),!g||!g["!drawel"])break;var y=cg(g["!drawel"].Target,e),x=h_(y),b=nwe(co(t,y,!0),Mg(co(t,x,!0),y)),C=cg(b,y),E=h_(C);g=jSe(co(t,C,!0),C,l,Mg(co(t,E,!0),C),u,g);break;case"macro":g=oCe(m,e,i,l,s[n],u,h,d);break;case"dialog":g=aCe(m,e,i,l,s[n],u,h,d);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=g;var R=[];s&&s[n]&&Nl(s[n]).forEach(function(k){var O="";if(s[n][k].Type==lp.CMNT){O=cg(s[n][k].Target,e);var P=fCe(qn(t,O,!0),O,l);if(!P||!P.length)return;_5(g,P,!1)}s[n][k].Type==lp.TCMNT&&(O=cg(s[n][k].Target,e),R=R.concat(swe(qn(t,O,!0),l)))}),R&&R.length&&_5(g,R,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function Io(t){return t.charAt(0)=="/"?t.slice(1):t}function JCe(t,e){if(GG(),e=e||{},NP(e),Wo(t,"META-INF/manifest.xml")||Wo(t,"objectdata.xml"))return W5(t,e);if(Wo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof vR<"u"){if(t.FileIndex)return vR(t);var r=ir.utils.cfb_new();return n5(t).forEach(function(oe){eve(r,oe,Jge(t,oe))}),vR(r)}throw new Error("Unsupported NUMBERS file")}if(!Wo(t,"[Content_Types].xml"))throw Wo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=n5(t),i=Kve(co(t,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",qn(t,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!qn(t,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Ig=[],i.sst)try{Ig=uCe(qn(t,Io(i.sst)),i.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&i.themes.length&&(l=cCe(co(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=lCe(qn(t,Io(i.style)),i.style,l,e))}i.links.map(function(oe){try{var re=Mg(co(t,h_(Io(oe))),oe);return dCe(qn(t,Io(oe)),re,oe,e)}catch{}});var h=nCe(qn(t,Io(i.workbooks[0])),i.workbooks[0],e),d={},m="";i.coreprops.length&&(m=qn(t,Io(i.coreprops[0]),!0),m&&(d=bY(m)),i.extprops.length!==0&&(m=qn(t,Io(i.extprops[0]),!0),m&&eye(m,d,e)));var g={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(m=co(t,Io(i.custprops[0]),!0),m&&(g=rye(m,e)));var y={};if((e.bookSheets||e.bookProps)&&(h.Sheets?o=h.Sheets.map(function(re){return re.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),e.bookProps&&(y.Props=d,y.Custprops=g),e.bookSheets&&typeof o<"u"&&(y.SheetNames=o),e.bookSheets?y.SheetNames:e.bookProps))return y;o={};var x={};e.bookDeps&&i.calcchain&&(x=hCe(qn(t,Io(i.calcchain)),i.calcchain));var b=0,C={},E,R;{var k=h.Sheets;d.Worksheets=k.length,d.SheetNames=[];for(var O=0;O!=k.length;++O)d.SheetNames[O]=k[O].name}var P=s?"bin":"xml",D=i.workbooks[0].lastIndexOf("/"),H=(i.workbooks[0].slice(0,D+1)+"_rels/"+i.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");Wo(t,H)||(H="xl/_rels/workbook."+P+".rels");var N=Mg(co(t,H,!0),H.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=pCe(qn(t,Io(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=owe(qn(t,Io(i.people[0])),e)),N&&(N=QCe(N,h.Sheets));var _=qn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=d.Worksheets;++b){var B="sheet";if(N&&N[b]?(E="xl/"+N[b][1].replace(/[\/]?xl\//,""),Wo(t,E)||(E=N[b][1]),Wo(t,E)||(E=H.replace(/_rels\/.*$/,"")+N[b][1]),B=N[b][2]):(E="xl/worksheets/sheet"+(b+1-_)+"."+P,E=E.replace(/sheet0\./,"sheet.")),R=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(d.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var j=!1,ee=0;ee!=e.sheets.length;++ee)typeof e.sheets[ee]=="number"&&e.sheets[ee]==b&&(j=1),typeof e.sheets[ee]=="string"&&e.sheets[ee].toLowerCase()==d.SheetNames[b].toLowerCase()&&(j=1);if(!j)continue e}}ZCe(t,E,R,d.SheetNames[b],b,C,o,B,e,h,l,u)}return y={Directory:i,Workbook:h,Props:d,Custprops:g,Deps:x,Sheets:o,SheetNames:d.SheetNames,Strings:Ig,Styles:u,Themes:l,SSF:Vi(_t)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(oe,re){oe=oe.replace(/^Root Entry[\/]/,""),y.keys.push(oe),y.files[oe]=t.FileIndex[re]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=qn(t,Io(i.vba[0]),!0):i.defaults&&i.defaults.bin===uwe&&(y.vbaraw=qn(t,"xl/vbaProject.bin",!0))),y}function eTe(t,e){var r=e||{},n="Workbook",i=ir.find(t,n);try{if(n="/!DataSpaces/Version",i=ir.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Gxe(i.content),n="/!DataSpaces/DataSpaceMap",i=ir.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qxe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=ir.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Kxe(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=ir.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Qxe(i.content)}catch{}if(n="/EncryptionInfo",i=ir.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Zxe(i.content);if(n="/EncryptedPackage",i=ir.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function LP(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=yo(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function tTe(t,e){return ir.find(t,"EncryptedPackage")?eTe(t,e):sq(t,e)}function rTe(t,e){var r,n=t,i=e||{};return i.type||(i.type=Zt&&Buffer.isBuffer(t)?"buffer":"base64"),r=ZG(n,i),JCe(r,i)}function cq(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return m_(t.slice(r),e);default:break e}return gv.to_workbook(t,e)}function nTe(t,e){var r="",n=LP(t,e);switch(e.type){case"base64":r=yo(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=wh(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ur(r)),e.type="binary",cq(r,e)}function iTe(t,e){var r=t;return e.type=="base64"&&(r=yo(r)),r=hv.utils.decode(1200,r.slice(2),"str"),e.type="binary",cq(r,e)}function sTe(t){return t.match(/[^\x00-\x7F]/)?ug(t):t}function yR(t,e,r,n){return n?(r.type="string",gv.to_workbook(t,r)):gv.to_workbook(e,r)}function x_(t,e){IG();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return x_(new Uint8Array(t),(r=Vi(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xp={},r.dateNF&&(xp.dateNF=r.dateNF),r.type||(r.type=Zt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Zt?"buffer":"binary",n=Gge(t),typeof Uint8Array<"u"&&!Zt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=sTe(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=Vi(r),r.type="array",x_(pP(n),r)}switch((i=LP(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return tTe(ir.read(n,r),r);break;case 9:if(i[1]<=8)return sq(n,r);break;case 60:return m_(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Pxe(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Mxe.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?rTe(n,r):yR(t,n,r,s);case 239:return i[3]===60?m_(n,r):yR(t,n,r,s);case 255:if(i[1]===254)return iTe(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Pg.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Pg.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return O5.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return u1e.to_workbook(n,r);break;case 10:case 13:case 32:return nTe(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Oxe.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?O5.to_workbook(n,r):yR(t,n,r,s)}function oTe(t,e,r,n,i,s,o,a){var l=ji(r),u=a.defval,h=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||t[r])for(var g=e.s.c;g<=e.e.c;++g){var y=o?t[r][g]:t[n[g]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[g]!=null&&(m[s[g]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(x==null)if(y.t=="e"&&x===null)m[s[g]]=null;else if(u!==void 0)m[s[g]]=u;else if(h&&x===null)m[s[g]]=null;else continue;else m[s[g]]=h&&(y.t!=="n"||y.t==="n"&&a.rawNumbers!==!1)?x:Ic(y,x,a);x!=null&&(d=!1)}}return{row:m,isempty:d}}function w_(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":l=An(h);break;case"number":l=An(t["!ref"]),l.s.r=h;break;default:l=h}n>0&&(i=0);var d=ji(l.s.r),m=[],g=[],y=0,x=0,b=Array.isArray(t),C=l.s.r,E=0,R={};b&&!t[C]&&(t[C]=[]);var k=u.skipHidden&&t["!cols"]||[],O=u.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(k[E]||{}).hidden)switch(m[E]=ui(E),r=b?t[C][E]:t[m[E]+d],n){case 1:s[E]=E-l.s.c;break;case 2:s[E]=m[E];break;case 3:s[E]=u.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=Ic(r,null,u),x=R[o]||0,!x)R[o]=1;else{do a=o+"_"+x++;while(R[a]);R[o]=x,R[a]=1}s[E]=a}for(C=l.s.r+i;C<=l.e.r;++C)if(!(O[C]||{}).hidden){var P=oTe(t,l,C,m,n,s,b,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[y++]=P.row)}return g.length=y,g}var G5=/"/g;function aTe(t,e,r,n,i,s,o,a){for(var l=!0,u=[],h="",d=ji(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var g=a.dense?(t[r]||[])[m]:t[n[m]+d];if(g==null)h="";else if(g.v!=null){l=!1,h=""+(a.rawNumbers&&g.t=="n"?g.v:Ic(g,null,a));for(var y=0,x=0;y!==h.length;++y)if((x=h.charCodeAt(y))===i||x===s||x===34||a.forceQuotes){h='"'+h.replace(G5,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(l=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(G5,'""')+'"')):h="";u.push(h)}return a.blankrows===!1&&l?null:u.join(o)}function uq(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=An(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",d=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(m[y]||{}).hidden||(d[y]=ui(y));for(var x=0,b=i.s.r;b<=i.e.r;++b)(g[b]||{}).hidden||(h=aTe(t,i,b,d,o,l,s,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&r.push((x++?a:"")+h)));return delete n.dense,r.join("")}function lTe(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=uq(t,e);return r}function cTe(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=An(t["!ref"]),s="",o=[],a,l=[],u=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=ui(a);for(var h=i.s.r;h<=i.e.r;++h)for(s=ji(h),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=u?(t[h]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function fq(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?gs(n.origin):n.origin;o=l.r,a=l.c}var u,h={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var d=An(s["!ref"]);h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(o=d.e.r+1,h.e.r=o+e.length-1+i)}else o==-1&&(o=0,h.e.r=e.length-1+i);var m=n.header||[],g=0;e.forEach(function(x,b){Nl(x).forEach(function(C){(g=m.indexOf(C))==-1&&(m[g=m.length]=C);var E=x[C],R="z",k="",O=At({c:a+g,r:o+b+i});u=wv(s,O),E&&typeof E=="object"&&!(E instanceof Date)?s[O]=E:(typeof E=="number"?R="n":typeof E=="boolean"?R="b":typeof E=="string"?R="s":E instanceof Date?(R="d",n.cellDates||(R="n",E=ws(E)),k=n.dateNF||_t[14]):E===null&&n.nullError&&(R="e",E=0),u?(u.t=R,u.v=E,delete u.w,delete u.R,k&&(u.z=k)):s[O]=u={t:R,v:E},k&&(u.z=k))})}),h.e.c=Math.max(h.e.c,a+m.length-1);var y=ji(o);if(i)for(g=0;g<m.length;++g)s[ui(g+a)+y]={t:"s",v:m[g]};return s["!ref"]=sr(h),s}function uTe(t,e){return fq(null,t,e)}function wv(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=gs(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?wv(t,At(e)):wv(t,At({r:e,c:r||0}))}function fTe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function FP(){return{SheetNames:[],Sheets:{}}}function HP(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(KSe(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function hTe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=fTe(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function dTe(t,e){return t.z=e,t}function hq(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function pTe(t,e,r){return hq(t,"#"+e,r)}function mTe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function gTe(t,e,r,n){for(var i=typeof e!="string"?e:An(e),s=typeof e=="string"?e:sr(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=wv(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var vTe={encode_col:ui,encode_row:ji,encode_cell:At,encode_range:sr,decode_col:CP,decode_row:SP,split_cell:kve,decode_cell:gs,decode_range:l0,format_cell:Ic,sheet_add_aoa:gY,sheet_add_json:fq,sheet_add_dom:oq,aoa_to_sheet:c0,json_to_sheet:uTe,table_to_sheet:aq,table_to_book:PCe,sheet_to_csv:uq,sheet_to_txt:lTe,sheet_to_json:w_,sheet_to_html:DCe,sheet_to_formulae:cTe,sheet_to_row_object_array:w_,sheet_get_cell:wv,book_new:FP,book_append_sheet:HP,book_set_sheet_visibility:hTe,cell_set_number_format:dTe,cell_set_hyperlink:hq,cell_set_internal_link:pTe,cell_add_comment:mTe,sheet_set_array_formula:gTe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Y5={},Em,q5;function Bn(){if(q5)return Em;q5=1;var t=function(e){return e&&e.Math===Math&&e};return Em=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof dF=="object"&&dF)||t(typeof Em=="object"&&Em)||function(){return this}()||Function("return this")(),Em}var xR={},wR,K5;function ri(){return K5||(K5=1,wR=function(t){try{return!!t()}catch{return!0}}),wR}var bR,X5;function ua(){if(X5)return bR;X5=1;var t=ri();return bR=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),bR}var SR,Q5;function VS(){if(Q5)return SR;Q5=1;var t=ri();return SR=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),SR}var CR,Z5;function Ti(){if(Z5)return CR;Z5=1;var t=VS(),e=Function.prototype.call;return CR=t?e.bind(e):function(){return e.apply(e,arguments)},CR}var TR={},J5;function yTe(){if(J5)return TR;J5=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return TR.f=r?function(i){var s=e(this,i);return!!s&&s.enumerable}:t,TR}var ER,e6;function jS(){return e6||(e6=1,ER=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),ER}var RR,t6;function Vn(){if(t6)return RR;t6=1;var t=VS(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return RR=t?n:function(i){return function(){return r.apply(i,arguments)}},RR}var AR,r6;function jh(){if(r6)return AR;r6=1;var t=Vn(),e=t({}.toString),r=t("".slice);return AR=function(n){return r(e(n),8,-1)},AR}var kR,n6;function xTe(){if(n6)return kR;n6=1;var t=Vn(),e=ri(),r=jh(),n=Object,i=t("".split);return kR=e(function(){return!n("z").propertyIsEnumerable(0)})?function(s){return r(s)==="String"?i(s,""):n(s)}:n,kR}var OR,i6;function BP(){return i6||(i6=1,OR=function(t){return t==null}),OR}var _R,s6;function my(){if(s6)return _R;s6=1;var t=BP(),e=TypeError;return _R=function(r){if(t(r))throw new e("Can't call method on "+r);return r},_R}var MR,o6;function gy(){if(o6)return MR;o6=1;var t=xTe(),e=my();return MR=function(r){return t(e(r))},MR}var DR,a6;function ni(){if(a6)return DR;a6=1;var t=typeof document=="object"&&document.all;return DR=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},DR}var PR,l6;function fa(){if(l6)return PR;l6=1;var t=ni();return PR=function(e){return typeof e=="object"?e!==null:t(e)},PR}var IR,c6;function u0(){if(c6)return IR;c6=1;var t=Bn(),e=ni(),r=function(n){return e(n)?n:void 0};return IR=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},IR}var NR,u6;function vy(){if(u6)return NR;u6=1;var t=Vn();return NR=t({}.isPrototypeOf),NR}var LR,f6;function WS(){if(f6)return LR;f6=1;var t=Bn(),e=t.navigator,r=e&&e.userAgent;return LR=r?String(r):"",LR}var FR,h6;function wTe(){if(h6)return FR;h6=1;var t=Bn(),e=WS(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,s=i&&i.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),FR=a,FR}var HR,d6;function VP(){if(d6)return HR;d6=1;var t=wTe(),e=ri(),r=Bn(),n=r.String;return HR=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),HR}var BR,p6;function dq(){if(p6)return BR;p6=1;var t=VP();return BR=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",BR}var VR,m6;function jP(){if(m6)return VR;m6=1;var t=u0(),e=ni(),r=vy(),n=dq(),i=Object;return VR=n?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&r(o.prototype,i(s))},VR}var jR,g6;function zS(){if(g6)return jR;g6=1;var t=String;return jR=function(e){try{return t(e)}catch{return"Object"}},jR}var WR,v6;function xo(){if(v6)return WR;v6=1;var t=ni(),e=zS(),r=TypeError;return WR=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},WR}var zR,y6;function yy(){if(y6)return zR;y6=1;var t=xo(),e=BP();return zR=function(r,n){var i=r[n];return e(i)?void 0:t(i)},zR}var UR,x6;function bTe(){if(x6)return UR;x6=1;var t=Ti(),e=ni(),r=fa(),n=TypeError;return UR=function(i,s){var o,a;if(s==="string"&&e(o=i.toString)&&!r(a=t(o,i))||e(o=i.valueOf)&&!r(a=t(o,i))||s!=="string"&&e(o=i.toString)&&!r(a=t(o,i)))return a;throw new n("Can't convert object to primitive value")},UR}var $R={exports:{}},GR,w6;function Wh(){return w6||(w6=1,GR=!1),GR}var YR,b6;function WP(){if(b6)return YR;b6=1;var t=Bn(),e=Object.defineProperty;return YR=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},YR}var S6;function zP(){if(S6)return $R.exports;S6=1;var t=Wh(),e=Bn(),r=WP(),n="__core-js_shared__",i=$R.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),$R.exports}var qR,C6;function pq(){if(C6)return qR;C6=1;var t=zP();return qR=function(e,r){return t[e]||(t[e]=r||{})},qR}var KR,T6;function f0(){if(T6)return KR;T6=1;var t=my(),e=Object;return KR=function(r){return e(t(r))},KR}var XR,E6;function ha(){if(E6)return XR;E6=1;var t=Vn(),e=f0(),r=t({}.hasOwnProperty);return XR=Object.hasOwn||function(i,s){return r(e(i),s)},XR}var QR,R6;function mq(){if(R6)return QR;R6=1;var t=Vn(),e=0,r=Math.random(),n=t(1.1.toString);return QR=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},QR}var ZR,A6;function Ya(){if(A6)return ZR;A6=1;var t=Bn(),e=pq(),r=ha(),n=mq(),i=VP(),s=dq(),o=t.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||n;return ZR=function(u){return r(a,u)||(a[u]=i&&r(o,u)?o[u]:l("Symbol."+u)),a[u]},ZR}var JR,k6;function STe(){if(k6)return JR;k6=1;var t=Ti(),e=fa(),r=jP(),n=yy(),i=bTe(),s=Ya(),o=TypeError,a=s("toPrimitive");return JR=function(l,u){if(!e(l)||r(l))return l;var h=n(l,a),d;if(h){if(u===void 0&&(u="default"),d=t(h,l,u),!e(d)||r(d))return d;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},JR}var e2,O6;function gq(){if(O6)return e2;O6=1;var t=STe(),e=jP();return e2=function(r){var n=t(r,"string");return e(n)?n:n+""},e2}var t2,_6;function UP(){if(_6)return t2;_6=1;var t=Bn(),e=fa(),r=t.document,n=e(r)&&e(r.createElement);return t2=function(i){return n?r.createElement(i):{}},t2}var r2,M6;function vq(){if(M6)return r2;M6=1;var t=ua(),e=ri(),r=UP();return r2=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),r2}var D6;function yq(){if(D6)return xR;D6=1;var t=ua(),e=Ti(),r=yTe(),n=jS(),i=gy(),s=gq(),o=ha(),a=vq(),l=Object.getOwnPropertyDescriptor;return xR.f=t?l:function(h,d){if(h=i(h),d=s(d),a)try{return l(h,d)}catch{}if(o(h,d))return n(!e(r.f,h,d),h[d])},xR}var n2={},i2,P6;function xq(){if(P6)return i2;P6=1;var t=ua(),e=ri();return i2=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),i2}var s2,I6;function Ei(){if(I6)return s2;I6=1;var t=fa(),e=String,r=TypeError;return s2=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},s2}var N6;function rf(){if(N6)return n2;N6=1;var t=ua(),e=vq(),r=xq(),n=Ei(),i=gq(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",h="writable";return n2.f=t?r?function(m,g,y){if(n(m),g=i(g),n(y),typeof m=="function"&&g==="prototype"&&"value"in y&&h in y&&!y[h]){var x=a(m,g);x&&x[h]&&(m[g]=y.value,y={configurable:u in y?y[u]:x[u],enumerable:l in y?y[l]:x[l],writable:!1})}return o(m,g,y)}:o:function(m,g,y){if(n(m),g=i(g),n(y),e)try{return o(m,g,y)}catch{}if("get"in y||"set"in y)throw new s("Accessors not supported");return"value"in y&&(m[g]=y.value),m},n2}var o2,L6;function h0(){if(L6)return o2;L6=1;var t=ua(),e=rf(),r=jS();return o2=t?function(n,i,s){return e.f(n,i,r(1,s))}:function(n,i,s){return n[i]=s,n},o2}var a2={exports:{}},l2,F6;function CTe(){if(F6)return l2;F6=1;var t=ua(),e=ha(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),s=i&&(function(){}).name==="something",o=i&&(!t||t&&n(r,"name").configurable);return l2={EXISTS:i,PROPER:s,CONFIGURABLE:o},l2}var c2,H6;function TTe(){if(H6)return c2;H6=1;var t=Vn(),e=ni(),r=zP(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),c2=r.inspectSource,c2}var u2,B6;function ETe(){if(B6)return u2;B6=1;var t=Bn(),e=ni(),r=t.WeakMap;return u2=e(r)&&/native code/.test(String(r)),u2}var f2,V6;function $P(){if(V6)return f2;V6=1;var t=pq(),e=mq(),r=t("keys");return f2=function(n){return r[n]||(r[n]=e(n))},f2}var h2,j6;function GP(){return j6||(j6=1,h2={}),h2}var d2,W6;function wq(){if(W6)return d2;W6=1;var t=ETe(),e=Bn(),r=fa(),n=h0(),i=ha(),s=zP(),o=$P(),a=GP(),l="Object already initialized",u=e.TypeError,h=e.WeakMap,d,m,g,y=function(E){return g(E)?m(E):d(E,{})},x=function(E){return function(R){var k;if(!r(R)||(k=m(R)).type!==E)throw new u("Incompatible receiver, "+E+" required");return k}};if(t||s.state){var b=s.state||(s.state=new h);b.get=b.get,b.has=b.has,b.set=b.set,d=function(E,R){if(b.has(E))throw new u(l);return R.facade=E,b.set(E,R),R},m=function(E){return b.get(E)||{}},g=function(E){return b.has(E)}}else{var C=o("state");a[C]=!0,d=function(E,R){if(i(E,C))throw new u(l);return R.facade=E,n(E,C,R),R},m=function(E){return i(E,C)?E[C]:{}},g=function(E){return i(E,C)}}return d2={set:d,get:m,has:g,enforce:y,getterFor:x},d2}var z6;function bq(){if(z6)return a2.exports;z6=1;var t=Vn(),e=ri(),r=ni(),n=ha(),i=ua(),s=CTe().CONFIGURABLE,o=TTe(),a=wq(),l=a.enforce,u=a.get,h=String,d=Object.defineProperty,m=t("".slice),g=t("".replace),y=t([].join),x=i&&!e(function(){return d(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),C=a2.exports=function(E,R,k){m(h(R),0,7)==="Symbol("&&(R="["+g(h(R),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),k&&k.getter&&(R="get "+R),k&&k.setter&&(R="set "+R),(!n(E,"name")||s&&E.name!==R)&&(i?d(E,"name",{value:R,configurable:!0}):E.name=R),x&&k&&n(k,"arity")&&E.length!==k.arity&&d(E,"length",{value:k.arity});try{k&&n(k,"constructor")&&k.constructor?i&&d(E,"prototype",{writable:!1}):E.prototype&&(E.prototype=void 0)}catch{}var O=l(E);return n(O,"source")||(O.source=y(b,typeof R=="string"?R:"")),E};return Function.prototype.toString=C(function(){return r(this)&&u(this).source||o(this)},"toString"),a2.exports}var p2,U6;function YP(){if(U6)return p2;U6=1;var t=ni(),e=rf(),r=bq(),n=WP();return p2=function(i,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(t(o)&&r(o,u,a),a.global)l?i[s]=o:n(s,o);else{try{a.unsafe?i[s]&&(l=!0):delete i[s]}catch{}l?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},p2}var m2={},g2,$6;function RTe(){if($6)return g2;$6=1;var t=Math.ceil,e=Math.floor;return g2=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},g2}var v2,G6;function xy(){if(G6)return v2;G6=1;var t=RTe();return v2=function(e){var r=+e;return r!==r||r===0?0:t(r)},v2}var y2,Y6;function ATe(){if(Y6)return y2;Y6=1;var t=xy(),e=Math.max,r=Math.min;return y2=function(n,i){var s=t(n);return s<0?e(s+i,0):r(s,i)},y2}var x2,q6;function kTe(){if(q6)return x2;q6=1;var t=xy(),e=Math.min;return x2=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},x2}var w2,K6;function d0(){if(K6)return w2;K6=1;var t=kTe();return w2=function(e){return t(e.length)},w2}var b2,X6;function OTe(){if(X6)return b2;X6=1;var t=gy(),e=ATe(),r=d0(),n=function(i){return function(s,o,a){var l=t(s),u=r(l);if(u===0)return!i&&-1;var h=e(a,u),d;if(i&&o!==o){for(;u>h;)if(d=l[h++],d!==d)return!0}else for(;u>h;h++)if((i||h in l)&&l[h]===o)return i||h||0;return!i&&-1}};return b2={includes:n(!0),indexOf:n(!1)},b2}var S2,Q6;function Sq(){if(Q6)return S2;Q6=1;var t=Vn(),e=ha(),r=gy(),n=OTe().indexOf,i=GP(),s=t([].push);return S2=function(o,a){var l=r(o),u=0,h=[],d;for(d in l)!e(i,d)&&e(l,d)&&s(h,d);for(;a.length>u;)e(l,d=a[u++])&&(~n(h,d)||s(h,d));return h},S2}var C2,Z6;function qP(){return Z6||(Z6=1,C2=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),C2}var J6;function _Te(){if(J6)return m2;J6=1;var t=Sq(),e=qP(),r=e.concat("length","prototype");return m2.f=Object.getOwnPropertyNames||function(i){return t(i,r)},m2}var T2={},e8;function MTe(){return e8||(e8=1,T2.f=Object.getOwnPropertySymbols),T2}var E2,t8;function DTe(){if(t8)return E2;t8=1;var t=u0(),e=Vn(),r=_Te(),n=MTe(),i=Ei(),s=e([].concat);return E2=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?s(l,u(a)):l},E2}var R2,r8;function Cq(){if(r8)return R2;r8=1;var t=ha(),e=DTe(),r=yq(),n=rf();return R2=function(i,s,o){for(var a=e(s),l=n.f,u=r.f,h=0;h<a.length;h++){var d=a[h];!t(i,d)&&!(o&&t(o,d))&&l(i,d,u(s,d))}},R2}var A2,n8;function PTe(){if(n8)return A2;n8=1;var t=ri(),e=ni(),r=/#|\.prototype\./,n=function(l,u){var h=s[i(l)];return h===a?!0:h===o?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},s=n.data={},o=n.NATIVE="N",a=n.POLYFILL="P";return A2=n,A2}var k2,i8;function Yr(){if(i8)return k2;i8=1;var t=Bn(),e=yq().f,r=h0(),n=YP(),i=WP(),s=Cq(),o=PTe();return k2=function(a,l){var u=a.target,h=a.global,d=a.stat,m,g,y,x,b,C;if(h?g=t:d?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(y in l){if(b=l[y],a.dontCallGetSet?(C=e(g,y),x=C&&C.value):x=g[y],m=o(h?y:u+(d?".":"#")+y,a.forced),!m&&x!==void 0){if(typeof b==typeof x)continue;s(b,x)}(a.sham||x&&x.sham)&&r(b,"sham",!0),n(g,y,b,a)}},k2}var O2,s8;function wy(){if(s8)return O2;s8=1;var t=VS(),e=Function.prototype,r=e.apply,n=e.call;return O2=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),O2}var _2,o8;function Tq(){if(o8)return _2;o8=1;var t=Vn(),e=xo();return _2=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},_2}var M2,a8;function ITe(){if(a8)return M2;a8=1;var t=fa();return M2=function(e){return t(e)||e===null},M2}var D2,l8;function NTe(){if(l8)return D2;l8=1;var t=ITe(),e=String,r=TypeError;return D2=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},D2}var P2,c8;function Eq(){if(c8)return P2;c8=1;var t=Tq(),e=fa(),r=my(),n=NTe();return P2=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,s={},o;try{o=t(Object.prototype,"__proto__","set"),o(s,[]),i=s instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?o(l,u):l.__proto__=u),l}}():void 0),P2}var I2,u8;function LTe(){if(u8)return I2;u8=1;var t=rf().f;return I2=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},I2}var N2,f8;function FTe(){if(f8)return N2;f8=1;var t=ni(),e=fa(),r=Eq();return N2=function(n,i,s){var o,a;return r&&t(o=i.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&r(n,a),n},N2}var L2,h8;function HTe(){if(h8)return L2;h8=1;var t=Ya(),e=t("toStringTag"),r={};return r[e]="z",L2=String(r)==="[object z]",L2}var F2,d8;function Rq(){if(d8)return F2;d8=1;var t=HTe(),e=ni(),r=jh(),n=Ya(),i=n("toStringTag"),s=Object,o=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return F2=t?r:function(l){var u,h,d;return l===void 0?"Undefined":l===null?"Null":typeof(h=a(u=s(l),i))=="string"?h:o?r(u):(d=r(u))==="Object"&&e(u.callee)?"Arguments":d},F2}var H2,p8;function US(){if(p8)return H2;p8=1;var t=Rq(),e=String;return H2=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},H2}var B2,m8;function BTe(){if(m8)return B2;m8=1;var t=US();return B2=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},B2}var V2,g8;function VTe(){if(g8)return V2;g8=1;var t=fa(),e=h0();return V2=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},V2}var j2,v8;function jTe(){if(v8)return j2;v8=1;var t=Vn(),e=Error,r=t("".replace),n=function(o){return String(new e(o).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(n);return j2=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=r(o,i,"");return o},j2}var W2,y8;function WTe(){if(y8)return W2;y8=1;var t=ri(),e=jS();return W2=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),W2}var z2,x8;function zTe(){if(x8)return z2;x8=1;var t=h0(),e=jTe(),r=WTe(),n=Error.captureStackTrace;return z2=function(i,s,o,a){r&&(n?n(i,s):t(i,"stack",e(o,a)))},z2}var U2,w8;function UTe(){if(w8)return U2;w8=1;var t=u0(),e=ha(),r=h0(),n=vy(),i=Eq(),s=Cq(),o=LTe(),a=FTe(),l=BTe(),u=VTe(),h=zTe(),d=ua(),m=Wh();return U2=function(g,y,x,b){var C="stackTraceLimit",E=b?2:1,R=g.split("."),k=R[R.length-1],O=t.apply(null,R);if(O){var P=O.prototype;if(!m&&e(P,"cause")&&delete P.cause,!x)return O;var D=t("Error"),H=y(function(N,_){var B=l(b?_:N,void 0),j=b?new O(N):new O;return B!==void 0&&r(j,"message",B),h(j,H,j.stack,2),this&&n(P,this)&&a(j,this,H),arguments.length>E&&u(j,arguments[E]),j});if(H.prototype=P,k!=="Error"?i?i(H,D):s(H,D,{name:!0}):d&&C in O&&(o(H,O,C),o(H,O,"prepareStackTrace")),s(H,O),!m)try{P.name!==k&&r(P,"name",k),P.constructor=H}catch{}return H}},U2}var b8;function $Te(){if(b8)return Y5;b8=1;var t=Yr(),e=Bn(),r=wy(),n=UTe(),i="WebAssembly",s=e[i],o=new Error("e",{cause:7}).cause!==7,a=function(u,h){var d={};d[u]=n(u,h,o),t({global:!0,constructor:!0,arity:1,forced:o},d)},l=function(u,h){if(s&&s[u]){var d={};d[u]=n(i+"."+u,h,o),t({target:i,stat:!0,constructor:!0,arity:1,forced:o},d)}};return a("Error",function(u){return function(d){return r(u,this,arguments)}}),a("EvalError",function(u){return function(d){return r(u,this,arguments)}}),a("RangeError",function(u){return function(d){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(d){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(d){return r(u,this,arguments)}}),a("TypeError",function(u){return function(d){return r(u,this,arguments)}}),a("URIError",function(u){return function(d){return r(u,this,arguments)}}),l("CompileError",function(u){return function(d){return r(u,this,arguments)}}),l("LinkError",function(u){return function(d){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(d){return r(u,this,arguments)}}),Y5}$Te();var S8={},$2,C8;function Aq(){if(C8)return $2;C8=1;var t=jh();return $2=Array.isArray||function(r){return t(r)==="Array"},$2}var G2,T8;function kq(){if(T8)return G2;T8=1;var t=ua(),e=Aq(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return G2=i?function(s,o){if(e(s)&&!n(s,"length").writable)throw new r("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},G2}var Y2,E8;function Oq(){if(E8)return Y2;E8=1;var t=TypeError,e=9007199254740991;return Y2=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Y2}var R8;function GTe(){if(R8)return S8;R8=1;var t=Yr(),e=f0(),r=d0(),n=kq(),i=Oq(),s=ri(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(h){var d=e(this),m=r(d),g=arguments.length;i(m+g);for(var y=0;y<g;y++)d[m]=arguments[y],m++;return n(d,m),m}}),S8}GTe();var A8={},q2,k8;function YTe(){if(k8)return q2;k8=1;var t=jh(),e=Vn();return q2=function(r){if(t(r)==="Function")return e(r)},q2}var K2,O8;function _q(){if(O8)return K2;O8=1;var t=YTe(),e=xo(),r=VS(),n=t(t.bind);return K2=function(i,s){return e(i),s===void 0?i:r?n(i,s):function(){return i.apply(s,arguments)}},K2}var X2,_8;function Mq(){return _8||(_8=1,X2={}),X2}var Q2,M8;function qTe(){if(M8)return Q2;M8=1;var t=Ya(),e=Mq(),r=t("iterator"),n=Array.prototype;return Q2=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Q2}var Z2,D8;function Dq(){if(D8)return Z2;D8=1;var t=Rq(),e=yy(),r=BP(),n=Mq(),i=Ya(),s=i("iterator");return Z2=function(o){if(!r(o))return e(o,s)||e(o,"@@iterator")||n[t(o)]},Z2}var J2,P8;function KTe(){if(P8)return J2;P8=1;var t=Ti(),e=xo(),r=Ei(),n=zS(),i=Dq(),s=TypeError;return J2=function(o,a){var l=arguments.length<2?i(o):a;if(e(l))return r(t(l,o));throw new s(n(o)+" is not iterable")},J2}var eA,I8;function wo(){if(I8)return eA;I8=1;var t=Ti(),e=Ei(),r=yy();return eA=function(n,i,s){var o,a;e(n);try{if(o=r(n,"return"),!o){if(i==="throw")throw s;return s}o=t(o,n)}catch(l){a=!0,o=l}if(i==="throw")throw s;if(a)throw o;return e(o),s},eA}var tA,N8;function p0(){if(N8)return tA;N8=1;var t=_q(),e=Ti(),r=Ei(),n=zS(),i=qTe(),s=d0(),o=vy(),a=KTe(),l=Dq(),u=wo(),h=TypeError,d=function(g,y){this.stopped=g,this.result=y},m=d.prototype;return tA=function(g,y,x){var b=x&&x.that,C=!!(x&&x.AS_ENTRIES),E=!!(x&&x.IS_RECORD),R=!!(x&&x.IS_ITERATOR),k=!!(x&&x.INTERRUPTED),O=t(y,b),P,D,H,N,_,B,j,ee=function(re){return P&&u(P,"normal"),new d(!0,re)},oe=function(re){return C?(r(re),k?O(re[0],re[1],ee):O(re[0],re[1])):k?O(re,ee):O(re)};if(E)P=g.iterator;else if(R)P=g;else{if(D=l(g),!D)throw new h(n(g)+" is not iterable");if(i(D)){for(H=0,N=s(g);N>H;H++)if(_=oe(g[H]),_&&o(m,_))return _;return new d(!1)}P=a(g,D)}for(B=E?g.next:P.next;!(j=e(B,P)).done;){try{_=oe(j.value)}catch(re){u(P,"throw",re)}if(typeof _=="object"&&_&&o(m,_))return _}return new d(!1)},tA}var rA,L8;function Pq(){if(L8)return rA;L8=1;var t=ua(),e=rf(),r=jS();return rA=function(n,i,s){t?e.f(n,i,r(0,s)):n[i]=s},rA}var F8;function XTe(){if(F8)return A8;F8=1;var t=Yr(),e=p0(),r=Pq();return t({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(o,a){r(s,o,a)},{AS_ENTRIES:!0}),s}}),A8}XTe();var H8={},nA,B8;function jl(){if(B8)return nA;B8=1;var t=Vn(),e=Set.prototype;return nA={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},nA}var iA,V8;function zh(){if(V8)return iA;V8=1;var t=jl().has;return iA=function(e){return t(e),e},iA}var sA,j8;function Uh(){if(j8)return sA;j8=1;var t=Ti();return sA=function(e,r,n){for(var i=n?e:e.iterator,s=e.next,o,a;!(o=t(s,i)).done;)if(a=r(o.value),a!==void 0)return a},sA}var oA,W8;function by(){if(W8)return oA;W8=1;var t=Vn(),e=Uh(),r=jl(),n=r.Set,i=r.proto,s=t(i.forEach),o=t(i.keys),a=o(new n).next;return oA=function(l,u,h){return h?e({iterator:o(l),next:a},u):s(l,u)},oA}var aA,z8;function KP(){if(z8)return aA;z8=1;var t=jl(),e=by(),r=t.Set,n=t.add;return aA=function(i){var s=new r;return e(i,function(o){n(s,o)}),s},aA}var lA,U8;function Sy(){if(U8)return lA;U8=1;var t=Tq(),e=jl();return lA=t(e.proto,"size","get")||function(r){return r.size},lA}var cA,$8;function nf(){return $8||($8=1,cA=function(t){return{iterator:t,next:t.next,done:!1}}),cA}var uA,G8;function $h(){if(G8)return uA;G8=1;var t=xo(),e=Ei(),r=Ti(),n=xy(),i=nf(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(h,d){this.set=h,this.size=l(d,0),this.has=t(h.has),this.keys=t(h.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(h){return r(this.has,this.set,h)}},uA=function(h){e(h);var d=+h.size;if(d!==d)throw new a(s);var m=n(d);if(m<0)throw new o(s);return new u(h,m)},uA}var fA,Y8;function QTe(){if(Y8)return fA;Y8=1;var t=zh(),e=jl(),r=KP(),n=Sy(),i=$h(),s=by(),o=Uh(),a=e.has,l=e.remove;return fA=function(h){var d=t(this),m=i(h),g=r(d);return n(d)<=m.size?s(d,function(y){m.includes(y)&&l(g,y)}):o(m.getIterator(),function(y){a(g,y)&&l(g,y)}),g},fA}var hA,q8;function Gh(){if(q8)return hA;q8=1;var t=u0(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return hA=function(n,i){var s=t("Set");try{new s()[n](e(0));try{return new s()[n](e(-1)),!1}catch{if(!i)return!0;try{return new s()[n](r(-1/0)),!1}catch{var o=new s;return o.add(1),o.add(2),i(o[n](r(1/0)))}}}catch{return!1}},hA}var K8;function ZTe(){if(K8)return H8;K8=1;var t=Yr(),e=QTe(),r=ri(),n=Gh(),i=!n("difference",function(o){return o.size===0}),s=i||r(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return t({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),H8}ZTe();var X8={},dA,Q8;function JTe(){if(Q8)return dA;Q8=1;var t=zh(),e=jl(),r=Sy(),n=$h(),i=by(),s=Uh(),o=e.Set,a=e.add,l=e.has;return dA=function(h){var d=t(this),m=n(h),g=new o;return r(d)>m.size?s(m.getIterator(),function(y){l(d,y)&&a(g,y)}):i(d,function(y){m.includes(y)&&a(g,y)}),g},dA}var Z8;function eEe(){if(Z8)return X8;Z8=1;var t=Yr(),e=ri(),r=JTe(),n=Gh(),i=!n("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),X8}eEe();var J8={},pA,eV;function tEe(){if(eV)return pA;eV=1;var t=zh(),e=jl().has,r=Sy(),n=$h(),i=by(),s=Uh(),o=wo();return pA=function(l){var u=t(this),h=n(l);if(r(u)<=h.size)return i(u,function(m){if(h.includes(m))return!1},!0)!==!1;var d=h.getIterator();return s(d,function(m){if(e(u,m))return o(d,"normal",!1)})!==!1},pA}var tV;function rEe(){if(tV)return J8;tV=1;var t=Yr(),e=tEe(),r=Gh(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),J8}rEe();var rV={},mA,nV;function nEe(){if(nV)return mA;nV=1;var t=zh(),e=Sy(),r=by(),n=$h();return mA=function(s){var o=t(this),a=n(s);return e(o)>a.size?!1:r(o,function(l){if(!a.includes(l))return!1},!0)!==!1},mA}var iV;function iEe(){if(iV)return rV;iV=1;var t=Yr(),e=nEe(),r=Gh(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),rV}iEe();var sV={},gA,oV;function sEe(){if(oV)return gA;oV=1;var t=zh(),e=jl().has,r=Sy(),n=$h(),i=Uh(),s=wo();return gA=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var h=u.getIterator();return i(h,function(d){if(!e(l,d))return s(h,"normal",!1)})!==!1},gA}var aV;function oEe(){if(aV)return sV;aV=1;var t=Yr(),e=sEe(),r=Gh(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),sV}oEe();var lV={},vA,cV;function aEe(){if(cV)return vA;cV=1;var t=zh(),e=jl(),r=KP(),n=$h(),i=Uh(),s=e.add,o=e.has,a=e.remove;return vA=function(u){var h=t(this),d=n(u).getIterator(),m=r(h);return i(d,function(g){o(h,g)?a(m,g):s(m,g)}),m},vA}var yA,uV;function Iq(){return uV||(uV=1,yA=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),yA}var fV;function lEe(){if(fV)return lV;fV=1;var t=Yr(),e=aEe(),r=Iq(),n=Gh(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),lV}lEe();var hV={},xA,dV;function cEe(){if(dV)return xA;dV=1;var t=zh(),e=jl().add,r=KP(),n=$h(),i=Uh();return xA=function(o){var a=t(this),l=n(o).getIterator(),u=r(a);return i(l,function(h){e(u,h)}),u},xA}var pV;function uEe(){if(pV)return hV;pV=1;var t=Yr(),e=cEe(),r=Iq(),n=Gh(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),hV}uEe();var mV={},gV={},wA,vV;function fEe(){if(vV)return wA;vV=1;var t=vy(),e=TypeError;return wA=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},wA}var bA,yV;function hEe(){if(yV)return bA;yV=1;var t=ri();return bA=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),bA}var SA,xV;function Nq(){if(xV)return SA;xV=1;var t=ha(),e=ni(),r=f0(),n=$P(),i=hEe(),s=n("IE_PROTO"),o=Object,a=o.prototype;return SA=i?o.getPrototypeOf:function(l){var u=r(l);if(t(u,s))return u[s];var h=u.constructor;return e(h)&&u instanceof h?h.prototype:u instanceof o?a:null},SA}var CA,wV;function dEe(){if(wV)return CA;wV=1;var t=bq(),e=rf();return CA=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},CA}var TA={},EA,bV;function pEe(){if(bV)return EA;bV=1;var t=Sq(),e=qP();return EA=Object.keys||function(n){return t(n,e)},EA}var SV;function mEe(){if(SV)return TA;SV=1;var t=ua(),e=xq(),r=rf(),n=Ei(),i=gy(),s=pEe();return TA.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),h=s(l),d=h.length,m=0,g;d>m;)r.f(a,g=h[m++],u[g]);return a},TA}var RA,CV;function Lq(){if(CV)return RA;CV=1;var t=u0();return RA=t("document","documentElement"),RA}var AA,TV;function XP(){if(TV)return AA;TV=1;var t=Ei(),e=mEe(),r=qP(),n=GP(),i=Lq(),s=UP(),o=$P(),a=">",l="<",u="prototype",h="script",d=o("IE_PROTO"),m=function(){},g=function(E){return l+h+a+E+l+"/"+h+a},y=function(E){E.write(g("")),E.close();var R=E.parentWindow.Object;return E=null,R},x=function(){var E=s("iframe"),R="java"+h+":",k;return E.style.display="none",i.appendChild(E),E.src=String(R),k=E.contentWindow.document,k.open(),k.write(g("document.F=Object")),k.close(),k.F},b,C=function(){try{b=new ActiveXObject("htmlfile")}catch{}C=typeof document<"u"?document.domain&&b?y(b):x():y(b);for(var E=r.length;E--;)delete C[u][r[E]];return C()};return n[d]=!0,AA=Object.create||function(R,k){var O;return R!==null?(m[u]=t(R),O=new m,m[u]=null,O[d]=R):O=C(),k===void 0?O:e.f(O,k)},AA}var kA,EV;function Fq(){if(EV)return kA;EV=1;var t=ri(),e=ni(),r=fa(),n=XP(),i=Nq(),s=YP(),o=Ya(),a=Wh(),l=o("iterator"),u=!1,h,d,m;[].keys&&(m=[].keys(),"next"in m?(d=i(i(m)),d!==Object.prototype&&(h=d)):u=!0);var g=!r(h)||t(function(){var y={};return h[l].call(y)!==y});return g?h={}:a&&(h=n(h)),e(h[l])||s(h,l,function(){return this}),kA={IteratorPrototype:h,BUGGY_SAFARI_ITERATORS:u},kA}var RV;function gEe(){if(RV)return gV;RV=1;var t=Yr(),e=Bn(),r=fEe(),n=Ei(),i=ni(),s=Nq(),o=dEe(),a=Pq(),l=ri(),u=ha(),h=Ya(),d=Fq().IteratorPrototype,m=ua(),g=Wh(),y="constructor",x="Iterator",b=h("toStringTag"),C=TypeError,E=e[x],R=g||!i(E)||E.prototype!==d||!l(function(){E({})}),k=function(){if(r(this,d),s(this)===d)throw new C("Abstract class Iterator not directly constructable")},O=function(P,D){m?o(d,P,{configurable:!0,get:function(){return D},set:function(H){if(n(this),this===d)throw new C("You can't redefine this property");u(this,P)?this[P]=H:a(this,P,H)}}):d[P]=D};return u(d,b)||O(b,x),(R||!u(d,y)||d[y]===Object)&&O(y,k),k.prototype=d,t({global:!0,constructor:!0,forced:R},{Iterator:k}),gV}var AV;function vEe(){return AV||(AV=1,gEe()),mV}vEe();var kV={},OV={},OA,_V;function yEe(){if(_V)return OA;_V=1;var t=YP();return OA=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},OA}var _A,MV;function xEe(){return MV||(MV=1,_A=function(t,e){return{value:t,done:e}}),_A}var MA,DV;function wEe(){if(DV)return MA;DV=1;var t=wo();return MA=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(s){r="throw",n=s}if(r==="throw")throw n;return n},MA}var DA,PV;function Hq(){if(PV)return DA;PV=1;var t=Ti(),e=XP(),r=h0(),n=yEe(),i=Ya(),s=wq(),o=yy(),a=Fq().IteratorPrototype,l=xEe(),u=wo(),h=wEe(),d=i("toStringTag"),m="IteratorHelper",g="WrapForValidIterator",y="normal",x="throw",b=s.set,C=function(k){var O=s.getterFor(k?g:m);return n(e(a),{next:function(){var D=O(this);if(k)return D.nextHandler();if(D.done)return l(void 0,!0);try{var H=D.nextHandler();return D.returnHandlerResult?H:l(H,D.done)}catch(N){throw D.done=!0,N}},return:function(){var P=O(this),D=P.iterator;if(P.done=!0,k){var H=o(D,"return");return H?t(H,D):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,y)}catch(N){return u(D,x,N)}if(P.openIters)try{h(P.openIters,y)}catch(N){return u(D,x,N)}return D&&u(D,y),l(void 0,!0)}})},E=C(!0),R=C(!1);return r(R,d,"Iterator Helper"),DA=function(k,O,P){var D=function(N,_){_?(_.iterator=N.iterator,_.next=N.next):_=N,_.type=O?g:m,_.returnHandlerResult=!!P,_.nextHandler=k,_.counter=0,_.done=!1,b(this,_)};return D.prototype=O?E:R,D},DA}var PA,IV;function Bq(){if(IV)return PA;IV=1;var t=Ei(),e=wo();return PA=function(r,n,i,s){try{return s?n(t(i)[0],i[1]):n(i)}catch(o){e(r,"throw",o)}},PA}var IA,NV;function Vq(){return NV||(NV=1,IA=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),IA}var NA,LV;function Yh(){if(LV)return NA;LV=1;var t=Bn();return NA=function(e,r){var n=t.Iterator,i=n&&n.prototype,s=i&&i[e],o=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(a){a instanceof r||(o=!1)}if(!o)return s},NA}var FV;function bEe(){if(FV)return OV;FV=1;var t=Yr(),e=Ti(),r=xo(),n=Ei(),i=nf(),s=Hq(),o=Bq(),a=Wh(),l=wo(),u=Vq(),h=Yh(),d=!a&&!u("filter",function(){}),m=!a&&!d&&h("filter",TypeError),g=a||d||m,y=s(function(){for(var x=this.iterator,b=this.predicate,C=this.next,E,R,k;;){if(E=n(e(C,x)),R=this.done=!!E.done,R)return;if(k=E.value,o(x,b,[k,this.counter++],!0))return k}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(C){l(this,"throw",C)}return m?e(m,this,b):new y(i(this),{predicate:b})}}),OV}var HV;function SEe(){return HV||(HV=1,bEe()),kV}SEe();var BV={},VV={},jV;function CEe(){if(jV)return VV;jV=1;var t=Yr(),e=Ti(),r=p0(),n=xo(),i=Ei(),s=nf(),o=wo(),a=Yh(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(h){i(this);try{n(h)}catch(g){o(this,"throw",g)}if(l)return e(l,this,h);var d=s(this),m=0;r(d,function(g){h(g,m++)},{IS_RECORD:!0})}}),VV}var WV;function TEe(){return WV||(WV=1,CEe()),BV}TEe();var zV={},UV={},$V;function EEe(){if($V)return UV;$V=1;var t=Yr(),e=Ti(),r=xo(),n=Ei(),i=nf(),s=Hq(),o=Bq(),a=wo(),l=Vq(),u=Yh(),h=Wh(),d=!h&&!l("map",function(){}),m=!h&&!d&&u("map",TypeError),g=h||d||m,y=s(function(){var x=this.iterator,b=n(e(this.next,x)),C=this.done=!!b.done;if(!C)return o(x,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(C){a(this,"throw",C)}return m?e(m,this,b):new y(i(this),{mapper:b})}}),UV}var GV;function REe(){return GV||(GV=1,EEe()),zV}REe();var YV={},qV={},LA,KV;function QP(){if(KV)return LA;KV=1;var t=Vn();return LA=t([].slice),LA}var FA,XV;function jq(){if(XV)return FA;XV=1;var t=TypeError;return FA=function(e,r){if(e<r)throw new t("Not enough arguments");return e},FA}var HA,QV;function AEe(){if(QV)return HA;QV=1;var t=WS();return HA=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),HA}var BA,ZV;function Wq(){if(ZV)return BA;ZV=1;var t=Bn(),e=WS(),r=jh(),n=function(i){return e.slice(0,i.length)===i};return BA=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),BA}var VA,JV;function kEe(){if(JV)return VA;JV=1;var t=Wq();return VA=t==="NODE",VA}var jA,e9;function zq(){if(e9)return jA;e9=1;var t=Bn(),e=wy(),r=_q(),n=ni(),i=ha(),s=ri(),o=Lq(),a=QP(),l=UP(),u=jq(),h=AEe(),d=kEe(),m=t.setImmediate,g=t.clearImmediate,y=t.process,x=t.Dispatch,b=t.Function,C=t.MessageChannel,E=t.String,R=0,k={},O="onreadystatechange",P,D,H,N;s(function(){P=t.location});var _=function(oe){if(i(k,oe)){var re=k[oe];delete k[oe],re()}},B=function(oe){return function(){_(oe)}},j=function(oe){_(oe.data)},ee=function(oe){t.postMessage(E(oe),P.protocol+"//"+P.host)};return(!m||!g)&&(m=function(re){u(arguments.length,1);var q=n(re)?re:b(re),Z=a(arguments,1);return k[++R]=function(){e(q,void 0,Z)},D(R),R},g=function(re){delete k[re]},d?D=function(oe){y.nextTick(B(oe))}:x&&x.now?D=function(oe){x.now(B(oe))}:C&&!h?(H=new C,N=H.port2,H.port1.onmessage=j,D=r(N.postMessage,N)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!s(ee)?(D=ee,t.addEventListener("message",j,!1)):O in l("script")?D=function(oe){o.appendChild(l("script"))[O]=function(){o.removeChild(this),_(oe)}}:D=function(oe){setTimeout(B(oe),0)}),jA={set:m,clear:g},jA}var t9;function OEe(){if(t9)return qV;t9=1;var t=Yr(),e=Bn(),r=zq().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),qV}var r9={},WA,n9;function _Ee(){if(n9)return WA;n9=1;var t=Bn(),e=wy(),r=ni(),n=Wq(),i=WS(),s=QP(),o=jq(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return WA=function(u,h){var d=h?2:1;return l?function(m,g){var y=o(arguments.length,1)>d,x=r(m)?m:a(m),b=y?s(arguments,d):[],C=y?function(){e(x,this,b)}:x;return h?u(C,g):u(C)}:u},WA}var i9;function MEe(){if(i9)return r9;i9=1;var t=Yr(),e=Bn(),r=zq().set,n=_Ee(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),r9}var s9;function DEe(){return s9||(s9=1,OEe(),MEe()),YV}DEe();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Uq,setPrototypeOf:o9,isFrozen:PEe,getPrototypeOf:IEe,getOwnPropertyDescriptor:NEe}=Object;let{freeze:bs,seal:oa,create:$q}=Object,{apply:b_,construct:S_}=typeof Reflect<"u"&&Reflect;bs||(bs=function(e){return e});oa||(oa=function(e){return e});b_||(b_=function(e,r,n){return e.apply(r,n)});S_||(S_=function(e,r){return new e(...r)});const C1=Ss(Array.prototype.forEach),LEe=Ss(Array.prototype.lastIndexOf),a9=Ss(Array.prototype.pop),Rm=Ss(Array.prototype.push),FEe=Ss(Array.prototype.splice),Bw=Ss(String.prototype.toLowerCase),zA=Ss(String.prototype.toString),l9=Ss(String.prototype.match),Am=Ss(String.prototype.replace),HEe=Ss(String.prototype.indexOf),BEe=Ss(String.prototype.trim),Ma=Ss(Object.prototype.hasOwnProperty),us=Ss(RegExp.prototype.test),km=VEe(TypeError);function Ss(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return b_(t,e,n)}}function VEe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return S_(t,r)}}function qt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Bw;o9&&o9(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=r(i);s!==i&&(PEe(e)||(e[n]=s),i=s)}t[i]=!0}return t}function jEe(t){for(let e=0;e<t.length;e++)Ma(t,e)||(t[e]=null);return t}function gc(t){const e=$q(null);for(const[r,n]of Uq(t))Ma(t,r)&&(Array.isArray(n)?e[r]=jEe(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=gc(n):e[r]=n);return e}function Om(t,e){for(;t!==null;){const n=NEe(t,e);if(n){if(n.get)return Ss(n.get);if(typeof n.value=="function")return Ss(n.value)}t=IEe(t)}function r(){return null}return r}const c9=bs(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),UA=bs(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$A=bs(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),WEe=bs(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),GA=bs(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),zEe=bs(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),u9=bs(["#text"]),f9=bs(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),YA=bs(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),h9=bs(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),T1=bs(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),UEe=oa(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$Ee=oa(/<%[\w\W]*|[\w\W]*%>/gm),GEe=oa(/\$\{[\w\W]*/gm),YEe=oa(/^data-[\-\w.\u00B7-\uFFFF]+$/),qEe=oa(/^aria-[\-\w]+$/),Gq=oa(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),KEe=oa(/^(?:\w+script|data):/i),XEe=oa(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Yq=oa(/^html$/i),QEe=oa(/^[a-z][.\w]*(-[.\w]+)+$/i);var d9=Object.freeze({__proto__:null,ARIA_ATTR:qEe,ATTR_WHITESPACE:XEe,CUSTOM_ELEMENT:QEe,DATA_ATTR:YEe,DOCTYPE_NAME:Yq,ERB_EXPR:$Ee,IS_ALLOWED_URI:Gq,IS_SCRIPT_OR_DATA:KEe,MUSTACHE_EXPR:UEe,TMPLIT_EXPR:GEe});const _m={element:1,text:3,progressingInstruction:7,comment:8,document:9},ZEe=function(){return typeof window>"u"?null:window},JEe=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},p9=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function qq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ZEe();const e=fe=>qq(fe);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==_m.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:h=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:m,trustedTypes:g}=t,y=l.prototype,x=Om(y,"cloneNode"),b=Om(y,"remove"),C=Om(y,"nextSibling"),E=Om(y,"childNodes"),R=Om(y,"parentNode");if(typeof o=="function"){const fe=r.createElement("template");fe.content&&fe.content.ownerDocument&&(r=fe.content.ownerDocument)}let k,O="";const{implementation:P,createNodeIterator:D,createDocumentFragment:H,getElementsByTagName:N}=r,{importNode:_}=n;let B=p9();e.isSupported=typeof Uq=="function"&&typeof R=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:j,ERB_EXPR:ee,TMPLIT_EXPR:oe,DATA_ATTR:re,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:Z,ATTR_WHITESPACE:ve,CUSTOM_ELEMENT:ie}=d9;let{IS_ALLOWED_URI:K}=d9,ce=null;const S=qt({},[...c9,...UA,...$A,...GA,...u9]);let A=null;const M=qt({},[...f9,...YA,...h9,...T1]);let L=Object.seal($q(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),V=null,J=null,ae=!0,ue=!0,pe=!1,ke=!0,z=!1,Be=!0,Fe=!1,ze=!1,Ge=!1,Ee=!1,Ue=!1,st=!1,tt=!0,at=!1;const je="user-content-";let er=!0,Nt=!1,jt={},Dt=null;const Et=qt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ct=null;const Rt=qt({},["audio","video","img","source","image","track"]);let Xe=null;const Je=qt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Lt="http://www.w3.org/1998/Math/MathML",nt="http://www.w3.org/2000/svg",ct="http://www.w3.org/1999/xhtml";let ar=ct,vn=!1,Br=null;const qr=qt({},[Lt,nt,ct],zA);let Wn=qt({},["mi","mo","mn","ms","mtext"]),Ai=qt({},["annotation-xml"]);const ga=qt({},["title","style","font","a","script"]);let ii=null;const So=["application/xhtml+xml","text/html"],Xa="text/html";let Or=null,zi=null;const yt=r.createElement("form"),On=function(G){return G instanceof RegExp||G instanceof Function},We=function(){let G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(zi&&zi===G)){if((!G||typeof G!="object")&&(G={}),G=gc(G),ii=So.indexOf(G.PARSER_MEDIA_TYPE)===-1?Xa:G.PARSER_MEDIA_TYPE,Or=ii==="application/xhtml+xml"?zA:Bw,ce=Ma(G,"ALLOWED_TAGS")?qt({},G.ALLOWED_TAGS,Or):S,A=Ma(G,"ALLOWED_ATTR")?qt({},G.ALLOWED_ATTR,Or):M,Br=Ma(G,"ALLOWED_NAMESPACES")?qt({},G.ALLOWED_NAMESPACES,zA):qr,Xe=Ma(G,"ADD_URI_SAFE_ATTR")?qt(gc(Je),G.ADD_URI_SAFE_ATTR,Or):Je,Ct=Ma(G,"ADD_DATA_URI_TAGS")?qt(gc(Rt),G.ADD_DATA_URI_TAGS,Or):Rt,Dt=Ma(G,"FORBID_CONTENTS")?qt({},G.FORBID_CONTENTS,Or):Et,V=Ma(G,"FORBID_TAGS")?qt({},G.FORBID_TAGS,Or):gc({}),J=Ma(G,"FORBID_ATTR")?qt({},G.FORBID_ATTR,Or):gc({}),jt=Ma(G,"USE_PROFILES")?G.USE_PROFILES:!1,ae=G.ALLOW_ARIA_ATTR!==!1,ue=G.ALLOW_DATA_ATTR!==!1,pe=G.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=G.ALLOW_SELF_CLOSE_IN_ATTR!==!1,z=G.SAFE_FOR_TEMPLATES||!1,Be=G.SAFE_FOR_XML!==!1,Fe=G.WHOLE_DOCUMENT||!1,Ee=G.RETURN_DOM||!1,Ue=G.RETURN_DOM_FRAGMENT||!1,st=G.RETURN_TRUSTED_TYPE||!1,Ge=G.FORCE_BODY||!1,tt=G.SANITIZE_DOM!==!1,at=G.SANITIZE_NAMED_PROPS||!1,er=G.KEEP_CONTENT!==!1,Nt=G.IN_PLACE||!1,K=G.ALLOWED_URI_REGEXP||Gq,ar=G.NAMESPACE||ct,Wn=G.MATHML_TEXT_INTEGRATION_POINTS||Wn,Ai=G.HTML_INTEGRATION_POINTS||Ai,L=G.CUSTOM_ELEMENT_HANDLING||{},G.CUSTOM_ELEMENT_HANDLING&&On(G.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(L.tagNameCheck=G.CUSTOM_ELEMENT_HANDLING.tagNameCheck),G.CUSTOM_ELEMENT_HANDLING&&On(G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(L.attributeNameCheck=G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),G.CUSTOM_ELEMENT_HANDLING&&typeof G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(L.allowCustomizedBuiltInElements=G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),z&&(ue=!1),Ue&&(Ee=!0),jt&&(ce=qt({},u9),A=[],jt.html===!0&&(qt(ce,c9),qt(A,f9)),jt.svg===!0&&(qt(ce,UA),qt(A,YA),qt(A,T1)),jt.svgFilters===!0&&(qt(ce,$A),qt(A,YA),qt(A,T1)),jt.mathMl===!0&&(qt(ce,GA),qt(A,h9),qt(A,T1))),G.ADD_TAGS&&(ce===S&&(ce=gc(ce)),qt(ce,G.ADD_TAGS,Or)),G.ADD_ATTR&&(A===M&&(A=gc(A)),qt(A,G.ADD_ATTR,Or)),G.ADD_URI_SAFE_ATTR&&qt(Xe,G.ADD_URI_SAFE_ATTR,Or),G.FORBID_CONTENTS&&(Dt===Et&&(Dt=gc(Dt)),qt(Dt,G.FORBID_CONTENTS,Or)),er&&(ce["#text"]=!0),Fe&&qt(ce,["html","head","body"]),ce.table&&(qt(ce,["tbody"]),delete V.tbody),G.TRUSTED_TYPES_POLICY){if(typeof G.TRUSTED_TYPES_POLICY.createHTML!="function")throw km('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof G.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw km('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=G.TRUSTED_TYPES_POLICY,O=k.createHTML("")}else k===void 0&&(k=JEe(g,i)),k!==null&&typeof O=="string"&&(O=k.createHTML(""));bs&&bs(G),zi=G}},qe=qt({},[...UA,...$A,...WEe]),ut=qt({},[...GA,...zEe]),ht=function(G){let de=R(G);(!de||!de.tagName)&&(de={namespaceURI:ar,tagName:"template"});const Ce=Bw(G.tagName),Ne=Bw(de.tagName);return Br[G.namespaceURI]?G.namespaceURI===nt?de.namespaceURI===ct?Ce==="svg":de.namespaceURI===Lt?Ce==="svg"&&(Ne==="annotation-xml"||Wn[Ne]):!!qe[Ce]:G.namespaceURI===Lt?de.namespaceURI===ct?Ce==="math":de.namespaceURI===nt?Ce==="math"&&Ai[Ne]:!!ut[Ce]:G.namespaceURI===ct?de.namespaceURI===nt&&!Ai[Ne]||de.namespaceURI===Lt&&!Wn[Ne]?!1:!ut[Ce]&&(ga[Ce]||!qe[Ce]):!!(ii==="application/xhtml+xml"&&Br[G.namespaceURI]):!1},Ot=function(G){Rm(e.removed,{element:G});try{R(G).removeChild(G)}catch{b(G)}},hn=function(G,de){try{Rm(e.removed,{attribute:de.getAttributeNode(G),from:de})}catch{Rm(e.removed,{attribute:null,from:de})}if(de.removeAttribute(G),G==="is")if(Ee||Ue)try{Ot(de)}catch{}else try{de.setAttribute(G,"")}catch{}},Ts=function(G){let de=null,Ce=null;if(Ge)G="<remove></remove>"+G;else{const Le=l9(G,/^[\r\n\t ]+/);Ce=Le&&Le[0]}ii==="application/xhtml+xml"&&ar===ct&&(G='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+G+"</body></html>");const Ne=k?k.createHTML(G):G;if(ar===ct)try{de=new m().parseFromString(Ne,ii)}catch{}if(!de||!de.documentElement){de=P.createDocument(ar,"template",null);try{de.documentElement.innerHTML=vn?O:Ne}catch{}}const Ie=de.body||de.documentElement;return G&&Ce&&Ie.insertBefore(r.createTextNode(Ce),Ie.childNodes[0]||null),ar===ct?N.call(de,Fe?"html":"body")[0]:Fe?de.documentElement:Ie},W=function(G){return D.call(G.ownerDocument||G,G,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},te=function(G){return G instanceof d&&(typeof G.nodeName!="string"||typeof G.textContent!="string"||typeof G.removeChild!="function"||!(G.attributes instanceof h)||typeof G.removeAttribute!="function"||typeof G.setAttribute!="function"||typeof G.namespaceURI!="string"||typeof G.insertBefore!="function"||typeof G.hasChildNodes!="function")},X=function(G){return typeof a=="function"&&G instanceof a};function Q(fe,G,de){C1(fe,Ce=>{Ce.call(e,G,de,zi)})}const ne=function(G){let de=null;if(Q(B.beforeSanitizeElements,G,null),te(G))return Ot(G),!0;const Ce=Or(G.nodeName);if(Q(B.uponSanitizeElement,G,{tagName:Ce,allowedTags:ce}),Be&&G.hasChildNodes()&&!X(G.firstElementChild)&&us(/<[/\w!]/g,G.innerHTML)&&us(/<[/\w!]/g,G.textContent)||G.nodeType===_m.progressingInstruction||Be&&G.nodeType===_m.comment&&us(/<[/\w]/g,G.data))return Ot(G),!0;if(!ce[Ce]||V[Ce]){if(!V[Ce]&&xe(Ce)&&(L.tagNameCheck instanceof RegExp&&us(L.tagNameCheck,Ce)||L.tagNameCheck instanceof Function&&L.tagNameCheck(Ce)))return!1;if(er&&!Dt[Ce]){const Ne=R(G)||G.parentNode,Ie=E(G)||G.childNodes;if(Ie&&Ne){const Le=Ie.length;for(let it=Le-1;it>=0;--it){const Wt=x(Ie[it],!0);Wt.__removalCount=(G.__removalCount||0)+1,Ne.insertBefore(Wt,C(G))}}}return Ot(G),!0}return G instanceof l&&!ht(G)||(Ce==="noscript"||Ce==="noembed"||Ce==="noframes")&&us(/<\/no(script|embed|frames)/i,G.innerHTML)?(Ot(G),!0):(z&&G.nodeType===_m.text&&(de=G.textContent,C1([j,ee,oe],Ne=>{de=Am(de,Ne," ")}),G.textContent!==de&&(Rm(e.removed,{element:G.cloneNode()}),G.textContent=de)),Q(B.afterSanitizeElements,G,null),!1)},se=function(G,de,Ce){if(tt&&(de==="id"||de==="name")&&(Ce in r||Ce in yt))return!1;if(!(ue&&!J[de]&&us(re,de))){if(!(ae&&us(q,de))){if(!A[de]||J[de]){if(!(xe(G)&&(L.tagNameCheck instanceof RegExp&&us(L.tagNameCheck,G)||L.tagNameCheck instanceof Function&&L.tagNameCheck(G))&&(L.attributeNameCheck instanceof RegExp&&us(L.attributeNameCheck,de)||L.attributeNameCheck instanceof Function&&L.attributeNameCheck(de))||de==="is"&&L.allowCustomizedBuiltInElements&&(L.tagNameCheck instanceof RegExp&&us(L.tagNameCheck,Ce)||L.tagNameCheck instanceof Function&&L.tagNameCheck(Ce))))return!1}else if(!Xe[de]){if(!us(K,Am(Ce,ve,""))){if(!((de==="src"||de==="xlink:href"||de==="href")&&G!=="script"&&HEe(Ce,"data:")===0&&Ct[G])){if(!(pe&&!us(Z,Am(Ce,ve,"")))){if(Ce)return!1}}}}}}return!0},xe=function(G){return G!=="annotation-xml"&&l9(G,ie)},Re=function(G){Q(B.beforeSanitizeAttributes,G,null);const{attributes:de}=G;if(!de||te(G))return;const Ce={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A,forceKeepAttr:void 0};let Ne=de.length;for(;Ne--;){const Ie=de[Ne],{name:Le,namespaceURI:it,value:Wt}=Ie,tr=Or(Le),vr=Wt;let Vr=Le==="value"?vr:BEe(vr);if(Ce.attrName=tr,Ce.attrValue=Vr,Ce.keepAttr=!0,Ce.forceKeepAttr=void 0,Q(B.uponSanitizeAttribute,G,Ce),Vr=Ce.attrValue,at&&(tr==="id"||tr==="name")&&(hn(Le,G),Vr=je+Vr),Be&&us(/((--!?|])>)|<\/(style|title)/i,Vr)){hn(Le,G);continue}if(Ce.forceKeepAttr)continue;if(!Ce.keepAttr){hn(Le,G);continue}if(!ke&&us(/\/>/i,Vr)){hn(Le,G);continue}z&&C1([j,ee,oe],ls=>{Vr=Am(Vr,ls," ")});const va=Or(G.nodeName);if(!se(va,tr,Vr)){hn(Le,G);continue}if(k&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!it)switch(g.getAttributeType(va,tr)){case"TrustedHTML":{Vr=k.createHTML(Vr);break}case"TrustedScriptURL":{Vr=k.createScriptURL(Vr);break}}if(Vr!==vr)try{it?G.setAttributeNS(it,Le,Vr):G.setAttribute(Le,Vr),te(G)?Ot(G):a9(e.removed)}catch{hn(Le,G)}}Q(B.afterSanitizeAttributes,G,null)},ge=function fe(G){let de=null;const Ce=W(G);for(Q(B.beforeSanitizeShadowDOM,G,null);de=Ce.nextNode();)Q(B.uponSanitizeShadowNode,de,null),ne(de),Re(de),de.content instanceof s&&fe(de.content);Q(B.afterSanitizeShadowDOM,G,null)};return e.sanitize=function(fe){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},de=null,Ce=null,Ne=null,Ie=null;if(vn=!fe,vn&&(fe="<!-->"),typeof fe!="string"&&!X(fe))if(typeof fe.toString=="function"){if(fe=fe.toString(),typeof fe!="string")throw km("dirty is not a string, aborting")}else throw km("toString is not a function");if(!e.isSupported)return fe;if(ze||We(G),e.removed=[],typeof fe=="string"&&(Nt=!1),Nt){if(fe.nodeName){const Wt=Or(fe.nodeName);if(!ce[Wt]||V[Wt])throw km("root node is forbidden and cannot be sanitized in-place")}}else if(fe instanceof a)de=Ts("<!---->"),Ce=de.ownerDocument.importNode(fe,!0),Ce.nodeType===_m.element&&Ce.nodeName==="BODY"||Ce.nodeName==="HTML"?de=Ce:de.appendChild(Ce);else{if(!Ee&&!z&&!Fe&&fe.indexOf("<")===-1)return k&&st?k.createHTML(fe):fe;if(de=Ts(fe),!de)return Ee?null:st?O:""}de&&Ge&&Ot(de.firstChild);const Le=W(Nt?fe:de);for(;Ne=Le.nextNode();)ne(Ne),Re(Ne),Ne.content instanceof s&&ge(Ne.content);if(Nt)return fe;if(Ee){if(Ue)for(Ie=H.call(de.ownerDocument);de.firstChild;)Ie.appendChild(de.firstChild);else Ie=de;return(A.shadowroot||A.shadowrootmode)&&(Ie=_.call(n,Ie,!0)),Ie}let it=Fe?de.outerHTML:de.innerHTML;return Fe&&ce["!doctype"]&&de.ownerDocument&&de.ownerDocument.doctype&&de.ownerDocument.doctype.name&&us(Yq,de.ownerDocument.doctype.name)&&(it="<!DOCTYPE "+de.ownerDocument.doctype.name+`>
`+it),z&&C1([j,ee,oe],Wt=>{it=Am(it,Wt," ")}),k&&st?k.createHTML(it):it},e.setConfig=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};We(fe),ze=!0},e.clearConfig=function(){zi=null,ze=!1},e.isValidAttribute=function(fe,G,de){zi||We({});const Ce=Or(fe),Ne=Or(G);return se(Ce,Ne,de)},e.addHook=function(fe,G){typeof G=="function"&&Rm(B[fe],G)},e.removeHook=function(fe,G){if(G!==void 0){const de=LEe(B[fe],G);return de===-1?void 0:FEe(B[fe],de,1)[0]}return a9(B[fe])},e.removeHooks=function(fe){B[fe]=[]},e.removeAllHooks=function(){B=p9()},e}var eRe=qq();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Kq;function Ye(){return Kq.apply(null,arguments)}function tRe(t){Kq=t}function ja(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function hh(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function hr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ZP(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(hr(t,e))return!1;return!0}function Ds(t){return t===void 0}function Nc(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Cy(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Xq(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Ou(t,e){for(var r in e)hr(e,r)&&(t[r]=e[r]);return hr(e,"toString")&&(t.toString=e.toString),hr(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Wl(t,e,r,n){return xK(t,e,r,n,!0).utc()}function rRe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function It(t){return t._pf==null&&(t._pf=rRe()),t._pf}var C_;Array.prototype.some?C_=Array.prototype.some:C_=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function JP(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=It(t),r=C_.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function $S(t){var e=Wl(NaN);return t!=null?Ou(It(e),t):It(e).userInvalidated=!0,e}var m9=Ye.momentProperties=[],qA=!1;function eI(t,e){var r,n,i,s=m9.length;if(Ds(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Ds(e._i)||(t._i=e._i),Ds(e._f)||(t._f=e._f),Ds(e._l)||(t._l=e._l),Ds(e._strict)||(t._strict=e._strict),Ds(e._tzm)||(t._tzm=e._tzm),Ds(e._isUTC)||(t._isUTC=e._isUTC),Ds(e._offset)||(t._offset=e._offset),Ds(e._pf)||(t._pf=It(e)),Ds(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=m9[r],i=e[n],Ds(i)||(t[n]=i);return t}function Ty(t){eI(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),qA===!1&&(qA=!0,Ye.updateOffset(this),qA=!1)}function Wa(t){return t instanceof Ty||t!=null&&t._isAMomentObject!=null}function Qq(t){Ye.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function da(t,e){var r=!0;return Ou(function(){if(Ye.deprecationHandler!=null&&Ye.deprecationHandler(null,t),r){var n=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])hr(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}Qq(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var g9={};function Zq(t,e){Ye.deprecationHandler!=null&&Ye.deprecationHandler(t,e),g9[t]||(Qq(e),g9[t]=!0)}Ye.suppressDeprecationWarnings=!1;Ye.deprecationHandler=null;function zl(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function nRe(t){var e,r;for(r in t)hr(t,r)&&(e=t[r],zl(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function T_(t,e){var r=Ou({},t),n;for(n in e)hr(e,n)&&(hh(t[n])&&hh(e[n])?(r[n]={},Ou(r[n],t[n]),Ou(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)hr(t,n)&&!hr(e,n)&&hh(t[n])&&(r[n]=Ou({},r[n]));return r}function tI(t){t!=null&&this.set(t)}var E_;Object.keys?E_=Object.keys:E_=function(t){var e,r=[];for(e in t)hr(t,e)&&r.push(e);return r};var iRe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function sRe(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return zl(n)?n.call(e,r):n}function Ll(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var rI=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,E1=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,KA={},wp={};function lt(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(wp[t]=i),e&&(wp[e[0]]=function(){return Ll(i.apply(this,arguments),e[1],e[2])}),r&&(wp[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function oRe(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function aRe(t){var e=t.match(rI),r,n;for(r=0,n=e.length;r<n;r++)wp[e[r]]?e[r]=wp[e[r]]:e[r]=oRe(e[r]);return function(i){var s="",o;for(o=0;o<n;o++)s+=zl(e[o])?e[o].call(i,t):e[o];return s}}function Vw(t,e){return t.isValid()?(e=Jq(e,t.localeData()),KA[e]=KA[e]||aRe(e),KA[e](t)):t.localeData().invalidDate()}function Jq(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(E1.lastIndex=0;r>=0&&E1.test(t);)t=t.replace(E1,n),E1.lastIndex=0,r-=1;return t}var lRe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function cRe(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(rI).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var uRe="Invalid date";function fRe(){return this._invalidDate}var hRe="%d",dRe=/\d{1,2}/;function pRe(t){return this._ordinal.replace("%d",t)}var mRe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function gRe(t,e,r,n){var i=this._relativeTime[r];return zl(i)?i(t,e,r,n):i.replace(/%d/i,t)}function vRe(t,e){var r=this._relativeTime[t>0?"future":"past"];return zl(r)?r(e):r.replace(/%s/i,e)}var v9={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function pa(t){return typeof t=="string"?v9[t]||v9[t.toLowerCase()]:void 0}function nI(t){var e={},r,n;for(n in t)hr(t,n)&&(r=pa(n),r&&(e[r]=t[n]));return e}var yRe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function xRe(t){var e=[],r;for(r in t)hr(t,r)&&e.push({unit:r,priority:yRe[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var eK=/\d/,bo=/\d\d/,tK=/\d{3}/,iI=/\d{4}/,GS=/[+-]?\d{6}/,nn=/\d\d?/,rK=/\d\d\d\d?/,nK=/\d\d\d\d\d\d?/,YS=/\d{1,3}/,sI=/\d{1,4}/,qS=/[+-]?\d{1,6}/,m0=/\d+/,KS=/[+-]?\d+/,wRe=/Z|[+-]\d\d:?\d\d/gi,XS=/Z|[+-]\d\d(?::?\d\d)?/gi,bRe=/[+-]?\d+(\.\d{1,3})?/,Ey=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,g0=/^[1-9]\d?/,oI=/^([1-9]\d|\d)/,Ob;Ob={};function Ze(t,e,r){Ob[t]=zl(e)?e:function(n,i){return n&&r?r:e}}function SRe(t,e){return hr(Ob,t)?Ob[t](e._strict,e._locale):new RegExp(CRe(t))}function CRe(t){return Ac(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function Ac(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Go(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Xt(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Go(e)),r}var R_={};function kr(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Nc(e)&&(n=function(s,o){o[e]=Xt(s)}),i=t.length,r=0;r<i;r++)R_[t[r]]=n}function Ry(t,e){kr(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function TRe(t,e,r){e!=null&&hr(R_,t)&&R_[t](e,r._a,r,t)}function QS(t){return t%4===0&&t%100!==0||t%400===0}var is=0,Cc=1,xl=2,fi=3,Fa=4,Tc=5,rh=6,ERe=7,RRe=8;lt("Y",0,0,function(){var t=this.year();return t<=9999?Ll(t,4):"+"+t});lt(0,["YY",2],0,function(){return this.year()%100});lt(0,["YYYY",4],0,"year");lt(0,["YYYYY",5],0,"year");lt(0,["YYYYYY",6,!0],0,"year");Ze("Y",KS);Ze("YY",nn,bo);Ze("YYYY",sI,iI);Ze("YYYYY",qS,GS);Ze("YYYYYY",qS,GS);kr(["YYYYY","YYYYYY"],is);kr("YYYY",function(t,e){e[is]=t.length===2?Ye.parseTwoDigitYear(t):Xt(t)});kr("YY",function(t,e){e[is]=Ye.parseTwoDigitYear(t)});kr("Y",function(t,e){e[is]=parseInt(t,10)});function Fg(t){return QS(t)?366:365}Ye.parseTwoDigitYear=function(t){return Xt(t)+(Xt(t)>68?1900:2e3)};var iK=v0("FullYear",!0);function ARe(){return QS(this.year())}function v0(t,e){return function(r){return r!=null?(sK(this,t,r),Ye.updateOffset(this,e),this):bv(this,t)}}function bv(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function sK(t,e,r){var n,i,s,o,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,o=t.month(),a=t.date(),a=a===29&&o===1&&!QS(s)?28:a,i?n.setUTCFullYear(s,o,a):n.setFullYear(s,o,a)}}function kRe(t){return t=pa(t),zl(this[t])?this[t]():this}function ORe(t,e){if(typeof t=="object"){t=nI(t);var r=xRe(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=pa(t),zl(this[t]))return this[t](e);return this}function _Re(t,e){return(t%e+e)%e}var Nn;Array.prototype.indexOf?Nn=Array.prototype.indexOf:Nn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function aI(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=_Re(e,12);return t+=(e-r)/12,r===1?QS(t)?29:28:31-r%7%2}lt("M",["MM",2],"Mo",function(){return this.month()+1});lt("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});lt("MMMM",0,0,function(t){return this.localeData().months(this,t)});Ze("M",nn,g0);Ze("MM",nn,bo);Ze("MMM",function(t,e){return e.monthsShortRegex(t)});Ze("MMMM",function(t,e){return e.monthsRegex(t)});kr(["M","MM"],function(t,e){e[Cc]=Xt(t)-1});kr(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Cc]=i:It(r).invalidMonth=t});var MRe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),oK="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),aK=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,DRe=Ey,PRe=Ey;function IRe(t,e){return t?ja(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||aK).test(e)?"format":"standalone"][t.month()]:ja(this._months)?this._months:this._months.standalone}function NRe(t,e){return t?ja(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[aK.test(e)?"format":"standalone"][t.month()]:ja(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function LRe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Wl([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=Nn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Nn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=Nn.call(this._shortMonthsParse,o),i!==-1?i:(i=Nn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Nn.call(this._longMonthsParse,o),i!==-1?i:(i=Nn.call(this._shortMonthsParse,o),i!==-1?i:null))}function FRe(t,e,r){var n,i,s;if(this._monthsParseExact)return LRe.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Wl([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function lK(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Xt(e);else if(e=t.localeData().monthsParse(e),!Nc(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,aI(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function cK(t){return t!=null?(lK(this,t),Ye.updateOffset(this,!0),this):bv(this,"Month")}function HRe(){return aI(this.year(),this.month())}function BRe(t){return this._monthsParseExact?(hr(this,"_monthsRegex")||uK.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(hr(this,"_monthsShortRegex")||(this._monthsShortRegex=DRe),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function VRe(t){return this._monthsParseExact?(hr(this,"_monthsRegex")||uK.call(this),t?this._monthsStrictRegex:this._monthsRegex):(hr(this,"_monthsRegex")||(this._monthsRegex=PRe),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function uK(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,s,o,a;for(i=0;i<12;i++)s=Wl([2e3,i]),o=Ac(this.monthsShort(s,"")),a=Ac(this.months(s,"")),e.push(o),r.push(a),n.push(a),n.push(o);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function jRe(t,e,r,n,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,s,o),a}function Sv(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function _b(t,e,r){var n=7+e-r,i=(7+Sv(t,0,n).getUTCDay()-e)%7;return-i+n-1}function fK(t,e,r,n,i){var s=(7+r-n)%7,o=_b(t,n,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=Fg(l)+a):a>Fg(t)?(l=t+1,u=a-Fg(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Cv(t,e,r){var n=_b(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+kc(o,e,r)):i>kc(t.year(),e,r)?(s=i-kc(t.year(),e,r),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function kc(t,e,r){var n=_b(t,e,r),i=_b(t+1,e,r);return(Fg(t)-n+i)/7}lt("w",["ww",2],"wo","week");lt("W",["WW",2],"Wo","isoWeek");Ze("w",nn,g0);Ze("ww",nn,bo);Ze("W",nn,g0);Ze("WW",nn,bo);Ry(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=Xt(t)});function WRe(t){return Cv(t,this._week.dow,this._week.doy).week}var zRe={dow:0,doy:6};function URe(){return this._week.dow}function $Re(){return this._week.doy}function GRe(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function YRe(t){var e=Cv(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}lt("d",0,"do","day");lt("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});lt("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});lt("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});lt("e",0,0,"weekday");lt("E",0,0,"isoWeekday");Ze("d",nn);Ze("e",nn);Ze("E",nn);Ze("dd",function(t,e){return e.weekdaysMinRegex(t)});Ze("ddd",function(t,e){return e.weekdaysShortRegex(t)});Ze("dddd",function(t,e){return e.weekdaysRegex(t)});Ry(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:It(r).invalidWeekday=t});Ry(["d","e","E"],function(t,e,r,n){e[n]=Xt(t)});function qRe(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function KRe(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function lI(t,e){return t.slice(e,7).concat(t.slice(0,e))}var XRe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),hK="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),QRe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ZRe=Ey,JRe=Ey,e2e=Ey;function t2e(t,e){var r=ja(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?lI(r,this._week.dow):t?r[t.day()]:r}function r2e(t){return t===!0?lI(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function n2e(t){return t===!0?lI(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function i2e(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Wl([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=Nn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=Nn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Nn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=Nn.call(this._weekdaysParse,o),i!==-1||(i=Nn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=Nn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=Nn.call(this._shortWeekdaysParse,o),i!==-1||(i=Nn.call(this._weekdaysParse,o),i!==-1)?i:(i=Nn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=Nn.call(this._minWeekdaysParse,o),i!==-1||(i=Nn.call(this._weekdaysParse,o),i!==-1)?i:(i=Nn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function s2e(t,e,r){var n,i,s;if(this._weekdaysParseExact)return i2e.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Wl([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function o2e(t){if(!this.isValid())return t!=null?this:NaN;var e=bv(this,"Day");return t!=null?(t=qRe(t,this.localeData()),this.add(t-e,"d")):e}function a2e(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function l2e(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=KRe(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function c2e(t){return this._weekdaysParseExact?(hr(this,"_weekdaysRegex")||cI.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(hr(this,"_weekdaysRegex")||(this._weekdaysRegex=ZRe),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function u2e(t){return this._weekdaysParseExact?(hr(this,"_weekdaysRegex")||cI.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=JRe),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function f2e(t){return this._weekdaysParseExact?(hr(this,"_weekdaysRegex")||cI.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=e2e),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function cI(){function t(h,d){return d.length-h.length}var e=[],r=[],n=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=Wl([2e3,1]).day(s),a=Ac(this.weekdaysMin(o,"")),l=Ac(this.weekdaysShort(o,"")),u=Ac(this.weekdays(o,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function uI(){return this.hours()%12||12}function h2e(){return this.hours()||24}lt("H",["HH",2],0,"hour");lt("h",["hh",2],0,uI);lt("k",["kk",2],0,h2e);lt("hmm",0,0,function(){return""+uI.apply(this)+Ll(this.minutes(),2)});lt("hmmss",0,0,function(){return""+uI.apply(this)+Ll(this.minutes(),2)+Ll(this.seconds(),2)});lt("Hmm",0,0,function(){return""+this.hours()+Ll(this.minutes(),2)});lt("Hmmss",0,0,function(){return""+this.hours()+Ll(this.minutes(),2)+Ll(this.seconds(),2)});function dK(t,e){lt(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}dK("a",!0);dK("A",!1);function pK(t,e){return e._meridiemParse}Ze("a",pK);Ze("A",pK);Ze("H",nn,oI);Ze("h",nn,g0);Ze("k",nn,g0);Ze("HH",nn,bo);Ze("hh",nn,bo);Ze("kk",nn,bo);Ze("hmm",rK);Ze("hmmss",nK);Ze("Hmm",rK);Ze("Hmmss",nK);kr(["H","HH"],fi);kr(["k","kk"],function(t,e,r){var n=Xt(t);e[fi]=n===24?0:n});kr(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});kr(["h","hh"],function(t,e,r){e[fi]=Xt(t),It(r).bigHour=!0});kr("hmm",function(t,e,r){var n=t.length-2;e[fi]=Xt(t.substr(0,n)),e[Fa]=Xt(t.substr(n)),It(r).bigHour=!0});kr("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[fi]=Xt(t.substr(0,n)),e[Fa]=Xt(t.substr(n,2)),e[Tc]=Xt(t.substr(i)),It(r).bigHour=!0});kr("Hmm",function(t,e,r){var n=t.length-2;e[fi]=Xt(t.substr(0,n)),e[Fa]=Xt(t.substr(n))});kr("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[fi]=Xt(t.substr(0,n)),e[Fa]=Xt(t.substr(n,2)),e[Tc]=Xt(t.substr(i))});function d2e(t){return(t+"").toLowerCase().charAt(0)==="p"}var p2e=/[ap]\.?m?\.?/i,m2e=v0("Hours",!0);function g2e(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var mK={calendar:iRe,longDateFormat:lRe,invalidDate:uRe,ordinal:hRe,dayOfMonthOrdinalParse:dRe,relativeTime:mRe,months:MRe,monthsShort:oK,week:zRe,weekdays:XRe,weekdaysMin:QRe,weekdaysShort:hK,meridiemParse:p2e},an={},Mm={},Tv;function v2e(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function y9(t){return t&&t.toLowerCase().replace("_","-")}function y2e(t){for(var e=0,r,n,i,s;e<t.length;){for(s=y9(t[e]).split("-"),r=s.length,n=y9(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=ZS(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&v2e(s,n)>=r-1)break;r--}e++}return Tv}function x2e(t){return!!(t&&t.match("^[^/\\\\]*$"))}function ZS(t){var e=null,r;if(an[t]===void 0&&typeof sb<"u"&&sb&&sb.exports&&x2e(t))try{e=Tv._abbr,r=require,r("./locale/"+t),Fu(e)}catch{an[t]=null}return an[t]}function Fu(t,e){var r;return t&&(Ds(e)?r=Vc(t):r=fI(t,e),r?Tv=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Tv._abbr}function fI(t,e){if(e!==null){var r,n=mK;if(e.abbr=t,an[t]!=null)Zq("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=an[t]._config;else if(e.parentLocale!=null)if(an[e.parentLocale]!=null)n=an[e.parentLocale]._config;else if(r=ZS(e.parentLocale),r!=null)n=r._config;else return Mm[e.parentLocale]||(Mm[e.parentLocale]=[]),Mm[e.parentLocale].push({name:t,config:e}),null;return an[t]=new tI(T_(n,e)),Mm[t]&&Mm[t].forEach(function(i){fI(i.name,i.config)}),Fu(t),an[t]}else return delete an[t],null}function w2e(t,e){if(e!=null){var r,n,i=mK;an[t]!=null&&an[t].parentLocale!=null?an[t].set(T_(an[t]._config,e)):(n=ZS(t),n!=null&&(i=n._config),e=T_(i,e),n==null&&(e.abbr=t),r=new tI(e),r.parentLocale=an[t],an[t]=r),Fu(t)}else an[t]!=null&&(an[t].parentLocale!=null?(an[t]=an[t].parentLocale,t===Fu()&&Fu(t)):an[t]!=null&&delete an[t]);return an[t]}function Vc(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Tv;if(!ja(t)){if(e=ZS(t),e)return e;t=[t]}return y2e(t)}function b2e(){return E_(an)}function hI(t){var e,r=t._a;return r&&It(t).overflow===-2&&(e=r[Cc]<0||r[Cc]>11?Cc:r[xl]<1||r[xl]>aI(r[is],r[Cc])?xl:r[fi]<0||r[fi]>24||r[fi]===24&&(r[Fa]!==0||r[Tc]!==0||r[rh]!==0)?fi:r[Fa]<0||r[Fa]>59?Fa:r[Tc]<0||r[Tc]>59?Tc:r[rh]<0||r[rh]>999?rh:-1,It(t)._overflowDayOfYear&&(e<is||e>xl)&&(e=xl),It(t)._overflowWeeks&&e===-1&&(e=ERe),It(t)._overflowWeekday&&e===-1&&(e=RRe),It(t).overflow=e),t}var S2e=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,C2e=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,T2e=/Z|[+-]\d\d(?::?\d\d)?/,R1=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],XA=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],E2e=/^\/?Date\((-?\d+)/i,R2e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,A2e={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function gK(t){var e,r,n=t._i,i=S2e.exec(n)||C2e.exec(n),s,o,a,l,u=R1.length,h=XA.length;if(i){for(It(t).iso=!0,e=0,r=u;e<r;e++)if(R1[e][1].exec(i[1])){o=R1[e][0],s=R1[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,r=h;e<r;e++)if(XA[e][1].exec(i[3])){a=(i[2]||" ")+XA[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(T2e.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),pI(t)}else t._isValid=!1}function k2e(t,e,r,n,i,s){var o=[O2e(t),oK.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function O2e(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function _2e(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function M2e(t,e,r){if(t){var n=hK.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return It(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function D2e(t,e,r){if(t)return A2e[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function vK(t){var e=R2e.exec(_2e(t._i)),r;if(e){if(r=k2e(e[4],e[3],e[2],e[5],e[6],e[7]),!M2e(e[1],r,t))return;t._a=r,t._tzm=D2e(e[8],e[9],e[10]),t._d=Sv.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),It(t).rfc2822=!0}else t._isValid=!1}function P2e(t){var e=E2e.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(gK(t),t._isValid===!1)delete t._isValid;else return;if(vK(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Ye.createFromInputFallback(t)}Ye.createFromInputFallback=da("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Zd(t,e,r){return t??e??r}function I2e(t){var e=new Date(Ye.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function dI(t){var e,r,n=[],i,s,o;if(!t._d){for(i=I2e(t),t._w&&t._a[xl]==null&&t._a[Cc]==null&&N2e(t),t._dayOfYear!=null&&(o=Zd(t._a[is],i[is]),(t._dayOfYear>Fg(o)||t._dayOfYear===0)&&(It(t)._overflowDayOfYear=!0),r=Sv(o,0,t._dayOfYear),t._a[Cc]=r.getUTCMonth(),t._a[xl]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[fi]===24&&t._a[Fa]===0&&t._a[Tc]===0&&t._a[rh]===0&&(t._nextDay=!0,t._a[fi]=0),t._d=(t._useUTC?Sv:jRe).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[fi]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(It(t).weekdayMismatch=!0)}}function N2e(t){var e,r,n,i,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=Zd(e.GG,t._a[is],Cv(tn(),1,4).year),n=Zd(e.W,1),i=Zd(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=Cv(tn(),s,o),r=Zd(e.gg,t._a[is],u.year),n=Zd(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),n<1||n>kc(r,s,o)?It(t)._overflowWeeks=!0:l!=null?It(t)._overflowWeekday=!0:(a=fK(r,n,i,s,o),t._a[is]=a.year,t._dayOfYear=a.dayOfYear)}Ye.ISO_8601=function(){};Ye.RFC_2822=function(){};function pI(t){if(t._f===Ye.ISO_8601){gK(t);return}if(t._f===Ye.RFC_2822){vK(t);return}t._a=[],It(t).empty=!0;var e=""+t._i,r,n,i,s,o,a=e.length,l=0,u,h;for(i=Jq(t._f,t._locale).match(rI)||[],h=i.length,r=0;r<h;r++)s=i[r],n=(e.match(SRe(s,t))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&It(t).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),l+=n.length),wp[s]?(n?It(t).empty=!1:It(t).unusedTokens.push(s),TRe(s,n,t)):t._strict&&!n&&It(t).unusedTokens.push(s);It(t).charsLeftOver=a-l,e.length>0&&It(t).unusedInput.push(e),t._a[fi]<=12&&It(t).bigHour===!0&&t._a[fi]>0&&(It(t).bigHour=void 0),It(t).parsedDateParts=t._a.slice(0),It(t).meridiem=t._meridiem,t._a[fi]=L2e(t._locale,t._a[fi],t._meridiem),u=It(t).era,u!==null&&(t._a[is]=t._locale.erasConvertYear(u,t._a[is])),dI(t),hI(t)}function L2e(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function F2e(t){var e,r,n,i,s,o,a=!1,l=t._f.length;if(l===0){It(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=eI({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],pI(e),JP(e)&&(o=!0),s+=It(e).charsLeftOver,s+=It(e).unusedTokens.length*10,It(e).score=s,a?s<n&&(n=s,r=e):(n==null||s<n||o)&&(n=s,r=e,o&&(a=!0));Ou(t,r||e)}function H2e(t){if(!t._d){var e=nI(t._i),r=e.day===void 0?e.date:e.day;t._a=Xq([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),dI(t)}}function B2e(t){var e=new Ty(hI(yK(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function yK(t){var e=t._i,r=t._f;return t._locale=t._locale||Vc(t._l),e===null||r===void 0&&e===""?$S({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Wa(e)?new Ty(hI(e)):(Cy(e)?t._d=e:ja(r)?F2e(t):r?pI(t):V2e(t),JP(t)||(t._d=null),t))}function V2e(t){var e=t._i;Ds(e)?t._d=new Date(Ye.now()):Cy(e)?t._d=new Date(e.valueOf()):typeof e=="string"?P2e(t):ja(e)?(t._a=Xq(e.slice(0),function(r){return parseInt(r,10)}),dI(t)):hh(e)?H2e(t):Nc(e)?t._d=new Date(e):Ye.createFromInputFallback(t)}function xK(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(hh(t)&&ZP(t)||ja(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,B2e(s)}function tn(t,e,r,n){return xK(t,e,r,n,!1)}var j2e=da("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=tn.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:$S()}),W2e=da("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=tn.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:$S()});function wK(t,e){var r,n;if(e.length===1&&ja(e[0])&&(e=e[0]),!e.length)return tn();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function z2e(){var t=[].slice.call(arguments,0);return wK("isBefore",t)}function U2e(){var t=[].slice.call(arguments,0);return wK("isAfter",t)}var $2e=function(){return Date.now?Date.now():+new Date},Dm=["year","quarter","month","week","day","hour","minute","second","millisecond"];function G2e(t){var e,r=!1,n,i=Dm.length;for(e in t)if(hr(t,e)&&!(Nn.call(Dm,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Dm[n]]){if(r)return!1;parseFloat(t[Dm[n]])!==Xt(t[Dm[n]])&&(r=!0)}return!0}function Y2e(){return this._isValid}function q2e(){return qa(NaN)}function JS(t){var e=nI(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,h=e.millisecond||0;this._isValid=G2e(e),this._milliseconds=+h+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=Vc(),this._bubble()}function jw(t){return t instanceof JS}function A_(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function K2e(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<n;o++)Xt(t[o])!==Xt(e[o])&&s++;return s+i}function bK(t,e){lt(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Ll(~~(r/60),2)+e+Ll(~~r%60,2)})}bK("Z",":");bK("ZZ","");Ze("Z",XS);Ze("ZZ",XS);kr(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=mI(XS,t)});var X2e=/([\+\-]|\d\d)/gi;function mI(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(X2e)||["-",0,0],s=+(i[1]*60)+Xt(i[2]),s===0?0:i[0]==="+"?s:-s)}function gI(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Wa(t)||Cy(t)?t.valueOf():tn(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ye.updateOffset(r,!1),r):tn(t).local()}function k_(t){return-Math.round(t._d.getTimezoneOffset())}Ye.updateOffset=function(){};function Q2e(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=mI(XS,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=k_(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?TK(this,qa(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ye.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:k_(this)}function Z2e(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function J2e(t){return this.utcOffset(0,t)}function eAe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(k_(this),"m")),this}function tAe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=mI(wRe,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function rAe(t){return this.isValid()?(t=t?tn(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function nAe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function iAe(){if(!Ds(this._isDSTShifted))return this._isDSTShifted;var t={},e;return eI(t,this),t=yK(t),t._a?(e=t._isUTC?Wl(t._a):tn(t._a),this._isDSTShifted=this.isValid()&&K2e(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function sAe(){return this.isValid()?!this._isUTC:!1}function oAe(){return this.isValid()?this._isUTC:!1}function SK(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aAe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,lAe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function qa(t,e){var r=t,n=null,i,s,o;return jw(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Nc(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=aAe.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:Xt(n[xl])*i,h:Xt(n[fi])*i,m:Xt(n[Fa])*i,s:Xt(n[Tc])*i,ms:Xt(A_(n[rh]*1e3))*i}):(n=lAe.exec(t))?(i=n[1]==="-"?-1:1,r={y:Rf(n[2],i),M:Rf(n[3],i),w:Rf(n[4],i),d:Rf(n[5],i),h:Rf(n[6],i),m:Rf(n[7],i),s:Rf(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=cAe(tn(r.from),tn(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new JS(r),jw(t)&&hr(t,"_locale")&&(s._locale=t._locale),jw(t)&&hr(t,"_isValid")&&(s._isValid=t._isValid),s}qa.fn=JS.prototype;qa.invalid=q2e;function Rf(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function x9(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function cAe(t,e){var r;return t.isValid()&&e.isValid()?(e=gI(e,t),t.isBefore(e)?r=x9(t,e):(r=x9(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function CK(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(Zq(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=qa(r,n),TK(this,i,t),this}}function TK(t,e,r,n){var i=e._milliseconds,s=A_(e._days),o=A_(e._months);t.isValid()&&(n=n??!0,o&&lK(t,bv(t,"Month")+o*r),s&&sK(t,"Date",bv(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&Ye.updateOffset(t,s||o))}var uAe=CK(1,"add"),fAe=CK(-1,"subtract");function EK(t){return typeof t=="string"||t instanceof String}function hAe(t){return Wa(t)||Cy(t)||EK(t)||Nc(t)||pAe(t)||dAe(t)||t===null||t===void 0}function dAe(t){var e=hh(t)&&!ZP(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=n.length;for(i=0;i<o;i+=1)s=n[i],r=r||hr(t,s);return e&&r}function pAe(t){var e=ja(t),r=!1;return e&&(r=t.filter(function(n){return!Nc(n)&&EK(t)}).length===0),e&&r}function mAe(t){var e=hh(t)&&!ZP(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||hr(t,s);return e&&r}function gAe(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function vAe(t,e){arguments.length===1&&(arguments[0]?hAe(arguments[0])?(t=arguments[0],e=void 0):mAe(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||tn(),n=gI(r,this).startOf("day"),i=Ye.calendarFormat(this,n)||"sameElse",s=e&&(zl(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,tn(r)))}function yAe(){return new Ty(this)}function xAe(t,e){var r=Wa(t)?t:tn(t);return this.isValid()&&r.isValid()?(e=pa(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function wAe(t,e){var r=Wa(t)?t:tn(t);return this.isValid()&&r.isValid()?(e=pa(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function bAe(t,e,r,n){var i=Wa(t)?t:tn(t),s=Wa(e)?e:tn(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function SAe(t,e){var r=Wa(t)?t:tn(t),n;return this.isValid()&&r.isValid()?(e=pa(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function CAe(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function TAe(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function EAe(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=gI(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=pa(e),e){case"year":s=Ww(this,n)/12;break;case"month":s=Ww(this,n);break;case"quarter":s=Ww(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Go(s)}function Ww(t,e){if(t.date()<e.date())return-Ww(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}Ye.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ye.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function RAe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function AAe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Vw(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):zl(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Vw(r,"Z")):Vw(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function kAe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function OAe(t){t||(t=this.isUtc()?Ye.defaultFormatUtc:Ye.defaultFormat);var e=Vw(this,t);return this.localeData().postformat(e)}function _Ae(t,e){return this.isValid()&&(Wa(t)&&t.isValid()||tn(t).isValid())?qa({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function MAe(t){return this.from(tn(),t)}function DAe(t,e){return this.isValid()&&(Wa(t)&&t.isValid()||tn(t).isValid())?qa({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function PAe(t){return this.to(tn(),t)}function RK(t){var e;return t===void 0?this._locale._abbr:(e=Vc(t),e!=null&&(this._locale=e),this)}var AK=da("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function kK(){return this._locale}var Mb=1e3,bp=60*Mb,Db=60*bp,OK=(365*400+97)*24*Db;function Sp(t,e){return(t%e+e)%e}function _K(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-OK:new Date(t,e,r).valueOf()}function MK(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-OK:Date.UTC(t,e,r)}function IAe(t){var e,r;if(t=pa(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?MK:_K,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Sp(e+(this._isUTC?0:this.utcOffset()*bp),Db);break;case"minute":e=this._d.valueOf(),e-=Sp(e,bp);break;case"second":e=this._d.valueOf(),e-=Sp(e,Mb);break}return this._d.setTime(e),Ye.updateOffset(this,!0),this}function NAe(t){var e,r;if(t=pa(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?MK:_K,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Db-Sp(e+(this._isUTC?0:this.utcOffset()*bp),Db)-1;break;case"minute":e=this._d.valueOf(),e+=bp-Sp(e,bp)-1;break;case"second":e=this._d.valueOf(),e+=Mb-Sp(e,Mb)-1;break}return this._d.setTime(e),Ye.updateOffset(this,!0),this}function LAe(){return this._d.valueOf()-(this._offset||0)*6e4}function FAe(){return Math.floor(this.valueOf()/1e3)}function HAe(){return new Date(this.valueOf())}function BAe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function VAe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function jAe(){return this.isValid()?this.toISOString():null}function WAe(){return JP(this)}function zAe(){return Ou({},It(this))}function UAe(){return It(this).overflow}function $Ae(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}lt("N",0,0,"eraAbbr");lt("NN",0,0,"eraAbbr");lt("NNN",0,0,"eraAbbr");lt("NNNN",0,0,"eraName");lt("NNNNN",0,0,"eraNarrow");lt("y",["y",1],"yo","eraYear");lt("y",["yy",2],0,"eraYear");lt("y",["yyy",3],0,"eraYear");lt("y",["yyyy",4],0,"eraYear");Ze("N",vI);Ze("NN",vI);Ze("NNN",vI);Ze("NNNN",rke);Ze("NNNNN",nke);kr(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?It(r).era=i:It(r).invalidEra=t});Ze("y",m0);Ze("yy",m0);Ze("yyy",m0);Ze("yyyy",m0);Ze("yo",ike);kr(["y","yy","yyy","yyyy"],is);kr(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[is]=r._locale.eraYearOrdinalParse(t,i):e[is]=parseInt(t,10)});function GAe(t,e){var r,n,i,s=this._eras||Vc("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=Ye(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=Ye(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function YAe(t,e,r){var n,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(o=s[n].name.toUpperCase(),a=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[n];break;case"NNNN":if(o===t)return s[n];break;case"NNNNN":if(l===t)return s[n];break}else if([o,a,l].indexOf(t)>=0)return s[n]}function qAe(t,e){var r=t.since<=t.until?1:-1;return e===void 0?Ye(t.since).year():Ye(t.since).year()+(e-t.offset)*r}function KAe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function XAe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function QAe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function ZAe(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-Ye(i[t].since).year())*r+i[t].offset;return this.year()}function JAe(t){return hr(this,"_erasNameRegex")||yI.call(this),t?this._erasNameRegex:this._erasRegex}function eke(t){return hr(this,"_erasAbbrRegex")||yI.call(this),t?this._erasAbbrRegex:this._erasRegex}function tke(t){return hr(this,"_erasNarrowRegex")||yI.call(this),t?this._erasNarrowRegex:this._erasRegex}function vI(t,e){return e.erasAbbrRegex(t)}function rke(t,e){return e.erasNameRegex(t)}function nke(t,e){return e.erasNarrowRegex(t)}function ike(t,e){return e._eraYearOrdinalRegex||m0}function yI(){var t=[],e=[],r=[],n=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=Ac(u[i].name),a=Ac(u[i].abbr),l=Ac(u[i].narrow),e.push(o),t.push(a),r.push(l),n.push(o),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}lt(0,["gg",2],0,function(){return this.weekYear()%100});lt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function eC(t,e){lt(0,[t,t.length],0,e)}eC("gggg","weekYear");eC("ggggg","weekYear");eC("GGGG","isoWeekYear");eC("GGGGG","isoWeekYear");Ze("G",KS);Ze("g",KS);Ze("GG",nn,bo);Ze("gg",nn,bo);Ze("GGGG",sI,iI);Ze("gggg",sI,iI);Ze("GGGGG",qS,GS);Ze("ggggg",qS,GS);Ry(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=Xt(t)});Ry(["gg","GG"],function(t,e,r,n){e[n]=Ye.parseTwoDigitYear(t)});function ske(t){return DK.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function oke(t){return DK.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function ake(){return kc(this.year(),1,4)}function lke(){return kc(this.isoWeekYear(),1,4)}function cke(){var t=this.localeData()._week;return kc(this.year(),t.dow,t.doy)}function uke(){var t=this.localeData()._week;return kc(this.weekYear(),t.dow,t.doy)}function DK(t,e,r,n,i){var s;return t==null?Cv(this,n,i).year:(s=kc(t,n,i),e>s&&(e=s),fke.call(this,t,e,r,n,i))}function fke(t,e,r,n,i){var s=fK(t,e,r,n,i),o=Sv(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}lt("Q",0,"Qo","quarter");Ze("Q",eK);kr("Q",function(t,e){e[Cc]=(Xt(t)-1)*3});function hke(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}lt("D",["DD",2],"Do","date");Ze("D",nn,g0);Ze("DD",nn,bo);Ze("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});kr(["D","DD"],xl);kr("Do",function(t,e){e[xl]=Xt(t.match(nn)[0])});var PK=v0("Date",!0);lt("DDD",["DDDD",3],"DDDo","dayOfYear");Ze("DDD",YS);Ze("DDDD",tK);kr(["DDD","DDDD"],function(t,e,r){r._dayOfYear=Xt(t)});function dke(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}lt("m",["mm",2],0,"minute");Ze("m",nn,oI);Ze("mm",nn,bo);kr(["m","mm"],Fa);var pke=v0("Minutes",!1);lt("s",["ss",2],0,"second");Ze("s",nn,oI);Ze("ss",nn,bo);kr(["s","ss"],Tc);var mke=v0("Seconds",!1);lt("S",0,0,function(){return~~(this.millisecond()/100)});lt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});lt(0,["SSS",3],0,"millisecond");lt(0,["SSSS",4],0,function(){return this.millisecond()*10});lt(0,["SSSSS",5],0,function(){return this.millisecond()*100});lt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});lt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});lt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});lt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Ze("S",YS,eK);Ze("SS",YS,bo);Ze("SSS",YS,tK);var _u,IK;for(_u="SSSS";_u.length<=9;_u+="S")Ze(_u,m0);function gke(t,e){e[rh]=Xt(("0."+t)*1e3)}for(_u="S";_u.length<=9;_u+="S")kr(_u,gke);IK=v0("Milliseconds",!1);lt("z",0,0,"zoneAbbr");lt("zz",0,0,"zoneName");function vke(){return this._isUTC?"UTC":""}function yke(){return this._isUTC?"Coordinated Universal Time":""}var He=Ty.prototype;He.add=uAe;He.calendar=vAe;He.clone=yAe;He.diff=EAe;He.endOf=NAe;He.format=OAe;He.from=_Ae;He.fromNow=MAe;He.to=DAe;He.toNow=PAe;He.get=kRe;He.invalidAt=UAe;He.isAfter=xAe;He.isBefore=wAe;He.isBetween=bAe;He.isSame=SAe;He.isSameOrAfter=CAe;He.isSameOrBefore=TAe;He.isValid=WAe;He.lang=AK;He.locale=RK;He.localeData=kK;He.max=W2e;He.min=j2e;He.parsingFlags=zAe;He.set=ORe;He.startOf=IAe;He.subtract=fAe;He.toArray=BAe;He.toObject=VAe;He.toDate=HAe;He.toISOString=AAe;He.inspect=kAe;typeof Symbol<"u"&&Symbol.for!=null&&(He[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});He.toJSON=jAe;He.toString=RAe;He.unix=FAe;He.valueOf=LAe;He.creationData=$Ae;He.eraName=KAe;He.eraNarrow=XAe;He.eraAbbr=QAe;He.eraYear=ZAe;He.year=iK;He.isLeapYear=ARe;He.weekYear=ske;He.isoWeekYear=oke;He.quarter=He.quarters=hke;He.month=cK;He.daysInMonth=HRe;He.week=He.weeks=GRe;He.isoWeek=He.isoWeeks=YRe;He.weeksInYear=cke;He.weeksInWeekYear=uke;He.isoWeeksInYear=ake;He.isoWeeksInISOWeekYear=lke;He.date=PK;He.day=He.days=o2e;He.weekday=a2e;He.isoWeekday=l2e;He.dayOfYear=dke;He.hour=He.hours=m2e;He.minute=He.minutes=pke;He.second=He.seconds=mke;He.millisecond=He.milliseconds=IK;He.utcOffset=Q2e;He.utc=J2e;He.local=eAe;He.parseZone=tAe;He.hasAlignedHourOffset=rAe;He.isDST=nAe;He.isLocal=sAe;He.isUtcOffset=oAe;He.isUtc=SK;He.isUTC=SK;He.zoneAbbr=vke;He.zoneName=yke;He.dates=da("dates accessor is deprecated. Use date instead.",PK);He.months=da("months accessor is deprecated. Use month instead",cK);He.years=da("years accessor is deprecated. Use year instead",iK);He.zone=da("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Z2e);He.isDSTShifted=da("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",iAe);function xke(t){return tn(t*1e3)}function wke(){return tn.apply(null,arguments).parseZone()}function NK(t){return t}var dr=tI.prototype;dr.calendar=sRe;dr.longDateFormat=cRe;dr.invalidDate=fRe;dr.ordinal=pRe;dr.preparse=NK;dr.postformat=NK;dr.relativeTime=gRe;dr.pastFuture=vRe;dr.set=nRe;dr.eras=GAe;dr.erasParse=YAe;dr.erasConvertYear=qAe;dr.erasAbbrRegex=eke;dr.erasNameRegex=JAe;dr.erasNarrowRegex=tke;dr.months=IRe;dr.monthsShort=NRe;dr.monthsParse=FRe;dr.monthsRegex=VRe;dr.monthsShortRegex=BRe;dr.week=WRe;dr.firstDayOfYear=$Re;dr.firstDayOfWeek=URe;dr.weekdays=t2e;dr.weekdaysMin=n2e;dr.weekdaysShort=r2e;dr.weekdaysParse=s2e;dr.weekdaysRegex=c2e;dr.weekdaysShortRegex=u2e;dr.weekdaysMinRegex=f2e;dr.isPM=d2e;dr.meridiem=g2e;function Pb(t,e,r,n){var i=Vc(),s=Wl().set(n,e);return i[r](s,t)}function LK(t,e,r){if(Nc(t)&&(e=t,t=void 0),t=t||"",e!=null)return Pb(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Pb(t,n,r,"month");return i}function xI(t,e,r,n){typeof t=="boolean"?(Nc(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Nc(e)&&(r=e,e=void 0),e=e||"");var i=Vc(),s=t?i._week.dow:0,o,a=[];if(r!=null)return Pb(e,(r+s)%7,n,"day");for(o=0;o<7;o++)a[o]=Pb(e,(o+s)%7,n,"day");return a}function bke(t,e){return LK(t,e,"months")}function Ske(t,e){return LK(t,e,"monthsShort")}function Cke(t,e,r){return xI(t,e,r,"weekdays")}function Tke(t,e,r){return xI(t,e,r,"weekdaysShort")}function Eke(t,e,r){return xI(t,e,r,"weekdaysMin")}Fu("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=Xt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});Ye.lang=da("moment.lang is deprecated. Use moment.locale instead.",Fu);Ye.langData=da("moment.langData is deprecated. Use moment.localeData instead.",Vc);var cc=Math.abs;function Rke(){var t=this._data;return this._milliseconds=cc(this._milliseconds),this._days=cc(this._days),this._months=cc(this._months),t.milliseconds=cc(t.milliseconds),t.seconds=cc(t.seconds),t.minutes=cc(t.minutes),t.hours=cc(t.hours),t.months=cc(t.months),t.years=cc(t.years),this}function FK(t,e,r,n){var i=qa(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function Ake(t,e){return FK(this,t,e,1)}function kke(t,e){return FK(this,t,e,-1)}function w9(t){return t<0?Math.floor(t):Math.ceil(t)}function Oke(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,o,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=w9(O_(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Go(t/1e3),n.seconds=i%60,s=Go(i/60),n.minutes=s%60,o=Go(s/60),n.hours=o%24,e+=Go(o/24),l=Go(HK(e)),r+=l,e-=w9(O_(l)),a=Go(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function HK(t){return t*4800/146097}function O_(t){return t*146097/4800}function _ke(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=pa(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+HK(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(O_(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function jc(t){return function(){return this.as(t)}}var BK=jc("ms"),Mke=jc("s"),Dke=jc("m"),Pke=jc("h"),Ike=jc("d"),Nke=jc("w"),Lke=jc("M"),Fke=jc("Q"),Hke=jc("y"),Bke=BK;function Vke(){return qa(this)}function jke(t){return t=pa(t),this.isValid()?this[t+"s"]():NaN}function qh(t){return function(){return this.isValid()?this._data[t]:NaN}}var Wke=qh("milliseconds"),zke=qh("seconds"),Uke=qh("minutes"),$ke=qh("hours"),Gke=qh("days"),Yke=qh("months"),qke=qh("years");function Kke(){return Go(this.days()/7)}var vc=Math.round,cp={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Xke(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function Qke(t,e,r,n){var i=qa(t).abs(),s=vc(i.as("s")),o=vc(i.as("m")),a=vc(i.as("h")),l=vc(i.as("d")),u=vc(i.as("M")),h=vc(i.as("w")),d=vc(i.as("y")),m=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(m=m||h<=1&&["w"]||h<r.w&&["ww",h]),m=m||u<=1&&["M"]||u<r.M&&["MM",u]||d<=1&&["y"]||["yy",d],m[2]=e,m[3]=+t>0,m[4]=n,Xke.apply(null,m)}function Zke(t){return t===void 0?vc:typeof t=="function"?(vc=t,!0):!1}function Jke(t,e){return cp[t]===void 0?!1:e===void 0?cp[t]:(cp[t]=e,t==="s"&&(cp.ss=e-1),!0)}function eOe(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=cp,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},cp,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=Qke(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var QA=Math.abs;function Fd(t){return(t>0)-(t<0)||+t}function tC(){if(!this.isValid())return this.localeData().invalidDate();var t=QA(this._milliseconds)/1e3,e=QA(this._days),r=QA(this._months),n,i,s,o,a=this.asSeconds(),l,u,h,d;return a?(n=Go(t/60),i=Go(n/60),t%=60,n%=60,s=Go(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Fd(this._months)!==Fd(a)?"-":"",h=Fd(this._days)!==Fd(a)?"-":"",d=Fd(this._milliseconds)!==Fd(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(r?u+r+"M":"")+(e?h+e+"D":"")+(i||n||t?"T":"")+(i?d+i+"H":"")+(n?d+n+"M":"")+(t?d+o+"S":"")):"P0D"}var or=JS.prototype;or.isValid=Y2e;or.abs=Rke;or.add=Ake;or.subtract=kke;or.as=_ke;or.asMilliseconds=BK;or.asSeconds=Mke;or.asMinutes=Dke;or.asHours=Pke;or.asDays=Ike;or.asWeeks=Nke;or.asMonths=Lke;or.asQuarters=Fke;or.asYears=Hke;or.valueOf=Bke;or._bubble=Oke;or.clone=Vke;or.get=jke;or.milliseconds=Wke;or.seconds=zke;or.minutes=Uke;or.hours=$ke;or.days=Gke;or.weeks=Kke;or.months=Yke;or.years=qke;or.humanize=eOe;or.toISOString=tC;or.toString=tC;or.toJSON=tC;or.locale=RK;or.localeData=kK;or.toIsoString=da("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",tC);or.lang=AK;lt("X",0,0,"unix");lt("x",0,0,"valueOf");Ze("x",KS);Ze("X",bRe);kr("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});kr("x",function(t,e,r){r._d=new Date(Xt(t))});//! moment.js
Ye.version="2.30.1";tRe(tn);Ye.fn=He;Ye.min=z2e;Ye.max=U2e;Ye.now=$2e;Ye.utc=Wl;Ye.unix=xke;Ye.months=bke;Ye.isDate=Cy;Ye.locale=Fu;Ye.invalid=$S;Ye.duration=qa;Ye.isMoment=Wa;Ye.weekdays=Cke;Ye.parseZone=wke;Ye.localeData=Vc;Ye.isDuration=jw;Ye.monthsShort=Ske;Ye.weekdaysMin=Eke;Ye.defineLocale=fI;Ye.updateLocale=w2e;Ye.locales=b2e;Ye.weekdaysShort=Tke;Ye.normalizeUnits=pa;Ye.relativeTimeRounding=Zke;Ye.relativeTimeThreshold=Jke;Ye.calendarFormat=gAe;Ye.prototype=He;Ye.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function tOe(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function b9(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function ZA(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function rC(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function VK(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function Sh(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function Bt(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function S9(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return Bt(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function C9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function mo(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return rC(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return s+l+u},"").trim()}function Hg(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Jt(t){return typeof t<"u"}function Hs(t){return typeof t>"u"}function zp(t){return t===null||t===""||Hs(t)}function rOe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const fg="length",Bg=t=>parseInt(t,16),T9=t=>parseInt(t,10),Ib=(t,e,r)=>t.substr(e,r),Vg=t=>t.codePointAt(0)-65,__=t=>`${t}`.replace(/\-/g,""),nOe=t=>Bg(Ib(__(t),Bg("12"),Vg("F")))/(Bg(Ib(__(t),Vg("B"),~~![][fg]))||9),iOe=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let E9=!1;const R9={invalid:()=>mo`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return mo`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>mo`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},A9={invalid:()=>mo`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return mo`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>mo`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function sOe(t,e){const r=!zp(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let s,o="invalid",a="invalid";t=__(t||"");const l=oOe(t);if(r||n||l)if(l){const u=Ye("29/04/2025","DD/MM/YYYY"),h=Math.floor(u.toDate().getTime()/864e5),d=nOe(t);s=Ye((d+1)*864e5,"x").format("MMMM DD, YYYY"),h>d?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(iOe()&&(o="valid",a="valid"),!E9&&o!=="valid"&&(R9[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](R9[o]({keyValidityDate:s,hotVersion:i})),E9=!0),a!=="valid"&&e.parentNode&&A9[a]({keyValidityDate:s,hotVersion:i})){const h=document.createElement("div");h.className="handsontable hot-display-license-info",h.innerHTML=A9[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(h,e.nextSibling)}}function oOe(t){let e=[][fg],r=e;if(t[fg]!==Vg("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=Vg(i.shift());s;s=Vg(i.shift()||"A"))--s<""[fg]?r=r|(T9(`${T9(Bg(n)+(Bg(Ib(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Ib(t,s,s?i[fg]===1?9:8:6);return r===e}function wI(t){return t[0].toUpperCase()+t.substr(1)}function jK(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function aOe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function lOe(t,e){return eRe.sanitize(t,e)}const Ay=t=>["tabindex",t],cOe=()=>["role","treegrid"],Mu=()=>["role","presentation"],uOe=()=>["role","gridcell"],fOe=()=>["role","rowheader"],WK=()=>["role","rowgroup"],hOe=()=>["role","columnheader"],M_=()=>["role","row"],dOe=()=>["scope","col"],pOe=()=>["scope","row"],mOe=t=>["aria-label",t],gOe=()=>["aria-multiselectable","true"],zK=t=>["aria-rowcount",t],nC=t=>["aria-colcount",t],UK=t=>["aria-rowindex",t],bI=t=>["aria-colindex",t],k9=()=>["aria-readonly","true"],O9=()=>["aria-invalid","true"],$K=()=>["aria-selected","true"];function vOe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function yOe(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function xOe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Nb(t){return xOe(t)&&t.parent}function GK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function A1(t,e,r){const n=[];let i=t;for(;i&&(i=GK(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function wOe(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function D_(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function bOe(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Af(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function YK(t){return!t||!t.length?[]:t.filter(e=>!!e)}function qK(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function Nr(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function $t(t,e){typeof e=="string"&&(e=e.split(" ")),e=YK(e),e.length>0&&t.classList.add(...e)}function Jr(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=qK(e,!0);r=YK(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function cn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function ky(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=qK(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function KK(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)KK(e[r])}}function Ev(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const SOe=/(<(.*)>|&(.*);)/;function COe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;SOe.test(e)?t.innerHTML=r?lOe(e):e:Oy(t,e)}function Oy(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Ev(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Rv(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Rv(n.host.impl);if(n.host)return Rv(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function TOe(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function qo(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function XK(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function SI(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function CI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?XK(e):t.scrollTop}function QK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?SI(e):t.scrollLeft}function Lb(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function EOe(t){return t.scrollHeight-t.clientHeight}function ROe(t){return t.scrollWidth-t.clientWidth}function Fb(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function _9(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Bs(t){return t.offsetWidth}function go(t){return t.offsetHeight}function jg(t){return t.clientHeight||t.innerHeight}function ZK(t){return t.clientWidth||t.innerWidth}function AOe(t){return t.selectionStart?t.selectionStart:0}function M9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function JK(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let JA;function kOe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function $s(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return JA===void 0&&(JA=kOe(t)),JA}function OOe(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function _Oe(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function TI(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function iC(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function zw(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function eX(t){return zw(t)&&t.hasAttribute("data-hot-input")===!1}function MOe(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function sC(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Rr(t){return typeof t=="function"}function DOe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function POe(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function P_(t,e,r,n,i,s,o,a){return Jt(a)?t.call(e,r,n,i,s,o,a):Jt(o)?t.call(e,r,n,i,s,o):Jt(s)?t.call(e,r,n,i,s):Jt(i)?t.call(e,r,n,i):Jt(n)?t.call(e,r,n):Jt(r)?t.call(e,r):t.call(e)}var D9={},ek,P9;function IOe(){if(P9)return ek;P9=1;var t=Vn(),e=Aq(),r=ni(),n=jh(),i=US(),s=t([].push);return ek=function(o){if(r(o))return o;if(e(o)){for(var a=o.length,l=[],u=0;u<a;u++){var h=o[u];typeof h=="string"?s(l,h):(typeof h=="number"||n(h)==="Number"||n(h)==="String")&&s(l,i(h))}var d=l.length,m=!0;return function(g,y){if(m)return m=!1,y;if(e(this))return y;for(var x=0;x<d;x++)if(l[x]===g)return y}}},ek}var I9;function NOe(){if(I9)return D9;I9=1;var t=Yr(),e=u0(),r=wy(),n=Ti(),i=Vn(),s=ri(),o=ni(),a=jP(),l=QP(),u=IOe(),h=VP(),d=String,m=e("JSON","stringify"),g=i(/./.exec),y=i("".charAt),x=i("".charCodeAt),b=i("".replace),C=i(1.1.toString),E=/[\uD800-\uDFFF]/g,R=/^[\uD800-\uDBFF]$/,k=/^[\uDC00-\uDFFF]$/,O=!h||s(function(){var N=e("Symbol")("stringify detection");return m([N])!=="[null]"||m({a:N})!=="{}"||m(Object(N))!=="{}"}),P=s(function(){return m("\uDF06\uD834")!=='"\\udf06\\ud834"'||m("\uDEAD")!=='"\\udead"'}),D=function(N,_){var B=l(arguments),j=u(_);if(!(!o(j)&&(N===void 0||a(N))))return B[1]=function(ee,oe){if(o(j)&&(oe=n(j,this,d(ee),oe)),!a(oe))return oe},r(m,null,B)},H=function(N,_,B){var j=y(B,_-1),ee=y(B,_+1);return g(R,N)&&!g(k,ee)||g(k,N)&&!g(R,j)?"\\u"+C(x(N,0),16):N};return m&&t({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(_,B,j){var ee=l(arguments),oe=r(O?D:m,null,ee);return P&&typeof oe=="string"?b(oe,E,H):oe}}),D9}NOe();function Av(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},fn(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Av(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Av(r[0])]:e[n]=[]:e[n]=null)})),e}function LOe(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Up(t,e,r){const n=Array.isArray(r);return fn(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function tX(t,e){fn(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),tX(t[n],e[n])):t[n]=e[n]})}function Gu(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function jn(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Bt(r,i=>{t.MIXINS.push(i.MIXIN_NAME),fn(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(h,d){const m=`_${h}`,g=y=>{let x=y;return(Array.isArray(x)||Fl(x))&&(x=Gu(x)),x};return function(){return this[m]===void 0&&(this[m]=g(d)),this[m]}},l=function(h){const d=`_${h}`;return function(m){this[d]=m}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function rX(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Fl(t){return Object.prototype.toString.call(t)==="[object Object]"}function sf(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function fn(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function FOe(t,e){const r=e.split(".");let n=t;return fn(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function tk(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==n.length-1?(Ch(i,s)||(i[s]={}),i=i[s]):i[s]=r)})}function EI(t){if(!Fl(t))return 0;const e=function(r){let n=0;return Fl(r)?fn(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function uo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Ch(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function N9(t){return window.requestAnimationFrame(t)}function HOe(){return"ontouchstart"in window}function BOe(){return typeof window<"u"}const zo=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Kh={chrome:zo((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:zo(t=>/CriOS/.test(t)),edge:zo(t=>/Edge/.test(t)),edgeWebKit:zo(t=>/EdgiOS/.test(t)),firefox:zo(t=>/Firefox/.test(t)),firefoxWebKit:zo(t=>/FxiOS/.test(t)),mobile:zo(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:zo((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},oC={mac:zo(t=>/^Mac/.test(t)),win:zo(t=>/^Win/.test(t)),linux:zo(t=>/^Linux/.test(t)),ios:zo(t=>/iPhone|iPad|iPod/i.test(t))};function VOe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};fn(Kh,r=>{let{test:n}=r;return void n(t,e)})}function jOe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};fn(oC,e=>{let{test:r}=e;return void r(t)})}BOe()&&(VOe(),jOe());function WOe(){return Kh.chrome.value}function zOe(){return Kh.chromeWebKit.value}function rk(){return Kh.firefox.value}function UOe(){return Kh.firefoxWebKit.value}function $Oe(){return Kh.edge.value}function up(){return Kh.mobile.value}function nX(){return oC.ios.value}function GOe(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&oC.mac.value}function L9(){return oC.mac.value}const dt={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:rk()?182:174,AUDIO_MUTE:rk()?181:173,AUDIO_UP:rk()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},YOe=[dt.ALT,dt.ARROW_DOWN,dt.ARROW_LEFT,dt.ARROW_RIGHT,dt.ARROW_UP,dt.AUDIO_DOWN,dt.AUDIO_MUTE,dt.AUDIO_UP,dt.BACKSPACE,dt.CAPS_LOCK,dt.DELETE,dt.END,dt.ENTER,dt.ESCAPE,dt.F1,dt.F2,dt.F3,dt.F4,dt.F5,dt.F6,dt.F7,dt.F8,dt.F9,dt.F10,dt.F11,dt.F12,dt.F13,dt.F14,dt.F15,dt.F16,dt.F17,dt.F18,dt.F19,dt.HOME,dt.INSERT,dt.MEDIA_NEXT,dt.MEDIA_PLAY_PAUSE,dt.MEDIA_PREV,dt.MEDIA_STOP,dt.NULL,dt.NUM_LOCK,dt.PAGE_DOWN,dt.PAGE_UP,dt.PAUSE,dt.SCROLL_LOCK,dt.SHIFT,dt.TAB];function qOe(t){return YOe.includes(t)}function KOe(t){return[dt.CONTROL,dt.COMMAND_LEFT,dt.COMMAND_RIGHT,dt.COMMAND_FIREFOX].includes(t)}function XOe(t,e){const r=e.split("|");let n=!1;return Bt(r,i=>{if(t===dt[i])return n=!0,!1}),n}function aC(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Yf(t){return t.isImmediatePropagationEnabled===!1}function I_(t){return t.button===2}function iX(t){return t.button===0}function Yu(){Jt(console)&&console.warn(...arguments)}function QOe(){Jt(console)&&console.error(...arguments)}const qf=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],nk=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),ik=new Map([[]]);var F9={},sk,H9;function ZOe(){if(H9)return sk;H9=1;var t=d0();return sk=function(e,r,n){for(var i=0,s=arguments.length>2?n:t(r),o=new e(s);s>i;)o[i]=r[i++];return o},sk}var ok,B9;function JOe(){if(B9)return ok;B9=1;var t=Bn();return ok=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},ok}var ak,V9;function RI(){if(V9)return ak;V9=1;var t=Ya(),e=XP(),r=rf().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),ak=function(s){i[n][s]=!0},ak}var j9;function e_e(){if(j9)return F9;j9=1;var t=Yr(),e=Vn(),r=xo(),n=gy(),i=ZOe(),s=JOe(),o=RI(),a=Array,l=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(h){h!==void 0&&r(h);var d=n(this),m=i(a,d);return l(m,h)}}),o("toSorted"),F9}e_e();var W9={},z9={},U9;function t_e(){if(U9)return z9;U9=1;var t=Yr(),e=Ti(),r=p0(),n=xo(),i=Ei(),s=nf(),o=wo(),a=Yh(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(h){i(this);try{n(h)}catch(g){o(this,"throw",g)}if(l)return e(l,this,h);var d=s(this),m=0;return r(d,function(g,y){if(h(g,m++))return y(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),z9}var $9;function r_e(){return $9||($9=1,t_e()),W9}r_e();function n_e(t,e){sX(t,e),e.add(t)}function lk(t,e,r){sX(t,e),e.set(t,r)}function sX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G9(t,e,r){return t.set(Hb(t,e),r),r}function Mi(t,e){return t.get(Hb(t,e))}function Hb(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const i_e=100;var so=new WeakMap,Jd=new WeakMap,ck=new WeakMap,uk=new WeakSet;class Y9{constructor(){n_e(this,uk),lk(this,so,new Map),lk(this,Jd,new Map),lk(this,ck,new Set),qf.forEach(e=>Hb(uk,this,q9).call(this,e))}getHooks(e){var r;return(r=Mi(so,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Mi(so,this).has(e)||(Hb(uk,this,q9).call(this,e),qf.push(e));const i=Mi(so,this).get(e);if(i.find(u=>u.callback===r))return;const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,o=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(h=>h.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let u=Mi(ck,this).has(e);!u&&s!==0&&(u=!0,Mi(ck,this).add(e)),u&&i.length>1&&Mi(so,this).set(e,i.toSorted((h,d)=>h.orderIndex-d.orderIndex))}}has(e){return Mi(so,this).has(e)&&Mi(so,this).get(e).length>0}remove(e,r){if(!Mi(so,this).has(e))return!1;const n=Mi(so,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=Mi(Jd,this).get(e);return i.skip=!0,s+=1,s>i_e&&(Mi(so,this).set(e,n.filter(o=>!o.skip)),s=0),Mi(Jd,this).set(e,s),!0}return!1}destroy(){Mi(so,this).clear(),Mi(Jd,this).clear(),G9(so,this,null),G9(Jd,this,null)}}function q9(t){Mi(so,this).set(t,[]),Mi(Jd,this).set(t,0)}function s_e(t,e,r){return(e=o_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o_e(t){var e=a_e(t,"string");return typeof e=="symbol"?e:e+""}function a_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const l_e=mo`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class yi{constructor(){s_e(this,"globalBucket",new Y9)}static getSingleton(){return u_e()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Y9),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Bt(r,s=>this.add(e,s,n)):(nk.has(e)&&Yu(aOe(l_e,{hookName:e,removedInVersion:nk.get(e)})),ik.has(e)&&Yu(ik.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Bt(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?Bt(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,o,a,l){{const u=this.getBucket().getHooks(r),h=u?u.length:0;let d=0;if(h)for(;d<h;){if(!u[d]||u[d].skip){d+=1;continue}const m=P_(u[d].callback,e,n,i,s,o,a,l);m!==void 0&&(n=m),u[d]&&u[d].runOnce&&this.remove(r,u[d].callback),d+=1}}{const u=this.getBucket(e).getHooks(r),h=u?u.length:0;let d=0;if(h)for(;d<h;){if(!u[d]||u[d].skip){d+=1;continue}const m=P_(u[d].callback,e,n,i,s,o,a,l);m!==void 0&&(n=m),u[d]&&u[d].runOnce&&this.remove(r,u[d].callback,e),d+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||qf.push(e)}deregister(e){this.isRegistered(e)&&qf.splice(qf.indexOf(e),1)}isDeprecated(e){return ik.has(e)||nk.has(e)}isRegistered(e){return qf.indexOf(e)>=0}getRegistered(){return qf}}const c_e=new yi;function u_e(){return c_e}const fk=new Map;function y0(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";fk.has(t)||fk.set(t,new Map);const e=fk.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o}}const N_=new WeakMap,{register:f_e,getItem:oX,hasItem:h_e}=y0("editors");function d_e(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},yi.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function p_e(t,e){let r;if(typeof t=="function")N_.get(t)||aX(null,t),r=N_.get(t);else if(typeof t=="string")r=oX(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function L_(t){if(typeof t=="function")return t;if(!h_e(t))throw Error(`No registered editor found under "${t}" name`);return oX(t).getConstructor()}function aX(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new d_e(e);typeof t=="string"&&f_e(t,r),N_.set(e,r)}function m_e(t,e,r){return(e=g_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g_e(t){var e=v_e(t,"string");return typeof e=="symbol"?e:e+""}function v_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $p{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;m_e(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,y_e(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function y_e(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),aC(this)},t}function x_e(t,e){w_e(t,e),e.add(t)}function w_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kf(t,e,r){return(e=b_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b_e(t){var e=S_e(t,"string");return typeof e=="symbol"?e:e+""}function S_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var k1=new WeakSet;class F_{constructor(e,r,n){x_e(this,k1),kf(this,"hot",void 0),kf(this,"tableMeta",void 0),kf(this,"selection",void 0),kf(this,"eventManager",void 0),kf(this,"destroyed",!1),kf(this,"activeEditor",void 0),kf(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new $p(e),this.hot.addHook("afterDocumentKeyDown",i=>hk(k1,this,K9).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>hk(k1,this,K9).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>hk(k1,this,C_e).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),h=this.hot.colToProp(a),d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=p_e(u,this.hot),this.activeEditor.prepare(n,i,h,l,d,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function K9(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Yf(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!qOe(r)&&!KOe(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function C_e(t,e){e.isCell()&&this.openEditor(null,t,!0)}const X9=new WeakMap;F_.getInstance=function(t,e,r){let n=X9.get(t);return n||(n=new F_(t,e,r),X9.set(t,n)),n};function T_e(t,e){lX(t,e),e.add(t)}function Pm(t,e,r){lX(t,e),e.set(t,r)}function lX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wr(t,e){return t.get(xc(t,e))}function Im(t,e,r){return t.set(xc(t,e),r),r}function xc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Cp=Object.freeze({CELL:"cell",MIXED:"mixed"});var Xn=new WeakMap,O1=new WeakMap,_1=new WeakMap,M1=new WeakMap,D1=new WeakMap,bu=new WeakSet;class E_e{constructor(e){var r=this;T_e(this,bu),Pm(this,Xn,void 0),Pm(this,O1,void 0),Pm(this,_1,1),Pm(this,M1,null),Pm(this,D1,new Map);const n=e.getSettings();Im(Xn,this,e),Im(O1,this,n.imeFastEdit?Cp.MIXED:Cp.CELL),Wr(Xn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return xc(bu,r,A_e).call(r,...s)}),Wr(Xn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return xc(bu,r,Q9).call(r,...s)}),Wr(Xn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return xc(bu,r,Q9).call(r,...s)}),Wr(Xn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return xc(bu,r,R_e).call(r,...s)})}getFocusMode(){return Wr(O1,this)}setFocusMode(e){Object.values(Cp).includes(e)?Im(O1,this,e):Yu(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Wr(_1,this)}setRefocusDelay(e){Im(_1,this,e)}setRefocusElementGetter(e){Im(M1,this,e)}getRefocusElement(){var e;return typeof Wr(M1,this)=="function"?Wr(M1,this).call(this):(e=Wr(Xn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const o=(i=Wr(Xn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=Wr(Xn,this).runHooks("modifyFocusedElement",o.row,o.col,n);sC(a)||(a=n),a&&!((s=Wr(Xn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):xc(bu,this,AI).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wr(_1,this);if(Wr(Xn,this).getSettings().imeFastEdit&&!((e=Wr(Xn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Wr(Xn,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Wr(D1,this).has(r)||Wr(D1,this).set(r,DOe(()=>{if(!Wr(Xn,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),Wr(D1,this).get(r)()}}}function AI(t){var e;const r=(e=Wr(Xn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!Wr(Xn,this).selection.isCellVisible(r)){t(null);return}const n=Wr(Xn,this).getCell(r.row,r.col,!0);n===null?Wr(Xn,this).addHookOnce("afterScroll",()=>{t(Wr(Xn,this).getCell(r.row,r.col,!0))}):t(n)}function Q9(){xc(bu,this,AI).call(this,t=>{const{activeElement:e}=Wr(Xn,this).rootDocument;e&&eX(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function R_e(){xc(bu,this,AI).call(this,t=>{this.getFocusMode()===Cp.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function A_e(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Cp.MIXED:Cp.CELL)}var Z9={},dk,J9;function k_e(){if(J9)return dk;J9=1;var t=fa(),e=jh(),r=Ya(),n=r("match");return dk=function(i){var s;return t(i)&&((s=i[n])!==void 0?!!s:e(i)==="RegExp")},dk}var pk,ej;function O_e(){if(ej)return pk;ej=1;var t=Bn(),e=ri(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var s={},o="",a=i?"dgimsy":"gimsy",l=function(m,g){Object.defineProperty(s,m,{get:function(){return o+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var h in u)l(h,u[h]);var d=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(s);return d!==a||o!==a});return pk={correct:n},pk}var mk,tj;function __e(){if(tj)return mk;tj=1;var t=Ei();return mk=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},mk}var gk,rj;function M_e(){if(rj)return gk;rj=1;var t=Ti(),e=ha(),r=vy(),n=O_e(),i=__e(),s=RegExp.prototype;return gk=n.correct?function(o){return o.flags}:function(o){return!n.correct&&r(s,o)&&!e(o,"flags")?t(i,o):o.flags},gk}var vk,nj;function D_e(){if(nj)return vk;nj=1;var t=Vn(),e=f0(),r=Math.floor,n=t("".charAt),i=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return vk=function(l,u,h,d,m,g){var y=h+l.length,x=d.length,b=a;return m!==void 0&&(m=e(m),b=o),i(g,b,function(C,E){var R;switch(n(E,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,h);case"'":return s(u,y);case"<":R=m[s(E,1,-1)];break;default:var k=+E;if(k===0)return C;if(k>x){var O=r(k/10);return O===0?C:O<=x?d[O-1]===void 0?n(E,1):d[O-1]+n(E,1):C}R=d[k-1]}return R===void 0?"":R})},vk}var ij;function P_e(){if(ij)return Z9;ij=1;var t=Yr(),e=Ti(),r=Vn(),n=my(),i=ni(),s=fa(),o=k_e(),a=US(),l=yy(),u=M_e(),h=D_e(),d=Ya(),m=Wh(),g=d("replace"),y=TypeError,x=r("".indexOf),b=r("".replace),C=r("".slice),E=Math.max;return t({target:"String",proto:!0},{replaceAll:function(k,O){var P=n(this),D,H,N,_,B,j,ee,oe,re,q,Z=0,ve="";if(s(k)){if(D=o(k),D&&(H=a(n(u(k))),!~x(H,"g")))throw new y("`.replaceAll` does not allow non-global regexes");if(N=l(k,g),N)return e(N,k,P,O);if(m&&D)return b(a(P),k,O)}for(_=a(P),B=a(k),j=i(O),j||(O=a(O)),ee=B.length,oe=E(1,ee),re=x(_,B);re!==-1;)q=j?a(O(B,re,_)):h(B,_,re,[],void 0,O),ve+=C(_,Z,re)+q,Z=re+ee,re=re+oe>_.length?-1:x(_,B,re+oe);return Z<_.length&&(ve+=C(_,Z)),ve}}),Z9}P_e();var sj={},oj={},aj;function I_e(){if(aj)return oj;aj=1;var t=Yr(),e=p0(),r=xo(),n=Ei(),i=nf(),s=wo(),o=Yh(),a=wy(),l=ri(),u=TypeError,h=l(function(){[].keys().reduce(function(){},void 0)}),d=!h&&o("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:h||d},{reduce:function(g){n(this);try{r(g)}catch(E){s(this,"throw",E)}var y=arguments.length<2,x=y?void 0:arguments[1];if(d)return a(d,this,y?[g]:[g,x]);var b=i(this),C=0;if(e(b,function(E){y?(y=!1,x=E):x=g(x,E,C),C++},{IS_RECORD:!0}),y)throw new u("Reduce of empty iterator with no initial value");return x}}),oj}var lj;function N_e(){return lj||(lj=1,I_e()),sj}N_e();const L_e={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"};new RegExp(Object.keys(L_e).map(t=>`(${t})`).join("|"),"gi");function cj(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],h=r?1:0,d=e?1:0;for(let m=0;m<s;m+=1){const g=e&&m===0,y=[];for(let b=0;b<o;b+=1){const C=!g&&r&&b===0;let E="";if(g)E=`<th>${t.getColHeader(b-h)}</th>`;else if(C)E=`<th>${t.getRowHeader(m-d)}</th>`;else{const R=i[m][b],{hidden:k,rowspan:O,colspan:P}=t.getCellMeta(m-d,b-h);if(!k){const D=[];if(O&&D.push(`rowspan="${O}"`),P&&D.push(`colspan="${P}"`),zp(R))E=`<td ${D.join(" ")}></td>`;else{const H=R.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");E=`<td ${D.join(" ")}>${H}</td>`}}}y.push(E)}const x=["<tr>",...y,"</tr>"].join("");g?l.splice(1,0,x):u.splice(-1,0,x)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function cX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function F_e(t){return cX(t,[","])}function Ko(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function uj(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function wn(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const H_="asc",H_e="desc",fj=new Map([[H_,[-1,1]],[H_e,[1,-1]]]),B_e=t=>`The priority '${t}' is already declared in a map.`,V_e=t=>`The priority '${t}' is not a number.`;function j_e(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Rr(t)?t:B_e,e=Rr(e)?e:V_e;function n(s,o){if(!cX(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H_;const[o,a]=fj.get(s)||fj.get(H_);return[...r].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}const W_e=t=>`The id '${t}' is already declared in a map.`;function lC(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Rr(t)?t:W_e;function r(u,h){if(l(u))throw new Error(t(u));e.set(u,h)}function n(u){return e.delete(u)}function i(){e.clear()}function s(u){const[h]=a().find(d=>{let[m,g]=d;return u===g?m:!1})||[null];return h}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:n}}const z_e=t=>`'${t}' value is already declared in a unique set.`;function U_e(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Rr(t)?t:z_e;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const uX=t=>`There is already registered "${t}" plugin.`,$_e=t=>`There is already registered plugin on priority "${t}".`,G_e=t=>`The priority "${t}" is not a number.`,Y_e=j_e({errorPriorityExists:$_e,errorPriorityNaN:G_e}),q_e=U_e({errorItemExists:uX}),K_e=lC({errorIdExists:uX});function X_e(){return[...Y_e.getItems(),...q_e.getItems()]}function Q_e(t){const e=wI(t);return K_e.getItem(e)}const{register:Z_e,getItem:J_e,hasItem:eMe}=y0("renderers");function B_(t){if(typeof t=="function")return t;if(!eMe(t))throw Error(`No registered renderer found under "${t}" name`);return J_e(t)}function tMe(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Z_e(t,e)}const{register:rMe,getItem:nMe,hasItem:iMe}=y0("validators");function sMe(t){if(typeof t=="function")return t;if(!iMe(t))throw Error(`No registered validator found under "${t}" name`);return nMe(t)}function oMe(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),rMe(t,e)}var hj={},dj;function aMe(){if(dj)return hj;dj=1;var t=Yr(),e=f0(),r=d0(),n=xy(),i=RI();return t({target:"Array",proto:!0},{at:function(o){var a=e(this),l=r(a),u=n(o),h=u>=0?u:l+u;return h<0||h>=l?void 0:a[h]}}),i("at"),hj}aMe();var pj={},mj;function lMe(){if(mj)return pj;mj=1;var t=Yr(),e=Vn(),r=my(),n=xy(),i=US(),s=ri(),o=e("".charAt),a=s(function(){return"".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var h=i(r(this)),d=h.length,m=n(u),g=m>=0?m:d+m;return g<0||g>=d?void 0:o(h,g)}}),pj}lMe();function Nm(t,e,r){return(e=cMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cMe(t){var e=uMe(t,"string");return typeof e=="symbol"?e:e+""}function uMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fMe{constructor(){Nm(this,"count",0),Nm(this,"startColumn",null),Nm(this,"endColumn",null),Nm(this,"startPosition",null),Nm(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=u[this.endColumn]+h-u[this.startColumn-1];if(y<=i&&(this.startColumn-=1),y>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const d=o>0?i+1:i,m=n+i-d,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);m<-1*s||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Lm(t,e,r){return(e=hMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hMe(t){var e=dMe(t,"string");return typeof e=="symbol"?e:e+""}function dMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pMe{constructor(){Lm(this,"count",0),Lm(this,"startRow",null),Lm(this,"endRow",null),Lm(this,"startPosition",null),Lm(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const m=l[this.endRow]+u-l[this.startRow-1];if(m<=i-s&&(this.startRow-=1),m>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const h=n+i-s,d=this.startRow===null?0:e.getRowHeight(this.startRow);h<d||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Fm(t,e,r){return(e=mMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mMe(t){var e=gMe(t,"string");return typeof e=="symbol"?e:e+""}function gMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fX{constructor(){Fm(this,"count",0),Fm(this,"startColumn",null),Fm(this,"endColumn",null),Fm(this,"startPosition",null),Fm(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+h-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const d=o>0?i+1:i;n+i-d<-1*s||n>u.at(-1)+h||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Hm(t,e,r){return(e=vMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vMe(t){var e=yMe(t,"string");return typeof e=="symbol"?e:e+""}function yMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hX{constructor(){Hm(this,"count",0),Hm(this,"startRow",null),Hm(this,"endRow",null),Hm(this,"startPosition",null),Hm(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,d>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Bm(t,e,r){return(e=xMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xMe(t){var e=wMe(t,"string");return typeof e=="symbol"?e:e+""}function wMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bMe{constructor(){Bm(this,"count",0),Bm(this,"startColumn",0),Bm(this,"endColumn",0),Bm(this,"startPosition",0),Bm(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Vm(t,e,r){return(e=SMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SMe(t){var e=CMe(t,"string");return typeof e=="symbol"?e:e+""}function CMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TMe{constructor(){Vm(this,"count",0),Vm(this,"startRow",0),Vm(this,"endRow",0),Vm(this,"startPosition",0),Vm(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function gj(t,e,r){return(e=EMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EMe(t){var e=RMe(t,"string");return typeof e=="symbol"?e:e+""}function RMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AMe extends fX{constructor(){super(...arguments),gj(this,"columnStartOffset",0),gj(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){const o=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function vj(t,e,r){return(e=kMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kMe(t){var e=OMe(t,"string");return typeof e=="symbol"?e:e+""}function OMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _Me extends hX{constructor(){super(...arguments),vj(this,"rowStartOffset",0),vj(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){const o=this.startRow,a=this.endRow;n(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function yj(t,e,r){return(e=MMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MMe(t){var e=DMe(t,"string");return typeof e=="symbol"?e:e+""}function DMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dX{constructor(e){yj(this,"calculationTypes",[]),yj(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ea(t,e,r){return(e=PMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PMe(t){var e=IMe(t,"string");return typeof e=="symbol"?e:e+""}function IMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pX=50;class NMe extends dX{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),Ea(this,"viewportWidth",0),Ea(this,"scrollOffset",0),Ea(this,"zeroBasedScrollOffset",0),Ea(this,"totalColumns",0),Ea(this,"columnWidthFn",null),Ea(this,"columnWidth",0),Ea(this,"overrideFn",null),Ea(this,"inlineStartOffset",0),Ea(this,"totalCalculatedWidth",0),Ea(this,"startPositions",[]),Ea(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?pX:r}}function No(t,e,r){return(e=LMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LMe(t){var e=FMe(t,"string");return typeof e=="symbol"?e:e+""}function FMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HMe extends dX{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),No(this,"viewportHeight",0),No(this,"scrollOffset",0),No(this,"zeroBasedScrollOffset",0),No(this,"totalRows",0),No(this,"rowHeightFn",null),No(this,"rowHeight",0),No(this,"overrideFn",null),No(this,"horizontalScrollbarHeight",0),No(this,"innerViewportHeight",0),No(this,"totalCalculatedHeight",0),No(this,"startPositions",[]),No(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function BMe(t,e,r){VMe(t,e),e.set(t,r)}function VMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xj(t,e,r){return(e=jMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jMe(t){var e=WMe(t,"string");return typeof e=="symbol"?e:e+""}function WMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hd(t,e){return t.get(mX(t,e))}function wj(t,e,r){return t.set(mX(t,e),r),r}function mX(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var uc=new WeakMap;class Th{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;xj(this,"row",null),xj(this,"col",null),BMe(this,uc,!1),wj(uc,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Hd(uc,this)}isSouthEastOf(e){return this.row>=e.row&&(Hd(uc,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Hd(uc,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Hd(uc,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Hd(uc,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Th&&wj(uc,this,e.isRtl()),this}clone(){return new Th(this.row,this.col,Hd(uc,this))}toObject(){return{row:this.row,col:this.col}}}function zMe(t,e,r){UMe(t,e),e.set(t,r)}function UMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yk(t,e,r){return(e=$Me(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Me(t){var e=GMe(t,"string");return typeof e=="symbol"?e:e+""}function GMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lo(t,e){return t.get(gX(t,e))}function YMe(t,e,r){return t.set(gX(t,e),r),r}function gX(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Os=new WeakMap;class _y{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;yk(this,"highlight",null),yk(this,"from",null),yk(this,"to",null),zMe(this,Os,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),YMe(Os,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),h=Math.max(i.row,a.row),d=Math.max(i.col,a.col),m=this._createCellCoords(l,u),g=this._createCellCoords(h,d);return this.from=m,this.to=g,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Lo(Os,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Lo(Os,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Lo(Os,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Lo(Os,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Lo(Os,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Lo(Os,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Lo(Os,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Lo(Os,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Th))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Lo(Os,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Lo(Os,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new _y(this.highlight,this.from,this.to,Lo(Os,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Th(e,r,Lo(Os,this))}}function il(t,e,r){qMe(t,e),e.set(t,r)}function qMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(vX(t,e))}function gu(t,e,r){return t.set(vX(t,e),r),r}function vX(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fo=new WeakMap,xk=new WeakMap,vi=new WeakMap,Bd=new WeakMap,P1=new WeakMap,Ra=new WeakMap,wk=new WeakMap,jm=new WeakMap,Of=new WeakMap,sl=new WeakMap;class yX{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;il(this,Fo,void 0),il(this,xk,void 0),il(this,vi,void 0),il(this,Bd,void 0),il(this,P1,void 0),il(this,Ra,void 0),il(this,wk,void 0),il(this,jm,void 0),il(this,Of,[null,null]),il(this,sl,[null,null]),gu(Fo,this,n),gu(xk,this,r),gu(vi,this,s),gu(Bd,this,o),gu(P1,this,a),gu(Ra,this,i),gu(wk,this,e),this.registerEvents()}registerEvents(){rt(Ra,this).addEventListener(rt(vi,this).holder,"contextmenu",n=>this.onContextMenu(n)),rt(Ra,this).addEventListener(rt(vi,this).TABLE,"mouseover",n=>this.onMouseOver(n)),rt(Ra,this).addEventListener(rt(vi,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{rt(Ra,this).addEventListener(rt(vi,this).holder,"touchstart",n=>this.onTouchStart(n)),rt(Ra,this).addEventListener(rt(vi,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),rt(Ra,this).addEventListener(rt(vi,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||rt(Fo,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,rt(Fo,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{rt(Ra,this).addEventListener(rt(vi,this).holder,"mouseup",n=>this.onMouseUp(n)),rt(Ra,this).addEventListener(rt(vi,this).holder,"mousedown",n=>this.onMouseDown(n))};up()?e():(HOe()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(rt(jm,this)&&n){const[i,s]=[n.row,rt(jm,this).from.row],[o,a]=[n.col,rt(jm,this).from.col];return i===s&&o===a}return!1}parentCell(e){const r={},n=rt(vi,this).TABLE,i=A1(e,["TD","TH"],n);return i?(r.coords=rt(vi,this).getCoords(i),r.TD=i):Nr(e,"wtBorder")&&Nr(e,"current")?(r.coords=rt(Bd,this).getFocusSelection().cellRange.highlight,r.TD=rt(vi,this).getCell(r.coords)):Nr(e,"wtBorder")&&Nr(e,"area")&&rt(Bd,this).getAreaSelection().cellRange&&(r.coords=rt(Bd,this).getAreaSelection().cellRange.to,r.TD=rt(vi,this).getCell(r.coords)),r}onMouseDown(e){const r=rt(xk,this).rootDocument.activeElement,n=POe(vOe,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);Nr(i,"corner")?rt(Fo,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&rt(Fo,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(rt(sl,this)[0]=s.TD,clearTimeout(rt(Of,this)[0]),rt(Of,this)[0]=setTimeout(()=>{rt(sl,this)[0]=null},1e3))}onContextMenu(e){if(rt(Fo,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!rt(Fo,this).has("onCellMouseOver"))return;const r=rt(vi,this).TABLE,n=A1(e.target,["TD","TH"],r),i=rt(P1,this)||this;n&&n!==i.lastMouseOver&&D_(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,rt(vi,this).getCoords(n),n))}onMouseOut(e){if(!rt(Fo,this).has("onCellMouseOut"))return;const r=rt(vi,this).TABLE,n=A1(e.target,["TD","TH"],r),i=A1(e.relatedTarget,["TD","TH"],r),s=rt(P1,this)||this;n&&n!==i&&D_(n,r)&&(this.callListener("onCellMouseOut",e,rt(vi,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&rt(Fo,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===rt(sl,this)[0]&&r.TD===rt(sl,this)[1]?(Nr(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),rt(sl,this)[0]=null,rt(sl,this)[1]=null):r.TD===rt(sl,this)[0]&&(rt(sl,this)[1]=r.TD,clearTimeout(rt(Of,this)[1]),rt(Of,this)[1]=setTimeout(()=>{rt(sl,this)[1]=null},500)))}onTouchStart(e){gu(jm,this,rt(Bd,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=Jt(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&rt(Fo,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];nX()&&(zOe()||UOe())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=rt(Fo,this).getSettingPure(e);s&&s(r,n,i,rt(wk,this).call(this))}destroy(){clearTimeout(rt(Of,this)[0]),clearTimeout(rt(Of,this)[1]),rt(Ra,this).destroy()}}function bk(t,e,r){return(e=KMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KMe(t){var e=XMe(t,"string");return typeof e=="symbol"?e:e+""}function XMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QMe{constructor(e,r,n){bk(this,"offset",void 0),bk(this,"total",void 0),bk(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Sk(t,e,r){return(e=ZMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZMe(t){var e=JMe(t,"string");return typeof e=="symbol"?e:e+""}function JMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eDe{constructor(e,r,n){Sk(this,"offset",void 0),Sk(this,"total",void 0),Sk(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function I1(t,e,r){return(e=tDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tDe(t){var e=rDe(t,"string");return typeof e=="symbol"?e:e+""}function rDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nDe{constructor(){I1(this,"currentSize",0),I1(this,"nextSize",0),I1(this,"currentOffset",0),I1(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const iDe=0,bj=1,V_=2;function Ck(t,e,r){return(e=sDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sDe(t){var e=oDe(t,"string");return typeof e=="symbol"?e:e+""}function oDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aDe{constructor(){Ck(this,"size",new nDe),Ck(this,"workingSpace",iDe),Ck(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=bj,e.workingSpace=V_,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=V_,e.workingSpace=bj,this.sharedSize=e.getViewSize()}}var Sj={},Tk,Cj;function lDe(){if(Cj)return Tk;Cj=1;var t=zS(),e=TypeError;return Tk=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},Tk}var Tj;function cDe(){if(Tj)return Sj;Tj=1;var t=Yr(),e=f0(),r=d0(),n=kq(),i=lDe(),s=Oq(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(h){var d=e(this),m=r(d),g=arguments.length;if(g){s(m+g);for(var y=m;y--;){var x=y+g;y in d?d[x]=d[y]:i(d,x)}for(var b=0;b<g;b++)d[b]=arguments[b]}return n(d,m+g)}}),Sj}cDe();function uDe(t,e,r){return(e=fDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fDe(t){var e=hDe(t,"string");return typeof e=="symbol"?e:e+""}function hDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ej{constructor(e,r){uDe(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function dDe(t,e,r){return(e=pDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pDe(t){var e=mDe(t,"string");return typeof e=="symbol"?e:e+""}function mDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gDe{constructor(e){dDe(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new Ej(s,r),l=new Ej(o,n),u=[];for(let h=0;h<i;h++){const d=a.get(h),m=l.get(h);if(m===-1)u.push(["remove",d]);else if(d===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(V_)?u.push(["append",m]):u.push(["prepend",m]);else if(m>d)a.has(m)&&(a.remove(m),n<=a.length&&(i-=1)),u.push(["replace",m,d]);else if(m<d){const g=a.prepend(m);u.push(["insert_before",m,d,g])}else u.push(["none",m])}return u}}function Vd(t,e,r){return(e=vDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vDe(t){var e=yDe(t,"string");return typeof e=="symbol"?e:e+""}function yDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xX{constructor(e,r){Vd(this,"rootNode",void 0),Vd(this,"nodesPool",void 0),Vd(this,"sizeSet",new aDe),Vd(this,"collectedNodes",[]),Vd(this,"viewDiffer",new gDe(this.sizeSet)),Vd(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,s,o]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(s)),r.removeChild(this.nodesPool(o));break;case"replace":r.replaceChild(a,this.nodesPool(s));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class wX extends xX{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Rj(t,e,r){return(e=xDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xDe(t){var e=wDe(t,"string");return typeof e=="symbol"?e:e+""}function wDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bDe{constructor(e){Rj(this,"nodeType",void 0),Rj(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}}function Wm(t,e,r){return(e=SDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SDe(t){var e=CDe(t,"string");return typeof e=="symbol"?e:e+""}function CDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class My{constructor(e,r){Wm(this,"nodesPool",null),Wm(this,"nodeType",void 0),Wm(this,"rootNode",void 0),Wm(this,"table",null),Wm(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new bDe(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Aj(t,e,r){return(e=TDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TDe(t){var e=EDe(t,"string");return typeof e=="symbol"?e:e+""}function EDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RDe extends My{constructor(){super("TH"),Aj(this,"orderViews",new WeakMap),Aj(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new wX(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),h=s.obtainOrderView(l);u.appendView(h).setSize(n).setOffset(0).start();for(let d=n-1;d>=0;d--){u.render();const m=u.getCurrentNode();m.className="",m.removeAttribute("style"),ky(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&cn(m,[fOe(),pOe(),bI(d+1),Ay(-1)]),r[d](a,m,d)}u.end()}}}class ADe extends My{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ev(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&cn(this.rootNode,[WK()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&cn(o,[M_(),UK(r+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),ky(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&cn(u,[bI(a+1+this.table.rowHeadersCount),Ay(-1),hOe(),...a>=0?[dOe()]:[M_()]]),n[r](l,u,r)}}}}let kj=!1;class kDe extends My{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!kj&&e>1e3&&(kj=!0,Yu(mo`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&$t(n,"rowHeader")}}function ODe(t,e,r){return(e=_De(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _De(t){var e=MDe(t,"string");return typeof e=="symbol"?e:e+""}function MDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jd={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Oj=!1;class DDe extends My{constructor(e){super("TR",e),ODe(this,"orderView",void 0),this.orderView=new xX(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Oj&&e>1e3&&(Oj=!0,Yu(mo`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&cn(this.rootNode,[WK()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;cn(s,[M_(),UK(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(o+1)%2===0?Nr(s,jd.rowEven)||(Jr(s,jd.rowOdd),$t(s,jd.rowEven)):Nr(s,jd.rowOdd)||(Jr(s,jd.rowEven),$t(s,jd.rowOdd))}this.orderView.end()}}function _j(t,e,r){return(e=PDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PDe(t){var e=IDe(t,"string");return typeof e=="symbol"?e:e+""}function IDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NDe extends My{constructor(){super("TD"),_j(this,"orderViews",new WeakMap),_j(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new wX(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const h=this.obtainOrderView(u),d=i.obtainOrderView(u);h.prependView(d).setSize(r).setOffset(0).start();for(let m=0;m<r;m++){h.render();const g=this.table.renderedColumnToSource(m),y=h.getCurrentNode();if(Nr(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),ky(y,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,y),this.table.isAriaEnabled()){var s,o;cn(y,[...y.hasAttribute("role")?[]:[uOe()],Ay(-1),bI(g+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}h.end()}}}function Gn(t,e,r){return(e=LDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LDe(t){var e=FDe(t,"string");return typeof e=="symbol"?e:e+""}function FDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HDe{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Gn(this,"rootNode",void 0),Gn(this,"rootDocument",void 0),Gn(this,"rowHeaders",null),Gn(this,"columnHeaders",null),Gn(this,"colGroup",null),Gn(this,"rows",null),Gn(this,"cells",null),Gn(this,"rowFilter",null),Gn(this,"columnFilter",null),Gn(this,"rowUtils",null),Gn(this,"columnUtils",null),Gn(this,"rowsToRender",0),Gn(this,"columnsToRender",0),Gn(this,"rowHeaderFunctions",[]),Gn(this,"rowHeadersCount",0),Gn(this,"columnHeaderFunctions",[]),Gn(this,"columnHeadersCount",0),Gn(this,"cellRenderer",void 0),Gn(this,"activeOverlayName",void 0),Gn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(n),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class BDe{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new HDe(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new RDe,columnHeaders:new ADe(r),colGroup:new kDe(n),rows:new DDe(i),cells:new NDe}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Ek(t,e,r){return(e=VDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VDe(t){var e=jDe(t,"string");return typeof e=="symbol"?e:e+""}function jDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WDe{constructor(e,r){Ek(this,"dataAccessObject",void 0),Ek(this,"wtSettings",void 0),Ek(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}}function Mj(t,e,r){return(e=zDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zDe(t){var e=UDe(t,"string");return typeof e=="symbol"?e:e+""}function UDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $De{constructor(e,r){Mj(this,"dataAccessObject",void 0),Mj(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function ol(t,e,r){return(e=GDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GDe(t){var e=YDe(t,"string");return typeof e=="symbol"?e:e+""}function YDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x0{constructor(e,r,n,i,s){ol(this,"wtSettings",null),ol(this,"domBindings",void 0),ol(this,"TBODY",null),ol(this,"THEAD",null),ol(this,"COLGROUP",null),ol(this,"hasTableHeight",!0),ol(this,"hasTableWidth",!0),ol(this,"isTableVisible",!1),ol(this,"tableOffset",0),ol(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,KK(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new $De(this.dataAccessObject,this.wtSettings),this.columnUtils=new WDe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new BDe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Nr(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&cn(n,[Mu()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Nr(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&cn(n,[Mu()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Nr(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",cn(n,[Ay(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&cn(n.parentNode,[Mu()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&cn(n,[Mu()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),h=u.length;let d=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=qo(this.holder),d=i.createCalculators(d),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,y!==this.correctHeaderWidth&&(d=!1)}if(d)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=qo(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),y=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new eDe(g,s,h),this.columnFilter=new QMe(y,o,l);let x=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),x=b.skipRender!==!0}x&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(wl)||this.is(Hu))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(wl))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(wl)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let m=!1;return this.isMaster&&(m=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(m=n.bottomOverlay.resetFixedPosition()||m),m=n.inlineStartOverlay.resetFixedPosition()||m,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=jg(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(wl))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=GK(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let s=bOe(n),o=r.cellIndex;Af(Ah,r,this.wtRootElement)||Af(Eh,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Af(Hu,r,this.wtRootElement)||Af(wl,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),Af(Ah,r,this.wtRootElement)||Af(Rh,r,this.wtRootElement)||Af(Hu,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=jg(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),s=i?go:jg,o=i?0:1,a=i?1:0;let l,u,h,d,m;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),l=this.getRowHeight(h),d=this.getTrForRow(h),m=d.querySelector("th");const g=h===0?a:0;m?u=s(m):u=s(d)-o,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-g||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Bs(this.TABLE)}getHeight(){return go(this.TABLE)}getTotalWidth(){const e=Bs(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=go(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Rv(this.TABLE)}_modifyRowHeaderWidth(e){let r=Rr(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const qDe="stickyRowsBottom",kI={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};sf(kI,"MIXIN_NAME",qDe,{writable:!1,enumerable:!1});const KDe="stickyColumnsStart",cC={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};sf(cC,"MIXIN_NAME",KDe,{writable:!1,enumerable:!1});class OI extends x0{constructor(e,r,n,i){super(e,r,n,i,Hu)}}jn(OI,kI);jn(OI,cC);const Eh="top",wl="bottom",Rh="inline_start",Ah="top_inline_start_corner",Hu="bottom_inline_start_corner",bX=[Eh,wl,Rh,Ah,Hu],XDe=new Map([[Eh,`ht_clone_${Eh}`],[wl,`ht_clone_${wl}`],[Rh,`ht_clone_${Rh} ht_clone_left`],[Ah,`ht_clone_${Ah} ht_clone_top_left_corner`],[Hu,`ht_clone_${Hu} ht_clone_bottom_left_corner`]]);function QDe(t,e){ZDe(t,e),e.add(t)}function ZDe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JDe(t,e,r){return(e=ePe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ePe(t){var e=tPe(t,"string");return typeof e=="symbol"?e:e+""}function tPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zm=new WeakSet;class rPe{constructor(e){QDe(this,zm),JDe(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const s=uo(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<o)return!1;const u=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let d=!1;return(l&&(e<u||e>h)||!l)&&(d=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),d}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const s=uo(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-o-1))return!1;const h=this.getFirstVisibleRow(),d=this.getLastVisibleRow();let m=!1;return(u&&(e<h||e>d)||!u)&&(m=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),m}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return N1(zm,this,Pj).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return N1(zm,this,Pj).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return N1(zm,this,Dj).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return N1(zm,this,Dj).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Dj(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const h=n.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(h.right-m)}else l=qo(n.wtRootElement).left;const u=Math.abs(QK(o,o));if(l>u){const h=ZK(o);let d=i.getRowHeaderWidth();for(let m=1;m<=s;m++)if(d+=r.sumCellSizes(m-1,m),l+d-u>=h){t=m-2;break}}}return t}function Pj(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=qo(r.wtRootElement),a=CI(s,s);if(o.top>a){const l=jg(s);let u=n.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(u+=e.sumCellSizes(h-1,h),o.top+u-a>=l){t=h-2;break}}}return t}function Ho(t,e,r){return(e=nPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nPe(t){var e=iPe(t,"string");return typeof e=="symbol"?e:e+""}function iPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _I{get eventManager(){return new $p(this)}constructor(e,r){Ho(this,"wtTable",void 0),Ho(this,"wtScroll",void 0),Ho(this,"wtViewport",void 0),Ho(this,"wtOverlays",void 0),Ho(this,"selectionManager",void 0),Ho(this,"wtEvent",void 0),Ho(this,"guid",`wt_${jK()}`),Ho(this,"drawInterrupted",!1),Ho(this,"drawn",!1),Ho(this,"activeOverlayName","master"),Ho(this,"domBindings",void 0),Ho(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new rPe(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Oy(n,e[r])}])}}createCellCoords(e,r){return new Th(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new _y(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||TOe(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Ij(t,e,r){return(e=sPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sPe(t){var e=oPe(t,"string");return typeof e=="symbol"?e:e+""}function oPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aPe extends _I{constructor(e,r,n){super(e,r),Ij(this,"cloneSource",void 0),Ij(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new yX(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function lPe(t,e,r){return(e=cPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cPe(t){var e=uPe(t,"string");return typeof e=="symbol"?e:e+""}function uPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dy{constructor(e,r,n,i,s){lPe(this,"wtSettings",null),sf(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=h,this.trimmingContainer=Fb(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Fb(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Lb(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Yu(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(o,s,h,u):d=this.getRelativeCellPositionWithinHolder(o,a,s,h,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+$s())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-s.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(bX.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${XDe.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&cn(s,[Mu()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Eh||u==="vertical"&&this.type===Rh?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Lb(e.TABLE),new aPe(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class fPe extends Dy{constructor(e,r,n,i,s,o){super(e,r,Hu,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new OI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else iC(r),this.repositionOverlay();let n=go(this.clone.wtTable.TABLE);const i=Bs(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=$s(n)),i.style.bottom=`${s}px`}}const hPe="calculatedColumns",uC={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};sf(uC,"MIXIN_NAME",hPe,{writable:!1,enumerable:!1});class MI extends x0{constructor(e,r,n,i){super(e,r,n,i,wl)}}jn(MI,kI);jn(MI,uC);function dPe(t,e,r){return(e=pPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pPe(t){var e=mPe(t,"string");return typeof e=="symbol"?e:e+""}function mPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gPe extends Dy{constructor(e,r,n,i){super(e,r,wl,n,i),dPe(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new MI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=$s(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(SI(r),top),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,stylesHandler:i}=this.wot,s=i.getDefaultRowHeight();let o=e,a=0;for(;o<r;){const l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=$s(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=go(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=$s(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return CI(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Nr(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?($t(o,"innerBorderBottom"),s=!a):(Jr(o,"innerBorderBottom"),s=a)}return s}}const vPe="calculatedRows",DI={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};sf(DI,"MIXIN_NAME",vPe,{writable:!1,enumerable:!1});class PI extends x0{constructor(e,r,n,i){super(e,r,n,i,Rh)}}jn(PI,DI);jn(PI,cC);const yPe="localHooks",Wc={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)P_(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};sf(Wc,"MIXIN_NAME",yPe,{writable:!1,enumerable:!1});let SX=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};jn(SX,Wc);const xPe="active-header",CX="header",II="area",Wg="focus",wPe="fill",bPe="row",SPe="column",CPe="custom-selection",NI=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var Nj={},Lj;function TPe(){if(Lj)return Nj;Lj=1;var t=RI();return t("flat"),Nj}TPe();function EPe(t,e){TX(t,e),e.add(t)}function Fj(t,e,r){TX(t,e),e.set(t,r)}function TX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pn(t,e){return t.get(zg(t,e))}function Hj(t,e,r){return t.set(zg(t,e),r),r}function zg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oa=new WeakMap,Ki=new WeakMap,L1=new WeakSet;class RPe{constructor(){EPe(this,L1),Fj(this,Oa,void 0),Fj(this,Ki,void 0)}setActiveOverlay(e){return Hj(Ki,this,e),this}setActiveSelection(e){return Hj(Oa,this,e),this}scan(){const e=pn(Oa,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=pn(Oa,this).getCorners(),{wtTable:o}=pn(Ki,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let h=-o.getRowHeadersCount();h<a;h++){const d=o.columnFilter.renderedToSource(h);if(!(d<n||d>s)){for(let m=-l;m<0;m++){if(m<r||m>i)continue;const g=m+l;let y=o.getColumnHeader(d,g);const x=pn(Ki,this).getSetting("onBeforeHighlightingColumnHeader",d,g,{selectionType:pn(Oa,this).settings.selectionType,columnCursor:u,selectionWidth:s-n+1});x!==null&&(x!==d&&(y=o.getColumnHeader(x,g)),e(y))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=pn(Oa,this).getCorners(),{wtTable:o}=pn(Ki,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let h=-o.getColumnHeadersCount();h<a;h++){const d=o.rowFilter.renderedToSource(h);if(!(d<r||d>i)){for(let m=-l;m<0;m++){if(m<n||m>s)continue;const g=m+l;let y=o.getRowHeader(d,g);const x=pn(Ki,this).getSetting("onBeforeHighlightingRowHeader",d,g,{selectionType:pn(Oa,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});x!==null&&(x!==d&&(y=o.getRowHeader(x,g)),e(y))}u+=1}}}scanCellsRange(e){const{wtTable:r}=pn(Ki,this);zg(L1,this,APe).call(this,(n,i)=>{const s=r.getCell(pn(Ki,this).createCellCoords(n,i)),o=pn(Ki,this).getSetting("onAfterDrawSelection",n,i,pn(Oa,this).settings.layerLevel);typeof o=="string"&&$t(s,o),e(s)})}scanRowsInCellsRange(e){const[r,,n]=pn(Oa,this).getCorners(),{wtTable:i}=pn(Ki,this);zg(L1,this,Bj).call(this,(s,o)=>{if(s>=r&&s<=n){const a=i.getCell(pn(Ki,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=pn(Oa,this).getCorners(),{wtTable:i}=pn(Ki,this);zg(L1,this,Bj).call(this,(s,o)=>{if(o>=r&&o<=n){const a=i.getCell(pn(Ki,this).createCellCoords(s,o));e(a)}})}}function APe(t){let[e,r,n,i]=pn(Oa,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:s}=pn(Ki,this),o=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),o){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else{const a=s.getCell(pn(Ki,this).createCellCoords(e,r));if(!sC(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function Bj(t){const{wtTable:e}=pn(Ki,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class Vj{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=NI(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),aC(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),up()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:r}=this.wot,n=r.getCSSVariableValue("cell-mobile-handle-size"),i=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),o=r.getCSSVariableValue("cell-mobile-handle-border-width"),a=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};fn(h,(m,g)=>{this.selectionHandles.styles.bottomHitArea[g]=m,this.selectionHandles.styles.topHitArea[g]=m});const d=r.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${i}px`,background:`${s}`,border:`${o}px solid ${a}`};fn(d,(m,g)=>{this.selectionHandles.styles.bottom[g]=m,this.selectionHandles.styles.top[g]=m}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:h,bottom:d,bottomHitArea:m}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),y=parseInt(u.width,10),x=parseInt(h.width,10),b=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();u.top=`${parseInt(n-y-1,10)}px`,u[l]=`${parseInt(i-y-1,10)}px`,h.top=`${parseInt(n-x/4*3,10)}px`,h[l]=`${parseInt(i-x/4*3,10)}px`;const E=Math.min(parseInt(i+s,10),b-y-g*2),R=Math.min(parseInt(i+s-x/4,10),b-x-g*2);d[l]=`${E}px`,m[l]=`${R}px`;const k=Math.min(parseInt(n+o,10),C-y-g*2),O=Math.min(parseInt(n+o-x/4,10),C-x-g*2);d.top=`${k}px`,m.top=`${O}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",h.display="block",this.isPartRange(e,r)?(d.display="none",m.display="none"):(d.display="block",m.display="block")):(u.display="none",d.display="none",h.display="none",m.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",h.zIndex="9999"):(u.zIndex="",h.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==s,h=o.getFirstRenderedRow(),d=o.getLastRenderedRow(),m=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(m<0&&g<0||h<0&&d<0){this.disappear();return}let y;if(u){if(n=Math.max(n,m),s=Math.min(s,g),r=Math.max(r,h),i=Math.min(i,d),s<n||i<r){this.disappear();return}y=o.getCell(this.wot.createCellCoords(r,n))}else if(y=o.getCell(this.wot.createCellCoords(r,n)),!sC(y)){this.disappear();return}const x=u?o.getCell(this.wot.createCellCoords(i,s)):y,b=qo(y),C=u?qo(x):b,E=qo(o.TABLE),R=b.top,k=b.left,O=this.wot.wtSettings.getSetting("rtlMode");let P=0,D=0;if(O){const Z=Bs(o.TABLE),ve=Bs(y),ie=l.innerWidth-E.left-Z;D=k+ve-C.left,P=l.innerWidth-k-ve-ie-1}else D=C.left+Bs(x)-k,P=k-E.left-1;if(this.isEntireColumnSelected(r,i)){const Z=r,ve=this.getDimensionsFromHeader("columns",n,s,Z,E);let ie=null;ve&&([ie,P,D]=ve),ie&&(y=ie)}let H=R-E.top-1,N=C.top+go(x)-R;if(this.isEntireRowSelected(n,s)){const Z=n,ve=this.getDimensionsFromHeader("rows",r,i,Z,E);let ie=null;ve&&([ie,H,N]=ve),ie&&(y=ie)}const _=l.getComputedStyle(y);parseInt(_.borderTopWidth,10)>0&&(H+=1,N=N>0?N-1:0),parseInt(_[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,D=D>0?D-1:0);const B=O?"right":"left";this.topStyle.top=`${H}px`,this.topStyle[B]=`${P}px`,this.topStyle.width=`${D}px`,this.topStyle.display="block",this.startStyle.top=`${H}px`,this.startStyle[B]=`${P}px`,this.startStyle.height=`${N}px`,this.startStyle.display="block";const j=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${H+N-j}px`,this.bottomStyle[B]=`${P}px`,this.bottomStyle.width=`${D}px`,this.bottomStyle.display="block",this.endStyle.top=`${H}px`,this.endStyle[B]=`${P+D-j}px`,this.endStyle.height=`${N+1}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const oe=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[re,q]=[i,s];if(oe&&Array.isArray(oe)&&([,,re,q]=oe),up()||!ee||this.isPartRange(re,q))this.cornerStyle.display="none";else{this.cornerStyle.top=`${H+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[B]=`${P+D+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Z=Fb(o.TABLE);const ve=Z===l;ve&&(Z=a.documentElement);const ie=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,K=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ce=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const S=ve?x.getBoundingClientRect().left:x.offsetLeft;let A=!1,M=0;O?(M=S-parseInt(this.cornerDefaultStyle.width,10)/2,A=M<0):(M=S+Bs(x)+parseInt(this.cornerDefaultStyle.width,10)/2,A=M>=ZK(Z)),A&&(this.cornerStyle[B]=`${Math.floor(P+D+this.cornerCenterPointOffset-K-ie)}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const M=(ve?x.getBoundingClientRect().top:x.offsetTop)+go(x)+parseInt(this.cornerDefaultStyle.height,10)/2>=jg(Z),L=this.wot.stylesHandler.isClassicTheme();if(M){const V=Math.floor(H+N+this.cornerCenterPointOffset-ce-ie);L?(this.cornerStyle.top=`${V}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${V-1}px`}}this.cornerStyle.display="block"}up()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,H,P,D,N)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,h=null,d=null,m=null,g=null,y=null,x=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return go(...arguments)},h="ht__selection--rows",g="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return Bs(...arguments)},h="ht__selection--columns",g="left";break}if(a.classList.contains(h)){const b=this.wot.getSetting("columnHeaders").length;if(y=l(r,b-i),x=l(n,b-i),!y||!x)return!1;const C=qo(y),E=qo(x);return y&&x&&(d=C[g]-s[g]-1,m=E[g]+u(x)-C[g]),[y,d,m]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?$t(this[e],"hidden"):(Nr(this[e],"hidden")&&Jr(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?$t(this[e],"hidden"):Jr(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",up()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function kPe(t,e){EX(t,e),e.add(t)}function Wd(t,e,r){EX(t,e),e.set(t,r)}function EX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(LI(t,e))}function jj(t,e,r){return t.set(LI(t,e),r),r}function LI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xi=new WeakMap,Ps=new WeakMap,Rk=new WeakMap,hg=new WeakMap,Ak=new WeakMap,_f=new WeakMap,Wj=new WeakSet;class OPe{constructor(e){kPe(this,Wj),Wd(this,Xi,void 0),Wd(this,Ps,void 0),Wd(this,Rk,new RPe),Wd(this,hg,new WeakMap),Wd(this,Ak,new WeakSet),Wd(this,_f,new Map),jj(Ps,this,e)}setActiveOverlay(e){return jj(Xi,this,e),Ft(Rk,this).setActiveOverlay(Ft(Xi,this)),Ft(hg,this).has(Ft(Xi,this))||Ft(hg,this).set(Ft(Xi,this),new Set),this}getFocusSelection(){return Ft(Ps,this)!==null?Ft(Ps,this).getFocus():null}getAreaSelection(){return Ft(Ps,this)!==null?Ft(Ps,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ft(_f,this).has(e)){const n=Ft(_f,this).get(e);if(n.has(Ft(Xi,this)))return n.get(Ft(Xi,this));const i=new Vj(Ft(Xi,this),e.settings);return n.set(Ft(Xi,this),i),i}const r=new Vj(Ft(Xi,this),e.settings);return Ft(_f,this).set(e,new Map([[Ft(Xi,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=Ft(_f,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){Ft(_f,this).get(e).forEach(r=>r.destroy()),Ft(_f,this).delete(e)}render(e){if(Ft(Ps,this)===null)return;e&&LI(Wj,this,_Pe).call(this);const r=Array.from(Ft(Ps,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:l,createLayers:u,selectionType:h}=o.settings;Ft(Ak,this).has(o)||(Ft(Ak,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const d=this.getBorderInstance(o);if(o.isEmpty()){d==null||d.disappear();continue}a&&Ft(Rk,this).setActiveSelection(o).scan().forEach(y=>{if(n.has(y)){const x=n.get(y);x.has(a)&&u===!0?x.set(a,x.get(a)+1):x.set(a,1)}else n.set(y,new Map([[a,1]]));l&&(i.has(y)||i.set(y,[]),y.nodeName==="TH"&&i.get(y).push(...l))});const m=o.getCorners();Ft(Xi,this).getSetting("onBeforeDrawBorders",m,h),d==null||d.appear(m)}n.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[h,d]=u;return d===1?h:[h,...Array.from({length:d-1},(m,g)=>`${h}-${g+1}`)]}).flat();l.forEach(u=>Ft(hg,this).get(Ft(Xi,this)).add(u)),$t(o,l),o.nodeName==="TD"&&Array.isArray((a=Ft(Ps,this).options)===null||a===void 0?void 0:a.cellAttributes)&&cn(o,Ft(Ps,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{cn(s,[...i.get(s)])})}}function _Pe(){const t=Ft(hg,this).get(Ft(Xi,this)),e=Ft(Xi,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=Ft(Xi,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((n=Ft(Ps,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=Ft(Ps,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ft(Ps,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...Ft(Ps,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)Jr(s[a],r),ky(s[a],o)}),t.clear()}class MPe extends Dy{constructor(e,r,n,i){super(e,r,Rh,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new PI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),TI(n,`${s}px`,"0px")):(s=this.getScrollPosition(),iC(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const s=r.scrollX;r.scrollTo(e,XK(r)),n=s!==r.scrollX}else if(e!==i.scrollLeft){const s=i.scrollLeft;i.scrollLeft=e,n=s!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=$s(n)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=Bs(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=NI(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Nr(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getColumnWidth(e),m=this.wot.wtViewport.getViewportWidth();d>m&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(h=$s(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=h,ROe(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(QK(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?Jr(n,"emptyRows"):$t(n,"emptyRows");let l=!1;if(!a){if(s&&!i.length)$t(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Nr(n,"innerBorderInlineStart");e?($t(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Jr(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const DPe="stickyRowsTop",FI={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};sf(FI,"MIXIN_NAME",DPe,{writable:!1,enumerable:!1});class HI extends x0{constructor(e,r,n,i){super(e,r,n,i,Ah)}}jn(HI,FI);jn(HI,cC);function zj(t,e,r){return(e=PPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PPe(t){var e=IPe(t,"string");return typeof e=="symbol"?e:e+""}function IPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NPe extends Dy{constructor(e,r,n,i,s,o){super(e,r,Ah,n,i),zj(this,"topOverlay",void 0),zj(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new HI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();TI(e,`${i}px`,`${s}px`)}else iC(e);let r=go(this.clone.wtTable.TABLE);const n=Bs(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class BI extends x0{constructor(e,r,n,i){super(e,r,n,i,Eh)}}jn(BI,FI);jn(BI,uC);function LPe(t,e,r){return(e=FPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FPe(t){var e=HPe(t,"string");return typeof e=="symbol"?e:e+""}function HPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BPe extends Dy{constructor(e,r,n,i){super(e,r,Eh,n,i),LPe(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new BI(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),h=e.offsetHeight;s=u===h,i=this.getOverlayOffset(),TI(e,"0px",`${i}px`)}else i=this.getScrollPosition(),iC(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(SI(r),e),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wot.stylesHandler.getDefaultRowHeight();let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=$s(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=go(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=NI(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Nr(o.parentNode,"innerBorderTop")?1:0;let h=this.getTableParentOffset(),d=0;if(r){const m=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();m>g&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(d=$s(this.domBindings.rootDocument)),r){const m=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");h+=this.sumCellSizes(0,e+1),h-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-m,g),h+=1,h+=u}else h+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return h+=d,EOe(this.mainTableScrollableElement)===h-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(h)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return CI(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?Jr(i,"emptyColumns"):$t(i,"emptyColumns");let a=!1;if(!r&&!o){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,h=n.getSetting("columnHeaders");if((u||l===0)&&h.length>0){const d=Nr(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?($t(i,"innerBorderTop"),a=!d):(Jr(i,"innerBorderTop"),a=d)}}return a}}function F1(t,e,r){VPe(t,e),e.set(t,r)}function VPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fc(t,e,r){return(e=jPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jPe(t){var e=WPe(t,"string");return typeof e=="symbol"?e:e+""}function WPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mf(t,e,r){return t.set(RX(t,e),r),r}function hc(t,e){return t.get(RX(t,e))}function RX(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zd=new WeakMap,H1=new WeakMap,Ud=new WeakMap,B1=new WeakMap;class zPe{constructor(e,r,n,i,s,o){fc(this,"wot",null),F1(this,zd,[]),fc(this,"topOverlay",null),fc(this,"bottomOverlay",null),fc(this,"inlineStartOverlay",null),fc(this,"topInlineStartCornerOverlay",null),fc(this,"bottomInlineStartCornerOverlay",null),fc(this,"browserLineHeight",void 0),fc(this,"wtSettings",null),F1(this,H1,!1),F1(this,Ud,0),F1(this,B1,null),fc(this,"resizeObserver",new ResizeObserver(h=>{N9(()=>{!Array.isArray(h)||!h.length||(Mf(Ud,this,hc(Ud,this)+1),hc(Ud,this)===100&&(Yu("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),hc(B1,this)!==null&&clearTimeout(hc(B1,this)),Mf(B1,this,setTimeout(()=>{Mf(Ud,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=$s(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:Lb(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...hc(zd,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new BPe(...e),this.bottomOverlay=new gPe(...e),this.inlineStartOverlay=new MPe(...e),this.topInlineStartCornerOverlay=new NPe(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new fPe(...e,this.bottomOverlay,this.inlineStartOverlay),Mf(zd,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Mf(H1,this,hc(zd,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),hc(zd,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),hc(zd,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",d=>this.onTableScroll(d),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!WOe())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{this.eventManager.addEventListener(d.clone.wtTable.holder,"wheel",m=>this.onCloneWheel(m,a),l)});let h;this.eventManager.addEventListener(r,"resize",()=>{N9(()=>{clearTimeout(h),this.wtSettings.getSetting("onWindowResize"),h=setTimeout(()=>{Mf(Ud,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=XOe(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!hc(H1,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Mf(H1,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Lb(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,h=a+this.inlineStartOverlay.sumCellSizes(0,s),m=r.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),y=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),x=g()?1:0,b=y()?1:0;m.width=`${h+b}px`,m.height=`${u+x}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Bt(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Bt(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function Uj(t,e,r){return(e=UPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UPe(t){var e=$Pe(t,"string");return typeof e=="symbol"?e:e+""}function $Pe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GPe{constructor(e){Uj(this,"settings",{}),Uj(this,"defaults",Object.freeze(this.getDefaults())),fn(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Oy(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?fn(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class VI extends x0{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Fb(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=_9(e,"height",r),s=_9(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,h=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const m=e.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",e.nextElementSibling?n.insertBefore(m,e.nextElementSibling):n.appendChild(m);const g=parseInt(r.getComputedStyle(m).height,10);n.removeChild(m),g===0&&(h=0)}h=Math.min(h,l),o.height=i==="auto"?"auto":`${h}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:h>0,this.hasTableWidth=u>0}this.isTableVisible=Rv(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let h=-1*a;h<l;h++)this.markIfOversizedColumnHeader(h);r.hasOversizedColumnHeadersMarked[n]=!0}}}jn(VI,DI);jn(VI,uC);let YPe=class{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new TMe:new _Me],["fullyVisible",()=>new pMe],["partiallyVisible",()=>new hX]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new bMe:new AMe],["fullyVisible",()=>new fMe],["partiallyVisible",()=>new fX]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=go(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollWidth>s.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return qo(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=go(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=Bs(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),h=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(h-u,h),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=$s(this.domBindings.rootDocument),new HMe({calculationTypes:e.map(d=>[d,this.rowsCalculatorTypes.get(d)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:d=>n.getRowHeight(d),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=$s(this.domBindings.rootDocument)),new NMe({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(o,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(o,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<l)}resetHasOversizedColumnHeadersMarked(){fn(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}};function qPe(t,e){AX(t,e),e.add(t)}function Df(t,e,r){AX(t,e),e.set(t,r)}function AX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xr(t,e){return t.get(Pa(t,e))}function Da(t,e,r){return t.set(Pa(t,e),r),r}function Pa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $j=23;var dl=new WeakMap,wc=new WeakMap,jI=new WeakMap,j_=new WeakMap,wu=new WeakMap,dg=new WeakMap,kv=new WeakMap,ml=new WeakSet;class KPe{constructor(e){qPe(this,ml),Df(this,dl,void 0),Df(this,wc,void 0),Df(this,jI,void 0),Df(this,j_,void 0),Df(this,wu,!0),Df(this,dg,{}),Df(this,kv,{}),Da(wc,this,e.rootTable.parentElement.parentElement),Da(j_,this,e.rootDocument)}isClassicTheme(){return Xr(wu,this)}getCSSVariableValue(e){var r;if(Xr(wu,this))return null;if(Xr(dg,this)[`--ht-${e}`])return Xr(dg,this)[`--ht-${e}`];const n=(r=Pa(ml,this,JPe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Pa(ml,this,kX).call(this,`--ht-${e}`);if(n!==null)return Xr(dg,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Xr(kv,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Xr(wu,this))return $j;const e=Pa(ml,this,XPe).call(this);return!e&&Nr(Xr(wc,this),"ht-wrapper")?(Yu(`The "${Xr(dl,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Da(wu,this,!0),this.useTheme(),$j):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Pa(ml,this,Gj).call(this),Da(wu,this,!0),Da(dl,this,e||void 0);return}e&&e!==Xr(dl,this)&&(Xr(dl,this)&&Pa(ml,this,eIe).call(this),Da(dl,this,e),Da(wu,this,!1),Pa(ml,this,QPe).call(this),Pa(ml,this,Gj).call(this))}getThemeName(){return Xr(dl,this)}removeClassNames(){Nr(Xr(wc,this),Xr(dl,this))&&Jr(Xr(wc,this),Xr(dl,this))}}function XPe(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function QPe(){Jr(Xr(wc,this),/ht-theme-.*/g),$t(Xr(wc,this),Xr(dl,this))}function Gj(){this.isClassicTheme()||Da(jI,this,getComputedStyle(Xr(wc,this)));const t=Pa(ml,this,ZPe).call(this,["box-sizing","border-bottom-width"]);Xr(kv,this).td={...Xr(kv,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function ZPe(t){const e=Xr(j_,this),r=Xr(wc,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(h=>{u[h]=l.getPropertyValue(h)}),r.removeChild(n),u}function JPe(t){const e=Math.ceil(parseFloat(Pa(ml,this,kX).call(this,t)));return Number.isNaN(e)?null:e}function kX(t){const e=Xr(jI,this).getPropertyValue(t);return e===""?null:e}function eIe(){Da(kv,this,{}),Da(dg,this,{}),Da(wu,this,!0)}class tIe extends _I{constructor(e,r){super(e,new GPe(r)),this.stylesHandler=new KPe(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new VI(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new YPe(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new OPe(this.wtSettings.getSetting("selections")),this.wtEvent=new yX(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new zPe(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];fn(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),Jr(this.wtTable.wtRootElement.parentNode,r),$t(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!bX.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class WI{constructor(e){e instanceof _I?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new WI(r);return()=>n},this._wot=new tIe(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Yj(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),h=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||h)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):h&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!h&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!h&&i.row<0||h&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!s.inInSelection(i),m=r||n&&d;i.row<0&&i.col>=0&&!o.column?m&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?m&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?m&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function rIe(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(u-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const nIe=new Map([["mousedown",Yj],["mouseover",rIe],["touchstart",Yj]]);function qj(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:s}=e;nIe.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:iX(t)||t.type==="touchstart",isRightClick:I_(t)})}const OX=new WeakMap,zI=Symbol("rootInstance");function iIe(t){OX.set(t,!0)}function sIe(t){return t===zI}function Uw(t){return OX.has(t)}function oIe(t,e){_X(t,e),e.add(t)}function vu(t,e,r){_X(t,e),e.set(t,r)}function _X(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,r){return(e=aIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aIe(t){var e=lIe(t,"string");return typeof e=="symbol"?e:e+""}function lIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dn(t,e){return t.get(Tp(t,e))}function _s(t,e,r){return t.set(Tp(t,e),r),r}function Tp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kk=new WeakMap,V1=new WeakMap,j1=new WeakMap,dc=new WeakMap,Aa=new WeakMap,Ok=new WeakMap,_k=new WeakMap,$d=new WeakMap,pg=new WeakSet;class cIe{constructor(e){oIe(this,pg),yu(this,"hot",void 0),yu(this,"eventManager",void 0),yu(this,"settings",void 0),yu(this,"THEAD",void 0),yu(this,"TBODY",void 0),yu(this,"_wt",void 0),yu(this,"activeWt",void 0),vu(this,kk,0),vu(this,V1,0),yu(this,"postponedAdjustElementsSize",!1),vu(this,j1,!1),vu(this,dc,void 0),vu(this,Aa,void 0),vu(this,Ok,0),vu(this,_k,0),vu(this,$d,null),this.hot=e,this.eventManager=new $p(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Tp(pg,this,fIe).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),$t(e,"handsontable"),_s(Aa,this,r.createElement("TABLE")),$t(Dn(Aa,this),"htCore"),this.hot.getSettings().tableClassName&&$t(Dn(Aa,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(cn(Dn(Aa,this),[Mu()]),cn(e,[cOe(),zK(-1),nC(this.hot.countCols()),gOe()])),this.THEAD=r.createElement("THEAD"),Dn(Aa,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Dn(Aa,this).appendChild(this.TBODY),this.hot.table=Dn(Aa,this),this.hot.container.insertBefore(Dn(Aa,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{_s(j1,this,!0),this.isTextSelectionAllowed(a.target)||(M9(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{_s(j1,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Dn(j1,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&M9(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{n.isInProgress()&&iX(a)&&n.finish(),_s(dc,this,!1);const l=eX(r.activeElement);zw(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!I_(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{n.isInProgress()&&I_(a)&&(n.finish(),_s(dc,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),_s(dc,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,h=a.y||a.clientY;let d=a.target;if(Dn(dc,this)||!e||!this.hot.view)return;const{holder:m}=this._wt.wtTable;if(d===m){const y=$s(r);if(r.elementFromPoint(u+y,h)!==m||r.elementFromPoint(u,h+y)!==m)return}else for(;d!==s;){if(d===null){if(a.isTargetWebComponent)break;return}if(d===e)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Nb(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Nb(o);this.eventManager.addEventListener(Dn(Aa,this),"selectstart",a=>{this.settings.fragmentSelection||zw(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&$t(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Jr(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Dn(Aa,this),isDataViewInstance:()=>Uw(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),_s(V1,this,s.length),this.hot.getSettings().ariaTags&&Tp(pg,this,MX).call(this)===this.hot.countCols()&&Tp(pg,this,uIe).call(this,Dn(V1,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),_s(kk,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let d=l,m=u;Array.isArray(h)&&([d,m]=h);const g=this.hot.getCellMeta(d,m),y=this.hot.colToProp(m);let x=this.hot.getDataAtRowProp(d,y);this.hot.hasHook("beforeValueRender")&&(x=this.hot.runHooks("beforeValueRender",x,g)),this.hot.runHooks("beforeRenderer",a,l,u,y,x,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,y,x,g),this.hot.runHooks("afterRenderer",a,l,u,y,x,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Rv(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,_s(dc,this,!0),_s($d,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,h),!Yf(s)&&(qj(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(d,m)=>this.hot._createCellCoords(d,m)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,_s(dc,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!Yf(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!Yf(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,h),!Yf(s)&&(Dn(dc,this)&&(!Dn($d,this)||Dn($d,this).x!==s.clientX||Dn($d,this).y!==s.clientY)&&qj(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(d,m)=>this.hot._createCellCoords(d,m)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt,_s($d,this,null))},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(Yf(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const d=this.hot.runHooks("beforeHighlightingRowHeader",h,o,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const d=this.hot.runHooks("beforeHighlightingColumnHeader",h,o,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,h]=this.translateFromRenderableToVisualIndex(s,o),d=this.hot.selection.getSelectedRange();if(d.size()>0){const g=d.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,h,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,h]=s,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.hot.runHooks("beforeDrawBorders",d,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=o>=0?h.getVisualFromRenderableIndex(o):o,m=s>=0?u.getVisualFromRenderableIndex(s):s,g=this.hot.runHooks("modifyGetCellCoords",m,d,a,l);if(Array.isArray(g)){const[y,x,b,C]=g;return[y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,1)):y,x>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(x,1)):x,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,C>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(C,-1)):C]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,h=s>=0?a.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCoordsElement",h,u);if(Array.isArray(d)){const[m,g]=d;return[m>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(m,1)):m,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const h=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-h,0),s.endRow=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const h=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-h,0),s.endColumn=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new WI(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(zw(e))return!0;const r=D_(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Dn(dc,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!Nr(n,"relative")){Ev(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;Nr(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",$t(o,["relative",...s()])):(Ev(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(cn(a,...Mu()),cn(l,...Mu())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Nr(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):Nr(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?COe(e,n(r,i)):(Oy(e,""),$t(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){_s(Ok,this,e),_s(_k,this,r)}getLastSize(){return{width:Dn(Ok,this),height:Dn(_k,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Dn(kk,this)}getRowHeadersCount(){return Dn(V1,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function MX(){return parseInt(this.hot.rootElement.getAttribute(nC()[0]),10)}function uIe(t){const e=Tp(pg,this,MX).call(this)+t;cn(this.hot.rootElement,...nC(e))}function fIe(){const t=this.hot.rootElement;this.hasVerticalScroll()?$t(t,"htHasScrollY"):Jr(t,"htHasScrollY"),this.hasHorizontalScroll()?$t(t,"htHasScrollX"):Jr(t,"htHasScrollX")}var Kj={},Xj={},Qj;function hIe(){if(Qj)return Xj;Qj=1;var t=Yr(),e=Ti(),r=p0(),n=xo(),i=Ei(),s=nf(),o=wo(),a=Yh(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(h){i(this);try{n(h)}catch(g){o(this,"throw",g)}if(l)return e(l,this,h);var d=s(this),m=0;return!r(d,function(g,y){if(!h(g,m++))return y()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Xj}var Zj;function dIe(){return Zj||(Zj=1,hIe()),Kj}dIe();const pIe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Jj=pIe.length;function mIe(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%Jj,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/Jj,10);return r}function DX(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Fl(t[0])&&(e=EI(t[0]))),e}function Um(t,e,r){return(e=gIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gIe(t){var e=vIe(t,"string");return typeof e=="symbol"?e:e+""}function vIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yIe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Um(this,"hot",void 0),Um(this,"data",void 0),Um(this,"dataType","array"),Um(this,"colToProp",()=>{}),Um(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return Bt(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,h)=>{l[h]=this.getAtPhysicalCell(e,h,a)}):Ko(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(Fl(a)||Rr(a))if(i?l=[]:l={},!s||i){const h=this.countFirstRowKeys()-1;Ko(0,h,d=>{const m=this.colToProp(d);if(d>=(r||0)&&d<=(n||h)&&!Number.isInteger(m)){const g=this.getAtPhysicalCell(e,m,a);i?l.push(g):o?tk(l,m,g):l[m]=g}})}else fn(a,(u,h)=>{const d=this.getAtPhysicalCell(e,h,a);o?tk(l,h,d):l[h]=d});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=uo(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:tk(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?FOe(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=uo(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Ko(s,a,h=>{u.push(i?this.getAtRow(h,void 0,void 0,n):this.getAtRow(h,o,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return DX(this.data)}destroy(){this.data=null,this.hot=null}}var eW={},tW={},rW;function xIe(){if(rW)return tW;rW=1;var t=Yr(),e=Ti(),r=p0(),n=xo(),i=Ei(),s=nf(),o=wo(),a=Yh(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(h){i(this);try{n(h)}catch(g){o(this,"throw",g)}if(l)return e(l,this,h);var d=s(this),m=0;return r(d,function(g,y){if(h(g,m++))return y()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),tW}var nW;function wIe(){return nW||(nW=1,xIe()),eW}wIe();function iW(t,e,r){return(e=bIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bIe(t){var e=SIe(t,"string");return typeof e=="symbol"?e:e+""}function SIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Py{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;iW(this,"indexedValues",[]),iW(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Rr(this.initValueOrFn)?Ko(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ko(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}jn(Py,Wc);function PX(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>Rr(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function IX(t,e){return VK(t,(r,n)=>e.includes(n)===!1)}class UI extends Py{insert(e,r){this.indexedValues=PX(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=IX(this.indexedValues,e),super.remove(e)}}class NX extends UI{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return rC(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function LX(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Bb(t,e){return VK(t,r=>e.includes(r)===!1)}function FX(t,e){return Sh(t,r=>r-e.filter(n=>n<r).length)}function HX(t,e){const r=e[0],n=e.length;return Sh(t,i=>i>=r?i+n:i)}function CIe(t,e,r){return(e=TIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TIe(t){var e=EIe(t,"string");return typeof e=="symbol"?e:e+""}function EIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RIe extends Py{constructor(){super(...arguments),CIe(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Bb(this.orderOfIndexes,[e]),Rr(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=PX(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=HX(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=IX(this.indexedValues,e),this.orderOfIndexes=Bb(this.orderOfIndexes,e),this.orderOfIndexes=FX(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class BX extends UI{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return rC(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class AIe extends Py{constructor(){super(e=>e)}insert(e,r){const n=HX(this.indexedValues,r);this.indexedValues=LX(n,e,r),super.insert(e,r)}remove(e){const r=Bb(this.indexedValues,e);this.indexedValues=FX(r,e),super.remove(e)}}const sW=new Map([["hiding",NX],["index",Py],["linkedPhysicalIndexToValue",RIe],["physicalIndexToValue",UI],["trimming",BX]]);function kIe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!sW.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(sW.get(t))(e)}function OIe(t,e,r){return(e=_Ie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ie(t){var e=MIe(t,"string");return typeof e=="symbol"?e:e+""}function MIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $I{constructor(){OIe(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);Jt(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Hs(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}jn($I,Wc);function Mk(t,e,r){return(e=DIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DIe(t){var e=PIe(t,"string");return typeof e=="symbol"?e:e+""}function PIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oW extends $I{constructor(e,r){super(),Mk(this,"mergedValuesCache",[]),Mk(this,"aggregationFunction",void 0),Mk(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Sh(this.get(),s=>s.getValues()),n=[],i=Jt(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return Sh(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return Jt(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function IIe(t,e,r){NIe(t,e),e.set(t,r)}function NIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LIe(t,e,r){return t.set(VX(t,e),r),r}function FIe(t,e){return t.get(VX(t,e))}function VX(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Dk=new WeakMap;class jX{constructor(){IIe(this,Dk,[])}subscribe(e){return this.addLocalHook("change",e),this._write(FIe(Dk,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){LIe(Dk,this,e)}}jn(jX,Wc);function aW(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function $m(t,e,r){HIe(t,e),e.set(t,r)}function HIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bo(t,e){return t.get(WX(t,e))}function W1(t,e,r){return t.set(WX(t,e),r),r}function WX(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var z1=new WeakMap,Gm=new WeakMap,U1=new WeakMap,$1=new WeakMap,G1=new WeakMap;class BIe{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$m(this,z1,new Set),$m(this,Gm,[]),$m(this,U1,[]),$m(this,$1,!1),$m(this,G1,!1),W1(G1,this,e??!1)}createObserver(){const e=new jX;return Bo(z1,this).add(e),e.addLocalHook("unsubscribe",()=>{Bo(z1,this).delete(e)}),e._writeInitialChanges(aW(Bo(Gm,this),Bo(U1,this))),e}emit(e){let r=Bo(U1,this);(!Bo($1,this)||Bo(Gm,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Bo(G1,this)):W1(Gm,this,new Array(e.length).fill(Bo(G1,this))),Bo($1,this)||(W1($1,this,!0),r=Bo(Gm,this)));const n=aW(r,e);Bo(z1,this).forEach(i=>i._write(n)),W1(U1,this,e)}}function fs(t,e,r){return(e=VIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VIe(t){var e=jIe(t,"string");return typeof e=="symbol"?e:e+""}function jIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_{constructor(){fs(this,"indexesSequence",new AIe),fs(this,"trimmingMapsCollection",new oW(e=>e.some(r=>r===!0),!1)),fs(this,"hidingMapsCollection",new oW(e=>e.some(r=>r===!0),!1)),fs(this,"variousMapsCollection",new $I),fs(this,"hidingChangesObservable",new BIe({initialIndexValue:!1})),fs(this,"notTrimmedIndexesCache",[]),fs(this,"notHiddenIndexesCache",[]),fs(this,"isBatched",!1),fs(this,"indexesSequenceChanged",!1),fs(this,"indexesChangeSource",void 0),fs(this,"trimmedIndexesChanged",!1),fs(this,"hiddenIndexesChanged",!1),fs(this,"renderablePhysicalIndexesCache",[]),fs(this,"fromPhysicalToVisualIndexesCache",new Map),fs(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,kIe(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof BX?this.trimmingMapsCollection.register(e,r):r instanceof NX?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return Jt(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return Jt(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return Jt(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return Jt(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Sh(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=Bb(this.getIndexesSequence(),n),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<i){const u=a[r];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(LX(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=Jt(n)?n:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=Sh(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}jn(W_,Wc);function WIe(t,e){return fn(e,(r,n)=>{Hs(t[n])&&(t[n]=r)}),t}function zX(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function UX(t){Jt(t)&&QOe(mo`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function zIe(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:UIe,getValues:$Ie}=y0("phraseFormatters");function GIe(t,e){UIe(t,e)}function YIe(){return $Ie()}GIe("pluralize",zIe);const $X="ContextMenu:items",kt=$X,GX=`${kt}.noItems`,YX=`${kt}.insertRowAbove`,qX=`${kt}.insertRowBelow`,KX=`${kt}.insertColumnOnTheLeft`,XX=`${kt}.insertColumnOnTheRight`,QX=`${kt}.removeRow`,ZX=`${kt}.removeColumn`,JX=`${kt}.undo`,eQ=`${kt}.redo`,tQ=`${kt}.readOnly`,rQ=`${kt}.clearColumn`,nQ=`${kt}.copy`,iQ=`${kt}.copyWithHeaders`,sQ=`${kt}.copyWithGroupHeaders`,oQ=`${kt}.copyHeadersOnly`,aQ=`${kt}.cut`,lQ=`${kt}.freezeColumn`,cQ=`${kt}.unfreezeColumn`,uQ=`${kt}.mergeCells`,fQ=`${kt}.unmergeCells`,hQ=`${kt}.addComment`,dQ=`${kt}.editComment`,pQ=`${kt}.removeComment`,mQ=`${kt}.readOnlyComment`,gQ=`${kt}.align`,vQ=`${kt}.align.left`,yQ=`${kt}.align.center`,xQ=`${kt}.align.right`,wQ=`${kt}.align.justify`,bQ=`${kt}.align.top`,SQ=`${kt}.align.middle`,CQ=`${kt}.align.bottom`,TQ=`${kt}.borders`,EQ=`${kt}.borders.top`,RQ=`${kt}.borders.right`,AQ=`${kt}.borders.bottom`,kQ=`${kt}.borders.left`,OQ=`${kt}.borders.remove`,_Q=`${kt}.nestedHeaders.insertChildRow`,MQ=`${kt}.nestedHeaders.detachFromParent`,DQ=`${kt}.hideColumn`,PQ=`${kt}.showColumn`,IQ=`${kt}.hideRow`,NQ=`${kt}.showRow`,Ks="Filters:",kn=`${Ks}conditions`,LQ=`${kn}.none`,FQ=`${kn}.isEmpty`,HQ=`${kn}.isNotEmpty`,BQ=`${kn}.isEqualTo`,VQ=`${kn}.isNotEqualTo`,jQ=`${kn}.beginsWith`,WQ=`${kn}.endsWith`,zQ=`${kn}.contains`,UQ=`${kn}.doesNotContain`,qIe=`${kn}.byValue`,$Q=`${kn}.greaterThan`,GQ=`${kn}.greaterThanOrEqualTo`,YQ=`${kn}.lessThan`,qQ=`${kn}.lessThanOrEqualTo`,KQ=`${kn}.isBetween`,XQ=`${kn}.isNotBetween`,QQ=`${kn}.after`,ZQ=`${kn}.before`,JQ=`${kn}.today`,eZ=`${kn}.tomorrow`,tZ=`${kn}.yesterday`,rZ=`${Ks}labels.filterByCondition`,nZ=`${Ks}labels.filterByValue`,iZ=`${Ks}labels.conjunction`,sZ=`${Ks}labels.disjunction`,oZ=`${Ks}values.blankCells`,aZ=`${Ks}buttons.selectAll`,lZ=`${Ks}buttons.clear`,cZ=`${Ks}buttons.ok`,uZ=`${Ks}buttons.cancel`,fZ=`${Ks}buttons.placeholder.search`,hZ=`${Ks}buttons.placeholder.value`,dZ=`${Ks}buttons.placeholder.secondValue`,GI="CheckboxRenderer:",pZ=`${GI}checked`,mZ=`${GI}unchecked`,KIe=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:pZ,CHECKBOX_RENDERER_NAMESPACE:GI,CHECKBOX_UNCHECKED:mZ,CONTEXTMENU_ITEMS_ADD_COMMENT:hQ,CONTEXTMENU_ITEMS_ALIGNMENT:gQ,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:CQ,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:yQ,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:wQ,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:vQ,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:SQ,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:xQ,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:bQ,CONTEXTMENU_ITEMS_BORDERS:TQ,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:AQ,CONTEXTMENU_ITEMS_BORDERS_LEFT:kQ,CONTEXTMENU_ITEMS_BORDERS_RIGHT:RQ,CONTEXTMENU_ITEMS_BORDERS_TOP:EQ,CONTEXTMENU_ITEMS_CLEAR_COLUMN:rQ,CONTEXTMENU_ITEMS_COPY:nQ,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:oQ,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:sQ,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:iQ,CONTEXTMENU_ITEMS_CUT:aQ,CONTEXTMENU_ITEMS_EDIT_COMMENT:dQ,CONTEXTMENU_ITEMS_FREEZE_COLUMN:lQ,CONTEXTMENU_ITEMS_HIDE_COLUMN:DQ,CONTEXTMENU_ITEMS_HIDE_ROW:IQ,CONTEXTMENU_ITEMS_INSERT_LEFT:KX,CONTEXTMENU_ITEMS_INSERT_RIGHT:XX,CONTEXTMENU_ITEMS_MERGE_CELLS:uQ,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:MQ,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:_Q,CONTEXTMENU_ITEMS_NO_ITEMS:GX,CONTEXTMENU_ITEMS_READ_ONLY:tQ,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:mQ,CONTEXTMENU_ITEMS_REDO:eQ,CONTEXTMENU_ITEMS_REMOVE_BORDERS:OQ,CONTEXTMENU_ITEMS_REMOVE_COLUMN:ZX,CONTEXTMENU_ITEMS_REMOVE_COMMENT:pQ,CONTEXTMENU_ITEMS_REMOVE_ROW:QX,CONTEXTMENU_ITEMS_ROW_ABOVE:YX,CONTEXTMENU_ITEMS_ROW_BELOW:qX,CONTEXTMENU_ITEMS_SHOW_COLUMN:PQ,CONTEXTMENU_ITEMS_SHOW_ROW:NQ,CONTEXTMENU_ITEMS_UNDO:JX,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:cQ,CONTEXTMENU_ITEMS_UNMERGE_CELLS:fQ,CONTEXT_MENU_ITEMS_NAMESPACE:$X,FILTERS_BUTTONS_CANCEL:uZ,FILTERS_BUTTONS_CLEAR:lZ,FILTERS_BUTTONS_OK:cZ,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:fZ,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:dZ,FILTERS_BUTTONS_PLACEHOLDER_VALUE:hZ,FILTERS_BUTTONS_SELECT_ALL:aZ,FILTERS_CONDITIONS_AFTER:QQ,FILTERS_CONDITIONS_BEFORE:ZQ,FILTERS_CONDITIONS_BEGINS_WITH:jQ,FILTERS_CONDITIONS_BETWEEN:KQ,FILTERS_CONDITIONS_BY_VALUE:qIe,FILTERS_CONDITIONS_CONTAINS:zQ,FILTERS_CONDITIONS_EMPTY:FQ,FILTERS_CONDITIONS_ENDS_WITH:WQ,FILTERS_CONDITIONS_EQUAL:BQ,FILTERS_CONDITIONS_GREATER_THAN:$Q,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:GQ,FILTERS_CONDITIONS_LESS_THAN:YQ,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:qQ,FILTERS_CONDITIONS_NAMESPACE:kn,FILTERS_CONDITIONS_NONE:LQ,FILTERS_CONDITIONS_NOT_BETWEEN:XQ,FILTERS_CONDITIONS_NOT_CONTAIN:UQ,FILTERS_CONDITIONS_NOT_EMPTY:HQ,FILTERS_CONDITIONS_NOT_EQUAL:VQ,FILTERS_CONDITIONS_TODAY:JQ,FILTERS_CONDITIONS_TOMORROW:eZ,FILTERS_CONDITIONS_YESTERDAY:tZ,FILTERS_DIVS_FILTER_BY_CONDITION:rZ,FILTERS_DIVS_FILTER_BY_VALUE:nZ,FILTERS_LABELS_CONJUNCTION:iZ,FILTERS_LABELS_DISJUNCTION:sZ,FILTERS_NAMESPACE:Ks,FILTERS_VALUES_BLANK_CELLS:oZ},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const gZ={languageCode:"en-US",[GX]:"No available options",[YX]:"Insert row above",[qX]:"Insert row below",[KX]:"Insert column left",[XX]:"Insert column right",[QX]:["Remove row","Remove rows"],[ZX]:["Remove column","Remove columns"],[JX]:"Undo",[eQ]:"Redo",[tQ]:"Read only",[rQ]:"Clear column",[gQ]:"Alignment",[vQ]:"Left",[yQ]:"Center",[xQ]:"Right",[wQ]:"Justify",[bQ]:"Top",[SQ]:"Middle",[CQ]:"Bottom",[lQ]:"Freeze column",[cQ]:"Unfreeze column",[TQ]:"Borders",[EQ]:"Top",[RQ]:"Right",[AQ]:"Bottom",[kQ]:"Left",[OQ]:"Remove border(s)",[hQ]:"Add comment",[dQ]:"Edit comment",[pQ]:"Delete comment",[mQ]:"Read-only comment",[uQ]:"Merge cells",[fQ]:"Unmerge cells",[nQ]:"Copy",[iQ]:["Copy with header","Copy with headers"],[sQ]:["Copy with group header","Copy with group headers"],[oQ]:["Copy header only","Copy headers only"],[aQ]:"Cut",[_Q]:"Insert child row",[MQ]:"Detach from parent",[DQ]:["Hide column","Hide columns"],[PQ]:["Show column","Show columns"],[IQ]:["Hide row","Hide rows"],[NQ]:["Show row","Show rows"],[LQ]:"None",[FQ]:"Is empty",[HQ]:"Is not empty",[BQ]:"Is equal to",[VQ]:"Is not equal to",[jQ]:"Begins with",[WQ]:"Ends with",[zQ]:"Contains",[UQ]:"Does not contain",[$Q]:"Greater than",[GQ]:"Greater than or equal to",[YQ]:"Less than",[qQ]:"Less than or equal to",[KQ]:"Is between",[XQ]:"Is not between",[QQ]:"After",[ZQ]:"Before",[JQ]:"Today",[eZ]:"Tomorrow",[tZ]:"Yesterday",[oZ]:"Blank cells",[rZ]:"Filter by condition",[nZ]:"Filter by value",[iZ]:"And",[sZ]:"Or",[aZ]:"Select all",[lZ]:"Clear",[cZ]:"OK",[uZ]:"Cancel",[fZ]:"Search",[hZ]:"Value",[dZ]:"Second value",[pZ]:"Checked",[mZ]:"Unchecked"},XIe=KIe,z_=gZ.languageCode,{register:QIe,getItem:vZ,hasItem:ZIe,getValues:JIe}=y0("languagesDictionaries");yZ(gZ);function yZ(t,e){let r=t,n=e;return Fl(t)&&(n=t,r=n.languageCode),eNe(r,n),QIe(r,Gu(n)),Gu(n)}function eNe(t,e){t!==z_&&WIe(e,vZ(z_))}function xZ(t){return YI(t)?Gu(vZ(t)):null}function YI(t){return ZIe(t)}function tNe(){return JIe()}function wZ(t,e,r){const n=xZ(t);if(n===null)return null;const i=n[e];if(Hs(i))return null;const s=rNe(i,r);return Array.isArray(s)?s[0]:s}function rNe(t,e){let r=t;return Bt(YIe(),n=>{r=n(t,e)}),r}function nNe(t){let e=zX(t);return YI(e)||(e=z_,UX(t)),e}function iNe(t,e,r){return(e=sNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sNe(t){var e=oNe(t,"string");return typeof e=="symbol"?e:e+""}function oNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zc extends SX{constructor(e,r){super(e,null),iNe(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function Pk(t){let{activeHeaderClassName:e,...r}=t;return new zc({className:e,...r,selectionType:xPe})}function aNe(t){let{areaCornerVisible:e,...r}=t;return new zc({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:II})}function lNe(t){let{...e}=t;return new zc({className:"highlight",...e,selectionType:II})}function cNe(t){let{columnClassName:e,...r}=t;return new zc({className:e,...r,selectionType:SPe})}function uNe(t){let{cellCornerVisible:e,...r}=t;return new zc({className:"current",headerAttributes:[$K()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Wg})}function fNe(t){let{border:e,visualCellRange:r,...n}=t;return new zc({...e,...n,selectionType:CPe},r)}function hNe(t){let{...e}=t;return new zc({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:wPe})}function lW(t){let{headerClassName:e,...r}=t;return new zc({className:e,...r,selectionType:CX})}function dNe(t){let{rowClassName:e,...r}=t;return new zc({className:e,...r,selectionType:bPe})}function pNe(t,e){mNe(t,e),e.add(t)}function mNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ms(t,e,r){return(e=gNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gNe(t){var e=vNe(t,"string");return typeof e=="symbol"?e:e+""}function vNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var al=new WeakSet;class yNe{constructor(e){pNe(this,al),Ms(this,"options",void 0),Ms(this,"layerLevel",0),Ms(this,"focus",void 0),Ms(this,"fill",void 0),Ms(this,"layeredAreas",new Map),Ms(this,"areas",new Map),Ms(this,"rowHeaders",new Map),Ms(this,"columnHeaders",new Map),Ms(this,"activeRowHeaders",new Map),Ms(this,"activeColumnHeaders",new Map),Ms(this,"activeCornerHeaders",new Map),Ms(this,"rowHighlights",new Map),Ms(this,"columnHighlights",new Map),Ms(this,"customSelections",[]),this.options=e,this.focus=uNe(e),this.fill=hNe(e)}isEnabledFor(e,r){let n=e;e===Wg&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return pc(al,this,mc).call(this,this.layeredAreas,aNe)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return pc(al,this,mc).call(this,this.areas,lNe)}getAreas(){return[...this.areas.values()]}createRowHeader(){return pc(al,this,mc).call(this,this.rowHeaders,lW)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return pc(al,this,mc).call(this,this.columnHeaders,lW)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return pc(al,this,mc).call(this,this.activeRowHeaders,Pk)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return pc(al,this,mc).call(this,this.activeColumnHeaders,Pk)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return pc(al,this,mc).call(this,this.activeCornerHeaders,Pk)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return pc(al,this,mc).call(this,this.rowHighlights,dNe)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return pc(al,this,mc).call(this,this.columnHighlights,cNe)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(fNe({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Bt(this.areas.values(),e=>void e.clear()),Bt(this.layeredAreas.values(),e=>void e.clear()),Bt(this.rowHeaders.values(),e=>void e.clear()),Bt(this.columnHeaders.values(),e=>void e.clear()),Bt(this.activeRowHeaders.values(),e=>void e.clear()),Bt(this.activeColumnHeaders.values(),e=>void e.clear()),Bt(this.activeCornerHeaders.values(),e=>void e.clear()),Bt(this.rowHighlights.values(),e=>void e.clear()),Bt(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function mc(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function cW(t,e,r){return(e=xNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xNe(t){var e=wNe(t,"string");return typeof e=="symbol"?e:e+""}function wNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let bNe=class{constructor(e){cW(this,"ranges",[]),cW(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}};function SNe(t,e){bZ(t,e),e.add(t)}function Ik(t,e,r){bZ(t,e),e.set(t,r)}function bZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e){return t.get(Yn(t,e))}function Y1(t,e,r){return t.set(Yn(t,e),r),r}function Yn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var q1=new WeakMap,zr=new WeakMap,Va=new WeakMap,ai=new WeakSet;class U_{constructor(e,r){SNe(this,ai),Ik(this,q1,void 0),Ik(this,zr,void 0),Ik(this,Va,{x:0,y:0}),Y1(q1,this,e),Y1(zr,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=nr(zr,this).createCellCoords(e,r);let s=nr(q1,this).current().highlight;const o=nr(zr,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:h}=Yn(ai,this,SZ).call(this),{row:d,col:m}=Yn(ai,this,fW).call(this,s),g=nr(zr,this).fixedRowsBottom(),y=nr(zr,this).minSpareRows(),x=nr(zr,this).minSpareCols(),b=nr(zr,this).autoWrapRow(),C=nr(zr,this).autoWrapCol(),E=nr(zr,this).createCellCoords(d+i.row,m+i.col);if(E.row>=h){const O=uo(n&&y>0&&g===0),P=E.col+1,D=nr(zr,this).createCellCoords(E.row-h,P>=u?P-u:P);this.runLocalHooks("beforeColumnWrap",O,Yn(ai,this,Gd).call(this,D),P>=u),O.value?this.runLocalHooks("insertRowRequire",nr(zr,this).countRenderableRows()):C&&E.assign(D)}else if(E.row<0){const O=uo(C),P=E.col-1,D=nr(zr,this).createCellCoords(h+E.row,P<0?u+P:P);this.runLocalHooks("beforeColumnWrap",O,Yn(ai,this,Gd).call(this,D),P<0),C&&E.assign(D)}if(E.col>=u){const O=uo(n&&x>0),P=E.row+1,D=nr(zr,this).createCellCoords(P>=h?P-h:P,E.col-u);this.runLocalHooks("beforeRowWrap",O,Yn(ai,this,Gd).call(this,D),P>=h),O.value?this.runLocalHooks("insertColRequire",nr(zr,this).countRenderableColumns()):b&&E.assign(D)}else if(E.col<0){const O=uo(b),P=E.row-1,D=nr(zr,this).createCellCoords(P<0?h+P:P,u+E.col);this.runLocalHooks("beforeRowWrap",O,Yn(ai,this,Gd).call(this,D),P<0),b&&E.assign(D)}const{rowDir:R,colDir:k}=Yn(ai,this,uW).call(this,E);a=R,l=k,s=Yn(ai,this,Gd).call(this,E)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,r){const n=nr(zr,this).createCellCoords(e,r),i=nr(q1,this).current(),s=nr(zr,this).visualToRenderableCoords(i.highlight),o=Yn(ai,this,Nk).call(this,i.to.row,i.from.row),a=Yn(ai,this,Lk).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,h=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:d,col:m}=Yn(ai,this,fW).call(this,i.highlight),g=nr(zr,this).createCellCoords(o+n.row,a+n.col),y=i.getTopStartCorner(),x=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=m&&g.col<m){const k=g.col-m;g.col=Yn(ai,this,Lk).call(this,y.col,x.col)+k}else if(n.col>0&&a<=m&&g.col>m){const k=Yn(ai,this,Lk).call(this,x.col,y.col),O=Math.max(g.col-k,1);g.col=k+O}if(n.row<0&&o>=d&&g.row<d){const k=g.row-d;g.row=Yn(ai,this,Nk).call(this,y.row,b.row)+k}else if(n.row>0&&o<=d&&g.row>d){const k=Yn(ai,this,Nk).call(this,b.row,y.row),O=Math.max(g.row-k,1);g.row=k+O}const{rowDir:C,colDir:E}=Yn(ai,this,uW).call(this,g);u=C,h=E;const R=Yn(ai,this,Gd).call(this,g);n.row===0&&n.col!==0?l.col=R.col:n.row!==0&&n.col===0?l.row=R.row:(l.row=R.row,l.col=R.col)}return this.runLocalHooks("afterTransformEnd",l,u,h),l}setOffsetSize(e){let{x:r,y:n}=e;Y1(Va,this,{x:r,y:n})}resetOffsetSize(){Y1(Va,this,{x:0,y:0})}}function uW(t){const{width:e,height:r}=Yn(ai,this,SZ).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function SZ(){return{width:nr(Va,this).x+nr(zr,this).countRenderableColumns(),height:nr(Va,this).y+nr(zr,this).countRenderableRows()}}function Nk(t,e){const r=nr(zr,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:nr(Va,this).y+r}function Lk(t,e){const r=nr(zr,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:nr(Va,this).x+r}function fW(t){const{row:e,col:r}=nr(zr,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return nr(zr,this).createCellCoords(nr(Va,this).y+e,nr(Va,this).x+r)}function Gd(t){const e=t.clone();return e.col=t.col-nr(Va,this).x,e.row=t.row-nr(Va,this).y,nr(zr,this).renderableToVisualCoords(e)}jn(U_,Wc);const CZ=0,TZ=1,EZ=2,qI=3,CNe=[qI,EZ],TNe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Fk=Symbol("root"),hW=Symbol("child");function RZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fk;if(e!==Fk&&e!==hW)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Fk;let i=CZ;if(r){const s=t[0];t.length===0?i=TZ:n&&s instanceof _y?i=qI:n&&Array.isArray(s)?i=RZ(s,hW):t.length>=2&&t.length<=4&&!t.some((a,l)=>!TNe[l].includes(typeof a))&&(i=EZ)}return i}function ENe(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!CNe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===qI;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],h=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof h=="string"&&(h=i(h))),Hs(u)&&(u=a),Hs(h)&&(h=l),!n){const g=a,y=l,x=u,b=h;a=Math.min(g,x),l=Math.min(y,b),u=Math.max(g,x),h=Math.max(y,b)}const d=e(a,l),m=e(u,h);return r(d,d,m)}}function Yd(t,e,r){RNe(t,e),e.set(t,r)}function RNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pf(t,e,r){return(e=ANe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ANe(t){var e=kNe(t,"string");return typeof e=="symbol"?e:e+""}function kNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kr(t,e){return t.get(AZ(t,e))}function ll(t,e,r){return t.set(AZ(t,e),r),r}function AZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yi=new WeakMap,If=new WeakMap,K1=new WeakMap,Ym=new WeakMap,X1=new WeakMap,qm=new WeakMap;class kZ{constructor(e,r){var n=this;Pf(this,"settings",void 0),Pf(this,"tableProps",void 0),Pf(this,"inProgress",!1),Pf(this,"selectedRange",new bNe((i,s,o)=>this.tableProps.createCellRange(i,s,o))),Pf(this,"highlight",void 0),Yd(this,Yi,void 0),Yd(this,If,void 0),Pf(this,"selectedByRowHeader",new Set),Pf(this,"selectedByColumnHeader",new Set),Yd(this,K1,!1),Yd(this,Ym,!1),Yd(this,X1,"unknown"),Yd(this,qm,-1),this.settings=e,this.tableProps=r,this.highlight=new yNe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[$K()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),ll(Yi,this,new U_(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),ll(If,this,new U_(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Kr(Yi,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),Kr(Yi,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),Kr(Yi,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),Kr(Yi,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),Kr(Yi,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),Kr(Yi,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),Kr(Yi,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),Kr(Yi,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),Kr(If,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),Kr(If,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){ll(X1,this,e)}markEndSource(){ll(X1,this,"unknown")}getSelectionSource(){return Kr(X1,this)}setExpectedLayers(e){ll(qm,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ll(qm,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=Hs(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();ll(K1,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&Hs(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),h=this.isMultiple();o.setTo(r),h&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),h&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Kr(qm,this)===-1||this.selectedRange.size()===Kr(qm,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(Bt(this.highlight.getAreas(),y=>void y.clear()),Bt(this.highlight.getLayeredAreas(),y=>void y.clear()),Bt(this.highlight.getRowHeaders(),y=>void y.clear()),Bt(this.highlight.getColumnHeaders(),y=>void y.clear()),Bt(this.highlight.getActiveRowHeaders(),y=>void y.clear()),Bt(this.highlight.getActiveColumnHeaders(),y=>void y.clear()),Bt(this.highlight.getActiveCornerHeaders(),y=>void y.clear()),Bt(this.highlight.getRowHighlights(),y=>void y.clear()),Bt(this.highlight.getColumnHighlights(),y=>void y.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),h.clear(),d.clear(),m.clear(),g.clear(),this.highlight.isEnabledFor(II,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const y=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(y.from).commit().syncWith(y),this.highlight.createLayeredArea().add(y.from).commit().syncWith(y),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(CX,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),C=this.tableProps.createCellCoords(e.to.row,-1),E=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),R=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(E).commit(),m.add(b).commit(),g.add(E).commit()):(a.add(b).add(C).commit(),l.add(E).add(R).commit(),m.add(b).add(C).commit(),g.add(E).add(R).commit())}const y=!Kr(Ym,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),x=!Kr(Ym,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());y&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),x&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),y&&x&&d.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Wg,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(ll(K1,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Kr(Yi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Kr(Yi,this).resetOffsetSize(),this.setRangeStart(Kr(Yi,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?Kr(Yi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Kr(Yi,this).resetOffsetSize(),this.setRangeEnd(Kr(Yi,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?Kr(If,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):Kr(If,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=Kr(If,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=u?-1:0,d=u?0:r;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(wn(i.row+d,h,a-1),i.col),g=this.tableProps.createCellCoords(wn(s.row+r,h,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(wn(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(m,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=l?-1:0,d=l?0:r;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(i.row,wn(i.col+d,h,a-1)),g=this.tableProps.createCellCoords(s.row,wn(s.col+r,h,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(o.row,wn(o.col+r,0,a-1))):this.setRangeStartOnly(m,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=uo(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Kr(K1,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,h=r?-a:0;if(u===0&&h===0&&(s===0||o===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:m,disableHeadersHighlight:g}=i;ll(Ym,this,g),m&&Number.isInteger(m==null?void 0:m.row)&&Number.isInteger(m==null?void 0:m.col)&&(d=this.tableProps.createCellCoords(wn(m.row,u,s-1),wn(m.col,h,o-1)));const y=this.tableProps.createCellCoords(u,h),x=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(y,void 0,d),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.finish(),ll(Ym,this,!1)}selectCells(e){var r=this;const n=RZ(e);if(n===TZ)return!1;if(n===CZ)throw new Error(mo`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=ENe(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),h=u.isValid(o);return!(h&&!u.containsHeaders()||h&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),Bt(e,l=>{const{from:u,to:h}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(h.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,h=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(o-1,s),m=this.tableProps.createCellRange(h,h,d).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(m){let g=0,y=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(g=wn(n.row,u,o-1),y=wn(n.col,Math.min(i,s),Math.max(i,s))):(g=wn(n,u,o-1),y=i);const x=this.tableProps.createCellCoords(g,y),b=l===0?0:wn(x.row,u,-1),C=o-1,E=this.tableProps.createCellCoords(b,i),R=this.tableProps.createCellCoords(C,s);this.runLocalHooks("beforeSelectColumns",E,R,x),E.row=b,R.row=C,this.setRangeStartOnly(E,void 0,x),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectColumns",E,R,x),this.finish()}return m}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,s-1),h=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(h){let d=0,m=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(d=wn(n.row,Math.min(e,r),Math.max(e,r)),m=wn(n.col,a,s-1)):(d=e,m=wn(n,a,s-1));const g=this.tableProps.createCellCoords(d,m),y=o===0?0:wn(g.col,a,-1),x=s-1,b=this.tableProps.createCellCoords(e,y),C=this.tableProps.createCellCoords(r,x);this.runLocalHooks("beforeSelectRows",b,C,g),b.col=y,C.col=x,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.runLocalHooks("afterSelectRows",b,C,g),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=n;this.clear(),o.assign({row:wn(o.row,-1/0,e-1),col:wn(o.col,-1/0,r-1)}),i.assign({row:wn(i.row,-1/0,e-1),col:wn(i.col,-1/0,r-1)}),s.assign({row:wn(s.row,0,e-1),col:wn(s.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.isEnabledFor(Wg,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(Wg,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),h.commit(),d.commit(),m.commit(),g.commit()}this.highlight.useLayerLevel(r)}}jn(kZ,Wc);function dW(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function Nf(t,e,r){return(e=ONe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ONe(t){var e=_Ne(t,"string");return typeof e=="symbol"?e:e+""}function _Ne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fp{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Nf(this,"hot",void 0),Nf(this,"metaManager",void 0),Nf(this,"tableMeta",void 0),Nf(this,"dataSource",void 0),Nf(this,"duckSchema",void 0),Nf(this,"colToPropCache",void 0),Nf(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=EI(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(Fl(a)){if(typeof a.data<"u"){const l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return DX(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&fn(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Jt(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(Jt(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Av(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};const h=this.tableMeta.maxRows,d=this.getSchema().length,m=[];for(;a<r&&s+a<h;){let y=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?y=Gu(this.getSchema()):(y=[],Ko(d-1,()=>y.push(null))):this.hot.dataType==="function"?y=this.tableMeta.dataSchema(l+a):(y={},tX(y,this.getSchema())),m.push(y),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,m);const g=this.hot.toVisualRow(o);return this.hot.countSourceRows()===m.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let h=a;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let m=this.hot.countCols(),g=0,y=h;i==="end"&&(y=Math.min(y+1,a));const x=y;for(;g<r&&m<o;){if(typeof l!="number"||l>=m)if(d>0)for(let C=0;C<d;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(let C=0;C<d;C++)s[C].splice(y,0,null);g+=1,y+=1,m+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(x,r));const b=this.hot.toVisualColumn(x);return this.hot.runHooks("afterCreateCol",b,g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:x}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const h=Jt(this.tableMeta.columns)||Jt(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!h&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((h,d)=>d-h).forEach(h=>{this.metaManager.removeRow(h,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((d,m)=>m-d);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0;const u=o.length,h=this.dataSource;for(let d=0;d<u;d++)l&&s[0]!==s[d]-d&&(l=!1);if(l)for(let d=0,m=this.hot.countSourceRows();d<m;d++)h[d].splice(s[0],r),d===0&&this.metaManager.removeColumn(s[0],r);else for(let d=0,m=this.hot.countSourceRows();d<m;d++)for(let g=0;g<u;g++)h[d].splice(o[g],1),d===0&&this.metaManager.removeColumn(o[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];b9(l,o);let h=0;for(;h<n;)l.push(null),h+=1;return tOe(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];b9(l,o);let h=0;for(;h<n;)l.push(null),h+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Ch(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let h=0,d=u.length;h<d;h++)if(l=l[u[h]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=uo(a);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=uo(s);this.hot.runHooks("modifyData",i,this.propToCol(r),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Ch(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=o,h=0,d;const m=r.split(".");for(h=0,d=m.length-1;h<d;h++){if(m[h]==="__proto__"||m[h]==="constructor"||m[h]==="prototype")return;typeof u[m[h]]>"u"&&(u[m[h]]={}),u=u[m[h]]}u[m[h]]=s}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;o[r]=s}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,fp.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const h=n===fp.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),m=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=d;s++){a=[];const g=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=m&&g!==null;o++)a.push(h.call(this,s,this.colToProp(o)));g!==null&&i.push(a)}return i}getText(e,r){return dW(this.getRange(e,r,fp.DESTINATION_RENDERER))}getCopyableText(e,r){return dW(this.getRange(e,r,fp.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:MNe,getItem:DNe,hasItem:PNe}=y0("cellTypes");function INe(t){if(!PNe(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return DNe(t)}function NNe(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&aX(t,r),n&&tMe(t,n),i&&oMe(t,i),MNe(t,e)}function LNe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Ch(e,t)}function fC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?INe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&fn(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Fl(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};fn(n,(s,o)=>{if(LNe(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Up(t,i)}function FNe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}LOe(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function $w(t){return Number.isInteger(t)&&t>=0}function Gw(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Q1(t){return t==null}const OZ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),zp(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),zp(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),rX(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function pW(t,e,r){return(e=HNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HNe(t){var e=BNe(t,"string");return typeof e=="symbol"?e:e+""}function BNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VNe(){return class{}}class jNe{constructor(e){pW(this,"metaCtor",VNe()),pW(this,"meta",void 0),this.meta=this.metaCtor.prototype,Up(this.meta,OZ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Up(this.meta,e),fC(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function WNe(t,e,r){return(e=zNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zNe(t){var e=UNe(t,"string");return typeof e=="symbol"?e:e+""}function UNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $Ne{constructor(e){WNe(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Up(this.meta,e),fC(this.meta,e,e)}}function Z1(t,e,r){return(e=GNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GNe(t){var e=YNe(t,"string");return typeof e=="symbol"?e:e+""}function YNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vb{constructor(e){Z1(this,"valueFactory",void 0),Z1(this,"data",[]),Z1(this,"index",[]),Z1(this,"holes",new Set),this.valueFactory=e}obtain(e){Gw(()=>$w(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gw(()=>$w(e)||Q1(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=Q1(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gw(()=>$w(e)||Q1(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Q1(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function mW(t,e,r){return(e=qNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qNe(t){var e=KNe(t,"string");return typeof e=="symbol"?e:e+""}function KNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XNe=["data","width"];class QNe{constructor(e){mW(this,"globalMeta",void 0),mW(this,"metas",new Vb(()=>this._createMeta())),this.globalMeta=e,this.metas=new Vb(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Up(n,r),fC(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return FNe(this.globalMeta.getMetaConstructor(),XNe).prototype}}function gW(t,e,r){return(e=ZNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZNe(t){var e=JNe(t,"string");return typeof e=="symbol"?e:e+""}function JNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e4e{constructor(e){gW(this,"columnMeta",void 0),gW(this,"metas",new Vb(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Up(i,n),fC(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Jt(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Gw(()=>$w(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Vb(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class _Z{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new jNe(e),this.tableMeta=new $Ne(this.globalMeta),this.columnMeta=new QNe(this.globalMeta),this.cellMeta=new e4e(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}jn(_Z,Wc);function vW(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:h}=n,d=wI(a),m=i.getSettings();Array.isArray(m.dataSchema)?i.dataType="array":Rr(m.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${d}`,t,h,l);const g=new fp(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const y=g.getSchema();t=[];let x,b=0,C=0;for(b=0,C=m.startRows;b<C;b++)if((i.dataType==="object"||i.dataType==="function")&&m.dataSchema)x=Gu(y),t.push(x);else if(i.dataType==="array")x=Gu(y[0]),t.push(x);else{x=[];for(let E=0,R=m.startCols;E<R;E++)x.push(null);t.push(x)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),m.data=t,g.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=g.colToProp.bind(g),o.propToCol=g.propToCol.bind(g),o.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${d}`,t,h,l),h||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&cn(i.rootElement,[zK(-1),nC(i.countCols()+(i.view?i.countRowHeaders():0))])}function yW(t,e,r){return(e=t4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t4e(t){var e=r4e(t,"string");return typeof e=="symbol"?e:e+""}function r4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n4e{constructor(e){var r=this;yW(this,"metaManager",void 0),yW(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),yi.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Ch(e,"type")?e.type:null;let h=Rr(e.cells)?e.cells(n,i,l):null;if(u)if(h){var d;h.type=(d=h.type)!==null&&d!==void 0?d:u}else h={type:u};h&&this.metaManager.updateCellMeta(n,i,h),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function i4e(t,e,r){s4e(t,e),e.set(t,r)}function s4e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hk(t,e,r){return(e=o4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o4e(t){var e=a4e(t,"string");return typeof e=="symbol"?e:e+""}function a4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l4e(t,e){return t.get(c4e(t,e))}function c4e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xW=new WeakMap;class u4e{constructor(e){Hk(this,"metaManager",void 0),Hk(this,"usageTracker",new Set),Hk(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),i4e(this,xW,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(i,l,s)):n&&(this.installPropWatcher(r,l,l4e(xW,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const MZ="gridDefault",DZ="editorManager.handlingEditor",f4e={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},h4e="hooksRefRegisterer",PZ={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Bt(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){fn(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};sf(PZ,"MIXIN_NAME",h4e,{writable:!1,enumerable:!1});function ka(t,e,r){return(e=d4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d4e(t){var e=p4e(t,"string");return typeof e=="symbol"?e:e+""}function p4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const m4e="base",Qn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class KI{static get EDITOR_TYPE(){return m4e}constructor(e){ka(this,"hot",void 0),ka(this,"state",Qn.VIRGIN),ka(this,"_opened",!1),ka(this,"_fullEditMode",!1),ka(this,"_closeCallback",null),ka(this,"TD",null),ka(this,"row",null),ka(this,"col",null),ka(this,"prop",null),ka(this,"originalValue",null),ka(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Qn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==Qn.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Qn.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Hg(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Qn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Qn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Qn.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Qn.FINISHED,this.discardEditor(o)}):(this.state=Qn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Qn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Qn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Qn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Qn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Qn.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=qo(r),a=Bs(r),l=qo(this.hot.rootElement),u=Bs(this.hot.rootElement),h=n.topOverlay.holder,d=n.inlineStartOverlay.holder,m=h!==s?h.scrollTop:0,g=d!==s?d.scrollLeft:0,y=s.innerWidth-l.left-u,{wtTable:x}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=x.name,C=["master","inline_start"].includes(b)?m:0,E=["master","top","bottom"].includes(b)?g:0,R=o.top===l.top?0:1;let k=o.top-l.top-R-C,O=0;this.hot.isRtl()?O=s.innerWidth-o.left-a-y-1+E:O=o.left-l.left-1-E,["top","top_inline_start_corner"].includes(b)&&(k+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(O+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),D=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),H=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),_=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&D<=0||D===_)&&(k+=1),H<=0&&(O+=1);const B=i.rowsRenderCalculator.startPosition,j=i.columnsRenderCalculator.startPosition,ee=Math.abs(n.inlineStartOverlay.getScrollPosition()),oe=n.topOverlay.getScrollPosition(),re=$s(this.hot.rootDocument);let q=r.offsetTop;if(["inline_start","master"].includes(b)&&(q+=B-oe),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:ae,wtTable:ue}=n.bottomOverlay.clone;q+=ae.getWorkspaceHeight()-ue.getHeight()-re}let Z=r.offsetLeft;this.hot.isRtl()?(Z>=0?Z=x.getWidth()-r.offsetLeft:Z=Math.abs(Z),Z+=j-ee-a):["top","master","bottom"].includes(b)&&(Z+=j-ee);const ve=s.getComputedStyle(this.TD),ie=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",K=parseInt(ve[ie],10)>0?0:1,ce=parseInt(ve.borderTopWidth,10)>0?0:1,S=Bs(r)+K,A=go(r)+ce,M=OOe(h)?re:0,L=_Oe(d)?re:0,V=this.hot.view.maximumVisibleElementWidth(Z)-M+K,J=Math.max(this.hot.view.maximumVisibleElementHeight(q)-L+ce,this.hot.view.getDefaultRowHeight());return{top:k,start:O,height:A,maxHeight:J,width:S,maxWidth:V}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}jn(KI,PZ);const g4e={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===Qn.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},v4e={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},y4e={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},x4e={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},w4e={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),aC(e))}};function b4e(){return[f4e,g4e,v4e,y4e,x4e,w4e]}const S4e={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},C4e={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(i,-1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},T4e={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},E4e={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},R4e={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},A4e={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},k4e={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},O4e={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},_4e={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},M4e={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},D4e={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},P4e={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},I4e={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},N4e={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(i,1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function L4e(){return[S4e,C4e,T4e,E4e,R4e,A4e,k4e,O4e,_4e,M4e,D4e,P4e,I4e,N4e]}const F4e={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},H4e={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?1:s,i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},B4e={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},V4e={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},j4e={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},W4e={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},z4e={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},U4e={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},$4e={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},G4e={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,s)),e.markEndSource()}},Y4e={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},q4e={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},K4e={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},X4e={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},Q4e={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Z4e={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?-1:-s,i===-n?s=-1:i+s<n&&(s=-(i+n)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function J4e(){return[F4e,H4e,B4e,V4e,j4e,W4e,z4e,U4e,$4e,G4e,Y4e,q4e,K4e,X4e,Q4e,Z4e]}const eLe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},tLe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const h=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-h,0)}if(e.row>=0){const h=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-h,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},rLe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},nLe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},iLe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},sLe=[...b4e(),...L4e(),...J4e(),eLe,tLe,rLe,nLe,iLe];function IZ(t){const e={};return sLe.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function oLe(t){const e=t.getShortcutManager().addContext("editor"),r=IZ(t),n={group:DZ};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function aLe(t){const e=t.getShortcutManager().addContext("grid"),r=IZ(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Jt(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:MZ};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:DZ,runOnlyIf:()=>Jt(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function lLe(t){[aLe,oLe].forEach(e=>e(t))}function cLe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=wW(t),i=wW(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function wW(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&cn(r,[mOe("Focus catcher")]),r}function uLe(t){const e=fLe(t);let r;const{activate:n,deactivate:i}=cLe(t,{onFocusFromTop(){var d;const m=(d=e(r))!==null&&d!==void 0?d:$_(t);m&&(t.runHooks("modifyFocusOnTabNavigation","from_above",m),t.selectCell(m.row,m.col)),t.listen()},onFocusFromBottom(){var d;const m=(d=e(r))!==null&&d!==void 0?d:G_(t);m&&(t.runHooks("modifyFocusOnTabNavigation","from_below",m),t.selectCell(m.row,m.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(d,m,g,y,x)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,x.value=!0),o){var b;r=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(d,m,g)=>{s.wrapped=!0,s.flipped=g});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:MZ,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:d}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!d&&(o=!1),d||(l=!0)},position:"before"},{...h,callback:d=>{const{tabNavigation:m,autoWrapRow:g}=t.getSettings();if(a=!1,o=!0,!m||!t.selection.isSelected()||g&&s.wrapped&&s.flipped||!g&&s.wrapped)return g&&s.wrapped&&s.flipped&&(r=d.shiftKey?$_(t):G_(t)),u(),!1;d.preventDefault()},position:"after"}])}function $_(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function G_(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function fLe(t){return e=>{if(!e)return null;const r=$_(t),n=G_(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function w0(t){sC(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function hC(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),o=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=s,h=l>=o,d=r.getFirstFullyVisibleRow(),m=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,y=n.getBottomEndCorner().row,x=g<=d,b=y>=m;return{getComputedColumnTarget(C){return i==="mouse"||i==="keyboard"?C.col:u&&h?n.highlight.col:u?a:h?l:C.col},getComputedRowTarget(C){return i==="mouse"||i==="keyboard"?C.row:x&&b?n.highlight.row:x?g:b?y:C.row}}}function hLe(t){return e=>{const r=hC(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;w0(t.getCell(n?-1:0,r,!0))})}}function dLe(){return()=>{}}function pLe(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;w0(t.getCell(r,n,!0))})}}function mLe(t){return e=>{const r=hC(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;w0(t.getCell(i,s,!0))})}}function gLe(t){return e=>{const r=hC(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;w0(t.getCell(i,s,!0))})}}function vLe(t){return e=>{const r=hC(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;w0(t.getCell(r,n?-1:0,!0))})}}function yLe(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,s=()=>{w0(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},s);else if(i<0&&n>=0)t.scrollViewportTo({row:n},s);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},s)}}}function xLe(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=pLe(t):e.isSelectedByCorner()?o=dLe():e.isSelectedByRowHeader()?o=vLe(t):e.isSelectedByColumnHeader()?o=hLe(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=mLe(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=yLe(t):e.getSelectedRange().size()>1&&(o=gLe(t)),(s=o)===null||s===void 0||s(i)}}}const bW=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),J1=t=>t.map(e=>{const r=e.toLowerCase();return bW.has(r)?bW.get(r):r}).sort().join("+"),wLe=t=>t.split("+"),SW=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Bk=t=>{let{which:e,key:r}=t;if(SW.has(e))return SW.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},NZ=Symbol("shortcut-context");function LZ(t){return Fl(t)&&t.__kindOf===NZ}const bLe=t=>{const e=lC({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:h,runOnlyIf:d=()=>!0,captureCtrl:m=!1,preventDefault:g=!0,stopPropagation:y=!1,relativeToGroup:x,position:b,forwardToContext:C}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Hs(h))throw new Error("You need to define the shortcut's group.");if(Rr(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(mo`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const E={callback:u,group:h,runOnlyIf:d,captureCtrl:m,preventDefault:g,stopPropagation:y};Jt(x)&&(E.relativeToGroup=x,E.position=b),LZ(C)&&(E.forwardToContext=C),l.forEach(R=>{const k=J1(R);if(e.hasItem(k)){const P=e.getItem(k);let D=P.findIndex(H=>H.group===x);D!==-1?b==="before"?D-=1:D+=1:D=P.length,P.splice(D,0,E)}else e.addItem(k,[E])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(h=>{fn(u,(d,m)=>{Object.prototype.hasOwnProperty.call(h,m)===!1&&(h[m]=u[m])}),r(h)})},i=l=>{const u=J1(l);e.removeItem(u)};return{__kindOf:NZ,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=J1(l),h=e.getItem(u);return Jt(h)?h.slice():[]},hasShortcut:l=>{const u=J1(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(h=>{let[d,m]=h;const g=m.filter(y=>y.group!==l);g.length===0?i(wLe(d)):(m.length=0,m.push(...g))})}}};function SLe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const CLe=["meta","alt","shift","control"],Km=SLe(),Xm=[];let ew=0;function TLe(t,e,r,n,i){const s=g=>CLe.includes(g),o=function(g){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const x=[];return g.altKey&&x.push("alt"),y&&(g.ctrlKey||g.metaKey)?x.push("control/meta"):(g.ctrlKey&&x.push("control"),g.metaKey&&x.push("meta")),g.shiftKey&&x.push("shift"),x},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||Yf(g))return;const x=Bk(g);let b=[];s(x)||(b=o(g));const C=[x].concat(b);!i(g,C)&&(L9()&&b.includes("meta")||!L9()&&b.includes("control"))&&i(g,[x].concat(o(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const y=Bk(g);s(y)&&Km.press(y)}},u=g=>{if(typeof g.key=="string"){const y=Bk(g);s(y)&&Km.release(y)}},h=()=>{Km.releaseAll()};return{mount:()=>{let g=t;for(ew+=1;g;)ew===1&&(g.document.documentElement.addEventListener("keydown",l),Xm.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),Xm.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",h),g=Nb(g)},unmount:()=>{let g=t;for(ew-=1;g;){if(ew===0){for(let y=0;y<Xm.length;y++){const{event:x,listener:b}=Xm[y];g.document.documentElement.removeEventListener(x,b)}Xm.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",h),g=Nb(g)}},isPressed:g=>Km.isPressed(g),releasePressedKeys:()=>Km.releaseAll()}}const ELe=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=lC({errorIdExists:y=>`The "${y}" context name is already registered.`});let o="grid";const a=y=>{const x=bLe(y);return s.addItem(y,x),x},l=()=>o,u=y=>s.getItem(y),h=y=>{if(!s.hasItem(y))throw new Error(mo`You've tried to activate the "${y}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=y};let d=!1;const m=function(y,x){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const C=LZ(b)?b:u(b);let E=!1;if(!C.hasShortcut(x))return E;const R=C.getShortcuts(x);for(let k=0;k<R.length;k++){const{callback:O,runOnlyIf:P,preventDefault:D,stopPropagation:H,captureCtrl:N,forwardToContext:_}=R[k];if(P(y)===!0){if(d=N,E=O(y,x)===!1,d=!1,D&&y.preventDefault(),H&&(aC(y),y.stopPropagation()),E)break;_&&m(y,x,_)}}return E},g=TLe(e,r,n,i,m);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:h,isCtrlPressed:()=>!d&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};function CW(t){const{classNames:e}=wOe(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Vk=null;const jk=new Map;function FZ(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new $p(s);let a,l,u,h,d,m,g=!0;sIe(i)&&iIe(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const y=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",x=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",x),this.isRtl=function(){return x==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=nNe(e.language);const b=Object.fromEntries(Object.entries(e).filter(S=>{let[A]=S;return!(yi.getSingleton().isRegistered(A)||yi.getSingleton().isDeprecated(A))})),C=new _Z(s,b,[n4e,u4e]),E=C.getTableMeta(),R=C.getGlobalMeta(),k=lC();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Uw(this)&&(sOe(e.licenseKey,t),$t(t,"ht-wrapper")),this.guid=`ht_${jK()}`,jk.set(this.guid,this),this.columnIndexMapper=new W_,this.rowIndexMapper=new W_,this.columnIndexMapper.addLocalHook("indexesSequenceChange",S=>{s.runHooks("afterColumnSequenceChange",S)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",S=>{s.runHooks("afterRowSequenceChange",S)}),o.addEventListener(this.rootDocument.documentElement,"compositionstart",S=>{s.runHooks("beforeCompositionStart",S)}),l=new yIe(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const O=S=>{const{row:A,col:M}=S;return s._createCellCoords(A>=0?s.rowIndexMapper.getRenderableFromVisualIndex(A):A,M>=0?s.columnIndexMapper.getRenderableFromVisualIndex(M):M)},P=S=>{const{row:A,col:M}=S;return s._createCellCoords(A>=0?s.rowIndexMapper.getVisualFromRenderableIndex(A):A,M>=0?s.columnIndexMapper.getVisualFromRenderableIndex(M):M)},D=(S,A)=>{const M=A>S?1:-1,L=Math.min(S,A),V=Math.max(S,A),J=s.rowIndexMapper.getNearestNotHiddenIndex(S,M);return J===null||M===1&&J>V||M===-1&&J<L?null:J>=0?s.rowIndexMapper.getRenderableFromVisualIndex(J):J},H=(S,A)=>{const M=A>S?1:-1,L=Math.min(S,A),V=Math.max(S,A),J=s.columnIndexMapper.getNearestNotHiddenIndex(S,M);return J===null||M===1&&J>V||M===-1&&J<L?null:J>=0?s.columnIndexMapper.getRenderableFromVisualIndex(J):J};let N=new kZ(E,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:S=>a.propToCol(S),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(S,A)=>s._createCellCoords(S,A),createCellRange:(S,A,M)=>s._createCellRange(S,A,M),visualToRenderableCoords:O,renderableToVisualCoords:P,findFirstNonHiddenRenderableRow:D,findFirstNonHiddenRenderableColumn:H,isDisabledCellSelection:(S,A)=>S<0||A<0?s.getSettings().disableVisualSelection:s.getCellMeta(S,A).disableVisualSelection});this.selection=N;const _=S=>{let{hiddenIndexesChanged:A}=S;this.forceFullRender=!0,A&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",_),this.rowIndexMapper.addLocalHook("cacheUpdated",_),this.selection.addLocalHook("afterSetRangeEnd",(S,A)=>{const M=uo(!1),L=this.selection.getSelectedRange(),{from:V,to:J}=L.current(),ae=L.size()-1;this.runHooks("afterSelection",V.row,V.col,J.row,J.col,M,ae),this.runHooks("afterSelectionByProp",V.row,s.colToProp(V.col),J.row,s.colToProp(J.col),M,ae),A&&(!M.isTouched()||M.isTouched()&&!M.value)&&m.scrollTo(S);const ue=N.isSelectedByRowHeader(),pe=N.isSelectedByColumnHeader();ue&&pe?$t(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ue?(Jr(this.rootElement,"ht__selection--columns"),$t(this.rootElement,"ht__selection--rows")):pe?(Jr(this.rootElement,"ht__selection--rows"),$t(this.rootElement,"ht__selection--columns")):Jr(this.rootElement,["ht__selection--rows","ht__selection--columns"]),N.getSelectionSource()!=="shift"&&h.closeEditor(null),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",S=>{this.runHooks("beforeSelectionFocusSet",S.row,S.col)}),this.selection.addLocalHook("afterSetFocus",S=>{const A=uo(!1);this.runHooks("afterSelectionFocusSet",S.row,S.col,A),(!A.isTouched()||A.isTouched()&&!A.value)&&m.scrollTo(S),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",S=>{const A=S.length-1,{from:M,to:L}=S[A];this.runHooks("afterSelectionEnd",M.row,M.col,L.row,L.col,A),this.runHooks("afterSelectionEndByProp",M.row,s.colToProp(M.col),L.row,s.colToProp(L.col),A)}),this.selection.addLocalHook("afterIsMultipleSelection",S=>{const A=this.runHooks("afterIsMultipleSelection",S.value);S.value&&(S.value=A)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),Jr(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeSetRangeStart",...A)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeSetRangeStartOnly",...A)}).addLocalHook("beforeSetRangeEnd",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeSetRangeEnd",...A)}).addLocalHook("beforeSelectColumns",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeSelectColumns",...A)}).addLocalHook("afterSelectColumns",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("afterSelectColumns",...A)}).addLocalHook("beforeSelectRows",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeSelectRows",...A)}).addLocalHook("afterSelectRows",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("afterSelectRows",...A)}).addLocalHook("beforeModifyTransformStart",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("modifyTransformStart",...A)}).addLocalHook("afterModifyTransformStart",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("afterModifyTransformStart",...A)}).addLocalHook("beforeModifyTransformFocus",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("modifyTransformFocus",...A)}).addLocalHook("afterModifyTransformFocus",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("afterModifyTransformFocus",...A)}).addLocalHook("beforeModifyTransformEnd",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("modifyTransformEnd",...A)}).addLocalHook("afterModifyTransformEnd",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("afterModifyTransformEnd",...A)}).addLocalHook("beforeRowWrap",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeRowWrap",...A)}).addLocalHook("beforeColumnWrap",function(){for(var S=arguments.length,A=new Array(S),M=0;M<S;M++)A[M]=arguments[M];return n.runHooks("beforeColumnWrap",...A)}).addLocalHook("insertRowRequire",S=>this.alter("insert_row_above",S,1,"auto")).addLocalHook("insertColRequire",S=>this.alter("insert_col_start",S,1,"auto")),u={alter(S,A){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0;const J=ae=>{if(ae.length===0)return[];const ue=[...ae];return ue.sort((ke,z)=>{let[Be]=ke,[Fe]=z;return Be===Fe?0:Be>Fe?1:-1}),rC(ue,(ke,z)=>{let[Be,Fe]=z;const ze=ke[ke.length-1],[Ge,Ee]=ze,Ue=Ge+Ee;if(Be<=Ue){const st=Math.max(Fe-(Ue-Be),0);ze[1]+=st}else ke.push([Be,Fe]);return ke},[ue[0]])};switch(S){case"insert_row_below":case"insert_row_above":const ae=s.countSourceRows();if(E.maxRows===ae)return;const ue=S==="insert_row_below"?"below":"above";A=A??(ue==="below"?ae:0);const{delta:pe,startPhysicalIndex:ke}=a.createRow(A,M,{source:L,mode:ue});N.shiftRows(s.toVisualRow(ke),pe);break;case"insert_col_start":case"insert_col_end":const z=S==="insert_col_end"?"end":"start";A=A??(z==="end"?s.countSourceCols():0);const{delta:Be,startPhysicalIndex:Fe}=a.createCol(A,M,{source:L,mode:z});if(Be){if(Array.isArray(E.colHeaders)){const Ee=[s.toVisualColumn(Fe),0];Ee.length+=Be,Array.prototype.splice.apply(E.colHeaders,Ee)}N.shiftColumns(s.toVisualColumn(Fe),Be)}break;case"remove_row":const ze=Ee=>{let Ue=0;Bt(Ee,st=>{let[tt,at]=st;const je=zp(tt)?s.countRows()-1:Math.max(tt-Ue,0);if(Number.isInteger(tt)&&(tt=Math.max(tt-Ue,0)),!a.removeRow(tt,at,L))return;if(N.isSelected()){const{row:Et}=s.getSelectedRangeLast().highlight;Et>=tt&&Et<=tt+at-1&&h.closeEditor(!0)}const Nt=s.countRows(),jt=E.fixedRowsTop;jt>=je+1&&(E.fixedRowsTop-=Math.min(at,jt-je));const Dt=E.fixedRowsBottom;Dt&&je>=Nt-Dt&&(E.fixedRowsBottom-=Math.min(at,Dt)),Nt===0?N.deselect():L==="ContextMenu.removeRow"?N.refresh():N.shiftRows(tt,-at),Ue+=at})};Array.isArray(A)?ze(J(A)):ze([[A,M]]);break;case"remove_col":const Ge=Ee=>{let Ue=0;Bt(Ee,st=>{let[tt,at]=st;const je=zp(tt)?s.countCols()-1:Math.max(tt-Ue,0);let er=s.toPhysicalColumn(je);if(Number.isInteger(tt)&&(tt=Math.max(tt-Ue,0)),!a.removeCol(tt,at,L))return;if(N.isSelected()){const{col:Et}=s.getSelectedRangeLast().highlight;Et>=tt&&Et<=tt+at-1&&h.closeEditor(!0)}s.countCols()===0?N.deselect():L==="ContextMenu.removeColumn"?N.refresh():N.shiftColumns(tt,-at);const Dt=E.fixedColumnsStart;Dt>=je+1&&(E.fixedColumnsStart-=Math.min(at,Dt-je)),Array.isArray(E.colHeaders)&&(typeof er>"u"&&(er=-1),E.colHeaders.splice(er,at)),Ue+=at})};Array.isArray(A)?Ge(J(A)):Ge([[A,M]]);break;default:throw new Error(`There is no such action "${S}"`)}V||u.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const S=E.minRows,A=E.minSpareRows,M=E.minCols,L=E.minSpareCols;if(S){const V=s.countRows();V<S&&a.createRow(V,S-V,{source:"auto"})}if(A){const V=s.countEmptyRows(!0);if(V<A){const J=A-V,ae=Math.min(J,E.maxRows-s.countSourceRows());a.createRow(s.countRows(),ae,{source:"auto"})}}{let V;(M||L)&&(V=s.countEmptyCols(!0));let J=s.countCols();if(M&&!E.columns&&J<M){const ae=M-J;V+=ae,a.createCol(J,ae,{source:"auto"})}if(L&&!E.columns&&s.dataType==="array"&&V<L){J=s.countCols();const ae=L-V,ue=Math.min(ae,E.maxCols-J);a.createCol(J,ue,{source:"auto"})}}},populateFromArray(S,A,M,L,V){let J,ae,ue,pe;const ke=[],z={},Be=[],Fe=S.row,ze=S.col;if(ae=A.length,ae===0)return!1;let Ge=0,Ee=0;switch(Fl(M)&&(Ge=M.col-ze+1,Ee=M.row-Fe+1),V){case"shift_down":const Ue=ZA(A),st=Ue.length,tt=Math.max(st,Ge),at=s.getData().slice(Fe),je=ZA(at).slice(ze,ze+tt);for(ue=0;ue<tt;ue+=1)if(ue<st){for(J=0,ae=Ue[ue].length;J<Ee-ae;J+=1)Ue[ue].push(Ue[ue][J%ae]);ue<je.length?Be.push(Ue[ue].concat(je[ue])):Be.push(Ue[ue].concat(new Array(at.length).fill(null)))}else Be.push(Ue[ue%st].concat(je[ue]));s.populateFromArray(Fe,ze,ZA(Be));break;case"shift_right":const er=A.length,Nt=Math.max(er,Ee),jt=s.getData().slice(Fe).map(nt=>nt.slice(ze));for(J=0;J<Nt;J+=1)if(J<er){for(ue=0,pe=A[J].length;ue<Ge-pe;ue+=1)A[J].push(A[J][ue%pe]);if(J<jt.length)for(let nt=0;nt<jt[J].length;nt+=1)A[J].push(jt[J][nt]);else A[J].push(...new Array(jt[0].length).fill(null))}else A.push(A[J%ae].slice(0,Nt).concat(jt[J]));s.populateFromArray(Fe,ze,A);break;case"overwrite":default:z.row=S.row,z.col=S.col;let Dt=0,Et=0,Ct=!0,Rt;const Xe=function(ct){let ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const vn=A[ct%A.length];return ar!==null?vn[ar%vn.length]:vn},Je=A.length,Lt=M?M.row-S.row+1:0;for(M?ae=Lt:ae=Math.max(Je,Lt),J=0;J<ae&&!(M&&z.row>M.row&&Lt>Je||!E.allowInsertRow&&z.row>s.countRows()-1||z.row>=E.maxRows);J++){const nt=J-Dt,ct=Xe(nt).length,ar=M?M.col-S.col+1:0;if(M?pe=ar:pe=Math.max(ct,ar),z.col=S.col,Rt=s.getCellMeta(z.row,z.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&Rt.skipRowOnPaste){Dt+=1,z.row+=1,ae+=1;continue}for(Et=0,ue=0;ue<pe&&!(M&&z.col>M.col&&ar>ct||!E.allowInsertColumn&&z.col>s.countCols()-1||z.col>=E.maxCols);ue++){if(Rt=s.getCellMeta(z.row,z.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&Rt.skipColumnOnPaste){Et+=1,z.col+=1,pe+=1;continue}if(Rt.readOnly&&L!=="UndoRedo.undo"){z.col+=1;continue}const vn=ue-Et;let Br=Xe(nt,vn),qr=s.getDataAtCell(z.row,z.col);if(Br!==null&&typeof Br=="object")if(Array.isArray(Br)&&qr===null&&(qr=[]),qr===null||typeof qr!="object")Ct=!1;else{const Wn=Av(Array.isArray(qr)?qr:qr[0]||qr),Ai=Av(Array.isArray(Br)?Br:Br[0]||Br);rX(Wn,Ai)||Array.isArray(Wn)&&Array.isArray(Ai)?Br=Gu(Br):Ct=!1}else qr!==null&&typeof qr=="object"&&(Ct=!1);Ct&&ke.push([z.row,z.col,Br]),Ct=!0,z.col+=1}z.row+=1}s.setDataAtCell(ke,null,null,L||"populateFromArray");break}}};function B(S){const A=zX(S);YI(A)?(s.runHooks("beforeLanguageChange",A),R.language=A,s.runHooks("afterLanguageChange",A)):UX(S)}function j(S,A){const M=S==="className"?s.rootElement:s.table;if(g)$t(M,A);else{let L=[],V=[];R[S]&&(L=Array.isArray(R[S])?R[S]:C9(R[S])),A&&(V=Array.isArray(A)?A:C9(A));const J=S9(L,V),ae=S9(V,L);J.length&&Jr(M,J),ae.length&&$t(M,ae)}R[S]=A}this.init=function(){l.setData(E.data),s.runHooks("beforeInit"),(up()||GOe())&&$t(s.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new cIe(this);const S=E.themeName||CW(s.rootElement);s.useTheme(S),s.view.addClassNameToLicenseElement(s.getCurrentThemeName()),h=F_.getInstance(s,E,N),m=xLe(s),d=new E_e(s),Uw(this)&&uLe(s),s.runHooks("init"),this.render(),g&&s.rootElement.offsetParent===null&&MOe(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function ee(){let S=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,S=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&S===!1&&(S=!0,this.onQueueEmpty(this.valid))}}}function oe(S){const A=S.replace(",",".");return isNaN(parseFloat(A))===!1?parseFloat(A):S}function re(S,A,M){if(!S.length){M();return}const L=s.getActiveEditor(),V=new ee;let J=!0;V.onQueueEmpty=()=>{L&&J&&L.cancelChanges(),M()};for(let ae=S.length-1;ae>=0;ae--){const[ue,pe]=S[ae],ke=a.propToCol(pe);let z;Number.isInteger(ke)?z=s.getCellMeta(ue,ke):z={...Object.getPrototypeOf(E),...E},s.getCellValidator(z)&&(V.addValidatorToQueue(),s.validateCell(S[ae][3],z,function(Be,Fe){return function(ze){if(typeof ze!="boolean")throw new Error("Validation error: result is not boolean");ze===!1&&Fe.allowInvalid===!1&&(J=!1,S.splice(Be,1),Fe.valid=!0),V.removeValidatorFormQueue()}}(ae,z),A))}V.checkIfQueueIsEmpty()}function q(S,A){for(let L=S.length-1;L>=0;L--){let V=!1;if(S[L]===null){S.splice(L,1);continue}if(!((S[L][2]===null||S[L][2]===void 0)&&(S[L][3]===null||S[L][3]===void 0))){if(E.allowInsertRow)for(;S[L][0]>s.countRows()-1;){const{delta:J}=a.createRow(void 0,void 0,{source:"auto"});if(J===0){V=!0;break}}if(s.dataType==="array"&&(!E.columns||E.columns.length===0)&&E.allowInsertColumn)for(;a.propToCol(S[L][1])>s.countCols()-1;){const{delta:J}=a.createCol(void 0,void 0,{source:"auto"});if(J===0){V=!0;break}}V||a.set(S[L][0],S[L][1],S[L][3])}}if(S.length>0){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",S,A),h.closeEditor(),s.render(),h.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",S,A||"edit");const L=s.getActiveEditor();L&&Jt(L.refreshValue)&&L.refreshValue()}else s.render()}this._createCellCoords=function(S,A){return s.view._wt.createCellCoords(S,A)},this._createCellRange=function(S,A,M){return s.view._wt.createCellRange(S,A,M)},this.validateCell=function(S,A,M,L){let V=s.getCellValidator(A);function J(ae){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||A.hidden===!0){M(ae);return}const pe=A.visualCol,ke=A.visualRow,z=s.getCell(ke,pe,!0);if(z&&z.nodeName!=="TH"){const Be=s.rowIndexMapper.getRenderableFromVisualIndex(ke),Fe=s.columnIndexMapper.getRenderableFromVisualIndex(pe);s.view._wt.getSetting("cellRenderer",Be,Fe,z)}M(ae)}rOe(V)&&(V=function(ae){return function(ue,pe){pe(ae.test(ue))}}(V)),Rr(V)?(S=s.runHooks("beforeValidate",S,A.visualRow,A.prop,L),s._registerImmediate(()=>{V.call(A,S,ae=>{s&&(ae=s.runHooks("afterValidate",ae,S,A.visualRow,A.prop,L),A.valid=ae,J(ae),s.runHooks("postAfterValidate",ae,S,A.visualRow,A.prop,L))})})):s._registerImmediate(()=>{A.valid=!0,J(A.valid,!1)})};function Z(S,A,M){return Array.isArray(S)?S:[[S,A,M]]}function ve(S,A){const M=s.runHooks("beforeChange",S,A||"edit"),L=S.filter(J=>J!==null);if(M===!1||L.length===0){var V;return(V=s.getActiveEditor())===null||V===void 0||V.cancelChanges(),[]}for(let J=L.length-1;J>=0;J--){const[ae,ue,,pe]=L[J],ke=a.propToCol(ue);let z;Number.isInteger(ke)?z=s.getCellMeta(ae,ke):z={...Object.getPrototypeOf(E),...E};const{type:Be,checkedTemplate:Fe,uncheckedTemplate:ze}=z;if(Be==="numeric"&&typeof pe=="string"&&F_e(pe)&&(L[J][3]=oe(pe)),Be==="checkbox"){const Ge=Hg(pe),Ee=Ge===Hg(Fe),Ue=Ge===Hg(ze);(Ee||Ue)&&(L[J][3]=Ee?Fe:ze)}}return L}this.setDataAtCell=function(S,A,M,L){const V=Z(S,A,M),J=[];let ae=L,ue,pe,ke;for(ue=0,pe=V.length;ue<pe;ue++){if(typeof V[ue]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof V[ue][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");V[ue][1]>=this.countCols()?ke=V[ue][1]:ke=a.colToProp(V[ue][1]),J.push([V[ue][0],ke,l.getAtCell(this.toPhysicalRow(V[ue][0]),V[ue][1]),V[ue][2]])}!ae&&typeof S=="object"&&(ae=A);const z=ve(J,ae);s.runHooks("afterSetDataAtCell",z,ae),re(z,ae,()=>{q(z,ae)})},this.setDataAtRowProp=function(S,A,M,L){const V=Z(S,A,M),J=[];let ae=L,ue,pe;for(ue=0,pe=V.length;ue<pe;ue++)J.push([V[ue][0],V[ue][1],l.getAtCell(this.toPhysicalRow(V[ue][0]),V[ue][1]),V[ue][2]]);!ae&&typeof S=="object"&&(ae=A);const ke=ve(J,L);s.runHooks("afterSetDataAtRowProp",ke,ae),re(ke,ae,()=>{q(ke,ae)})},this.listen=function(){s&&!s.isListening()&&(jk.forEach(S=>{s!==S&&S.unlisten()}),Vk=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Vk=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Vk===s.guid},this.destroyEditor=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(S),s.view.render(),A&&N.isSelected()&&h.prepareEditor()},this.populateFromArray=function(S,A,M,L,V,J,ae){if(!(typeof M=="object"&&typeof M[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ue=typeof L=="number"?s._createCellCoords(L,V):null;return u.populateFromArray(s._createCellCoords(S,A),M,ue,J,ae)},this.spliceCol=function(S,A,M){for(var L=arguments.length,V=new Array(L>3?L-3:0),J=3;J<L;J++)V[J-3]=arguments[J];return a.spliceCol(S,A,M,...V)},this.spliceRow=function(S,A,M){for(var L=arguments.length,V=new Array(L>3?L-3:0),J=3;J<L;J++)V[J-3]=arguments[J];return a.spliceRow(S,A,M,...V)},this.getSelected=function(){if(N.isSelected())return Sh(N.getSelectedRange(),S=>{let{from:A,to:M}=S;return[A.row,A.col,M.row,M.col]})},this.getSelectedLast=function(){const S=this.getSelected();let A;return S&&S.length>0&&(A=S[S.length-1]),A},this.getSelectedRange=function(){if(N.isSelected())return Array.from(N.getSelectedRange())},this.getSelectedRangeLast=function(){const S=this.getSelectedRange();let A;return S&&S.length>0&&(A=S[S.length-1]),A},this.emptySelectedCells=function(S){if(!N.isSelected()||this.countRows()===0||this.countCols()===0)return;const A=[];Bt(N.getSelectedRange(),M=>{if(M.isSingleHeader())return;const L=M.getTopStartCorner(),V=M.getBottomEndCorner();Ko(L.row,V.row,J=>{Ko(L.col,V.col,ae=>{this.getCellMeta(J,ae).readOnly||A.push([J,ae,null])})})}),A.length>0&&this.setDataAtCell(A,S)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const S=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(S,0),!this.isRenderSuspended()&&S===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(S){this.suspendRender();const A=S();return this.resumeRender(),A},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const A=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(A,0),(!this.isExecutionSuspended()&&A===this.executionSuspendedCounter||S)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const M=S();return this.resumeExecution(A),M},this.batch=function(S){this.suspendRender(),this.suspendExecution();const A=S();return this.resumeExecution(),this.resumeRender(),A},this.refreshDimensions=function(){if(!s.view)return;const S=s.view,{width:A,height:M}=S.getLastSize(),{width:L,height:V}=s.rootElement.getBoundingClientRect(),J=L!==A||V!==M;s.runHooks("beforeRefreshDimensions",{width:A,height:M},{width:L,height:V},J)!==!1&&((J||S._wt.wtOverlays.scrollableElement===s.rootWindow)&&(S.setLastSize(L,V),s.render(),S.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:A,height:M},{width:L,height:V},J))},this.updateData=function(S,A){vW(S,M=>{a=M},M=>{a=M,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),N.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:A,metaManager:C,firstRun:g})},this.loadData=function(S,A){vW(S,M=>{a=M},()=>{C.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),N.refresh(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:A,metaManager:C,firstRun:g})},this.getInitialColumnCount=function(){const S=E.columns;let A=0;if(Array.isArray(S))A=S.length;else if(Rr(S))if(s.dataType==="array"){const M=this.countSourceCols();for(let L=0;L<M;L+=1)S(L)&&(A+=1)}else(s.dataType==="object"||s.dataType==="function")&&(A=a.colToPropCache.length);else if(Jt(E.dataSchema)){const M=a.getSchema();A=Array.isArray(M)?M.length:EI(M)}else A=this.countSourceCols();return A},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(S,A,M,L){return Hs(S)?a.getAll():a.getRange(s._createCellCoords(S,A),s._createCellCoords(M,L),a.DESTINATION_RENDERER)},this.getCopyableText=function(S,A,M,L){return a.getCopyableText(s._createCellCoords(S,A),s._createCellCoords(M,L))},this.getCopyableData=function(S,A){return a.getCopyable(S,a.colToProp(A))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const M=(g?s.loadData:s.updateData).bind(this);let L=!1,V,J;if(Jt(S.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Jt(S.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Jt(S.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');S.language&&B(S.language);for(V in S)if(!(V==="data"||V==="language"))if(V==="className")j("className",S.className);else if(V==="tableClassName"&&s.table)j("tableClassName",S.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(yi.getSingleton().isRegistered(V)||yi.getSingleton().isDeprecated(V)){const z=S[V];Rr(z)?(yi.getSingleton().addAsFixed(V,z,s),E[V]=z):Array.isArray(z)&&(yi.getSingleton().add(V,z,s),E[V]=z)}else!A&&Ch(S,V)&&(R[V]=S[V]);S.data===void 0&&E.data===void 0?M(null,"updateSettings"):S.data!==void 0?M(S.data,"updateSettings"):S.columns!==void 0&&(a.createMap(),s.initIndexMappers());const ae=s.countCols(),ue=E.columns;if(ue&&Rr(ue)&&(L=!0),(S.cell!==void 0||S.cells!==void 0||S.columns!==void 0)&&C.clearCache(),ae>0)for(V=0,J=0;V<ae;V++){if(ue){const z=L?ue(V):ue[J];z&&C.updateColumnMeta(J,z)}J+=1}Jt(S.cell)&&fn(S.cell,z=>{s.setCellMetaObject(z.row,z.col,z)}),s.runHooks("afterCellMetaReset");let pe=s.rootElement.style.height;pe!==""&&(pe=parseInt(s.rootElement.style.height,10));let ke=S.height;if(Rr(ke)&&(ke=ke()),A&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),ke===null){const z=s.rootElement.getAttribute("data-initialstyle");z&&(z.indexOf("height")>-1||z.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",z):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else ke!==void 0&&(s.rootElement.style.height=isNaN(ke)?`${ke}`:`${ke}px`,s.rootElement.style.overflow="hidden");if(typeof S.width<"u"){let z=S.width;Rr(z)&&(z=z()),s.rootElement.style.width=isNaN(z)?`${z}`:`${z}px`}if(!A){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const z=s.getCurrentThemeName(),Be=Ch(S,"themeName");z&&Be&&z!==S.themeName&&(s.view.getStylesHandler().removeClassNames(),s.view.removeClassNameFromLicenseElement(z));const Fe=Be&&S.themeName||CW(s.rootElement);s.useTheme(Fe),s.view.addClassNameToLicenseElement(s.getCurrentThemeName())}s.runHooks("afterUpdateSettings",S)}u.adjustRowsAndCols(),s.view&&!g&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!A&&s.view&&(pe===""||ke===""||ke===void 0)&&pe!==ke&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const S=s.getSelectedLast();if(E.getValue){if(Rr(E.getValue))return E.getValue.call(s);if(S)return s.getData()[S[0][0]][E.getValue]}else if(S)return s.getDataAtCell(S[0],S[1])},this.getSettings=function(){return E},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(S,A,M,L,V){u.alter(S,A,M,L,V)},this.getCell=function(S,A){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,L=A,V=S;if(A>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(A)))return null;L=this.columnIndexMapper.getRenderableFromVisualIndex(A)}if(S>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(S)))return null;V=this.rowIndexMapper.getRenderableFromVisualIndex(S)}return V===null||L===null||V===void 0||L===void 0?null:s.view.getCellAtCoords(s._createCellCoords(V,L),M)},this.getCoords=function(S){const A=this.view._wt.wtTable.getCoords(S);if(A===null)return null;const{row:M,col:L}=A;let V=M,J=L;return M>=0&&(V=this.rowIndexMapper.getVisualFromRenderableIndex(M)),L>=0&&(J=this.columnIndexMapper.getVisualFromRenderableIndex(L)),s._createCellCoords(V,J)},this.colToProp=function(S){return a.colToProp(S)},this.propToCol=function(S){return a.propToCol(S)},this.toVisualRow=S=>this.rowIndexMapper.getVisualFromPhysicalIndex(S),this.toVisualColumn=S=>this.columnIndexMapper.getVisualFromPhysicalIndex(S),this.toPhysicalRow=S=>this.rowIndexMapper.getPhysicalFromVisualIndex(S),this.toPhysicalColumn=S=>this.columnIndexMapper.getPhysicalFromVisualIndex(S),this.getDataAtCell=function(S,A){return a.get(S,a.colToProp(A))},this.getDataAtRowProp=function(S,A){return a.get(S,A)},this.getDataAtCol=function(S){const A=[],M=a.getRange(s._createCellCoords(0,S),s._createCellCoords(E.data.length-1,S),a.DESTINATION_RENDERER);for(let L=0;L<M.length;L+=1)for(let V=0;V<M[L].length;V+=1)A.push(M[L][V]);return A},this.getDataAtProp=function(S){const A=[],M=a.getRange(s._createCellCoords(0,a.propToCol(S)),s._createCellCoords(E.data.length-1,a.propToCol(S)),a.DESTINATION_RENDERER);for(let L=0;L<M.length;L+=1)for(let V=0;V<M[L].length;V+=1)A.push(M[L][V]);return A},this.getSourceData=function(S,A,M,L){let V;return S===void 0?V=l.getData():V=l.getByRange(s._createCellCoords(S,A),s._createCellCoords(M,L)),V},this.getSourceDataArray=function(S,A,M,L){let V;return S===void 0?V=l.getData(!0):V=l.getByRange(s._createCellCoords(S,A),s._createCellCoords(M,L),!0),V},this.getSourceDataAtCol=function(S){return l.getAtColumn(S)},this.setSourceDataAtCell=function(S,A,M,L){const V=Z(S,A,M),J=this.hasHook("afterSetSourceDataAtCell"),ae=[];J&&Bt(V,pe=>{let[ke,z,Be]=pe;ae.push([ke,z,l.getAtCell(ke,z),Be])}),Bt(V,pe=>{let[ke,z,Be]=pe;l.setAtCell(ke,z,Be)}),J&&this.runHooks("afterSetSourceDataAtCell",ae,L),this.render();const ue=s.getActiveEditor();ue&&Jt(ue.refreshValue)&&ue.refreshValue()},this.getSourceDataAtRow=function(S){return l.getAtRow(S)},this.getSourceDataAtCell=function(S,A){return l.getAtCell(S,A)},this.getDataAtRow=function(S){return a.getRange(s._createCellCoords(S,0),s._createCellCoords(S,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(S,A,M,L){const V=S===void 0?[0,0,this.countRows(),this.countCols()]:[S,A,M,L],[J,ae]=V;let[,,ue,pe]=V,ke=null,z=null;ue===void 0&&(ue=J),pe===void 0&&(pe=ae);let Be="mixed";return Ko(Math.max(Math.min(J,ue),0),Math.max(J,ue),Fe=>{let ze=!0;return Ko(Math.max(Math.min(ae,pe),0),Math.max(ae,pe),Ge=>(z=this.getCellMeta(Fe,Ge).type,ke?ze=ke===z:ke=z,ze)),Be=ze?z:"mixed",ze}),Be},this.removeCellMeta=function(S,A,M){const[L,V]=[this.toPhysicalRow(S),this.toPhysicalColumn(A)];let J=C.getCellMetaKeyValue(L,V,M);s.runHooks("beforeRemoveCellMeta",S,A,M,J)!==!1&&(C.removeCellMeta(L,V,M),s.runHooks("afterRemoveCellMeta",S,A,M,J)),J=null},this.spliceCellsMeta=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var M=arguments.length,L=new Array(M>2?M-2:0),V=2;V<M;V++)L[V-2]=arguments[V];if(L.length>0&&!Array.isArray(L[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");A>0&&C.removeRow(this.toPhysicalRow(S),A),L.length>0&&Bt(L.reverse(),J=>{C.createRow(this.toPhysicalRow(S)),Bt(J,(ae,ue)=>this.setCellMetaObject(S,ue,ae))}),s.render()},this.setCellMetaObject=function(S,A,M){typeof M=="object"&&fn(M,(L,V)=>{this.setCellMeta(S,A,V,L)})},this.setCellMeta=function(S,A,M,L){if(s.runHooks("beforeSetCellMeta",S,A,M,L)===!1)return;let J=S,ae=A;S<this.countRows()&&(J=this.toPhysicalRow(S)),A<this.countCols()&&(ae=this.toPhysicalColumn(A)),C.setCellMeta(J,ae,M,L),s.runHooks("afterSetCellMeta",S,A,M,L)},this.getCellsMeta=function(){return C.getCellsMeta()},this.getCellMeta=function(S,A){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},L=this.toPhysicalRow(S),V=this.toPhysicalColumn(A);return L===null&&(L=S),V===null&&(V=A),C.getCellMeta(L,V,{visualRow:S,visualColumn:A,...M})},this.getColumnMeta=function(S){return C.getColumnMeta(this.toPhysicalColumn(S))},this.getCellMetaAtRow=function(S){return C.getCellsMetaAtRow(S)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||E.columns)},this.getCellRenderer=function(S,A){const M=typeof S=="number"?s.getCellMeta(S,A).renderer:S.renderer;return typeof M=="string"?B_(M):Hs(M)?B_("text"):M},this.getCellEditor=function(S,A){const M=typeof S=="number"?s.getCellMeta(S,A).editor:S.editor;return typeof M=="string"?L_(M):Hs(M)?L_("text"):M},this.getCellValidator=function(S,A){const M=typeof S=="number"?s.getCellMeta(S,A).validator:S.validator;return typeof M=="string"?sMe(M):M},this.validateCells=function(S){this._validateCells(S)},this.validateRows=function(S,A){if(!Array.isArray(S))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(A,S)},this.validateColumns=function(S,A){if(!Array.isArray(S))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(A,void 0,S)},this._validateCells=function(S,A,M){const L=new ee;S&&(L.onQueueEmpty=S);let V=s.countRows()-1;for(;V>=0;){if(A!==void 0&&A.indexOf(V)===-1){V-=1;continue}let J=s.countCols()-1;for(;J>=0;){if(M!==void 0&&M.indexOf(J)===-1){J-=1;continue}L.addValidatorToQueue(),s.validateCell(s.getDataAtCell(V,J),s.getCellMeta(V,J),ae=>{if(typeof ae!="boolean")throw new Error("Validation error: result is not boolean");ae===!1&&(L.valid=!1),L.removeValidatorFormQueue()},"validateCells"),J-=1}V-=1}L.checkIfQueueIsEmpty()},this.getRowHeader=function(S){let A=E.rowHeaders,M=S;return M!==void 0&&(M=s.runHooks("modifyRowHeader",M)),M===void 0?(A=[],Ko(s.countRows()-1,L=>{A.push(s.getRowHeader(L))})):Array.isArray(A)&&A[M]!==void 0?A=A[M]:Rr(A)?A=A(M):A&&typeof A!="string"&&typeof A!="number"&&(A=M+1),A},this.hasRowHeaders=function(){return!!E.rowHeaders},this.hasColHeaders=function(){if(E.colHeaders!==void 0&&E.colHeaders!==null)return!!E.colHeaders;for(let S=0,A=s.countCols();S<A;S++)if(s.getColHeader(S))return!0;return!1},this.getColHeader=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const M=s.runHooks("modifyColHeader",S);if(M===void 0){const ue=[],pe=s.countCols();for(let ke=0;ke<pe;ke++)ue.push(s.getColHeader(ke));return ue}let L=E.colHeaders;const V=function(ue){const pe=[],ke=s.countCols();let z=0;for(;z<ke;z++)Rr(E.columns)&&E.columns(z)&&pe.push(z);return pe[ue]},J=s.toPhysicalColumn(M),ae=V(J);return E.colHeaders===!1?L=null:E.columns&&Rr(E.columns)&&E.columns(ae)&&E.columns(ae).title?L=E.columns(ae).title:E.columns&&E.columns[J]&&E.columns[J].title?L=E.columns[J].title:Array.isArray(E.colHeaders)&&E.colHeaders[J]!==void 0?L=E.colHeaders[J]:Rr(E.colHeaders)?L=E.colHeaders(J):E.colHeaders&&typeof E.colHeaders!="string"&&typeof E.colHeaders!="number"&&(L=mIe(M)),L=s.runHooks("modifyColumnHeaderValue",L,S,A),L},this._getColWidthFromSettings=function(S){let A;if(S>=0&&(A=s.getCellMeta(0,S).width),(A===void 0||A===E.width)&&(A=E.colWidths),A!=null){switch(typeof A){case"object":A=A[S];break;case"function":A=A(S);break}typeof A=="string"&&(A=parseInt(A,10))}return A},this.getColWidth=function(S,A){let M=s._getColWidthFromSettings(S);return M=s.runHooks("modifyColWidth",M,S,A),M===void 0&&(M=pX),M},this._getRowHeightFromSettings=function(S){const A=this.view.getDefaultRowHeight();let M=E.rowHeights;if(M!=null){switch(typeof M){case"object":M=M[S];break;case"function":M=M(S);break}typeof M=="string"&&(M=parseInt(M,10))}return M!=null&&M<A?A:M},this.getRowHeight=function(S,A){let M=s._getRowHeightFromSettings(S);return M=s.runHooks("modifyRowHeight",M,S,A),M},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const S=E.maxCols,A=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(S,A)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,A=0;return uj(s.countRows()-1,M=>{if(s.isEmptyRow(M))A+=1;else if(S===!0)return!1}),A},this.countEmptyCols=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,A=0;return uj(s.countCols()-1,M=>{if(s.isEmptyCol(M))A+=1;else if(S===!0)return!1}),A},this.isEmptyRow=function(S){return E.isEmptyRow.call(s,S)},this.isEmptyCol=function(S){return E.isEmptyCol.call(s,S)},this.selectCell=function(S,A,M,L){let V=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,J=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Hs(S)||Hs(A)?!1:this.selectCells([[S,A,M,L]],V,J)},this.selectCells=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;A===!1&&m.suspend();const L=N.selectCells(S);return L&&M&&s.listen(),m.resume(),L},this.selectColumns=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S,M=arguments.length>2?arguments[2]:void 0;return N.selectColumns(S,A,M)},this.selectRows=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S,M=arguments.length>2?arguments[2]:void 0;return N.selectRows(S,A,M)},this.deselectCell=function(){N.deselect()},this.selectAll=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S,M=arguments.length>2?arguments[2]:void 0;m.skipNextScrollCycle(),N.selectAll(S,A,M)};const ie=(S,A)=>S.getNearestNotHiddenIndex(A,1,!0);this.scrollViewportTo=function(S,A){if(typeof S=="number"){var M;S={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(M=arguments[4])!==null&&M!==void 0?M:!0}}const{row:L,col:V,considerHiddenIndexes:J}=S??{};let ae=L,ue=V;if(Rr(A)&&this.addHookOnce("afterScroll",A),J===void 0||J){const Be=Number.isInteger(L)&&L>=0,Fe=Number.isInteger(V)&&V>=0,ze=Be?ie(this.rowIndexMapper,L):void 0,Ge=Fe?ie(this.columnIndexMapper,V):void 0;if(ze===null||Ge===null)return!1;ae=Be?s.rowIndexMapper.getRenderableFromVisualIndex(ze):L,ue=Fe?s.columnIndexMapper.getRenderableFromVisualIndex(Ge):V}const pe=Number.isInteger(ae),ke=Number.isInteger(ue);let z=!1;return pe&&ae>=0&&ke&&ue>=0?z=s.view.scrollViewport(s._createCellCoords(ae,ue),S.horizontalSnap,S.verticalSnap):pe&&ae>=0&&(ke&&ue<0||!ke)?z=s.view.scrollViewportVertically(ae,S.verticalSnap):ke&&ue>=0&&(pe&&ae<0||!pe)&&(z=s.view.scrollViewportHorizontally(ue,S.horizontalSnap)),Rr(A)&&(z?this.view.render():(this.removeHook("afterScroll",A),this._registerMicrotask(()=>A()))),z},this.scrollToFocusedCell=function(S){if(!this.selection.isSelected())return!1;Rr(S)&&this.addHookOnce("afterScroll",S);const{highlight:A}=this.getSelectedRangeLast(),M=this.scrollViewportTo(A.toObject());return M?this.view.render():Rr(S)&&(this.removeHook("afterScroll",S),this._registerMicrotask(()=>S())),M},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),C.clearCache(),jk.delete(this.guid),Uw(s)){const S=this.rootDocument.querySelector(".hot-display-license-info");S&&S.parentNode.removeChild(S)}Ev(s.rootElement),o.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),k.getItems().forEach(S=>{let[,A]=S;A.destroy()}),k.clear(),s.runHooks("afterDestroy")},!0),yi.getSingleton().destroy(s),fn(s,(S,A,M)=>{Rr(S)?M[A]=K(A):A!=="guid"&&(M[A]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,N=null,h=null,s=null};function K(S){return()=>{throw new Error(`The "${S}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(S){return k.getItem(wI(S))},this.getPluginName=function(S){return S===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:k.getId(S)},this.getInstance=function(){return s},this.addHook=function(S,A,M){yi.getSingleton().add(S,A,s,M)},this.hasHook=function(S){return yi.getSingleton().has(S,s)||yi.getSingleton().has(S)},this.addHookOnce=function(S,A,M){yi.getSingleton().once(S,A,s,M)},this.removeHook=function(S,A){yi.getSingleton().remove(S,A,s)},this.runHooks=function(S,A,M,L,V,J,ae){return yi.getSingleton().run(s,S,A,M,L,V,J,ae)},this.getTranslatedPhrase=function(S,A){return wZ(E.language,S,A)},this.toHTML=()=>cj(this),this.toTableElement=()=>{const S=this.rootDocument.createElement("div");return S.insertAdjacentHTML("afterbegin",cj(this)),S.firstElementChild},this.timeouts=[],this.useTheme=S=>{this.view.getStylesHandler().useTheme(S),this.runHooks("afterSetTheme",S,!!g)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(S){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=S;typeof M=="function"&&(M=setTimeout(M,A)),this.timeouts.push(M)},this._clearTimeouts=function(){Bt(this.timeouts,S=>{clearTimeout(S)})},this.immediates=[],this._registerImmediate=function(S){this.immediates.push(setImmediate(S))},this._clearImmediates=function(){Bt(this.immediates,S=>{clearImmediate(S)})},this._registerMicrotask=function(S){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||S()})},this._getEditorManager=function(){return h};const ce=ELe({handleEvent(){return s.isListening()},beforeKeyDown:S=>this.runHooks("beforeKeyDown",S),afterKeyDown:S=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",S)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",S=>{S.ctrlKey===!1&&S.metaKey===!1&&ce.releasePressedKeys()}),this.getShortcutManager=function(){return ce},this.getFocusManager=function(){return d},X_e().forEach(S=>{const A=Q_e(S);k.addItem(S,new A(this))}),lLe(s),ce.setActiveContextName("grid"),yi.getSingleton().run(s,"construct")}function TW(t,e,r){t.addEventListener(e,r,!1)}function EW(t,e,r){t.removeEventListener(e,r,!1)}function tw(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function RLe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:d=>d.value,...e},n=t.body,i=t.createTextNode(""),s=t.createElement("span");let o;function a(){var d,m;i.textContent=r.textContent(o),s.style.position="absolute",s.style.fontSize=tw(o).fontSize,s.style.fontFamily=tw(o).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);const g=parseInt(((d=tw(o))===null||d===void 0?void 0:d.paddingInlineStart)||0,10),y=parseInt(((m=tw(o))===null||m===void 0?void 0:m.paddingInlineEnd)||0,10),x=s.clientWidth+g+y+1;n.removeChild(s);const b=o.style;b.height=`${r.minHeight}px`,r.minWidth>x?b.width=`${r.minWidth}px`:x>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${x}px`;const C=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>C?b.height=`${r.minHeight}px`:r.maxHeight<C?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${C}px`}function l(){t.defaultView.setTimeout(a,0)}function u(d){if(d&&d.minHeight)if(d.minHeight==="inherit")r.minHeight=o.clientHeight;else{const m=parseInt(d.minHeight,10);isNaN(m)||(r.minHeight=m)}if(d&&d.maxHeight)if(d.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const m=parseInt(d.maxHeight,10);isNaN(m)||(r.maxHeight=m)}if(d&&d.minWidth)if(d.minWidth==="inherit")r.minWidth=o.clientWidth;else{const m=parseInt(d.minWidth,10);isNaN(m)||(r.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const m=parseInt(d.maxWidth,10);isNaN(m)||(r.maxWidth=m)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function h(d,m){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=d,u(m),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),g&&(TW(o,"input",a),TW(o,"keydown",l)),a()}return{init:h,resize:a,unObserve(){EW(o,"input",a),EW(o,"keydown",l)}}}function RW(t,e){const r=AOe(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}JK(e,i)}function Lf(t,e,r){return(e=ALe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ALe(t){var e=kLe(t,"string");return typeof e=="symbol"?e:e+""}function kLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OLe="ht_editor_visible",rw="ht_editor_hidden",AW="textEditor",_Le="text";class MLe extends KI{static get EDITOR_TYPE(){return _Le}constructor(e){super(e),Lf(this,"eventManager",new $p(this)),Lf(this,"autoResize",RLe(this.hot.rootDocument)),Lf(this,"TEXTAREA",void 0),Lf(this,"textareaStyle",void 0),Lf(this,"TEXTAREA_PARENT",void 0),Lf(this,"textareaParentStyle",void 0),Lf(this,"layerClass",void 0),this.eventManager=new $p(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),yOe(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Qn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Qn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),JK(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),cn(this.TEXTAREA,[["data-hot-input",""],Ay(-1)]),$t(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),$t(this.TEXTAREA_PARENT,"handsontableInputHolder"),Nr(this.TEXTAREA_PARENT,this.layerClass)&&Jr(this.TEXTAREA_PARENT,this.layerClass),$t(this.TEXTAREA_PARENT,rw),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){$Oe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Jr(this.TEXTAREA_PARENT,this.layerClass),$t(this.TEXTAREA_PARENT,rw)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ko(e.length-1,n=>{const i=e[n];if(Nr(i,"handsontableEditor"))return r=!0,!1}),Nr(this.TEXTAREA_PARENT,rw)&&Jr(this.TEXTAREA_PARENT,rw),r?(this.layerClass=OLe,$t(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),$t(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Qn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){nX()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Qn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Qn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Jt(this.hot.getSelected()),group:AW},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;RW(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;RW(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(AW)}}const DLe="base";function HZ(t,e,r,n,i,s,o){const a=o.ariaTags,l=[],u=[],h=[],d=[];o.className&&$t(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&d.push(k9())):a&&h.push(k9()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&d.push(O9())):(u.push(o.invalidCellClassName),a&&h.push(O9()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),Jr(e,u),$t(e,l),ky(e,h),cn(e,d)}HZ.RENDERER_TYPE=DLe;const PLe="text";function BZ(t,e,r,n,i,s,o){HZ.apply(this,[t,e,r,n,i,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=Hg(a),o.trimWhitespace&&(a=a.trim()),Oy(e,a)}BZ.RENDERER_TYPE=PLe;const ILe="text",NLe={CELL_TYPE:ILe,editor:MLe,renderer:BZ};NNe(NLe);Ut.editors={BaseEditor:KI};function Ut(t,e){const r=new FZ(t,e||{},zI);return r.init(),r}Ut.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new FZ(t,e,zI)};Ut.DefaultSettings=OZ();Ut.hooks=yi.getSingleton();Ut.CellCoords=Th;Ut.CellRange=_y;Ut.packageName="handsontable";Ut.buildDate="24/04/2025 10:59:00";Ut.version="15.3.0";Ut.languages={dictionaryKeys:XIe,getLanguageDictionary:xZ,getLanguagesDictionaries:tNe,registerLanguageDictionary:yZ,getTranslatedPhrase:wZ};function Y_(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function LLe(t){if(Array.isArray(t))return Y_(t)}function FLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ov(t,e,r){return e=jb(e),ULe(t,VZ()?Reflect.construct(e,r||[],jb(t).constructor):e.apply(t,r))}function Gp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kW(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jZ(n.key),n)}}function Yp(t,e,r){return e&&kW(t.prototype,e),r&&kW(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function HLe(t,e,r){return(e=jZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jb(t){return jb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jb(t)}function _v(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q_(t,e)}function VZ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VZ=function(){return!!t})()}function BLe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function VLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jLe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OW(Object(r),!0).forEach(function(n){HLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WLe(t,e){if(t==null)return{};var r,n,i=zLe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function zLe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ULe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FLe(t)}function q_(t,e){return q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},q_(t,e)}function $Le(t){return LLe(t)||BLe(t)||YLe(t)||VLe()}function GLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function jZ(t){var e=GLe(t,"string");return typeof e=="symbol"?e:e+""}function YLe(t,e){if(t){if(typeof t=="string")return Y_(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y_(t,e):void 0}}var Wk=null,qLe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",KLe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Wb="global",XLe="hot-wrapper-editor-container";function QLe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function K_(t,e){var r=Kt.Children.toArray(t),n=Kt.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function WZ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function zZ(t,e){if(typeof t>"u"||e===null)return null;var r=$Z(e.props,!1);return r.className="".concat(XLe," ").concat(r.className),rp.createPortal(Kt.createElement("div",Object.assign({},r),e),t.body)}function UZ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wb,n=K_(t,"hot-editor"),i=WZ(n);return n?Kt.cloneElement(n,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??Wb,o)},editorColumnScope:r,isEditor:!0}):null}function ZLe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),Wk||(Wk=r.createDocumentFragment());var s=i??r.createElement("DIV");Wk.appendChild(s);var o=Kt.cloneElement(t,jLe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:rp.createPortal(o,s,n),portalContainer:s}}function $Z(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function JLe(){return typeof window<"u"}var GZ=function(){function t(){Gp(this,t)}return Yp(t,null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.prevProps,s=i===void 0?{}:i,o=n.isInit,a=o===void 0?!1:o,l=n.initOnlySettingKeys,u=l===void 0?[]:l,h=function(b){return!a&&u.includes(b)?s[b]===r[b]:!1},d={};if(r.settings){var m=r.settings;for(var g in m)m.hasOwnProperty(g)&&!h(g)&&(d[g]=m[g])}for(var y in r)y!=="settings"&&y!=="children"&&!h(y)&&r.hasOwnProperty(y)&&(d[y]=r[y]);return d}}])}(),e3e=function(t){function e(){return Gp(this,e),Ov(this,e,arguments)}return _v(e,t),Yp(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,s){return i[s]=n.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return UZ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=GZ.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=zZ(n,this.getLocalEditorElement());return Kt.createElement(Kt.Fragment,null,i)}}])}(Kt.Component),t3e=function(t){function e(){var r;return Gp(this,e),r=Ov(this,e,arguments),r.state={portals:[]},r}return _v(e,t),Yp(e,[{key:"render",value:function(){return Kt.createElement(Kt.Fragment,null,this.state.portals)}}])}(Kt.Component),r3e="15.3.0";function n3e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var YZ={exports:{}},zk,_W;function i3e(){if(_W)return zk;_W=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return zk=t,zk}var Uk,MW;function s3e(){if(MW)return Uk;MW=1;var t=i3e();function e(){}function r(){}return r.resetWarningCache=e,Uk=function(){function i(a,l,u,h,d,m){if(m!==t){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},Uk}YZ.exports=s3e()();var o3e=YZ.exports,$k=n3e(o3e),XI=function(t){function e(){var r;return Gp(this,e),r=Ov(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return _v(e,t),Yp(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(KLe),null)},set:function(n){this.__hotInstance=n}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return JLe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(o,a,l,u,h,d,m){var g=i.getRenderedCellCache(),y=i.getPortalContainerCache(),x="".concat(l,"-").concat(u),b=o.guid,C="".concat(b,"-").concat(x),E="".concat(x,"-").concat(b);if(g.has(x)&&(a.innerHTML=g.get(x).innerHTML),a&&!a.getAttribute("ghost-table")){for(var R=i.portalCache.get(E),k=y.get(C);a.firstChild;)a.removeChild(a.firstChild);if(R&&k)a.appendChild(k);else{var O=ZLe(n,{TD:a,row:l,col:u,prop:h,value:d,cellProperties:m,isRenderer:!0},a.ownerDocument,E,k),P=O.portal,D=O.portalContainer;y.set(C,D),a.appendChild(D),i.portalCache.set(E,P)}}return g.set(x,a),a}}},{key:"getEditorClass",value:function(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wb,o=WZ(n),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(n){var i=function(s){function o(a){var l;return Gp(this,o),l=Ov(this,o,[a]),n.hotCustomEditorInstance=l,l.editorComponent=n,l}return _v(o,s),Yp(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Ut.editors.BaseEditor);return Object.getOwnPropertyNames(Ut.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(o=n[s]).call.apply(o,[n].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return K_(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return UZ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((n=this.hotInstance)===null||n===void 0||(n=n.getSettings())===null||n===void 0?void 0:n._initOnlySettings)||[],a=GZ.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,u)a.editor=this.getEditorClass(u,Wb);else{var h;this.props.editor||(h=this.props.settings)!==null&&h!==void 0&&h.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=L_("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var d;this.props.renderer||(d=this.props.settings)!==null&&d!==void 0&&d.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=B_("text")}return a}},{key:"displayAutoSizeWarning",value:function(n){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&QLe(qLe)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:$Le(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new Ut.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(n){this.clearCache();var i=this.createNewGlobalSettings(!1,n);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(h){return h.type===e3e},s=Kt.Children.toArray(this.props.children),o=s.filter(function(u){return i(u)}).map(function(u,h){return Kt.cloneElement(u,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:h,_getChildElementByType:K_.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:u.props.children})}),a=$Z(this.props),l=zZ(this.getOwnerDocument(),this.getGlobalEditorElement());return Kt.createElement(Kt.Fragment,null,Kt.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),Kt.createElement(t3e,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return r3e}}])}(Kt.Component);XI.propTypes={style:$k.object,id:$k.string,className:$k.string};var a3e=["children"],qZ=Kt.forwardRef(function(t,e){var r,n=t.children,i=WLe(t,a3e),s=typeof Kt.useId=="function"?Kt.useId():void 0,o=(r=i.id)!==null&&r!==void 0?r:s;return Kt.createElement(XI,Object.assign({id:o},i,{ref:e}),n)});qZ.version=XI.version;Kt.Component;const nw=[{title:"K-M Related",tables:["AZTONCEF04","AZTONCEF06","AZTONCEF09"]},{title:"Ratio Related",tables:["AZTONCEF02A","AZTONCEF02B"]},{title:"Time to Event Related",tables:["AZTONCEF14"]},{title:"Other",tables:["AZTONCEF01","AZTONCEF03","AZTONCEF13","AZTONCEF05"]}],l3e="/ogemsharing/excel_sheets/O-GEM efficacy macro dev tracker.xlsx",c3e=["AZTONCEF04","AZTONCEF02A","AZTONCEF14","AZTONCEF01"],DW={AZTONCEF01:"Best overall response <at timepoint> based on [[confirmed|unconfirmed]] response by [[blinded independent central review|independent central review|investigator assessment]]",AZTONCEF02A:"Objective response/Clinical benefit/Disease control rate <at x weeks> based on [[confirmed|unconfirmed]] response by [[blinded independent central review|independent central review|investigator assessment]] - [[sensitivity|supplementary]] analysis <<Subjects with measurable disease>>",AZTONCEF02B:"Objective response/Clinical benefit/Disease control rate <at x weeks> based on [[confirmed|unconfirmed]] response by [[blinded independent central review|investigator assessment]] - [[sensitivity|supplementary]] analysis <<Subjects with measurable disease>>",AZTONCEF03:"Duration and onset of [[objective response|response]] based on [[confirmed|unconfirmed]] response by [[blinded independent central review|independent central review|investigator assessment]]",AZTONCEF04:"Progression-free survival by [[blinded independent central review|independent central review|investigator assessment]]",AZTONCEF09:"Overall survival",AZTONCEF14:"Time to [[first subsequent therapy|second subsequent therapy|IP discontinuation]] or death",AZTONCEF17:"Second progression-free survival by [[blinded independent central review|independent central review|investigator assessment]]"};function u3e(t){const e=[];let r=0;const n=/\[\[(.*?)\]\]/g;let i,s=0;for(;(i=n.exec(t))!==null;)i.index>r&&e.push(t.slice(r,i.index)),e.push(I.jsx("span",{style:{color:"#00b96b",fontFamily:"inherit"},children:i[1]},s++)),r=n.lastIndex;return r<t.length&&e.push(t.slice(r)),e}function f3e(t,e=80,r=400){if(!t||t.length===0)return[];const n=t[0].length,i=[];for(let s=0;s<n;s++){let o=e;for(let a=0;a<t.length;a++){const l=t[a][s]?String(t[a][s]):"";o=Math.max(o,l.length*12+24)}i.push(Math.min(o,r))}return i}const h3e=({theme:t})=>{const[e,r]=Y.useState(0),[n,i]=Y.useState(nw[0].tables[0]),[s,o]=Y.useState(null),[a,l]=Y.useState([]),[u,h]=Y.useState([]),[d,m]=Y.useState(!1);return Kt.useEffect(()=>{i(nw[e].tables[0])},[e]),Kt.useEffect(()=>{if(!c3e.includes(n)){o(null),l([]),h([]);return}m(!0),fetch(l3e).then(g=>g.arrayBuffer()).then(g=>{const x=x_(g,{type:"array",cellStyles:!0}).Sheets[n];if(x){console.log("sheet:",n),console.log(":",x["!merges"]);let b=vTe.sheet_to_json(x,{header:1});const E=(x["!merges"]||[]).map(k=>({row:k.s.r,col:k.s.c,rowspan:k.e.r-k.s.r+1,colspan:k.e.c-k.s.c+1}));let R=0;b.forEach(k=>{k.length>R&&(R=k.length)}),E.forEach(k=>{k.col+k.colspan>R&&(R=k.col+k.colspan)}),b=b.map(k=>{const O=[...k];for(;O.length<R;)O.push("");return O}),o(b),h(f3e(b)),l(E)}else o(null),l([]),h([]);m(!1)}).catch(()=>{o(null),l([]),h([]),m(!1)})},[n]),I.jsxs(qs,{title:"Onco core efficacy Tables Classification",children:[I.jsxs(Bi,{sx:{p:3,minHeight:500,boxShadow:"none",background:"transparent"},children:[I.jsx(yhe,{value:e,onChange:(g,y)=>r(y),sx:{mb:2,minHeight:48,borderBottom:"2px solid #e0e0e0"},TabIndicatorProps:{style:{background:"#8B008B",height:4}},children:nw.map((g,y)=>I.jsx(Jfe,{label:g.title,sx:{minHeight:48,fontWeight:e===y?700:500,color:e===y?"#8B008B":"#444",bgcolor:e===y?"#f3e6f7":"transparent",borderRadius:"8px 8px 0 0",mx:.5,transition:"all 0.2s",border:"2px solid transparent",borderBottom:e===y?"none":"2px solid #e0e0e0"}},g.title))}),I.jsxs(_e,{sx:{display:"flex",gap:4,alignItems:"flex-start",mt:2},children:[I.jsx(_e,{sx:{minWidth:260,maxWidth:340},children:nw[e].tables.map(g=>I.jsxs(_e,{sx:{mb:2},children:[I.jsx(Iue,{variant:n===g?"contained":"outlined",color:"primary",size:"small",sx:{mb:.5,width:"100%",justifyContent:"flex-start",fontWeight:500,textTransform:"none",whiteSpace:"normal",wordBreak:"break-word"},onClick:()=>i(g),disabled:!1,children:g}),DW[g]&&I.jsx(pt,{variant:"caption",sx:{display:"block",color:"#666",pl:2,pr:1,whiteSpace:"normal",wordBreak:"break-word"},children:u3e(DW[g])})]},g))}),I.jsx(_e,{sx:{flex:1,minWidth:320,overflow:"auto",border:"1px solid #e0e0e0",borderRadius:2,bgcolor:"#fafbfc"},children:d?I.jsx(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:200},children:I.jsx(CD,{})}):s&&s.length>0?I.jsx("div",{style:{width:"100%",minWidth:600,height:600,background:"#fff",borderRadius:6,overflow:"auto",border:"1px solid #e0e0e0"},children:I.jsx(qZ,{data:s,colHeaders:!0,rowHeaders:!0,width:"100%",height:580,stretchH:"all",mergeCells:a,colWidths:u,licenseKey:"non-commercial-and-evaluation",readOnly:!0,className:"custom-excel-grid",cells:(g,y)=>{if(["AZTONCEF04","AZTONCEF14","AZTONCEF01"].includes(n)){if(g===1)return{className:"htBorderTopThick"};if(g===3)return{className:"htBorderBottomThick"}}return{}}})}):I.jsx(pt,{variant:"body2",sx:{color:"text.secondary",mt:2},children:"No Excel data for this table."})})]})]}),I.jsx("style",{children:`
        .custom-excel-grid .htCore td,
        .custom-excel-grid .htCore th {
          border: 1px solid #bdbdbd !important;
        }
        .custom-excel-grid .htBorderTopThick {
          border-top: 3px solid #222 !important;
        }
        .custom-excel-grid .htBorderBottomThick {
          border-bottom: 3px solid #222 !important;
        }
      `})]})},d3e=({theme:t})=>{var y,x,b,C,E,R;const[e,r]=Y.useState(!1),[n,i]=Y.useState(!1),[s,o]=Y.useState(!0),[a,l]=Y.useState(!1);let u=0;s||(e&&!n?u=-18:!e&&n?u=18:u=0);let h=I.jsxs(I.Fragment,{children:[I.jsx(pt,{variant:"h5",sx:{fontWeight:700,color:((x=(y=t==null?void 0:t.palette)==null?void 0:y.primary)==null?void 0:x.main)||"#36e09e",mb:2},children:"Why O-GEM Macros?"}),I.jsxs(pt,{variant:"body1",sx:{color:"#444",fontSize:18,lineHeight:1.7,mb:2},children:["Our efficacy macros are designed to ",I.jsx("b",{children:"balance stability and flexibility"}),".",I.jsx("br",{}),"You can easily switch between standardized and complex outputs, ensuring both ",I.jsx("b",{children:"consistency"})," and ",I.jsx("b",{children:"customization"})," for your needs."]}),I.jsx(_e,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",mt:2},children:I.jsx("img",{src:"/ogemsharing/images/breakdownpic.png",alt:"Breakdown",style:{maxWidth:"100%",maxHeight:240,borderRadius:8,boxShadow:"0 2px 12px #0002",cursor:"zoom-in",transition:"box-shadow 0.2s"},onClick:()=>l(!0)})}),I.jsx(hfe,{open:a,onClose:()=>l(!1),maxWidth:"xl",PaperProps:{sx:{bgcolor:"#fff",boxShadow:"none"}},children:I.jsx(_e,{sx:{width:"90vw",height:"90vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#fff",borderRadius:2},onClick:()=>l(!1),children:I.jsx("img",{src:"/ogemsharing/images/breakdownpic.png",alt:"Breakdown Large",style:{maxWidth:"88vw",maxHeight:"88vh",borderRadius:8,boxShadow:"0 2px 24px #0008"}})})})]});s||(e&&!n?h=I.jsxs(I.Fragment,{children:[I.jsx(pt,{variant:"h5",sx:{fontWeight:700,color:((C=(b=t==null?void 0:t.palette)==null?void 0:b.primary)==null?void 0:C.main)||"#36e09e",mb:2},children:"Standardized Output"}),I.jsx(pt,{variant:"body1",sx:{color:"#444",fontSize:18,lineHeight:1.7,mb:2},children:"Display macro with flexible output dataset modification"}),I.jsxs(_e,{sx:{mt:1,pl:1},children:[I.jsx(pt,{variant:"subtitle2",sx:{color:"#888",fontWeight:600,mb:.5},children:"Display Macros:"}),I.jsxs(_e,{component:"ul",sx:{pl:3,mb:0,color:"#444",fontSize:16},children:[I.jsx("li",{children:"m_t_aztoncef04"}),I.jsx("li",{children:"m_t_aztoncef05"}),I.jsx("li",{children:"m_t_aztoncef02a"}),I.jsx("li",{children:"m_t_aztoncef02b"}),I.jsx("li",{children:"Etc."})]})]})]}):n&&!e&&(h=I.jsxs(I.Fragment,{children:[I.jsx(pt,{variant:"h5",sx:{fontWeight:700,color:((R=(E=t==null?void 0:t.palette)==null?void 0:E.primary)==null?void 0:R.main)||"#36e09e",mb:2},children:"Complex Output"}),I.jsx(pt,{variant:"body1",sx:{color:"#444",fontSize:18,lineHeight:1.7,mb:2},children:"Open template code with multiple utility macros"}),I.jsxs(_e,{sx:{mt:1,pl:1},children:[I.jsx(pt,{variant:"subtitle2",sx:{color:"#888",fontWeight:600,mb:.5},children:"Utility Macros:"}),I.jsxs(_e,{component:"ul",sx:{pl:3,mb:0,color:"#444",fontSize:16},children:[I.jsx("li",{children:"m_u_effcount"}),I.jsx("li",{children:"m_u_cox_logrank"}),I.jsx("li",{children:"m_u_km"}),I.jsx("li",{children:"m_u_binom_cpgrp"}),I.jsx("li",{children:"m_u_binom_odds"}),I.jsx("li",{children:"Etc."})]})]})]})));const d=()=>{r(!1),i(!1),o(!0)},m=()=>{r(k=>!k),i(!1),o(!1)},g=()=>{i(k=>!k),r(!1),o(!1)};return I.jsx(qs,{title:"O-GEM Efficacy Macros",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:"flex-start",justifyContent:"center",height:"100%",width:"100%"},children:[I.jsx(_e,{sx:{flex:1,minWidth:320,mr:{xs:0,md:4},mt:{xs:4,md:0},display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start"},children:I.jsx(Bi,{elevation:3,sx:{p:3,borderRadius:3,bgcolor:"#f7f7f7",minHeight:220,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:h})}),I.jsxs(_e,{sx:{flex:1.2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:340,height:"100%"},children:[I.jsxs(_e,{sx:{display:"flex",gap:4,mb:2,width:"100%",justifyContent:"center"},children:[I.jsxs(Bi,{elevation:4,sx:{width:220,minHeight:70,p:2,bgcolor:"#f7f7f7",borderRadius:3,textAlign:"center",cursor:"pointer",border:e?"2px solid #36e09e":"2px solid #e0e0e0",transition:"border 0.2s",boxShadow:e?"0 0 12px #36e09e44":void 0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:18},onClick:m,children:[I.jsxs(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:[I.jsx(pt,{variant:"subtitle1",sx:{fontWeight:700,fontSize:18,color:"#444"},children:"Standardized Outputs"}),I.jsx(c_,{sx:{ml:1,transform:e?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"}})]}),I.jsx(tv,{in:e,children:I.jsx(pt,{sx:{fontSize:17,color:"#36e09e",fontWeight:700,mt:1},children:"Simplicity and Consistency"})})]}),I.jsxs(Bi,{elevation:4,sx:{width:220,minHeight:70,p:2,bgcolor:"#f7f7f7",borderRadius:3,textAlign:"center",cursor:"pointer",border:n?"2px solid #ff6b6b":"2px solid #e0e0e0",transition:"border 0.2s",boxShadow:n?"0 0 12px #ff6b6b44":void 0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:18},onClick:g,children:[I.jsxs(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:[I.jsx(pt,{variant:"subtitle1",sx:{fontWeight:700,fontSize:18,color:"#444"},children:"Complex Outputs"}),I.jsx(c_,{sx:{ml:1,transform:n?"rotate(180deg)":"rotate(0deg)",transition:"0.2s"}})]}),I.jsx(tv,{in:n,children:I.jsx(pt,{sx:{fontSize:17,color:"#ff6b6b",fontWeight:700,mt:1},children:"Flexibility and Complexity"})})]})]}),I.jsx(_e,{sx:{position:"relative",width:"100%",height:240,display:"flex",justifyContent:"center",alignItems:"center"},children:I.jsxs(_e,{sx:{position:"relative",left:0,top:"30%",transform:"translateY(-50%)",width:340,height:180,cursor:"pointer"},onClick:d,children:[I.jsxs(ti.div,{style:{width:"100%",height:20,position:"absolute",top:60,left:0,zIndex:2,originX:.5,originY:.5},animate:{rotate:u},transition:{type:"spring",stiffness:80,damping:10},children:[I.jsx(_e,{sx:{width:"100%",height:16,bgcolor:"#fff",border:"3px solid #444",borderRadius:8,boxShadow:"0 2px 8px #0002"}}),I.jsx(_e,{sx:{position:"absolute",left:18,top:18,width:80,height:32,bgcolor:"#fff",border:"3px solid #444",borderRadius:"0 0 40px 40px",borderTop:"none",boxShadow:"0 2px 8px #0001",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}}),I.jsx(_e,{sx:{position:"absolute",right:18,top:18,width:80,height:32,bgcolor:"#fff",border:"3px solid #444",borderRadius:"0 0 40px 40px",borderTop:"none",boxShadow:"0 2px 8px #0001",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}})]}),I.jsx(_e,{sx:{position:"absolute",left:"50%",top:10,transform:"translateX(-50%)",width:36,height:36,borderRadius:"50%",border:"3px solid #444",bgcolor:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},children:I.jsx(_e,{sx:{width:18,height:6,bgcolor:"#bbb",borderRadius:2}})})]})}),I.jsx(pt,{variant:"h3",sx:{fontWeight:700,color:"#444",mt:2,fontFamily:"Comic Sans MS, Comic Sans, cursive",textShadow:"1px 2px 8px #fff8"},children:"Balancing Simplicity and Complexity"})]})]})})},PW=rn(I.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),p3e=rn(I.jsx("path",{d:"M7.5 5.6 10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.996.996 0 0 0-1.41 0L1.29 18.96c-.39.39-.39 1.02 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05c.39-.39.39-1.02 0-1.41zm-1.03 5.49-2.12-2.12 2.44-2.44 2.12 2.12z"})),m3e=rn(I.jsx("path",{d:"M18.6 6.62c-1.44 0-2.8.56-3.77 1.53L12 10.66 10.48 12h.01L7.8 14.39c-.64.64-1.49.99-2.4.99-1.87 0-3.39-1.51-3.39-3.38S3.53 8.62 5.4 8.62c.91 0 1.76.35 2.44 1.03l1.13 1 1.51-1.34L9.22 8.2C8.2 7.18 6.84 6.62 5.4 6.62 2.42 6.62 0 9.04 0 12s2.42 5.38 5.4 5.38c1.44 0 2.8-.56 3.77-1.53l2.83-2.5.01.01L13.52 12h-.01l2.69-2.39c.64-.64 1.49-.99 2.4-.99 1.87 0 3.39 1.51 3.39 3.38s-1.52 3.38-3.39 3.38c-.9 0-1.76-.35-2.44-1.03l-1.14-1.01-1.51 1.34 1.27 1.12c1.02 1.01 2.37 1.57 3.82 1.57 2.98 0 5.4-2.41 5.4-5.38s-2.42-5.37-5.4-5.37"})),g3e=rn(I.jsx("path",{d:"M13 7.83c.85-.3 1.53-.98 1.83-1.83H18l-3 7c0 1.66 1.57 3 3.5 3s3.5-1.34 3.5-3l-3-7h2V4h-6.17c-.41-1.17-1.52-2-2.83-2s-2.42.83-2.83 2H3v2h2l-3 7c0 1.66 1.57 3 3.5 3S9 14.66 9 13L6 6h3.17c.3.85.98 1.53 1.83 1.83V19H2v2h20v-2h-9zM20.37 13h-3.74l1.87-4.36zm-13 0H3.63L5.5 8.64zM12 6c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),v3e=rn(I.jsx("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}));let X_=[],KZ=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,r=0;e<t.length;e++)(e%2?KZ:X_).push(r=r+t[e])})();function y3e(t){if(t<768)return!1;for(let e=0,r=X_.length;;){let n=e+r>>1;if(t<X_[n])r=n;else if(t>=KZ[n])e=n+1;else return!0;if(e==r)return!1}}function IW(t){return t>=127462&&t<=127487}const NW=8205;function x3e(t,e,r=!0,n=!0){return(r?XZ:w3e)(t,e,n)}function XZ(t,e,r){if(e==t.length)return e;e&&QZ(t.charCodeAt(e))&&ZZ(t.charCodeAt(e-1))&&e--;let n=Gk(t,e);for(e+=LW(n);e<t.length;){let i=Gk(t,e);if(n==NW||i==NW||r&&y3e(i))e+=LW(i),n=i;else if(IW(i)){let s=0,o=e-2;for(;o>=0&&IW(Gk(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function w3e(t,e,r){for(;e>0;){let n=XZ(t,e-2,r);if(n<e)return n;e--}return 0}function Gk(t,e){let r=t.charCodeAt(e);if(!ZZ(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return QZ(n)?(r-55296<<10)+(n-56320)+65536:r}function QZ(t){return t>=56320&&t<57344}function ZZ(t){return t>=55296&&t<56320}function LW(t){return t<65536?1:2}class cr{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,n){[e,r]=qp(this,e,r);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(r,this.length,i,1),bl.from(i,this.length-(r-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){[e,r]=qp(this,e,r);let n=[];return this.decompose(e,r,n,0),bl.from(n,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new Ug(this),s=new Ug(e);for(let o=r,a=r;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(a+=i.value.length,i.done||a>=n)return!0}}iter(e=1){return new Ug(this,e)}iterRange(e,r=this.length){return new JZ(this,e,r)}iterLines(e,r){let n;if(e==null)n=this.iter();else{r==null&&(r=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new eJ(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?cr.empty:e.length<=32?new Ln(e):bl.from(Ln.split(e,[]))}}class Ln extends cr{constructor(e,r=b3e(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,n,i){for(let s=0;;s++){let o=this.text[s],a=i+o.length;if((r?n:a)>=e)return new S3e(i,a,n,o);i=a+1,n++}}decompose(e,r,n,i){let s=e<=0&&r>=this.length?this:new Ln(FW(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(i&1){let o=n.pop(),a=Yw(s.text,o.text.slice(),0,s.length);if(a.length<=32)n.push(new Ln(a,o.length+s.length));else{let l=a.length>>1;n.push(new Ln(a.slice(0,l)),new Ln(a.slice(l)))}}else n.push(s)}replace(e,r,n){if(!(n instanceof Ln))return super.replace(e,r,n);[e,r]=qp(this,e,r);let i=Yw(this.text,Yw(n.text,FW(this.text,0,e)),r),s=this.length+n.length-(r-e);return i.length<=32?new Ln(i,s):bl.from(Ln.split(i,[]),s)}sliceString(e,r=this.length,n=`
`){[e,r]=qp(this,e,r);let i="";for(let s=0,o=0;s<=r&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(i+=n),e<l&&r>s&&(i+=a.slice(Math.max(0,e-s),r-s)),s=l+1}return i}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let n=[],i=-1;for(let s of e)n.push(s),i+=s.length+1,n.length==32&&(r.push(new Ln(n,i)),n=[],i=-1);return i>-1&&r.push(new Ln(n,i)),r}}class bl extends cr{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,r,n,i){for(let s=0;;s++){let o=this.children[s],a=i+o.length,l=n+o.lines-1;if((r?l:a)>=e)return o.lineInner(e,r,n,i);i=a+1,n=l+1}}decompose(e,r,n,i){for(let s=0,o=0;o<=r&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&r>=o){let u=i&((o<=e?1:0)|(l>=r?2:0));o>=e&&l<=r&&!u?n.push(a):a.decompose(e-o,r-o,n,u)}o=l+1}}replace(e,r,n){if([e,r]=qp(this,e,r),n.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],a=s+o.length;if(e>=s&&r<=a){let l=o.replace(e-s,r-s,n),u=this.lines-o.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let h=this.children.slice();return h[i]=l,new bl(h,this.length-(r-e)+n.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,r,n)}sliceString(e,r=this.length,n=`
`){[e,r]=qp(this,e,r);let i="";for(let s=0,o=0;s<this.children.length&&o<=r;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(i+=n),e<l&&r>o&&(i+=a.sliceString(e-o,r-o,n)),o=l+1}return i}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof bl))return 0;let n=0,[i,s,o,a]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=r,s+=r){if(i==o||s==a)return n;let l=this.children[i],u=e.children[s];if(l!=u)return n+l.scanIdentical(u,r);n+=l.length+1}}static from(e,r=e.reduce((n,i)=>n+i.length+1,-1)){let n=0;for(let g of e)n+=g.lines;if(n<32){let g=[];for(let y of e)y.flatten(g);return new Ln(g,r)}let i=Math.max(32,n>>5),s=i<<1,o=i>>1,a=[],l=0,u=-1,h=[];function d(g){let y;if(g.lines>s&&g instanceof bl)for(let x of g.children)d(x);else g.lines>o&&(l>o||!l)?(m(),a.push(g)):g instanceof Ln&&l&&(y=h[h.length-1])instanceof Ln&&g.lines+y.lines<=32?(l+=g.lines,u+=g.length+1,h[h.length-1]=new Ln(y.text.concat(g.text),y.length+1+g.length)):(l+g.lines>i&&m(),l+=g.lines,u+=g.length+1,h.push(g))}function m(){l!=0&&(a.push(h.length==1?h[0]:bl.from(h,u)),u=-1,l=h.length=0)}for(let g of e)d(g);return m(),a.length==1?a[0]:new bl(a,r)}}cr.empty=new Ln([""],0);function b3e(t){let e=-1;for(let r of t)e+=r.length+1;return e}function Yw(t,e,r=0,n=1e9){for(let i=0,s=0,o=!0;s<t.length&&i<=n;s++){let a=t[s],l=i+a.length;l>=r&&(l>n&&(a=a.slice(0,n-i)),i<r&&(a=a.slice(r-i)),o?(e[e.length-1]+=a,o=!1):e.push(a)),i=l+1}return e}function FW(t,e,r){return Yw(t,[""],e,r)}class Ug{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof Ln?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],s=this.offsets[n],o=s>>1,a=i instanceof Ln?i.text.length:i.children.length;if(o==(r>0?a:0)){if(n==0)return this.done=!0,this.value="",this;r>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(r>0?0:1)){if(this.offsets[n]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof Ln){let l=i.text[o+(r<0?-1:0)];if(this.offsets[n]+=r,l.length>Math.max(0,e))return this.value=e==0?l:r>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[o+(r<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=r):(r<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(r>0?1:(l instanceof Ln?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class JZ{constructor(e,r,n){this.value="",this.done=!1,this.cursor=new Ug(e,r>n?-1:1),this.pos=r>n?e.length:0,this.from=Math.min(r,n),this.to=Math.max(r,n)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let n=r<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*r,this.value=i.length<=n?i:r<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class eJ{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:n,value:i}=this.inner.next(e);return r&&this.afterBreak?(this.value="",this.afterBreak=!1):r?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(cr.prototype[Symbol.iterator]=function(){return this.iter()},Ug.prototype[Symbol.iterator]=JZ.prototype[Symbol.iterator]=eJ.prototype[Symbol.iterator]=function(){return this});class S3e{constructor(e,r,n,i){this.from=e,this.to=r,this.number=n,this.text=i}get length(){return this.to-this.from}}function qp(t,e,r){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,r))]}function Hi(t,e,r=!0,n=!0){return x3e(t,e,r,n)}function C3e(t){return t>=56320&&t<57344}function T3e(t){return t>=55296&&t<56320}function Ns(t,e){let r=t.charCodeAt(e);if(!T3e(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return C3e(n)?(r-55296<<10)+(n-56320)+65536:r}function QI(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function Sl(t){return t<65536?1:2}const Q_=/\r\n?|\n/;var ps=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(ps||(ps={}));class Dl{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r+1];e+=n<0?this.sections[r]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,n=0,i=0;r<this.sections.length;){let s=this.sections[r++],o=this.sections[r++];o<0?(e(n,i,s),i+=s):i+=o,n+=s}}iterChangedRanges(e,r=!1){Z_(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let n=this.sections[r++],i=this.sections[r++];i<0?e.push(n,i):e.push(i,n)}return new Dl(e)}composeDesc(e){return this.empty?e:e.empty?this:tJ(this,e)}mapDesc(e,r=!1){return e.empty?this:J_(this,e,r)}mapPos(e,r=-1,n=ps.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],u=i+a;if(l<0){if(u>e)return s+(e-i);s+=a}else{if(n!=ps.Simple&&u>=e&&(n==ps.TrackDel&&i<e&&u>e||n==ps.TrackBefore&&i<e||n==ps.TrackAfter&&u>e))return null;if(u>e||u==e&&r<0&&!a)return e==i||r<0?s:s+l;s+=l}i=u}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,r=e){for(let n=0,i=0;n<this.sections.length&&i<=r;){let s=this.sections[n++],o=this.sections[n++],a=i+s;if(o>=0&&i<=r&&a>=e)return i<e&&a>r?"cover":!0;i=a}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let n=this.sections[r++],i=this.sections[r++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Dl(e)}static create(e){return new Dl(e)}}class ci extends Dl{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Z_(this,(r,n,i,s,o)=>e=e.replace(i,i+(n-r),o),!1),e}mapDesc(e,r=!1){return J_(this,e,r,!0)}invert(e){let r=this.sections.slice(),n=[];for(let i=0,s=0;i<r.length;i+=2){let o=r[i],a=r[i+1];if(a>=0){r[i]=a,r[i+1]=o;let l=i>>1;for(;n.length<l;)n.push(cr.empty);n.push(o?e.slice(s,s+o):cr.empty)}s+=o}return new ci(r,n)}compose(e){return this.empty?e:e.empty?this:tJ(this,e,!0)}map(e,r=!1){return e.empty?this:J_(this,e,r,!0)}iterChanges(e,r=!1){Z_(this,e,r)}get desc(){return Dl.create(this.sections)}filter(e){let r=[],n=[],i=[],s=new Mv(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let h=Math.min(s.len,l-a);Zi(i,h,-1);let d=s.ins==-1?-1:s.off==0?s.ins:0;Zi(r,h,d),d>0&&Du(n,r,s.text),s.forward(h),a+=h}let u=e[o++];for(;a<u;){if(s.done)break e;let h=Math.min(s.len,u-a);Zi(r,h,-1),Zi(i,h,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(h),a+=h}}return{changes:new ci(r,n),filtered:Dl.create(i)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r],i=this.sections[r+1];i<0?e.push(n):i==0?e.push([n]):e.push([n].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,n){let i=[],s=[],o=0,a=null;function l(h=!1){if(!h&&!i.length)return;o<r&&Zi(i,r-o,-1);let d=new ci(i,s);a=a?a.compose(d.map(a)):d,i=[],s=[],o=0}function u(h){if(Array.isArray(h))for(let d of h)u(d);else if(h instanceof ci){if(h.length!=r)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${r})`);l(),a=a?a.compose(h.map(a)):h}else{let{from:d,to:m=d,insert:g}=h;if(d>m||d<0||m>r)throw new RangeError(`Invalid change range ${d} to ${m} (in doc of length ${r})`);let y=g?typeof g=="string"?cr.of(g.split(n||Q_)):g:cr.empty,x=y.length;if(d==m&&x==0)return;d<o&&l(),d>o&&Zi(i,d-o,-1),Zi(i,m-d,x),Du(s,i,y),o=m}}return u(e),l(!a),a}static empty(e){return new ci(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],n=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")r.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)r.push(s[0],0);else{for(;n.length<i;)n.push(cr.empty);n[i]=cr.of(s.slice(1)),r.push(s[0],n[i].length)}}}return new ci(r,n)}static createSet(e,r){return new ci(e,r)}}function Zi(t,e,r,n=!1){if(e==0&&r<=0)return;let i=t.length-2;i>=0&&r<=0&&r==t[i+1]?t[i]+=e:i>=0&&e==0&&t[i]==0?t[i+1]+=r:n?(t[i]+=e,t[i+1]+=r):t.push(e,r)}function Du(t,e,r){if(r.length==0)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(r);else{for(;t.length<n;)t.push(cr.empty);t.push(r)}}function Z_(t,e,r){let n=t.inserted;for(let i=0,s=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)i+=a,s+=a;else{let u=i,h=s,d=cr.empty;for(;u+=a,h+=l,l&&n&&(d=d.append(n[o-2>>1])),!(r||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(i,u,s,h,d),i=u,s=h}}}function J_(t,e,r,n=!1){let i=[],s=n?[]:null,o=new Mv(t),a=new Mv(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let u=Math.min(o.len,a.len);Zi(i,u,-1),o.forward(u),a.forward(u)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!r))){let u=a.len;for(Zi(i,a.ins,-1);u;){let h=Math.min(o.len,u);o.ins>=0&&l<o.i&&o.len<=h&&(Zi(i,0,o.ins),s&&Du(s,i,o.text),l=o.i),o.forward(h),u-=h}a.next()}else if(o.ins>=0){let u=0,h=o.len;for(;h;)if(a.ins==-1){let d=Math.min(h,a.len);u+=d,h-=d,a.forward(d)}else if(a.ins==0&&a.len<h)h-=a.len,a.next();else break;Zi(i,u,l<o.i?o.ins:0),s&&l<o.i&&Du(s,i,o.text),l=o.i,o.forward(o.len-h)}else{if(o.done&&a.done)return s?ci.createSet(i,s):Dl.create(i);throw new Error("Mismatched change set lengths")}}}function tJ(t,e,r=!1){let n=[],i=r?[]:null,s=new Mv(t),o=new Mv(e);for(let a=!1;;){if(s.done&&o.done)return i?ci.createSet(n,i):Dl.create(n);if(s.ins==0)Zi(n,s.len,0,a),s.next();else if(o.len==0&&!o.done)Zi(n,0,o.ins,a),i&&Du(i,n,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),u=n.length;if(s.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;Zi(n,l,h,a),i&&h&&Du(i,n,o.text)}else o.ins==-1?(Zi(n,s.off?0:s.len,l,a),i&&Du(i,n,s.textBit(l))):(Zi(n,s.off?0:s.len,o.off?0:o.ins,a),i&&!o.off&&Du(i,n,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||n.length>u),s.forward2(l),o.forward(l)}}}}class Mv{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?cr.empty:e[r]}textBit(e){let{inserted:r}=this.set,n=this.i-2>>1;return n>=r.length&&!e?cr.empty:r[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class nh{constructor(e,r,n){this.from=e,this.to=r,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,r=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,r):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new nh(n,i,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return Pe.range(e,r);let n=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return Pe.range(this.anchor,n)}eq(e,r=!1){return this.anchor==e.anchor&&this.head==e.head&&(!r||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Pe.range(e.anchor,e.head)}static create(e,r,n){return new nh(e,r,n)}}class Pe{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:Pe.create(this.ranges.map(n=>n.map(e,r)),this.mainIndex)}eq(e,r=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],r))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Pe([this.main],0)}addRange(e,r=!0){return Pe.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let n=this.ranges.slice();return n[r]=e,Pe.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Pe(e.ranges.map(r=>nh.fromJSON(r)),e.main)}static single(e,r=e){return new Pe([Pe.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=n:s.from<n)return Pe.normalized(e.slice(),r);n=s.to}return new Pe(e,r)}static cursor(e,r=0,n,i){return nh.create(e,e,(r==0?0:r<0?8:16)|(n==null?7:Math.min(6,n))|(i??16777215)<<6)}static range(e,r,n,i){let s=(n??16777215)<<6|(i==null?7:Math.min(6,i));return r<e?nh.create(r,e,48|s):nh.create(e,r,(r>e?8:0)|s)}static normalized(e,r=0){let n=e[r];e.sort((i,s)=>i.from-s.from),r=e.indexOf(n);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);i<=r&&r--,e.splice(--i,2,s.anchor>s.head?Pe.range(l,a):Pe.range(a,l))}}return new Pe(e,r)}}function rJ(t,e){for(let r of t.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}let ZI=0;class Ke{constructor(e,r,n,i,s){this.combine=e,this.compareInput=r,this.compare=n,this.isStatic=i,this.id=ZI++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Ke(e.combine||(r=>r),e.compareInput||((r,n)=>r===n),e.compare||(e.combine?(r,n)=>r===n:JI),!!e.static,e.enables)}of(e){return new qw([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new qw(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new qw(e,this,2,r)}from(e,r){return r||(r=n=>n),this.compute([e],n=>r(n.field(e)))}}function JI(t,e){return t==e||t.length==e.length&&t.every((r,n)=>r===e[n])}class qw{constructor(e,r,n,i){this.dependencies=e,this.facet=r,this.type=n,this.value=i,this.id=ZI++}dynamicSlot(e){var r;let n=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,u=!1,h=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?u=!0:(((r=e[d.id])!==null&&r!==void 0?r:1)&1)==0&&h.push(e[d.id]);return{create(d){return d.values[o]=n(d),1},update(d,m){if(l&&m.docChanged||u&&(m.docChanged||m.selection)||eM(d,h)){let g=n(d);if(a?!HW(g,d.values[o],i):!i(g,d.values[o]))return d.values[o]=g,1}return 0},reconfigure:(d,m)=>{let g,y=m.config.address[s];if(y!=null){let x=Ub(m,y);if(this.dependencies.every(b=>b instanceof Ke?m.facet(b)===d.facet(b):b instanceof Wi?m.field(b,!1)==d.field(b,!1):!0)||(a?HW(g=n(d),x,i):i(g=n(d),x)))return d.values[o]=x,0}else g=n(d);return d.values[o]=g,1}}}}function HW(t,e,r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}function eM(t,e){let r=!1;for(let n of e)$g(t,n)&1&&(r=!0);return r}function E3e(t,e,r){let n=r.map(l=>t[l.id]),i=r.map(l=>l.type),s=n.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let u=[];for(let h=0;h<n.length;h++){let d=Ub(l,n[h]);if(i[h]==2)for(let m of d)u.push(m);else u.push(d)}return e.combine(u)}return{create(l){for(let u of n)$g(l,u);return l.values[o]=a(l),1},update(l,u){if(!eM(l,s))return 0;let h=a(l);return e.compare(h,l.values[o])?0:(l.values[o]=h,1)},reconfigure(l,u){let h=eM(l,n),d=u.config.facets[e.id],m=u.facet(e);if(d&&!h&&JI(r,d))return l.values[o]=m,0;let g=a(l);return e.compare(g,m)?(l.values[o]=m,0):(l.values[o]=g,1)}}}const iw=Ke.define({static:!0});class Wi{constructor(e,r,n,i,s){this.id=e,this.createF=r,this.updateF=n,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let r=new Wi(ZI++,e.create,e.update,e.compare||((n,i)=>n===i),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(iw).find(n=>n.field==this);return((r==null?void 0:r.create)||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:n=>(n.values[r]=this.create(n),1),update:(n,i)=>{let s=n.values[r],o=this.updateF(s,i);return this.compareF(s,o)?0:(n.values[r]=o,1)},reconfigure:(n,i)=>{let s=n.facet(iw),o=i.facet(iw),a;return(a=s.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(n.values[r]=a.create(n),1):i.config.address[this.id]!=null?(n.values[r]=i.field(this),0):(n.values[r]=this.create(n),1)}}}init(e){return[this,iw.of({field:this,create:e})]}get extension(){return this}}const Kf={lowest:4,low:3,default:2,high:1,highest:0};function Qm(t){return e=>new nJ(e,t)}const Xh={highest:Qm(Kf.highest),high:Qm(Kf.high),default:Qm(Kf.default),low:Qm(Kf.low),lowest:Qm(Kf.lowest)};class nJ{constructor(e,r){this.inner=e,this.prec=r}}class dC{of(e){return new tM(this,e)}reconfigure(e){return dC.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class tM{constructor(e,r){this.compartment=e,this.inner=r}}class zb{constructor(e,r,n,i,s,o){for(this.base=e,this.compartments=r,this.dynamicSlots=n,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,n){let i=[],s=Object.create(null),o=new Map;for(let m of R3e(e,r,o))m instanceof Wi?i.push(m):(s[m.facet.id]||(s[m.facet.id]=[])).push(m);let a=Object.create(null),l=[],u=[];for(let m of i)a[m.id]=u.length<<1,u.push(g=>m.slot(g));let h=n==null?void 0:n.config.facets;for(let m in s){let g=s[m],y=g[0].facet,x=h&&h[m]||[];if(g.every(b=>b.type==0))if(a[y.id]=l.length<<1|1,JI(x,g))l.push(n.facet(y));else{let b=y.combine(g.map(C=>C.value));l.push(n&&y.compare(b,n.facet(y))?n.facet(y):b)}else{for(let b of g)b.type==0?(a[b.id]=l.length<<1|1,l.push(b.value)):(a[b.id]=u.length<<1,u.push(C=>b.dynamicSlot(C)));a[y.id]=u.length<<1,u.push(b=>E3e(b,y,g))}}let d=u.map(m=>m(a));return new zb(e,o,d,a,l,s)}}function R3e(t,e,r){let n=[[],[],[],[],[]],i=new Map;function s(o,a){let l=i.get(o);if(l!=null){if(l<=a)return;let u=n[l].indexOf(o);u>-1&&n[l].splice(u,1),o instanceof tM&&r.delete(o.compartment)}if(i.set(o,a),Array.isArray(o))for(let u of o)s(u,a);else if(o instanceof tM){if(r.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;r.set(o.compartment,u),s(u,a)}else if(o instanceof nJ)s(o.inner,o.prec);else if(o instanceof Wi)n[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof qw)n[a].push(o),o.facet.extensions&&s(o.facet.extensions,Kf.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,a)}}return s(t,Kf.default),n.reduce((o,a)=>o.concat(a))}function $g(t,e){if(e&1)return 2;let r=e>>1,n=t.status[r];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;t.status[r]=4;let i=t.computeSlot(t,t.config.dynamicSlots[r]);return t.status[r]=2|i}function Ub(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const iJ=Ke.define(),rM=Ke.define({combine:t=>t.some(e=>e),static:!0}),sJ=Ke.define({combine:t=>t.length?t[0]:void 0,static:!0}),oJ=Ke.define(),aJ=Ke.define(),lJ=Ke.define(),cJ=Ke.define({combine:t=>t.length?t[0]:!1});class Ul{constructor(e,r){this.type=e,this.value=r}static define(){return new A3e}}class A3e{of(e){return new Ul(this,e)}}class k3e{constructor(e){this.map=e}of(e){return new Mt(this,e)}}class Mt{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new Mt(this.type,r)}is(e){return this.type==e}static define(e={}){return new k3e(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let n=[];for(let i of e){let s=i.map(r);s&&n.push(s)}return n}}Mt.reconfigure=Mt.define();Mt.appendConfig=Mt.define();class hi{constructor(e,r,n,i,s,o){this.startState=e,this.changes=r,this.selection=n,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,n&&rJ(n,r.newLength),s.some(a=>a.type==hi.time)||(this.annotations=s.concat(hi.time.of(Date.now())))}static create(e,r,n,i,s,o){return new hi(e,r,n,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(hi.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}}hi.time=Ul.define();hi.userEvent=Ul.define();hi.addToHistory=Ul.define();hi.remote=Ul.define();function O3e(t,e){let r=[];for(let n=0,i=0;;){let s,o;if(n<t.length&&(i==e.length||e[i]>=t[n]))s=t[n++],o=t[n++];else if(i<e.length)s=e[i++],o=e[i++];else return r;!r.length||r[r.length-1]<s?r.push(s,o):r[r.length-1]<o&&(r[r.length-1]=o)}}function uJ(t,e,r){var n;let i,s,o;return r?(i=e.changes,s=ci.empty(e.changes.length),o=t.changes.compose(e.changes)):(i=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(n=t.selection)===null||n===void 0?void 0:n.map(i),effects:Mt.mapEffects(t.effects,i).concat(Mt.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function nM(t,e,r){let n=e.selection,i=Ep(e.annotations);return e.userEvent&&(i=i.concat(hi.userEvent.of(e.userEvent))),{changes:e.changes instanceof ci?e.changes:ci.of(e.changes||[],r,t.facet(sJ)),selection:n&&(n instanceof Pe?n:Pe.single(n.anchor,n.head)),effects:Ep(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function fJ(t,e,r){let n=nM(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(r=!1);let o=!!e[s].sequential;n=uJ(n,nM(t,e[s],o?n.changes.newLength:t.doc.length),o)}let i=hi.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return M3e(r?_3e(i):i)}function _3e(t){let e=t.startState,r=!0;for(let i of e.facet(oJ)){let s=i(t);if(s===!1){r=!1;break}Array.isArray(s)&&(r=r===!0?s:O3e(r,s))}if(r!==!0){let i,s;if(r===!1)s=t.changes.invertedDesc,i=ci.empty(e.doc.length);else{let o=t.changes.filter(r);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=hi.create(e,i,t.selection&&t.selection.map(s),Mt.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let n=e.facet(aJ);for(let i=n.length-1;i>=0;i--){let s=n[i](t);s instanceof hi?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof hi?t=s[0]:t=fJ(e,Ep(s),!1)}return t}function M3e(t){let e=t.startState,r=e.facet(lJ),n=t;for(let i=r.length-1;i>=0;i--){let s=r[i](t);s&&Object.keys(s).length&&(n=uJ(n,nM(e,s,t.changes.newLength),!0))}return n==t?t:hi.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}const D3e=[];function Ep(t){return t==null?D3e:Array.isArray(t)?t:[t]}var un=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(un||(un={}));const P3e=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let iM;try{iM=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function I3e(t){if(iM)return iM.test(t);for(let e=0;e<t.length;e++){let r=t[e];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||P3e.test(r)))return!0}return!1}function N3e(t){return e=>{if(!/\S/.test(e))return un.Space;if(I3e(e))return un.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return un.Word;return un.Other}}class Qt{constructor(e,r,n,i,s,o){this.config=e,this.doc=r,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)$g(this,a<<1);this.computeSlot=null}field(e,r=!0){let n=this.config.address[e.id];if(n==null){if(r)throw new RangeError("Field is not present in this state");return}return $g(this,n),Ub(this,n)}update(...e){return fJ(this,e,!0)}applyTransaction(e){let r=this.config,{base:n,compartments:i}=r;for(let a of e.effects)a.is(dC.reconfigure)?(r&&(i=new Map,r.compartments.forEach((l,u)=>i.set(u,l)),r=null),i.set(a.value.compartment,a.value.extension)):a.is(Mt.reconfigure)?(r=null,n=a.value):a.is(Mt.appendConfig)&&(r=null,n=Ep(n).concat(a.value));let s;r?s=e.startState.values.slice():(r=zb.resolve(n,i,this),s=new Qt(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(l,u)=>u.reconfigure(l,this),null).values);let o=e.startState.facet(rM)?e.newSelection:e.newSelection.asSingle();new Qt(r,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:Pe.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,n=e(r.ranges[0]),i=this.changes(n.changes),s=[n.range],o=Ep(n.effects);for(let a=1;a<r.ranges.length;a++){let l=e(r.ranges[a]),u=this.changes(l.changes),h=u.map(i);for(let m=0;m<a;m++)s[m]=s[m].map(h);let d=i.mapDesc(u,!0);s.push(l.range.map(d)),i=i.compose(h),o=Mt.mapEffects(o,h).concat(Mt.mapEffects(Ep(l.effects),d))}return{changes:i,selection:Pe.create(s,r.mainIndex),effects:o}}changes(e=[]){return e instanceof ci?e:ci.of(e,this.doc.length,this.facet(Qt.lineSeparator))}toText(e){return cr.of(e.split(this.facet(Qt.lineSeparator)||Q_))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:($g(this,r),Ub(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof Wi&&this.config.address[i.id]!=null&&(r[n]=i.spec.toJSON(this.field(e[n]),this))}return r}static fromJSON(e,r={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let o=n[s],a=e[s];i.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Qt.create({doc:e.doc,selection:Pe.fromJSON(e.selection),extensions:r.extensions?i.concat([r.extensions]):i})}static create(e={}){let r=zb.resolve(e.extensions||[],new Map),n=e.doc instanceof cr?e.doc:cr.of((e.doc||"").split(r.staticFacet(Qt.lineSeparator)||Q_)),i=e.selection?e.selection instanceof Pe?e.selection:Pe.single(e.selection.anchor,e.selection.head):Pe.single(0);return rJ(i,n.length),r.staticFacet(rM)||(i=i.asSingle()),new Qt(r,n,i,r.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Qt.tabSize)}get lineBreak(){return this.facet(Qt.lineSeparator)||`
`}get readOnly(){return this.facet(cJ)}phrase(e,...r){for(let n of this.facet(Qt.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(n,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>r.length?n:r[s-1]})),e}languageDataAt(e,r,n=-1){let i=[];for(let s of this.facet(iJ))for(let o of s(this,r,n))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){return N3e(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:r,from:n,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-n,a=e-n;for(;o>0;){let l=Hi(r,o,!1);if(s(r.slice(l,o))!=un.Word)break;o=l}for(;a<i;){let l=Hi(r,a);if(s(r.slice(a,l))!=un.Word)break;a=l}return o==a?null:Pe.range(o+n,a+n)}}Qt.allowMultipleSelections=rM;Qt.tabSize=Ke.define({combine:t=>t.length?t[0]:4});Qt.lineSeparator=sJ;Qt.readOnly=cJ;Qt.phrases=Ke.define({compare(t,e){let r=Object.keys(t),n=Object.keys(e);return r.length==n.length&&r.every(i=>t[i]==e[i])}});Qt.languageData=iJ;Qt.changeFilter=oJ;Qt.transactionFilter=aJ;Qt.transactionExtender=lJ;dC.reconfigure=Mt.define();function $l(t,e,r={}){let n={};for(let i of t)for(let s of Object.keys(i)){let o=i[s],a=n[s];if(a===void 0)n[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(r,s))n[s]=r[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)n[i]===void 0&&(n[i]=e[i]);return n}class kh{eq(e){return this==e}range(e,r=e){return sM.create(e,r,this)}}kh.prototype.startSide=kh.prototype.endSide=0;kh.prototype.point=!1;kh.prototype.mapMode=ps.TrackDel;let sM=class hJ{constructor(e,r,n){this.from=e,this.to=r,this.value=n}static create(e,r,n){return new hJ(e,r,n)}};function oM(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class eN{constructor(e,r,n,i){this.from=e,this.to=r,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,r,n,i=0){let s=n?this.to:this.from;for(let o=i,a=s.length;;){if(o==a)return o;let l=o+a>>1,u=s[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-r;if(l==o)return u>=0?o:a;u>=0?a=l:o=l+1}}between(e,r,n,i){for(let s=this.findIndex(r,-1e9,!0),o=this.findIndex(n,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,r){let n=[],i=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],h=this.from[l]+e,d=this.to[l]+e,m,g;if(h==d){let y=r.mapPos(h,u.startSide,u.mapMode);if(y==null||(m=g=y,u.startSide!=u.endSide&&(g=r.mapPos(h,u.endSide),g<m)))continue}else if(m=r.mapPos(h,u.startSide),g=r.mapPos(d,u.endSide),m>g||m==g&&u.startSide>0&&u.endSide<=0)continue;(g-m||u.endSide-u.startSide)<0||(o<0&&(o=m),u.point&&(a=Math.max(a,g-m)),n.push(u),i.push(m-o),s.push(g-o))}return{mapped:n.length?new eN(i,s,n,a):null,pos:o}}}class lr{constructor(e,r,n,i){this.chunkPos=e,this.chunk=r,this.nextLayer=n,this.maxPoint=i}static create(e,r,n,i){return new lr(e,r,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:n=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(r.length==0&&!o)return this;if(n&&(r=r.slice().sort(oM)),this.isEmpty)return r.length?lr.of(r):this;let a=new dJ(this,null,-1).goto(0),l=0,u=[],h=new Lc;for(;a.value||l<r.length;)if(l<r.length&&(a.from-r[l].from||a.startSide-r[l].value.startSide)>=0){let d=r[l++];h.addInner(d.from,d.to,d.value)||u.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==r.length||this.chunkEnd(a.chunkIndex)<r[l].from)&&(!o||i>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&h.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||i>a.to||s<a.from||o(a.from,a.to,a.value))&&(h.addInner(a.from,a.to,a.value)||u.push(sM.create(a.from,a.to,a.value))),a.next());return h.finishInner(this.nextLayer.isEmpty&&!u.length?lr.empty:this.nextLayer.update({add:u,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],n=[],i=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],u=e.touchesRange(a,a+l.length);if(u===!1)i=Math.max(i,l.maxPoint),r.push(l),n.push(e.mapPos(a));else if(u===!0){let{mapped:h,pos:d}=l.map(a,e);h&&(i=Math.max(i,h.maxPoint),r.push(h),n.push(d))}}let s=this.nextLayer.map(e);return r.length==0?s:new lr(n,r,s||lr.empty,i)}between(e,r,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(r>=s&&e<=s+o.length&&o.between(s,e-s,r-s,n)===!1)return}this.nextLayer.between(e,r,n)}}iter(e=0){return Dv.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return Dv.from(e).goto(r)}static compare(e,r,n,i,s=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),a=r.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),l=BW(o,a,n),u=new Zm(o,l,s),h=new Zm(a,l,s);n.iterGaps((d,m,g)=>VW(u,d,h,m,g,i)),n.empty&&n.length==0&&VW(u,0,h,0,0,i)}static eq(e,r,n=0,i){i==null&&(i=999999999);let s=e.filter(h=>!h.isEmpty&&r.indexOf(h)<0),o=r.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=BW(s,o),l=new Zm(s,a,0).goto(n),u=new Zm(o,a,0).goto(n);for(;;){if(l.to!=u.to||!aM(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>i)return!0;l.next(),u.next()}}static spans(e,r,n,i,s=-1){let o=new Zm(e,null,s).goto(r),a=r,l=o.openStart;for(;;){let u=Math.min(o.to,n);if(o.point){let h=o.activeForPoint(o.to),d=o.pointFrom<r?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,l);i.point(a,u,o.point,h,d,o.pointRank),l=Math.min(o.openEnd(u),h.length)}else u>a&&(i.span(a,u,o.active,l),l=o.openEnd(u));if(o.to>n)return l+(o.point&&o.to>n?1:0);a=o.to,o.next()}}static of(e,r=!1){let n=new Lc;for(let i of e instanceof sM?[e]:r?L3e(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return lr.empty;let r=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=lr.empty;i=i.nextLayer)r=new lr(i.chunkPos,i.chunk,r,Math.max(i.maxPoint,r.maxPoint));return r}}lr.empty=new lr([],[],null,-1);function L3e(t){if(t.length>1)for(let e=t[0],r=1;r<t.length;r++){let n=t[r];if(oM(e,n)>0)return t.slice().sort(oM);e=n}return t}lr.empty.nextLayer=lr.empty;class Lc{finishChunk(e){this.chunks.push(new eN(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,r,n){this.addInner(e,r,n)||(this.nextLayer||(this.nextLayer=new Lc)).add(e,r,n)}addInner(e,r,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=r,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let n=r.value.length-1;return this.last=r.value[n],this.lastFrom=r.from[n]+e,this.lastTo=r.to[n]+e,!0}finish(){return this.finishInner(lr.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=lr.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}}function BW(t,e,r){let n=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&n.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=n.get(s.chunk[o]);a!=null&&(r?r.mapPos(a):a)==s.chunkPos[o]&&!(r!=null&&r.touchesRange(a,a+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class dJ{constructor(e,r,n,i=0){this.layer=e,this.skip=r,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,n){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],n=e+r.from[this.rangeIndex];if(this.from=n,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Dv{constructor(e){this.heap=e}static from(e,r=null,n=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&i.push(new dJ(o,r,n,s));return i.length==1?i[0]:new Dv(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let n of this.heap)n.goto(e,r);for(let n=this.heap.length>>1;n>=0;n--)Yk(this.heap,n);return this.next(),this}forward(e,r){for(let n of this.heap)n.forward(e,r);for(let n=this.heap.length>>1;n>=0;n--)Yk(this.heap,n);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Yk(this.heap,0)}}}function Yk(t,e){for(let r=t[e];;){let n=(e<<1)+1;if(n>=t.length)break;let i=t[n];if(n+1<t.length&&i.compare(t[n+1])>=0&&(i=t[n+1],n++),r.compare(i)<0)break;t[n]=r,t[e]=i,e=n}}class Zm{constructor(e,r,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Dv.from(e,r,n)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){sw(this.active,e),sw(this.activeTo,e),sw(this.activeRank,e),this.minActive=jW(this.active,this.activeTo)}addActive(e){let r=0,{value:n,to:i,rank:s}=this.cursor;for(;r<this.activeRank.length&&(s-this.activeRank[r]||i-this.activeTo[r])>0;)r++;ow(this.active,r,n),ow(this.activeTo,r,i),ow(this.activeRank,r,s),e&&ow(e,r,this.cursor.from),this.minActive=jW(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&sw(n,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let i=n.length-1;i>=0&&n[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&r.push(this.active[n]);return r.reverse()}openEnd(e){let r=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)r++;return r}}function VW(t,e,r,n,i,s){t.goto(e),r.goto(n);let o=n+i,a=n,l=n-e;for(;;){let u=t.to+l-r.to,h=u||t.endSide-r.endSide,d=h<0?t.to+l:r.to,m=Math.min(d,o);if(t.point||r.point?t.point&&r.point&&(t.point==r.point||t.point.eq(r.point))&&aM(t.activeForPoint(t.to),r.activeForPoint(r.to))||s.comparePoint(a,m,t.point,r.point):m>a&&!aM(t.active,r.active)&&s.compareRange(a,m,t.active,r.active),d>o)break;(u||t.openEnd!=r.openEnd)&&s.boundChange&&s.boundChange(d),a=d,h<=0&&t.next(),h>=0&&r.next()}}function aM(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r]&&!t[r].eq(e[r]))return!1;return!0}function sw(t,e){for(let r=e,n=t.length-1;r<n;r++)t[r]=t[r+1];t.pop()}function ow(t,e,r){for(let n=t.length-1;n>=e;n--)t[n+1]=t[n];t[e]=r}function jW(t,e){let r=-1,n=1e9;for(let i=0;i<e.length;i++)(e[i]-n||t[i].endSide-t[r].endSide)<0&&(r=i,n=e[i]);return r}function b0(t,e,r=t.length){let n=0;for(let i=0;i<r&&i<t.length;)t.charCodeAt(i)==9?(n+=e-n%e,i++):(n++,i=Hi(t,i));return n}function lM(t,e,r,n){for(let i=0,s=0;;){if(s>=e)return i;if(i==t.length)break;s+=t.charCodeAt(i)==9?r-s%r:1,i=Hi(t,i)}return n===!0?-1:t.length}const cM="",WW=typeof Symbol>"u"?"__"+cM:Symbol.for(cM),uM=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),zW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class qu{constructor(e,r){this.rules=[];let{finish:n}=r||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,u){let h=[],d=/^@(\w+)\b/.exec(o[0]),m=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let g in a){let y=a[g];if(/&/.test(g))s(g.split(/,\s*/).map(x=>o.map(b=>x.replace(/&/,b))).reduce((x,b)=>x.concat(b)),y,l);else if(y&&typeof y=="object"){if(!d)throw new RangeError("The value of a property ("+g+") should be a primitive value.");s(i(g),y,h,m)}else y!=null&&h.push(g.replace(/_.*/,"").replace(/[A-Z]/g,x=>"-"+x.toLowerCase())+": "+y+";")}(h.length||m)&&l.push((n&&!d&&!u?o.map(n):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=zW[WW]||1;return zW[WW]=e+1,cM+e.toString(36)}static mount(e,r,n){let i=e[uM],s=n&&n.nonce;i?s&&i.setNonce(s):i=new F3e(e,s),i.mount(Array.isArray(r)?r:[r],e)}}let UW=new Map;class F3e{constructor(e,r){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=UW.get(n);if(s)return e[uM]=s;this.sheet=new i.CSSStyleSheet,UW.set(n,this)}else this.styleTag=n.createElement("style"),r&&this.styleTag.setAttribute("nonce",r);this.modules=[],e[uM]=this}mount(e,r){let n=this.sheet,i=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),n)for(let u=0;u<a.rules.length;u++)n.insertRule(a.rules[u],i++)}else{for(;s<l;)i+=this.modules[s++].rules.length;i+=a.rules.length,s++}}if(n)r.adoptedStyleSheets.indexOf(this.sheet)<0&&(r.adoptedStyleSheets=[this.sheet,...r.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=r.head||r;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Ku={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Pv={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},H3e=typeof navigator<"u"&&/Mac/.test(navigator.platform),B3e=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Li=0;Li<10;Li++)Ku[48+Li]=Ku[96+Li]=String(Li);for(var Li=1;Li<=24;Li++)Ku[Li+111]="F"+Li;for(var Li=65;Li<=90;Li++)Ku[Li]=String.fromCharCode(Li+32),Pv[Li]=String.fromCharCode(Li);for(var qk in Ku)Pv.hasOwnProperty(qk)||(Pv[qk]=Ku[qk]);function V3e(t){var e=H3e&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||B3e&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Pv:Ku)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}function Pr(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];typeof i=="string"?t.setAttribute(n,i):i!=null&&(t[n]=i)}e++}for(;e<arguments.length;e++)pJ(t,arguments[e]);return t}function pJ(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)pJ(t,e[r]);else throw new RangeError("Unsupported child node: "+e)}function Iv(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function fM(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function Kw(t,e){if(!e.anchorNode)return!1;try{return fM(t,e.anchorNode)}catch{return!1}}function Kp(t){return t.nodeType==3?_h(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Gg(t,e,r,n){return r?$W(t,e,r,n,-1)||$W(t,e,r,n,1):!1}function Oh(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function $b(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function $W(t,e,r,n,i){for(;;){if(t==r&&e==n)return!0;if(e==(i<0?0:Hl(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=Oh(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=i<0?Hl(t):0}else return!1}}function Hl(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Iy(t,e){let r=e?t.left:t.right;return{left:r,right:r,top:t.top,bottom:t.bottom}}function j3e(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function mJ(t,e){let r=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.width-t.offsetWidth)<1)&&(r=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:r,scaleY:n}}function W3e(t,e,r,n,i,s,o,a){let l=t.ownerDocument,u=l.defaultView||window;for(let h=t,d=!1;h&&!d;)if(h.nodeType==1){let m,g=h==l.body,y=1,x=1;if(g)m=j3e(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(d=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let E=h.getBoundingClientRect();({scaleX:y,scaleY:x}=mJ(h,E)),m={left:E.left,right:E.left+h.clientWidth*y,top:E.top,bottom:E.top+h.clientHeight*x}}let b=0,C=0;if(i=="nearest")e.top<m.top?(C=e.top-(m.top+o),r>0&&e.bottom>m.bottom+C&&(C=e.bottom-m.bottom+o)):e.bottom>m.bottom&&(C=e.bottom-m.bottom+o,r<0&&e.top-C<m.top&&(C=e.top-(m.top+o)));else{let E=e.bottom-e.top,R=m.bottom-m.top;C=(i=="center"&&E<=R?e.top+E/2-R/2:i=="start"||i=="center"&&r<0?e.top-o:e.bottom-R+o)-m.top}if(n=="nearest"?e.left<m.left?(b=e.left-(m.left+s),r>0&&e.right>m.right+b&&(b=e.right-m.right+s)):e.right>m.right&&(b=e.right-m.right+s,r<0&&e.left<m.left+b&&(b=e.left-(m.left+s))):b=(n=="center"?e.left+(e.right-e.left)/2-(m.right-m.left)/2:n=="start"==a?e.left-s:e.right-(m.right-m.left)+s)-m.left,b||C)if(g)u.scrollBy(b,C);else{let E=0,R=0;if(C){let k=h.scrollTop;h.scrollTop+=C/x,R=(h.scrollTop-k)*x}if(b){let k=h.scrollLeft;h.scrollLeft+=b/y,E=(h.scrollLeft-k)*y}e={left:e.left-E,top:e.top-R,right:e.right-E,bottom:e.bottom-R},E&&Math.abs(E-b)<1&&(n="nearest"),R&&Math.abs(R-C)<1&&(i="nearest")}if(g)break;(e.top<m.top||e.bottom>m.bottom||e.left<m.left||e.right>m.right)&&(e={left:Math.max(e.left,m.left),right:Math.min(e.right,m.right),top:Math.max(e.top,m.top),bottom:Math.min(e.bottom,m.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function z3e(t){let e=t.ownerDocument,r,n;for(let i=t.parentNode;i&&!(i==e.body||r&&n);)if(i.nodeType==1)!n&&i.scrollHeight>i.clientHeight&&(n=i),!r&&i.scrollWidth>i.clientWidth&&(r=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:r,y:n}}class U3e{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:r,focusNode:n}=e;this.set(r,Math.min(e.anchorOffset,r?Hl(r):0),n,Math.min(e.focusOffset,n?Hl(n):0))}set(e,r,n,i){this.anchorNode=e,this.anchorOffset=r,this.focusNode=n,this.focusOffset=i}}let qd=null;function gJ(t){if(t.setActive)return t.setActive();if(qd)return t.focus(qd);let e=[];for(let r=t;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(t.focus(qd==null?{get preventScroll(){return qd={preventScroll:!0},!0}}:void 0),!qd){qd=!1;for(let r=0;r<e.length;){let n=e[r++],i=e[r++],s=e[r++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=s&&(n.scrollLeft=s)}}}let GW;function _h(t,e,r=e){let n=GW||(GW=document.createRange());return n.setEnd(t,r),n.setStart(t,e),n}function Rp(t,e,r,n){let i={key:e,code:e,keyCode:r,which:r,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function $3e(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function vJ(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function G3e(t,e){let r=e.focusNode,n=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=n)return!1;for(n=Math.min(n,Hl(r));;)if(n){if(r.nodeType!=1)return!1;let i=r.childNodes[n-1];i.contentEditable=="false"?n--:(r=i,n=Hl(r))}else{if(r==t)return!0;n=Oh(r),r=r.parentNode}}function yJ(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function xJ(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n>0)return{node:r,offset:n};if(r.nodeType==1&&n>0){if(r.contentEditable=="false")return null;r=r.childNodes[n-1],n=Hl(r)}else if(r.parentNode&&!$b(r))n=Oh(r),r=r.parentNode;else return null}}function wJ(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n<r.nodeValue.length)return{node:r,offset:n};if(r.nodeType==1&&n<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[n],n=0}else if(r.parentNode&&!$b(r))n=Oh(r)+1,r=r.parentNode;else return null}}class es{constructor(e,r,n=!0){this.node=e,this.offset=r,this.precise=n}static before(e,r){return new es(e.parentNode,Oh(e),r)}static after(e,r){return new es(e.parentNode,Oh(e)+1,r)}}const tN=[];class Lr{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let r=this.posAtStart;for(let n of this.children){if(n==e)return r;r+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,r){if(this.flags&2){let n=this.dom,i=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=i?i.nextSibling:n.firstChild)){let a=Lr.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,r),o.flags&=-8}if(s=i?i.nextSibling:n.firstChild,r&&!r.written&&r.node==n&&s!=o.dom&&(r.written=!0),o.dom.parentNode==n)for(;s&&s!=o.dom;)s=YW(s);else n.insertBefore(o.dom,s);i=o.dom}for(s=i?i.nextSibling:n.firstChild,s&&r&&r.node==n&&(r.written=!0);s;)s=YW(s)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,r),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,r){let n;if(e==this.dom)n=this.dom.childNodes[r];else{let i=Hl(e)==0?0:r==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Lr.get(n);)n=n.nextSibling;if(!n)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==n)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,r,n=0){let i=-1,s=-1,o=-1,a=-1;for(let l=0,u=n,h=n;l<this.children.length;l++){let d=this.children[l],m=u+d.length;if(u<e&&m>r)return d.domBoundsAround(e,r,u);if(m>=e&&i==-1&&(i=l,s=u),u>r&&d.dom.parentNode==this.dom){o=l,a=h;break}h=m,u=m+d.breakAfter}return{from:s,to:a<0?n+this.length:a,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let r=this.parent;r;r=r.parent){if(e&&(r.flags|=2),r.flags&1)return;r.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let r=e.parent;if(!r)return e;e=r}}replaceChildren(e,r,n=tN){this.markDirty();for(let i=e;i<r;i++){let s=this.children[i];s.parent==this&&n.indexOf(s)<0&&s.destroy()}n.length<250?this.children.splice(e,r-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(r));for(let i=0;i<n.length;i++)n[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new bJ(this.children,e,this.children.length)}childPos(e,r=1){return this.childCursor().findPos(e,r)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,r,n,i,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Lr.prototype.breakAfter=0;function YW(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class bJ{constructor(e,r,n){this.children=e,this.pos=r,this.i=n,this.off=0}findPos(e,r=1){for(;;){if(e>this.pos||e==this.pos&&(r>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function SJ(t,e,r,n,i,s,o,a,l){let{children:u}=t,h=u.length?u[e]:null,d=s.length?s[s.length-1]:null,m=d?d.breakAfter:o;if(!(e==n&&h&&!o&&!m&&s.length<2&&h.merge(r,i,s.length?d:null,r==0,a,l))){if(n<u.length){let g=u[n];g&&(i<g.length||g.breakAfter&&(d!=null&&d.breakAfter))?(e==n&&(g=g.split(i),i=0),!m&&d&&g.merge(0,i,d,!0,0,l)?s[s.length-1]=g:((i||g.children.length&&!g.children[0].length)&&g.merge(0,i,null,!1,0,l),s.push(g))):g!=null&&g.breakAfter&&(d?d.breakAfter=1:o=1),n++}for(h&&(h.breakAfter=o,r>0&&(!o&&s.length&&h.merge(r,h.length,s[0],!1,a,0)?h.breakAfter=s.shift().breakAfter:(r<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(r,h.length,null,!1,a,0),e++));e<n&&s.length;)if(u[n-1].become(s[s.length-1]))n--,s.pop(),l=s.length?0:a;else if(u[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&n<u.length&&!u[e-1].breakAfter&&u[n].merge(0,0,u[e-1],!1,a,l)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function CJ(t,e,r,n,i,s){let o=t.childCursor(),{i:a,off:l}=o.findPos(r,1),{i:u,off:h}=o.findPos(e,-1),d=e-r;for(let m of n)d+=m.length;t.length+=d,SJ(t,u,h,a,l,n,0,i,s)}let Ls=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},hM=typeof document<"u"?document:{documentElement:{style:{}}};const dM=/Edge\/(\d+)/.exec(Ls.userAgent),TJ=/MSIE \d/.test(Ls.userAgent),pM=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ls.userAgent),pC=!!(TJ||pM||dM),qW=!pC&&/gecko\/(\d+)/i.test(Ls.userAgent),Kk=!pC&&/Chrome\/(\d+)/.exec(Ls.userAgent),Y3e="webkitFontSmoothing"in hM.documentElement.style,EJ=!pC&&/Apple Computer/.test(Ls.vendor),KW=EJ&&(/Mobile\/\w+/.test(Ls.userAgent)||Ls.maxTouchPoints>2);var Qe={mac:KW||/Mac/.test(Ls.platform),windows:/Win/.test(Ls.platform),linux:/Linux|X11/.test(Ls.platform),ie:pC,ie_version:TJ?hM.documentMode||6:pM?+pM[1]:dM?+dM[1]:0,gecko:qW,gecko_version:qW?+(/Firefox\/(\d+)/.exec(Ls.userAgent)||[0,0])[1]:0,chrome:!!Kk,chrome_version:Kk?+Kk[1]:0,ios:KW,android:/Android\b/.test(Ls.userAgent),safari:EJ,webkit_version:Y3e?+(/\bAppleWebKit\/(\d+)/.exec(Ls.userAgent)||[0,0])[1]:0,tabSize:hM.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const q3e=256;class za extends Lr{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,r){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(r&&r.node==this.dom&&(r.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,r,n){return this.flags&8||n&&(!(n instanceof za)||this.length-(r-e)+n.length>q3e||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(r),this.markDirty(),!0)}split(e){let r=new za(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),r.flags|=this.flags&8,r}localPosFromDOM(e,r){return e==this.dom?r:r?this.text.length:0}domAtPos(e){return new es(this.dom,e)}domBoundsAround(e,r,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,r){return K3e(this.dom,e,r)}}class Fc extends Lr{constructor(e,r=[],n=0){super(),this.mark=e,this.children=r,this.length=n;for(let i of r)i.setParent(this)}setAttrs(e){if(vJ(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let r in this.mark.attrs)e.setAttribute(r,this.mark.attrs[r]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,r){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,r)}merge(e,r,n,i,s,o){return n&&(!(n instanceof Fc&&n.mark.eq(this.mark))||e&&s<=0||r<this.length&&o<=0)?!1:(CJ(this,e,r,n?n.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let r=[],n=0,i=-1,s=0;for(let a of this.children){let l=n+a.length;l>e&&r.push(n<e?a.split(e-n):a),i<0&&n>=e&&(i=s),n=l,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new Fc(this.mark,r,o)}domAtPos(e){return RJ(this,e)}coordsAt(e,r){return kJ(this,e,r)}}function K3e(t,e,r){let n=t.nodeValue.length;e>n&&(e=n);let i=e,s=e,o=0;e==0&&r<0||e==n&&r>=0?Qe.chrome||Qe.gecko||(e?(i--,o=1):s<n&&(s++,o=-1)):r<0?i--:s<n&&s++;let a=_h(t,i,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:r>=0)?0:a.length-1];return Qe.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,u=>u.width)||l),o?Iy(l,o<0):l||null}class Pu extends Lr{static create(e,r,n){return new Pu(e,r,n)}constructor(e,r,n){super(),this.widget=e,this.length=r,this.side=n,this.prevWidget=null}split(e){let r=Pu.create(this.widget,this.length-e,this.side);return this.length-=e,r}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,r,n,i,s,o){return n&&(!(n instanceof Pu)||!this.widget.compare(n.widget)||e>0&&s<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}become(e){return e instanceof Pu&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return cr.empty;let e=this;for(;e.parent;)e=e.parent;let{view:r}=e,n=r&&r.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):cr.empty}domAtPos(e){return(this.length?e==0:this.side>0)?es.before(this.dom):es.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);if(n)return n;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?i.length-1:0;s=i[a],!(e>0?a==0:a==i.length-1||s.top<s.bottom);a+=o?-1:1);return Iy(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Xp extends Lr{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Xp&&e.side==this.side}split(){return new Xp(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?es.before(this.dom):es.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return cr.empty}get isHidden(){return!0}}za.prototype.children=Pu.prototype.children=Xp.prototype.children=tN;function RJ(t,e){let r=t.dom,{children:n}=t,i=0;for(let s=0;i<n.length;i++){let o=n[i],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==r)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=i;s>0;s--){let o=n[s-1];if(o.dom.parentNode==r)return o.domAtPos(o.length)}for(let s=i;s<n.length;s++){let o=n[s];if(o.dom.parentNode==r)return o.domAtPos(0)}return new es(r,0)}function AJ(t,e,r){let n,{children:i}=t;r>0&&e instanceof Fc&&i.length&&(n=i[i.length-1])instanceof Fc&&n.mark.eq(e.mark)?AJ(n,e.children[0],r-1):(i.push(e),e.setParent(t)),t.length+=e.length}function kJ(t,e,r){let n=null,i=-1,s=null,o=-1;function a(u,h){for(let d=0,m=0;d<u.children.length&&m<=h;d++){let g=u.children[d],y=m+g.length;y>=h&&(g.children.length?a(g,h-m):(!s||s.isHidden&&(r>0||Q3e(s,g)))&&(y>h||m==y&&g.getSide()>0)?(s=g,o=h-m):(m<h||m==y&&g.getSide()<0&&!g.isHidden)&&(n=g,i=h-m)),m=y}}a(t,e);let l=(r<0?n:s)||n||s;return l?l.coordsAt(Math.max(0,l==n?i:o),r):X3e(t)}function X3e(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let r=Kp(e);return r[r.length-1]||null}function Q3e(t,e){let r=t.coordsAt(0,1),n=e.coordsAt(0,1);return r&&n&&n.top<r.bottom}function mM(t,e){for(let r in t)r=="class"&&e.class?e.class+=" "+t.class:r=="style"&&e.style?e.style+=";"+t.style:e[r]=t[r];return e}const XW=Object.create(null);function Gb(t,e,r){if(t==e)return!0;t||(t=XW),e||(e=XW);let n=Object.keys(t),i=Object.keys(e);if(n.length-(r&&n.indexOf(r)>-1?1:0)!=i.length-(r&&i.indexOf(r)>-1?1:0))return!1;for(let s of n)if(s!=r&&(i.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function gM(t,e,r){let n=!1;if(e)for(let i in e)r&&i in r||(n=!0,i=="style"?t.style.cssText="":t.removeAttribute(i));if(r)for(let i in r)e&&e[i]==r[i]||(n=!0,i=="style"?t.style.cssText=r[i]:t.setAttribute(i,r[i]));return n}function Z3e(t){let e=Object.create(null);for(let r=0;r<t.attributes.length;r++){let n=t.attributes[r];e[n.name]=n.value}return e}class Uc{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,r,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var ys=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(ys||(ys={}));class ft extends kh{constructor(e,r,n,i){super(),this.startSide=e,this.endSide=r,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new Ny(e)}static widget(e){let r=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return r+=n&&!e.inlineOrder?r>0?3e8:-4e8:r>0?1e8:-1e8,new Xu(e,r,r,n,e.widget||null,!1)}static replace(e){let r=!!e.block,n,i;if(e.isBlockGap)n=-5e8,i=4e8;else{let{start:s,end:o}=OJ(e,r);n=(s?r?-3e8:-1:5e8)-1,i=(o?r?2e8:1:-6e8)+1}return new Xu(e,n,i,r,e.widget||null,!0)}static line(e){return new Ly(e)}static set(e,r=!1){return lr.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ft.none=lr.empty;class Ny extends ft{constructor(e){let{start:r,end:n}=OJ(e);super(r?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var r,n;return this==e||e instanceof Ny&&this.tagName==e.tagName&&(this.class||((r=this.attrs)===null||r===void 0?void 0:r.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Gb(this.attrs,e.attrs,"class")}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}}Ny.prototype.point=!1;class Ly extends ft{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Ly&&this.spec.class==e.spec.class&&Gb(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}}Ly.prototype.mapMode=ps.TrackBefore;Ly.prototype.point=!0;class Xu extends ft{constructor(e,r,n,i,s,o){super(r,n,s,e),this.block=i,this.isReplace=o,this.mapMode=i?r<=0?ps.TrackBefore:ps.TrackAfter:ps.TrackDel}get type(){return this.startSide!=this.endSide?ys.WidgetRange:this.startSide<=0?ys.WidgetBefore:ys.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Xu&&J3e(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}}Xu.prototype.point=!0;function OJ(t,e=!1){let{inclusiveStart:r,inclusiveEnd:n}=t;return r==null&&(r=t.inclusive),n==null&&(n=t.inclusive),{start:r??e,end:n??e}}function J3e(t,e){return t==e||!!(t&&e&&t.compare(e))}function Xw(t,e,r,n=0){let i=r.length-1;i>=0&&r[i]+n>=t?r[i]=Math.max(r[i],e):r.push(t,e)}class Jn extends Lr{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,r,n,i,s,o){if(n){if(!(n instanceof Jn))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),CJ(this,e,r,n?n.children.slice():[],s,o),!0}split(e){let r=new Jn;if(r.breakAfter=this.breakAfter,this.length==0)return r;let{i:n,off:i}=this.childPos(e);i&&(r.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)r.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,r}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Gb(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,r){AJ(this,e,r)}addLineDeco(e){let r=e.spec.attributes,n=e.spec.class;r&&(this.attrs=mM(r,this.attrs||{})),n&&(this.attrs=mM({class:n},this.attrs||{}))}domAtPos(e){return RJ(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,r){var n;this.dom?this.flags&4&&(vJ(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(gM(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,r);let i=this.dom.lastChild;for(;i&&Lr.get(i)instanceof Fc;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((n=Lr.get(i))===null||n===void 0?void 0:n.isEditable)==!1&&(!Qe.ios||!this.children.some(s=>s instanceof za))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,r;for(let n of this.children){if(!(n instanceof za)||/[^ -~]/.test(n.text))return null;let i=Kp(n.dom);if(i.length!=1)return null;e+=i[0].width,r=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:r}:null}coordsAt(e,r){let n=kJ(this,e,r);if(!this.children.length&&n&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let o=(s-i.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return e instanceof Jn&&this.children.length==0&&e.children.length==0&&Gb(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,r){for(let n=0,i=0;n<e.children.length;n++){let s=e.children[n],o=i+s.length;if(o>=r){if(s instanceof Jn)return s;if(o>r)break}i=o+s.breakAfter}return null}}class Oc extends Lr{constructor(e,r,n){super(),this.widget=e,this.length=r,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,r,n,i,s,o){return n&&(!(n instanceof Oc)||!this.widget.compare(n.widget)||e>0&&s<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}domAtPos(e){return e==0?es.before(this.dom):es.after(this.dom,e==this.length)}split(e){let r=this.length-e;this.length=e;let n=new Oc(this.widget,r,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return tN}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):cr.empty}domBoundsAround(){return null}become(e){return e instanceof Oc&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);return n||(this.widget instanceof vM?null:Iy(this.dom.getBoundingClientRect(),this.length?e==0:r<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:r,endSide:n}=this.deco;return r==n?!1:e<0?r<0:n>0}}class vM extends Uc{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Yg{constructor(e,r,n,i){this.doc=e,this.pos=r,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=r}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Oc&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Jn),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(aw(new Xp(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Oc)&&this.getLine()}buildText(e,r,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(r.slice(r.length-n)),this.getLine().append(aw(new za(this.text.slice(this.textOff,this.textOff+i)),r),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,r,n,i){this.buildText(r-e,n,i),this.pos=r,this.openStart<0&&(this.openStart=i)}point(e,r,n,i,s,o){if(this.disallowBlockEffectsFor[o]&&n instanceof Xu){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(r>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=r-e;if(n instanceof Xu)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Oc(n.widget||Qp.block,a,n));else{let l=Pu.create(n.widget||Qp.inline,a,a?0:n.startSide),u=this.atCursorPos&&!l.isEditable&&s<=i.length&&(e<r||n.startSide>0),h=!l.isEditable&&(e<r||s>i.length||n.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),u&&(d.append(aw(new Xp(1),i),s),s=i.length+Math.max(0,s-i.length)),d.append(aw(l,i),s),this.atCursorPos=h,this.pendingBuffer=h?e<r||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=r),this.openStart<0&&(this.openStart=s)}static build(e,r,n,i,s){let o=new Yg(e,r,n,s);return o.openEnd=lr.spans(i,r,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function aw(t,e){for(let r of e)t=new Fc(r,[t],t.length);return t}class Qp extends Uc{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Qp.inline=new Qp("span");Qp.block=new Qp("div");var en=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(en||(en={}));const Mh=en.LTR,rN=en.RTL;function _J(t){let e=[];for(let r=0;r<t.length;r++)e.push(1<<+t[r]);return e}const eFe=_J("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),tFe=_J("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),yM=Object.create(null),cl=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),r=t.charCodeAt(1);yM[e]=r,yM[r]=-e}function MJ(t){return t<=247?eFe[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?tFe[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const rFe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Iu{get dir(){return this.level%2?rN:Mh}constructor(e,r,n){this.from=e,this.to=r,this.level=n}side(e,r){return this.dir==r==e?this.to:this.from}forward(e,r){return e==(this.dir==r)}static find(e,r,n,i){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=r&&a.to>=r){if(a.level==n)return o;(s<0||(i!=0?i<0?a.from<r:a.to>r:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function DJ(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++){let n=t[r],i=e[r];if(n.from!=i.from||n.to!=i.to||n.direction!=i.direction||!DJ(n.inner,i.inner))return!1}return!0}const Ir=[];function nFe(t,e,r,n,i){for(let s=0;s<=n.length;s++){let o=s?n[s-1].to:e,a=s<n.length?n[s].from:r,l=s?256:i;for(let u=o,h=l,d=l;u<a;u++){let m=MJ(t.charCodeAt(u));m==512?m=h:m==8&&d==4&&(m=16),Ir[u]=m==4?2:m,m&7&&(d=m),h=m}for(let u=o,h=l,d=l;u<a;u++){let m=Ir[u];if(m==128)u<a-1&&h==Ir[u+1]&&h&24?m=Ir[u]=h:Ir[u]=256;else if(m==64){let g=u+1;for(;g<a&&Ir[g]==64;)g++;let y=u&&h==8||g<r&&Ir[g]==8?d==1?1:8:256;for(let x=u;x<g;x++)Ir[x]=y;u=g-1}else m==8&&d==1&&(Ir[u]=1);h=m,m&7&&(d=m)}}}function iFe(t,e,r,n,i){let s=i==1?2:1;for(let o=0,a=0,l=0;o<=n.length;o++){let u=o?n[o-1].to:e,h=o<n.length?n[o].from:r;for(let d=u,m,g,y;d<h;d++)if(g=yM[m=t.charCodeAt(d)])if(g<0){for(let x=a-3;x>=0;x-=3)if(cl[x+1]==-g){let b=cl[x+2],C=b&2?i:b&4?b&1?s:i:0;C&&(Ir[d]=Ir[cl[x]]=C),a=x;break}}else{if(cl.length==189)break;cl[a++]=d,cl[a++]=m,cl[a++]=l}else if((y=Ir[d])==2||y==1){let x=y==i;l=x?0:1;for(let b=a-3;b>=0;b-=3){let C=cl[b+2];if(C&2)break;if(x)cl[b+2]|=2;else{if(C&4)break;cl[b+2]|=4}}}}}function sFe(t,e,r,n){for(let i=0,s=n;i<=r.length;i++){let o=i?r[i-1].to:t,a=i<r.length?r[i].from:e;for(let l=o;l<a;){let u=Ir[l];if(u==256){let h=l+1;for(;;)if(h==a){if(i==r.length)break;h=r[i++].to,a=i<r.length?r[i].from:e}else if(Ir[h]==256)h++;else break;let d=s==1,m=(h<e?Ir[h]:n)==1,g=d==m?d?1:2:n;for(let y=h,x=i,b=x?r[x-1].to:t;y>l;)y==b&&(y=r[--x].from,b=x?r[x-1].to:t),Ir[--y]=g;l=h}else s=u,l++}}}function xM(t,e,r,n,i,s,o){let a=n%2?2:1;if(n%2==i%2)for(let l=e,u=0;l<r;){let h=!0,d=!1;if(u==s.length||l<s[u].from){let x=Ir[l];x!=a&&(h=!1,d=x==16)}let m=!h&&a==1?[]:null,g=h?n:n+1,y=l;e:for(;;)if(u<s.length&&y==s[u].from){if(d)break e;let x=s[u];if(!h)for(let b=x.to,C=u+1;;){if(b==r)break e;if(C<s.length&&s[C].from==b)b=s[C++].to;else{if(Ir[b]==a)break e;break}}if(u++,m)m.push(x);else{x.from>l&&o.push(new Iu(l,x.from,g));let b=x.direction==Mh!=!(g%2);wM(t,b?n+1:n,i,x.inner,x.from,x.to,o),l=x.to}y=x.to}else{if(y==r||(h?Ir[y]!=a:Ir[y]==a))break;y++}m?xM(t,l,y,n+1,i,m,o):l<y&&o.push(new Iu(l,y,g)),l=y}else for(let l=r,u=s.length;l>e;){let h=!0,d=!1;if(!u||l>s[u-1].to){let x=Ir[l-1];x!=a&&(h=!1,d=x==16)}let m=!h&&a==1?[]:null,g=h?n:n+1,y=l;e:for(;;)if(u&&y==s[u-1].to){if(d)break e;let x=s[--u];if(!h)for(let b=x.from,C=u;;){if(b==e)break e;if(C&&s[C-1].to==b)b=s[--C].from;else{if(Ir[b-1]==a)break e;break}}if(m)m.push(x);else{x.to<l&&o.push(new Iu(x.to,l,g));let b=x.direction==Mh!=!(g%2);wM(t,b?n+1:n,i,x.inner,x.from,x.to,o),l=x.from}y=x.from}else{if(y==e||(h?Ir[y-1]!=a:Ir[y-1]==a))break;y--}m?xM(t,y,l,n+1,i,m,o):y<l&&o.push(new Iu(y,l,g)),l=y}}function wM(t,e,r,n,i,s,o){let a=e%2?2:1;nFe(t,i,s,n,a),iFe(t,i,s,n,a),sFe(i,s,n,a),xM(t,i,s,e,r,n,o)}function oFe(t,e,r){if(!t)return[new Iu(0,0,e==rN?1:0)];if(e==Mh&&!r.length&&!rFe.test(t))return PJ(t.length);if(r.length)for(;t.length>Ir.length;)Ir[Ir.length]=256;let n=[],i=e==Mh?0:1;return wM(t,i,i,r,0,t.length,n),n}function PJ(t){return[new Iu(0,t,0)]}let IJ="";function aFe(t,e,r,n,i){var s;let o=n.head-t.from,a=Iu.find(e,o,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),l=e[a],u=l.side(i,r);if(o==u){let m=a+=i?1:-1;if(m<0||m>=e.length)return null;l=e[a=m],o=l.side(!i,r),u=l.side(i,r)}let h=Hi(t.text,o,l.forward(i,r));(h<l.from||h>l.to)&&(h=u),IJ=t.text.slice(Math.min(o,h),Math.max(o,h));let d=a==(i?e.length-1:0)?null:e[a+(i?1:-1)];return d&&h==u&&d.level+(i?0:1)<l.level?Pe.cursor(d.side(!i,r)+t.from,d.forward(i,r)?1:-1,d.level):Pe.cursor(h+t.from,l.forward(i,r)?-1:1,l.level)}function lFe(t,e,r){for(let n=e;n<r;n++){let i=MJ(t.charCodeAt(n));if(i==1)return Mh;if(i==2||i==4)return rN}return Mh}const NJ=Ke.define(),LJ=Ke.define(),FJ=Ke.define(),HJ=Ke.define(),bM=Ke.define(),BJ=Ke.define(),VJ=Ke.define(),nN=Ke.define(),iN=Ke.define(),jJ=Ke.define({combine:t=>t.some(e=>e)}),WJ=Ke.define({combine:t=>t.some(e=>e)}),zJ=Ke.define();class Ap{constructor(e,r="nearest",n="nearest",i=5,s=5,o=!1){this.range=e,this.y=r,this.x=n,this.yMargin=i,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Ap(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ap(Pe.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const lw=Mt.define({map:(t,e)=>t.map(e)}),UJ=Mt.define();function js(t,e,r){let n=t.facet(HJ);n.length?n[0](e):window.onerror&&window.onerror(String(e),r,void 0,void 0,e)||(r?console.error(r+":",e):console.error(e))}const bc=Ke.define({combine:t=>t.length?t[0]:!0});let cFe=0;const hp=Ke.define({combine(t){return t.filter((e,r)=>{for(let n=0;n<r;n++)if(t[n].plugin==e.plugin)return!1;return!0})}});class Fn{constructor(e,r,n,i,s){this.id=e,this.create=r,this.domEventHandlers=n,this.domEventObservers=i,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(hp.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(hp.of({plugin:this,arg:e}))}static define(e,r){const{eventHandlers:n,eventObservers:i,provide:s,decorations:o}=r||{};return new Fn(cFe++,e,n,i,a=>{let l=[];return o&&l.push(Nv.of(u=>{let h=u.plugin(a);return h?o(h):ft.none})),s&&l.push(s(a)),l})}static fromClass(e,r){return Fn.define((n,i)=>new e(n,i),r)}}class Xk{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(n){if(js(r.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(r){js(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(n){js(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const $J=Ke.define(),sN=Ke.define(),Nv=Ke.define(),GJ=Ke.define(),oN=Ke.define(),YJ=Ke.define();function QW(t,e){let r=t.state.facet(YJ);if(!r.length)return r;let n=r.map(s=>s instanceof Function?s(t):s),i=[];return lr.spans(n,e.from,e.to,{point(){},span(s,o,a,l){let u=s-e.from,h=o-e.from,d=i;for(let m=a.length-1;m>=0;m--,l--){let g=a[m].spec.bidiIsolate,y;if(g==null&&(g=lFe(e.text,u,h)),l>0&&d.length&&(y=d[d.length-1]).to==u&&y.direction==g)y.to=h,d=y.inner;else{let x={from:u,to:h,direction:g,inner:[]};d.push(x),d=x.inner}}}}),i}const qJ=Ke.define();function aN(t){let e=0,r=0,n=0,i=0;for(let s of t.state.facet(qJ)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(r=Math.max(r,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(i=Math.max(i,o.bottom)))}return{left:e,right:r,top:n,bottom:i}}const mg=Ke.define();class ta{constructor(e,r,n,i){this.fromA=e,this.toA=r,this.fromB=n,this.toB=i}join(e){return new ta(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,n=this;for(;r>0;r--){let i=e[r-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(r-1,1)}}return e.splice(r,0,n),e}static extendWithRanges(e,r){if(r.length==0)return e;let n=[];for(let i=0,s=0,o=0,a=0;;i++){let l=i==e.length?null:e[i],u=o-a,h=l?l.fromB:1e9;for(;s<r.length&&r[s]<h;){let d=r[s],m=r[s+1],g=Math.max(a,d),y=Math.min(h,m);if(g<=y&&new ta(g+u,y+u,g,y).addToSet(n),m>h)break;s+=2}if(!l)return n;new ta(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),o=l.toA,a=l.toB}}}class Yb{constructor(e,r,n){this.view=e,this.state=r,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=ci.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,a,l)=>i.push(new ta(s,o,a,l))),this.changedRanges=i}static create(e,r,n){return new Yb(e,r,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class ZW extends Lr{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ft.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Jn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ta(0,0,0,e.state.doc.length)],0,null)}update(e){var r;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:u,toA:h})=>h<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((r=this.domChanged)===null||r===void 0)&&r.newSel?i=this.domChanged.newSel.head:!gFe(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?fFe(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:h}=this.hasComposition;n=new ta(u,h,e.changes.mapPos(u,-1),e.changes.mapPos(h,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Qe.ie||Qe.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=pFe(o,a,e.changes);return n=ta.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,r,n);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Qe.chrome||Qe.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Oc&&o.widget instanceof vM&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,r,n){let i=n?n.range.addToSet(e.slice()):e,s=this.childCursor(r);for(let o=i.length-1;;o--){let a=o>=0?i[o]:null;if(!a)break;let{fromA:l,toA:u,fromB:h,toB:d}=a,m,g,y,x;if(n&&n.range.fromB<d&&n.range.toB>h){let k=Yg.build(this.view.state.doc,h,n.range.fromB,this.decorations,this.dynamicDecorationMap),O=Yg.build(this.view.state.doc,n.range.toB,d,this.decorations,this.dynamicDecorationMap);g=k.breakAtStart,y=k.openStart,x=O.openEnd;let P=this.compositionView(n);O.breakAtStart?P.breakAfter=1:O.content.length&&P.merge(P.length,P.length,O.content[0],!1,O.openStart,0)&&(P.breakAfter=O.content[0].breakAfter,O.content.shift()),k.content.length&&P.merge(0,0,k.content[k.content.length-1],!0,0,k.openEnd)&&k.content.pop(),m=k.content.concat(P).concat(O.content)}else({content:m,breakAtStart:g,openStart:y,openEnd:x}=Yg.build(this.view.state.doc,h,d,this.decorations,this.dynamicDecorationMap));let{i:b,off:C}=s.findPos(u,1),{i:E,off:R}=s.findPos(l,-1);SJ(this,E,R,b,C,m,g,y,x)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let r of e.transactions)for(let n of r.effects)n.is(UJ)&&(this.editContextFormatting=n.value)}compositionView(e){let r=new za(e.text.nodeValue);r.flags|=8;for(let{deco:i}of e.marks)r=new Fc(i,[r],r.length);let n=new Jn;return n.append(r,0),n}fixCompositionDOM(e){let r=(s,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=Lr.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},n=this.childPos(e.range.fromB,1),i=this.children[n.i];r(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)n=i.childPos(n.off,1),i=i.children[n.i],r(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,r=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,s=!i&&!(this.view.state.facet(bc)||this.dom.tabIndex>-1)&&Kw(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||r||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),u=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(Qe.gecko&&a.empty&&!this.hasComposition&&uFe(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=u=new es(d,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!Gg(l.node,l.offset,h.anchorNode,h.anchorOffset)||!Gg(u.node,u.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,a))&&(this.view.observer.ignore(()=>{Qe.android&&Qe.chrome&&this.dom.contains(h.focusNode)&&mFe(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=Iv(this.view.root);if(d)if(a.empty){if(Qe.gecko){let m=hFe(l.node,l.offset);if(m&&m!=3){let g=(m==1?xJ:wJ)(l.node,l.offset);g&&(l=new es(g.node,g.offset))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(u.node,u.offset)}catch{}}else{let m=document.createRange();a.anchor>a.head&&([l,u]=[u,l]),m.setEnd(u.node,u.offset),m.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(m)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new es(h.anchorNode,h.anchorOffset),this.impreciseHead=u.precise?null:new es(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,r){return this.hasComposition&&r.empty&&Gg(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==r.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,r=e.state.selection.main,n=Iv(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!n||!r.empty||!r.assoc||!n.modify)return;let o=Jn.find(this,r.head);if(!o)return;let a=o.posAtStart;if(r.head==a||r.head==a+o.length)return;let l=this.coordsAt(r.head,-1),u=this.coordsAt(r.head,1);if(!l||!u||l.bottom>u.top)return;let h=this.domAtPos(r.head+r.assoc);n.collapse(h.node,h.offset),n.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=r.from&&n.collapse(i,s)}moveToLine(e){let r=this.dom,n;if(e.node!=r)return e;for(let i=e.offset;!n&&i<r.childNodes.length;i++){let s=Lr.get(r.childNodes[i]);s instanceof Jn&&(n=s.domAtPos(0))}for(let i=e.offset-1;!n&&i>=0;i--){let s=Lr.get(r.childNodes[i]);s instanceof Jn&&(n=s.domAtPos(s.length))}return n?new es(n.node,n.offset,!0):e}nearest(e){for(let r=e;r;){let n=Lr.get(r);if(n&&n.rootView==this)return n;r=r.parentNode}return null}posFromDOM(e,r){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,r)+n.posAtStart}domAtPos(e){let{i:r,off:n}=this.childCursor().findPos(e,-1);for(;r<this.children.length-1;){let i=this.children[r];if(n<i.length||i instanceof Jn)break;r++,n=0}return this.children[r].domAtPos(n)}coordsAt(e,r){let n=null,i=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,u=l-a.length;if(l<e)break;if(u<=e&&(u<e||a.covers(-1))&&(l>e||a.covers(1))&&(!n||a instanceof Jn&&!(n instanceof Jn&&r>=0)))n=a,i=u;else if(n&&u==e&&l==e&&a instanceof Oc&&Math.abs(r)<2){if(a.deco.startSide<0)break;o&&(n=null)}s=u}return n?n.coordsAt(e-i,r):null}coordsForChar(e){let{i:r,off:n}=this.childPos(e,1),i=this.children[r];if(!(i instanceof Jn))return null;for(;i.children.length;){let{i:a,off:l}=i.childPos(n,1);for(;;a++){if(a==i.children.length)return null;if((i=i.children[a]).length)break}n=l}if(!(i instanceof za))return null;let s=Hi(i.text,n);if(s==n)return null;let o=_h(i.dom,n,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let r=[],{from:n,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==en.LTR;for(let u=0,h=0;h<this.children.length;h++){let d=this.children[h],m=u+d.length;if(m>i)break;if(u>=n){let g=d.dom.getBoundingClientRect();if(r.push(g.height),o){let y=d.dom.lastChild,x=y?Kp(y):[];if(x.length){let b=x[x.length-1],C=l?b.right-g.left:g.right-b.left;C>a&&(a=C,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=m)}}}u=m+d.breakAfter}return r}textDirectionAt(e){let{i:r}=this.childPos(e,1);return getComputedStyle(this.children[r].dom).direction=="rtl"?en.RTL:en.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Jn){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),r,n,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Kp(e.firstChild)[0];r=e.getBoundingClientRect().height,n=s?s.width/27:7,i=s?s.height:r,e.remove()}),{lineHeight:r,charWidth:n,textHeight:i}}childCursor(e=this.length){let r=this.children.length;return r&&(e-=this.children[--r].length),new bJ(this.children,e,r)}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let n=0,i=0;;i++){let s=i==r.viewports.length?null:r.viewports[i],o=s?s.from-1:this.length;if(o>n){let a=(r.lineBlockAt(o).bottom-r.lineBlockAt(n).top)/this.view.scaleY;e.push(ft.replace({widget:new vM(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!s)break;n=s.to+1}return ft.set(e)}updateDeco(){let e=1,r=this.view.state.facet(Nv).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,i=this.view.state.facet(GJ).map((s,o)=>{let a=typeof s=="function";return a&&(n=!0),a?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=n,r.push(lr.join(i))),this.decorations=[this.editContextFormatting,...r,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(zJ))try{if(u(this.view,e.range,e))return!0}catch(h){js(this.view.state,h,"scroll handler")}let{range:r}=e,n=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),i;if(!n)return;!r.empty&&(i=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(n={left:Math.min(n.left,i.left),top:Math.min(n.top,i.top),right:Math.max(n.right,i.right),bottom:Math.max(n.bottom,i.bottom)});let s=aN(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;W3e(this.view.scrollDOM,o,r.head<r.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==en.LTR)}}function uFe(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function KJ(t,e){let r=t.observer.selectionRange;if(!r.focusNode)return null;let n=xJ(r.focusNode,r.focusOffset),i=wJ(r.focusNode,r.focusOffset),s=n||i;if(i&&n&&i.node!=n.node){let a=Lr.get(i.node);if(!a||a instanceof za&&a.text!=i.node.nodeValue)s=i;else if(t.docView.lastCompositionAfterCursor){let l=Lr.get(n.node);!l||l instanceof za&&l.text!=n.node.nodeValue||(s=i)}}if(t.docView.lastCompositionAfterCursor=s!=n,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function fFe(t,e,r){let n=KJ(t,r);if(!n)return null;let{node:i,from:s,to:o}=n,a=i.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(n.from,n.to)!=a)return null;let l=e.invertedDesc,u=new ta(l.mapPos(s),l.mapPos(o),s,o),h=[];for(let d=i.parentNode;;d=d.parentNode){let m=Lr.get(d);if(m instanceof Fc)h.push({node:d,deco:m.mark});else{if(m instanceof Jn||d.nodeName=="DIV"&&d.parentNode==t.contentDOM)return{range:u,text:i,marks:h,line:d};if(d!=t.contentDOM)h.push({node:d,deco:new Ny({inclusive:!0,attributes:Z3e(d),tagName:d.tagName.toLowerCase()})});else return null}}}function hFe(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let dFe=class{constructor(){this.changes=[]}compareRange(e,r){Xw(e,r,this.changes)}comparePoint(e,r){Xw(e,r,this.changes)}boundChange(e){Xw(e,e,this.changes)}};function pFe(t,e,r){let n=new dFe;return lr.compare(t,e,r,n),n.changes}function mFe(t,e){for(let r=t;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function gFe(t,e){let r=!1;return e&&t.iterChangedRanges((n,i)=>{n<e.to&&i>e.from&&(r=!0)}),r}function vFe(t,e,r=1){let n=t.charCategorizer(e),i=t.doc.lineAt(e),s=e-i.from;if(i.length==0)return Pe.cursor(e);s==0?r=1:s==i.length&&(r=-1);let o=s,a=s;r<0?o=Hi(i.text,s,!1):a=Hi(i.text,s);let l=n(i.text.slice(o,a));for(;o>0;){let u=Hi(i.text,o,!1);if(n(i.text.slice(u,o))!=l)break;o=u}for(;a<i.length;){let u=Hi(i.text,a);if(n(i.text.slice(a,u))!=l)break;a=u}return Pe.range(o+i.from,a+i.from)}function yFe(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function xFe(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Qk(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function JW(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function ez(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function SM(t,e,r){let n,i,s,o,a=!1,l,u,h,d;for(let y=t.firstChild;y;y=y.nextSibling){let x=Kp(y);for(let b=0;b<x.length;b++){let C=x[b];i&&Qk(i,C)&&(C=JW(ez(C,i.bottom),i.top));let E=yFe(e,C),R=xFe(r,C);if(E==0&&R==0)return y.nodeType==3?tz(y,e,r):SM(y,e,r);(!n||o>R||o==R&&s>E)&&(n=y,i=C,s=E,o=R,a=E?e<C.left?b>0:b<x.length-1:!0),E==0?r>C.bottom&&(!h||h.bottom<C.bottom)?(l=y,h=C):r<C.top&&(!d||d.top>C.top)&&(u=y,d=C):h&&Qk(h,C)?h=ez(h,C.bottom):d&&Qk(d,C)&&(d=JW(d,C.top))}}if(h&&h.bottom>=r?(n=l,i=h):d&&d.top<=r&&(n=u,i=d),!n)return{node:t,offset:0};let m=Math.max(i.left,Math.min(i.right,e));if(n.nodeType==3)return tz(n,m,r);if(a&&n.contentEditable!="false")return SM(n,m,r);let g=Array.prototype.indexOf.call(t.childNodes,n)+(e>=(i.left+i.right)/2?1:0);return{node:t,offset:g}}function tz(t,e,r){let n=t.nodeValue.length,i=-1,s=1e9,o=0;for(let a=0;a<n;a++){let l=_h(t,a,a+1).getClientRects();for(let u=0;u<l.length;u++){let h=l[u];if(h.top==h.bottom)continue;o||(o=e-h.left);let d=(h.top>r?h.top-r:r-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&d<s){let m=e>=(h.left+h.right)/2,g=m;if((Qe.chrome||Qe.gecko)&&_h(t,a).getBoundingClientRect().left==h.right&&(g=!m),d<=0)return{node:t,offset:a+(g?1:0)};i=a+(g?1:0),s=d}}}return{node:t,offset:i>-1?i:o>0?t.nodeValue.length:0}}function XJ(t,e,r,n=-1){var i,s;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:u}=t.viewState,{x:h,y:d}=e,m=d-a;if(m<0)return 0;if(m>u)return t.state.doc.length;for(let k=t.viewState.heightOracle.textHeight/2,O=!1;l=t.elementAtHeight(m),l.type!=ys.Text;)for(;m=n>0?l.bottom+k:l.top-k,!(m>=0&&m<=u);){if(O)return r?null:0;O=!0,n=-n}d=a+m;let g=l.from;if(g<t.viewport.from)return t.viewport.from==0?0:r?null:rz(t,o,l,h,d);if(g>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:r?null:rz(t,o,l,h,d);let y=t.dom.ownerDocument,x=t.root.elementFromPoint?t.root:y,b=x.elementFromPoint(h,d);b&&!t.contentDOM.contains(b)&&(b=null),b||(h=Math.max(o.left+1,Math.min(o.right-1,h)),b=x.elementFromPoint(h,d),b&&!t.contentDOM.contains(b)&&(b=null));let C,E=-1;if(b&&((i=t.docView.nearest(b))===null||i===void 0?void 0:i.isEditable)!=!1){if(y.caretPositionFromPoint){let k=y.caretPositionFromPoint(h,d);k&&({offsetNode:C,offset:E}=k)}else if(y.caretRangeFromPoint){let k=y.caretRangeFromPoint(h,d);k&&({startContainer:C,startOffset:E}=k,(!t.contentDOM.contains(C)||Qe.safari&&wFe(C,E,h)||Qe.chrome&&bFe(C,E,h))&&(C=void 0))}C&&(E=Math.min(Hl(C),E))}if(!C||!t.docView.dom.contains(C)){let k=Jn.find(t.docView,g);if(!k)return m>l.top+l.height/2?l.to:l.from;({node:C,offset:E}=SM(k.dom,h,d))}let R=t.docView.nearest(C);if(!R)return null;if(R.isWidget&&((s=R.dom)===null||s===void 0?void 0:s.nodeType)==1){let k=R.dom.getBoundingClientRect();return e.y<k.top||e.y<=k.bottom&&e.x<=(k.left+k.right)/2?R.posAtStart:R.posAtEnd}else return R.localPosFromDOM(C,E)+R.posAtStart}function rz(t,e,r,n,i){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&r.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((i-r.top-(t.defaultLineHeight-a)*.5)/a);s+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(r.from,r.to);return r.from+lM(o,s,t.state.tabSize)}function wFe(t,e,r){let n,i=t;if(t.nodeType!=3||e!=(n=t.nodeValue.length))return!1;for(;;){let s=i.nextSibling;if(s){if(s.nodeName=="BR")break;return!1}else{let o=i.parentNode;if(!o||o.nodeName=="DIV")break;i=o}}return _h(t,n-1,n).getBoundingClientRect().right>r}function bFe(t,e,r){if(e!=0)return!1;for(let i=t;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let n=t.nodeType==1?t.getBoundingClientRect():_h(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return r-n.left>5}function CM(t,e,r){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let i;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!i||s.type==ys.Text&&(i.type!=s.type||(r<0?s.from<e:s.to>e)))&&(i=s)}}return i||n}return n}function SFe(t,e,r,n){let i=CM(t,e.head,e.assoc||-1),s=!n||i.type!=ys.Text||!(t.lineWrapping||i.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(i.from),l=t.posAtCoords({x:r==(a==en.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return Pe.cursor(l,r?-1:1)}return Pe.cursor(r?i.to:i.from,r?-1:1)}function nz(t,e,r,n){let i=t.state.doc.lineAt(e.head),s=t.bidiSpans(i),o=t.textDirectionAt(i.from);for(let a=e,l=null;;){let u=aFe(i,s,o,a,r),h=IJ;if(!u){if(i.number==(r?t.state.doc.lines:1))return a;h=`
`,i=t.state.doc.line(i.number+(r?1:-1)),s=t.bidiSpans(i),u=t.visualLineSide(i,!r)}if(l){if(!l(h))return a}else{if(!n)return u;l=n(h)}a=u}}function CFe(t,e,r){let n=t.state.charCategorizer(e),i=n(r);return s=>{let o=n(s);return i==un.Space&&(i=o),i==o}}function TFe(t,e,r,n){let i=e.head,s=r?1:-1;if(i==(r?t.state.doc.length:0))return Pe.cursor(i,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),u=t.coordsAtPos(i,e.assoc||-1),h=t.documentTop;if(u)o==null&&(o=u.left-l.left),a=s<0?u.top:u.bottom;else{let g=t.viewState.lineBlockAt(i);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(i-g.from))),a=(s<0?g.top:g.bottom)+h}let d=l.left+o,m=n??t.viewState.heightOracle.textHeight>>1;for(let g=0;;g+=10){let y=a+(m+g)*s,x=XJ(t,{x:d,y},!1,s);if(y<l.top||y>l.bottom||(s<0?x<i:x>i)){let b=t.docView.coordsForChar(x),C=!b||y<b.top?-1:1;return Pe.cursor(x,C,void 0,o)}}}function Qw(t,e,r){for(;;){let n=0;for(let i of t)i.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=n||r||(e-s<o-e?-1:1);e=l<0?s:o,n=l}});if(!n)return e}}function Zk(t,e,r){let n=Qw(t.state.facet(oN).map(i=>i(t)),r.from,e.head>r.from?-1:1);return n==r.from?r:Pe.cursor(n,n<r.from?1:-1)}const gg="";class EFe{constructor(e,r){this.points=e,this.text="",this.lineSeparator=r.facet(Qt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=gg}readRange(e,r){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let s=this.text.length;this.readNode(i);let o=i.nextSibling;if(o==r)break;let a=Lr.get(i),l=Lr.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:$b(i))||$b(o)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&this.lineBreak(),i=o}return this.findPointBefore(n,r),this}readTextNode(e){let r=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,r.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=r.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(a=i.exec(r))&&(s=a.index,o=a[0].length),this.append(r.slice(n,s<0?r.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let r=Lr.get(e),n=r&&r.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let i=n.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==r&&(n.pos=this.text.length)}findPointInside(e,r){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(RFe(e,n.node,n.offset)?r:0))}}function RFe(t,e,r){for(;;){if(!e||r<Hl(e))return!1;if(e==t)return!0;r=Oh(e)+1,e=e.parentNode}}class iz{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}}class AFe{constructor(e,r,n,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=r>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=e.docView.domBoundsAround(r,n,0))){let a=s||o?[]:_Fe(e),l=new EFe(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=MFe(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!fM(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),u=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!fM(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),h=e.viewport;if((Qe.ios||Qe.chrome)&&e.state.selection.main.empty&&l!=u&&(h.from>0||h.to<e.state.doc.length)){let d=Math.min(l,u),m=Math.max(l,u),g=h.from-d,y=h.to-m;(g==0||g==1||d==0)&&(y==0||y==-1||m==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=Pe.single(u,l)}}}function QJ(t,e){let r,{newSel:n}=e,i=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=i.from,u=null;(s===8||Qe.android&&e.text.length<a-o)&&(l=i.to,u="end");let h=OFe(t.state.doc.sliceString(o,a,gg),e.text,l-o,u);h&&(Qe.chrome&&s==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==gg+gg&&h.toB--,r={from:o+h.from,to:o+h.toA,insert:cr.of(e.text.slice(h.from,h.toB).split(gg))})}else n&&(!t.hasFocus&&t.state.facet(bc)||n.main.eq(i))&&(n=null);if(!r&&!n)return!1;if(!r&&e.typeOver&&!i.empty&&n&&n.main.empty?r={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,i.to)}:(Qe.mac||Qe.android)&&r&&r.from==r.to&&r.from==i.head-1&&/^\. ?$/.test(r.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(n&&r.insert.length==2&&(n=Pe.single(n.main.anchor-1,n.main.head-1)),r={from:r.from,to:r.to,insert:cr.of([r.insert.toString().replace("."," ")])}):r&&r.from>=i.from&&r.to<=i.to&&(r.from!=i.from||r.to!=i.to)&&i.to-i.from-(r.to-r.from)<=4?r={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,i.to))}:Qe.chrome&&r&&r.from==r.to&&r.from==i.head&&r.insert.toString()==`
 `&&t.lineWrapping&&(n&&(n=Pe.single(n.main.anchor-1,n.main.head-1)),r={from:i.from,to:i.to,insert:cr.of([" "])}),r)return lN(t,r,n,s);if(n&&!n.main.eq(i)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:o,userEvent:a}),!0}else return!1}function lN(t,e,r,n=-1){if(Qe.ios&&t.inputState.flushIOSKey(e))return!0;let i=t.state.selection.main;if(Qe.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&t.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Rp(t.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&Rp(t.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&Rp(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=kFe(t,e,r));return t.state.facet(BJ).some(l=>l(t,e.from,e.to,s,a))||t.dispatch(a()),!0}function kFe(t,e,r){let n,i=t.state,s=i.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!r||r.main.empty&&r.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=s.from<e.from?i.sliceDoc(s.from,e.from):"",l=s.to>e.to?i.sliceDoc(e.to,s.to):"";n=i.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=i.changes(e),l=r&&r.main.to<=a.newLength?r.main:void 0;if(i.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let u=t.state.sliceDoc(e.from,e.to),h,d=r&&KJ(t,r.main.head);if(d){let y=e.insert.length-(e.to-e.from);h={from:d.from,to:d.to-y}}else h=t.state.doc.lineAt(s.head);let m=s.to-e.to,g=s.to-s.from;n=i.changeByRange(y=>{if(y.from==s.from&&y.to==s.to)return{changes:a,range:l||y.map(a)};let x=y.to-m,b=x-u.length;if(y.to-y.from!=g||t.state.sliceDoc(b,x)!=u||y.to>=h.from&&y.from<=h.to)return{range:y};let C=i.changes({from:b,to:x,insert:e.insert}),E=y.to-s.to;return{changes:C,range:l?Pe.range(Math.max(0,l.anchor+E),Math.max(0,l.head+E)):y.map(C)}})}else n={changes:a,selection:l&&i.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:o,scrollIntoView:!0})}function OFe(t,e,r,n){let i=Math.min(t.length,e.length),s=0;for(;s<i&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(n=="end"){let l=Math.max(0,s-Math.min(o,a));r-=o+l-s}if(o<s&&t.length<e.length){let l=r<=s&&r>=o?s-r:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function _Fe(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}=t.observer.selectionRange;return r&&(e.push(new iz(r,n)),(i!=r||s!=n)&&e.push(new iz(i,s))),e}function MFe(t,e){if(t.length==0)return null;let r=t[0].pos,n=t.length==2?t[1].pos:r;return r>-1&&n>-1?Pe.single(r+e,n+e):null}class DFe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Qe.safari&&e.contentDOM.addEventListener("input",()=>null),Qe.gecko&&qFe(e.contentDOM.ownerDocument)}handleEvent(e){!VFe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,r){let n=this.handlers[e];if(n){for(let i of n.observers)i(this.view,r);for(let i of n.handlers){if(r.defaultPrevented)break;if(i(this.view,r)){r.preventDefault();break}}}}ensureHandlers(e){let r=PFe(e),n=this.handlers,i=this.view.contentDOM;for(let s in r)if(s!="scroll"){let o=!r[s].handlers.length,a=n[s];a&&o!=!a.handlers.length&&(i.removeEventListener(s,this.handleEvent),a=null),a||i.addEventListener(s,this.handleEvent,{passive:o})}for(let s in n)s!="scroll"&&!r[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=r}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&JJ.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Qe.android&&Qe.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let r;return Qe.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((r=ZJ.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||IFe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=r||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let r=this.pendingIOSKey;return!r||r.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Rp(this.view.contentDOM,r.key,r.keyCode,r instanceof KeyboardEvent?r:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Qe.safari&&!Qe.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function sz(t,e){return(r,n)=>{try{return e.call(t,n,r)}catch(i){js(r.state,i)}}}function PFe(t){let e=Object.create(null);function r(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of t){let i=n.spec,s=i&&i.plugin.domEventHandlers,o=i&&i.plugin.domEventObservers;if(s)for(let a in s){let l=s[a];l&&r(a).handlers.push(sz(n.value,l))}if(o)for(let a in o){let l=o[a];l&&r(a).observers.push(sz(n.value,l))}}for(let n in Ua)r(n).handlers.push(Ua[n]);for(let n in aa)r(n).observers.push(aa[n]);return e}const ZJ=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],IFe="dthko",JJ=[16,17,18,20,91,92,224,225],cw=6;function uw(t){return Math.max(0,t)*.7+8}function NFe(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class LFe{constructor(e,r,n,i){this.view=e,this.startEvent=r,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParents=z3e(e.contentDOM),this.atoms=e.state.facet(oN).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(Qt.allowMultipleSelections)&&FFe(e,r),this.dragging=BFe(e,r)&&ree(r)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&NFe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,n=0,i=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=aN(this.view);e.clientX-l.left<=i+cw?r=-uw(i-e.clientX):e.clientX+l.right>=o-cw&&(r=uw(e.clientX-o)),e.clientY-l.top<=s+cw?n=-uw(s-e.clientY):e.clientY+l.bottom>=a-cw&&(n=uw(e.clientY-a)),this.setScrollSpeed(r,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:r}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),r&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=r,r=0),(e||r)&&this.view.win.scrollBy(e,r),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let r=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],s=null;if(i.empty){let o=Qw(this.atoms,i.from,0);o!=i.from&&(s=Pe.cursor(o,-1))}else{let o=Qw(this.atoms,i.from,-1),a=Qw(this.atoms,i.to,1);(o!=i.from||a!=i.to)&&(s=Pe.range(i.from==i.anchor?o:a,i.from==i.head?o:a))}s&&(r||(r=e.ranges.slice()),r[n]=s)}return r?Pe.create(r,e.mainIndex):e}select(e){let{view:r}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(r.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(r=>r.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function FFe(t,e){let r=t.state.facet(NJ);return r.length?r[0](e):Qe.mac?e.metaKey:e.ctrlKey}function HFe(t,e){let r=t.state.facet(LJ);return r.length?r[0](e):Qe.mac?!e.altKey:!e.ctrlKey}function BFe(t,e){let{main:r}=t.state.selection;if(r.empty)return!1;let n=Iv(t.root);if(!n||n.rangeCount==0)return!0;let i=n.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function VFe(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,n;r!=t.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(n=Lr.get(r))&&n.ignoreEvent(e))return!1;return!0}const Ua=Object.create(null),aa=Object.create(null),eee=Qe.ie&&Qe.ie_version<15||Qe.ios&&Qe.webkit_version<604;function jFe(t){let e=t.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.remove(),tee(t,r.value)},50)}function mC(t,e,r){for(let n of t.facet(e))r=n(r,t);return r}function tee(t,e){e=mC(t.state,nN,e);let{state:r}=t,n,i=1,s=r.toText(e),o=s.lines==r.selection.ranges.length;if(TM!=null&&r.selection.ranges.every(l=>l.empty)&&TM==s.toString()){let l=-1;n=r.changeByRange(u=>{let h=r.doc.lineAt(u.from);if(h.from==l)return{range:u};l=h.from;let d=r.toText((o?s.line(i++).text:e)+r.lineBreak);return{changes:{from:h.from,insert:d},range:Pe.cursor(u.from+d.length)}})}else o?n=r.changeByRange(l=>{let u=s.line(i++);return{changes:{from:l.from,to:l.to,insert:u.text},range:Pe.cursor(l.from+u.length)}}):n=r.replaceSelection(s);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}aa.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};Ua.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);aa.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};aa.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};Ua.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let r=null;for(let n of t.state.facet(FJ))if(r=n(t,e),r)break;if(!r&&e.button==0&&(r=UFe(t,e)),r){let n=!t.hasFocus;t.inputState.startMouseSelection(new LFe(t,e,r,n)),n&&t.observer.ignore(()=>{gJ(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let i=t.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}return!1};function oz(t,e,r,n){if(n==1)return Pe.cursor(e,r);if(n==2)return vFe(t.state,e,r);{let i=Jn.find(t.docView,e),s=t.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,a=i?i.posAtEnd:s.to;return a<t.state.doc.length&&a==s.to&&a++,Pe.range(o,a)}}let az=(t,e,r)=>e>=r.top&&e<=r.bottom&&t>=r.left&&t<=r.right;function WFe(t,e,r,n){let i=Jn.find(t.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&az(r,n,o))return-1;let a=i.coordsAt(s,1);return a&&az(r,n,a)?1:o&&o.bottom>=n?-1:1}function lz(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:r,bias:WFe(t,r,e.clientX,e.clientY)}}const zFe=Qe.ie&&Qe.ie_version<=11;let cz=null,uz=0,fz=0;function ree(t){if(!zFe)return t.detail;let e=cz,r=fz;return cz=t,fz=Date.now(),uz=!e||r>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(uz+1)%3:1}function UFe(t,e){let r=lz(t,e),n=ree(e),i=t.state.selection;return{update(s){s.docChanged&&(r.pos=s.changes.mapPos(r.pos),i=i.map(s.changes))},get(s,o,a){let l=lz(t,s),u,h=oz(t,l.pos,l.bias,n);if(r.pos!=l.pos&&!o){let d=oz(t,r.pos,r.bias,n),m=Math.min(d.from,h.from),g=Math.max(d.to,h.to);h=m<h.from?Pe.range(m,g):Pe.range(g,m)}return o?i.replaceRange(i.main.extend(h.from,h.to)):a&&n==1&&i.ranges.length>1&&(u=$Fe(i,l.pos))?u:a?i.addRange(h):Pe.create([h])}}}function $Fe(t,e){for(let r=0;r<t.ranges.length;r++){let{from:n,to:i}=t.ranges[r];if(n<=e&&i>=e)return Pe.create(t.ranges.slice(0,r).concat(t.ranges.slice(r+1)),t.mainIndex==r?0:t.mainIndex-(t.mainIndex>r?1:0))}return null}Ua.dragstart=(t,e)=>{let{selection:{main:r}}=t.state;if(e.target.draggable){let i=t.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,o=s+i.length;(s>=r.to||o<=r.from)&&(r=Pe.range(s,o))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,e.dataTransfer&&(e.dataTransfer.setData("Text",mC(t.state,iN,t.state.sliceDoc(r.from,r.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ua.dragend=t=>(t.inputState.draggedContent=null,!1);function hz(t,e,r,n){if(r=mC(t.state,nN,r),!r)return;let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=n&&s&&HFe(t,e)?{from:s.from,to:s.to}:null,a={from:i,insert:r},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Ua.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let r=e.dataTransfer.files;if(r&&r.length){let n=Array(r.length),i=0,s=()=>{++i==r.length&&hz(t,e,n.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<r.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(n[o]=a.result),s()},a.readAsText(r[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return hz(t,e,n,!0),!0}return!1};Ua.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let r=eee?null:e.clipboardData;return r?(tee(t,r.getData("text/plain")||r.getData("text/uri-list")),!0):(jFe(t),!1)};function GFe(t,e){let r=t.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),t.focus()},50)}function YFe(t){let e=[],r=[],n=!1;for(let i of t.selection.ranges)i.empty||(e.push(t.sliceDoc(i.from,i.to)),r.push(i));if(!e.length){let i=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>i&&(e.push(o.text),r.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),i=o.number}n=!0}return{text:mC(t,iN,e.join(t.lineBreak)),ranges:r,linewise:n}}let TM=null;Ua.copy=Ua.cut=(t,e)=>{let{text:r,ranges:n,linewise:i}=YFe(t.state);if(!r&&!i)return!1;TM=i?r:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=eee?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",r),!0):(GFe(t,r),!1)};const nee=Ul.define();function iee(t,e){let r=[];for(let n of t.facet(VJ)){let i=n(t,e);i&&r.push(i)}return r.length?t.update({effects:r,annotations:nee.of(!0)}):null}function see(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let r=iee(t.state,e);r?t.dispatch(r):t.update([])}},10)}aa.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),see(t)};aa.blur=t=>{t.observer.clearSelectionRange(),see(t)};aa.compositionstart=aa.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};aa.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Qe.chrome&&Qe.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};aa.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};Ua.beforeinput=(t,e)=>{var r,n;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let s=(r=e.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let a=o[0],l=t.posAtDOM(a.startContainer,a.startOffset),u=t.posAtDOM(a.endContainer,a.endOffset);return lN(t,{from:l,to:u,insert:t.state.toText(s)},null),!0}}let i;if(Qe.chrome&&Qe.android&&(i=ZJ.find(s=>s.inputType==e.inputType))&&(t.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return Qe.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),Qe.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>aa.compositionend(t,e),20),!1};const dz=new Set;function qFe(t){dz.has(t)||(dz.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const pz=["pre-wrap","normal","pre-line","break-spaces"];let Zp=!1;function mz(){Zp=!1}class KFe{constructor(e){this.lineWrapping=e,this.doc=cr.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,r){let n=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((r-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return pz.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(i*10)]||(r=!0,this.heightSamples[Math.floor(i*10)]=!0)}return r}refresh(e,r,n,i,s,o){let a=pz.indexOf(e)>-1,l=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=r,this.charWidth=n,this.textHeight=i,this.lineLength=s,l){this.heightSamples={};for(let u=0;u<o.length;u++){let h=o[u];h<0?u++:this.heightSamples[Math.floor(h*10)]=!0}}return l}}class XFe{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}}class Cl{constructor(e,r,n,i,s){this.from=e,this.length=r,this.top=n,this.height=i,this._content=s}get type(){return typeof this._content=="number"?ys.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Xu?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let r=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Cl(this.from,this.length+e.length,this.top,this.height+e.height,r)}}var Qr=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Qr||(Qr={}));const Zw=.001;class xs{constructor(e,r,n=2){this.length=e,this.height=r,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Zw&&(Zp=!0),this.height=e)}replace(e,r,n){return xs.of(n)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,n,i){let s=this,o=n.doc;for(let a=i.length-1;a>=0;a--){let{fromA:l,toA:u,fromB:h,toB:d}=i[a],m=s.lineAt(l,Qr.ByPosNoHeight,n.setDoc(r),0,0),g=m.to>=u?m:s.lineAt(u,Qr.ByPosNoHeight,n,0,0);for(d+=g.to-u,u=g.to;a>0&&m.from<=i[a-1].toA;)l=i[a-1].fromA,h=i[a-1].fromB,a--,l<m.from&&(m=s.lineAt(l,Qr.ByPosNoHeight,n,0,0));h+=m.from-l,l=m.from;let y=cN.build(n.setDoc(o),e,h,d);s=qb(s,s.replace(l,u,y))}return s.updateHeight(n,0)}static empty(){return new oo(0,0)}static of(e){if(e.length==1)return e[0];let r=0,n=e.length,i=0,s=0;for(;;)if(r==n)if(i>s*2){let a=e[r-1];a.break?e.splice(--r,1,a.left,null,a.right):e.splice(--r,1,a.left,a.right),n+=1+a.break,i-=a.size}else if(s>i*2){let a=e[n];a.break?e.splice(n,1,a.left,null,a.right):e.splice(n,1,a.left,a.right),n+=2+a.break,s-=a.size}else break;else if(i<s){let a=e[r++];a&&(i+=a.size)}else{let a=e[--n];a&&(s+=a.size)}let o=0;return e[r-1]==null?(o=1,r--):e[r]==null&&(o=1,n++),new QFe(xs.of(e.slice(0,r)),o,xs.of(e.slice(n)))}}function qb(t,e){return t==e?t:(t.constructor!=e.constructor&&(Zp=!0),e)}xs.prototype.size=1;class oee extends xs{constructor(e,r,n){super(e,r),this.deco=n}blockAt(e,r,n,i){return new Cl(i,this.length,n,this.height,this.deco||0)}lineAt(e,r,n,i,s){return this.blockAt(0,n,i,s)}forEachLine(e,r,n,i,s,o){e<=s+this.length&&r>=s&&o(this.blockAt(0,n,i,s))}updateHeight(e,r=0,n=!1,i){return i&&i.from<=r&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class oo extends oee{constructor(e,r){super(e,r,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,r,n,i){return new Cl(i,this.length,n,this.height,this.breaks)}replace(e,r,n){let i=n[0];return n.length==1&&(i instanceof oo||i instanceof Pi&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Pi?i=new oo(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):xs.of(n)}updateHeight(e,r=0,n=!1,i){return i&&i.from<=r&&i.more?this.setHeight(i.heights[i.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Pi extends xs{constructor(e){super(e,0)}heightMetrics(e,r){let n=e.doc.lineAt(r).number,i=e.doc.lineAt(r+this.length).number,s=i-n+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:n,lastLine:i,perLine:o,perChar:a}}blockAt(e,r,n,i){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(r,i);if(r.lineWrapping){let u=i+(e<r.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),h=r.doc.lineAt(u),d=a+h.length*l,m=Math.max(n,e-d/2);return new Cl(h.from,h.length,m,d,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-n)/a))),{from:h,length:d}=r.doc.line(s+u);return new Cl(h,d,n+a*u,a,0)}}lineAt(e,r,n,i,s){if(r==Qr.ByHeight)return this.blockAt(e,n,i,s);if(r==Qr.ByPosNoHeight){let{from:g,to:y}=n.doc.lineAt(e);return new Cl(g,y-g,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,s),u=n.doc.lineAt(e),h=a+u.length*l,d=u.number-o,m=i+a*d+l*(u.from-s-d);return new Cl(u.from,u.length,Math.max(i,Math.min(m,i+this.height-h)),h,0)}forEachLine(e,r,n,i,s,o){e=Math.max(e,s),r=Math.min(r,s+this.length);let{firstLine:a,perLine:l,perChar:u}=this.heightMetrics(n,s);for(let h=e,d=i;h<=r;){let m=n.doc.lineAt(h);if(h==e){let y=m.number-a;d+=l*y+u*(e-s-y)}let g=l+u*m.length;o(new Cl(m.from,m.length,d,g,0)),d+=g,h=m.to+1}}replace(e,r,n){let i=this.length-r;if(i>0){let s=n[n.length-1];s instanceof Pi?n[n.length-1]=new Pi(s.length+i):n.push(null,new Pi(i-1))}if(e>0){let s=n[0];s instanceof Pi?n[0]=new Pi(e+s.length):n.unshift(new Pi(e-1),null)}return xs.of(n)}decomposeLeft(e,r){r.push(new Pi(e-1),null)}decomposeRight(e,r){r.push(null,new Pi(this.length-e-1))}updateHeight(e,r=0,n=!1,i){let s=r+this.length;if(i&&i.from<=r+this.length&&i.more){let o=[],a=Math.max(r,i.from),l=-1;for(i.from>r&&o.push(new Pi(i.from-r-1).updateHeight(e,r));a<=s&&i.more;){let h=e.doc.lineAt(a).length;o.length&&o.push(null);let d=i.heights[i.index++];l==-1?l=d:Math.abs(d-l)>=Zw&&(l=-2);let m=new oo(h,d);m.outdated=!1,o.push(m),a+=h+1}a<=s&&o.push(null,new Pi(s-a).updateHeight(e,a));let u=xs.of(o);return(l<0||Math.abs(u.height-this.height)>=Zw||Math.abs(l-this.heightMetrics(e,r).perLine)>=Zw)&&(Zp=!0),qb(this,u)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class QFe extends xs{constructor(e,r,n){super(e.length+r+n.length,e.height+n.height,r|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,r,n,i){let s=n+this.left.height;return e<s?this.left.blockAt(e,r,n,i):this.right.blockAt(e,r,s,i+this.left.length+this.break)}lineAt(e,r,n,i,s){let o=i+this.left.height,a=s+this.left.length+this.break,l=r==Qr.ByHeight?e<o:e<a,u=l?this.left.lineAt(e,r,n,i,s):this.right.lineAt(e,r,n,o,a);if(this.break||(l?u.to<a:u.from>a))return u;let h=r==Qr.ByPosNoHeight?Qr.ByPosNoHeight:Qr.ByPos;return l?u.join(this.right.lineAt(a,h,n,o,a)):this.left.lineAt(a,h,n,i,s).join(u)}forEachLine(e,r,n,i,s,o){let a=i+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,r,n,i,s,o),r>=l&&this.right.forEachLine(e,r,n,a,l,o);else{let u=this.lineAt(l,Qr.ByPos,n,i,s);e<u.from&&this.left.forEachLine(e,u.from-1,n,i,s,o),u.to>=e&&u.from<=r&&o(u),r>u.to&&this.right.forEachLine(u.to+1,r,n,a,l,o)}}replace(e,r,n){let i=this.left.length+this.break;if(r<i)return this.balanced(this.left.replace(e,r,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,r-i,n));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of n)s.push(a);if(e>0&&gz(s,o-1),r<this.length){let a=s.length;this.decomposeRight(r,s),gz(s,a)}return xs.of(s)}decomposeLeft(e,r){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(n++,e>=n&&r.push(null)),e>n&&this.right.decomposeLeft(e-n,r)}decomposeRight(e,r){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,r);e<n&&this.left.decomposeRight(e,r),this.break&&e<i&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?xs.of(this.break?[e,null,r]:[e,r]):(this.left=qb(this.left,e),this.right=qb(this.right,r),this.setHeight(e.height+r.height),this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,n=!1,i){let{left:s,right:o}=this,a=r+s.length+this.break,l=null;return i&&i.from<=r+s.length&&i.more?l=s=s.updateHeight(e,r,n,i):s.updateHeight(e,r,n),i&&i.from<=a+o.length&&i.more?l=o=o.updateHeight(e,a,n,i):o.updateHeight(e,a,n),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function gz(t,e){let r,n;t[e]==null&&(r=t[e-1])instanceof Pi&&(n=t[e+1])instanceof Pi&&t.splice(e-1,3,new Pi(r.length+1+n.length))}const ZFe=5;class cN{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let n=Math.min(r,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof oo?i.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new oo(n-this.pos,-1)),this.writtenTo=n,r>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,n){if(e<r||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=r-e;n.block?this.addBlock(new oee(o,i,n)):(o||s||i>=ZFe)&&this.addLineDeco(i,s,o)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new oo(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,r){let n=new Pi(r-e);return this.oracle.doc.lineAt(e).to==r&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof oo)return e;let r=new oo(0,-1);return this.nodes.push(r),r}addBlock(e){this.enterLine();let r=e.deco;r&&r.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r&&r.endSide>0&&(this.covering=e)}addLineDeco(e,r,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=r,this.writtenTo=this.pos=this.pos+n}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof oo)&&!this.isCovered?this.nodes.push(new oo(0,-1)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let i of this.nodes)i instanceof oo&&i.updateHeight(this.oracle,n),n+=i?i.length:1;return this.nodes}static build(e,r,n,i){let s=new cN(n,e);return lr.spans(r,n,i,s,0),s.finish(n)}}function JFe(t,e,r){let n=new eHe;return lr.compare(t,e,r,n,0),n.changes}class eHe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,n,i){(e<r||n&&n.heightRelevant||i&&i.heightRelevant)&&Xw(e,r,this.changes,5)}}function tHe(t,e){let r=t.getBoundingClientRect(),n=t.ownerDocument,i=n.defaultView||window,s=Math.max(0,r.left),o=Math.min(i.innerWidth,r.right),a=Math.max(0,r.top),l=Math.min(i.innerHeight,r.bottom);for(let u=t.parentNode;u&&u!=n.body;)if(u.nodeType==1){let h=u,d=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&d.overflow!="visible"){let m=h.getBoundingClientRect();s=Math.max(s,m.left),o=Math.min(o,m.right),a=Math.max(a,m.top),l=Math.min(u==t.parentNode?i.innerHeight:l,m.bottom)}u=d.position=="absolute"||d.position=="fixed"?h.offsetParent:h.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-r.left,right:Math.max(s,o)-r.left,top:a-(r.top+e),bottom:Math.max(a,l)-(r.top+e)}}function rHe(t){let e=t.getBoundingClientRect(),r=t.ownerDocument.defaultView||window;return e.left<r.innerWidth&&e.right>0&&e.top<r.innerHeight&&e.bottom>0}function nHe(t,e){let r=t.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}class Jk{constructor(e,r,n,i){this.from=e,this.to=r,this.size=n,this.displaySize=i}static same(e,r){if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],s=r[n];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,r){return ft.replace({widget:new iHe(this.displaySize*(r?e.scaleY:e.scaleX),r)}).range(this.from,this.to)}}class iHe extends Uc{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class vz{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=yz,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=en.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(sN).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new KFe(r),this.stateDeco=e.facet(Nv).filter(n=>typeof n!="function"),this.heightMap=xs.empty().applyChanges(this.stateDeco,cr.empty,this.heightOracle.setDoc(e.doc),[new ta(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ft.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let n=0;n<=1;n++){let i=n?r.head:r.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new fw(s,o))}}return this.viewports=e.sort((n,i)=>n.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?yz:new uN(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(vg(e,this.scaler))})}update(e,r=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Nv).filter(h=>typeof h!="function");let i=e.changedRanges,s=ta.extendWithRanges(i,JFe(n,this.stateDeco,e?e.changes:ci.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);mz(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Zp)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<l.from||r.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,r));let u=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(WJ)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,n=window.getComputedStyle(r),i=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?en.RTL:en.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=r.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let u=0,h=0;if(a.width&&a.height){let{scaleX:k,scaleY:O}=mJ(r,a);(k>.005&&Math.abs(this.scaleX-k)>.005||O>.005&&Math.abs(this.scaleY-O)>.005)&&(this.scaleX=k,this.scaleY=O,u|=16,o=l=!0)}let d=(parseInt(n.paddingTop)||0)*this.scaleY,m=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=m)&&(this.paddingTop=d,this.paddingBottom=m,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let g=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=g&&(this.scrollAnchorHeight=-1,this.scrollTop=g),this.scrolledToBottom=yJ(e.scrollDOM);let y=(this.printing?nHe:tHe)(r,this.paddingTop),x=y.top-this.pixelViewport.top,b=y.bottom-this.pixelViewport.bottom;this.pixelViewport=y;let C=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(C!=this.inView&&(this.inView=C,C&&(l=!0)),!this.inView&&!this.scrollTarget&&!rHe(e.dom))return 0;let E=a.width;if((this.contentDOMWidth!=E||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),l){let k=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(k)&&(o=!0),o||i.lineWrapping&&Math.abs(E-this.contentDOMWidth)>i.charWidth){let{lineHeight:O,charWidth:P,textHeight:D}=e.docView.measureTextSize();o=O>0&&i.refresh(s,O,P,D,E/P,k),o&&(e.docView.minWidth=0,u|=16)}x>0&&b>0?h=Math.max(x,b):x<0&&b<0&&(h=Math.min(x,b)),mz();for(let O of this.viewports){let P=O.from==this.viewport.from?k:e.docView.measureVisibleLineHeights(O);this.heightMap=(o?xs.empty().applyChanges(this.stateDeco,cr.empty,this.heightOracle,[new ta(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new XFe(O.from,P))}Zp&&(u|=2)}let R=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return R&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),u|=this.updateForViewport()),(u&2||R)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new fw(i.lineAt(o-n*1e3,Qr.ByHeight,s,0,0).from,i.lineAt(a+(1-n)*1e3,Qr.ByHeight,s,0,0).to);if(r){let{head:u}=r.range;if(u<l.from||u>l.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=i.lineAt(u,Qr.ByPos,s,0,0),m;r.y=="center"?m=(d.top+d.bottom)/2-h/2:r.y=="start"||r.y=="nearest"&&u<l.from?m=d.top:m=d.bottom-h,l=new fw(i.lineAt(m-1e3/2,Qr.ByHeight,s,0,0).from,i.lineAt(m+h+1e3/2,Qr.ByHeight,s,0,0).to)}}return l}mapViewport(e,r){let n=r.mapPos(e.from,-1),i=r.mapPos(e.to,1);return new fw(this.heightMap.lineAt(n,Qr.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,Qr.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,Qr.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(r,Qr.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||i<=o-Math.max(10,Math.min(-n,250)))&&(r==this.state.doc.length||s>=a+Math.max(10,Math.min(n,250)))&&i>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let n=[];for(let i of e)r.touchesRange(i.from,i.to)||n.push(new Jk(r.mapPos(i.from),r.mapPos(i.to),i.size,i.displaySize));return n}ensureLineGaps(e,r){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=en.LTR&&!n)return[];let a=[],l=(h,d,m,g)=>{if(d-h<s)return;let y=this.state.selection.main,x=[y.from];y.empty||x.push(y.to);for(let C of x)if(C>h&&C<d){l(h,C-10,m,g),l(C+10,d,m,g);return}let b=oHe(e,C=>C.from>=m.from&&C.to<=m.to&&Math.abs(C.from-h)<s&&Math.abs(C.to-d)<s&&!x.some(E=>C.from<E&&C.to>E));if(!b){if(d<m.to&&r&&n&&r.visibleRanges.some(R=>R.from<=d&&R.to>=d)){let R=r.moveToLineBoundary(Pe.cursor(d),!1,!0).head;R>h&&(d=R)}let C=this.gapSize(m,h,d,g),E=n||C<2e6?C:2e6;b=new Jk(h,d,C,E)}a.push(b)},u=h=>{if(h.length<o||h.type!=ys.Text)return;let d=sHe(h.from,h.to,this.stateDeco);if(d.total<o)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,g,y;if(n){let x=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,b,C;if(m!=null){let E=dw(d,m),R=((this.visibleBottom-this.visibleTop)/2+x)/h.height;b=E-R,C=E+R}else b=(this.visibleTop-h.top-x)/h.height,C=(this.visibleBottom-h.top+x)/h.height;g=hw(d,b),y=hw(d,C)}else{let x=d.total*this.heightOracle.charWidth,b=i*this.heightOracle.charWidth,C=0;if(x>2e6)for(let P of e)P.from>=h.from&&P.from<h.to&&P.size!=P.displaySize&&P.from*this.heightOracle.charWidth+C<this.pixelViewport.left&&(C=P.size-P.displaySize);let E=this.pixelViewport.left+C,R=this.pixelViewport.right+C,k,O;if(m!=null){let P=dw(d,m),D=((R-E)/2+b)/x;k=P-D,O=P+D}else k=(E-b)/x,O=(R+b)/x;g=hw(d,k),y=hw(d,O)}g>h.from&&l(h.from,g,h,d),y<h.to&&l(y,h.to,h,d)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(u):u(h);return a}gapSize(e,r,n,i){let s=dw(i,n)-dw(i,r);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){Jk.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ft.set(e.map(r=>r.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let r=this.stateDeco;this.lineGaps.length&&(r=r.concat(this.lineGapDeco));let n=[];lr.spans(r,this.viewport.from,this.viewport.to,{span(s,o){n.push({from:s,to:o})},point(){}},20);let i=0;if(n.length!=this.visibleRanges.length)i=12;else for(let s=0;s<n.length&&!(i&8);s++){let o=this.visibleRanges[s],a=n[s];(o.from!=a.from||o.to!=a.to)&&(i|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(i|=8))}return this.visibleRanges=n,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||vg(this.heightMap.lineAt(e,Qr.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(r=>r.top<=e&&r.bottom>=e)||vg(this.heightMap.lineAt(this.scaler.fromDOM(e),Qr.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let r=this.lineBlockAtHeight(e+8);return r.from>=this.viewport.from||this.viewportLines[0].top-e>200?r:this.viewportLines[0]}elementAtHeight(e){return vg(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class fw{constructor(e,r){this.from=e,this.to=r}}function sHe(t,e,r){let n=[],i=t,s=0;return lr.spans(r,t,e,{span(){},point(o,a){o>i&&(n.push({from:i,to:o}),s+=o-i),i=a}},20),i<e&&(n.push({from:i,to:e}),s+=e-i),{total:s,ranges:n}}function hw({total:t,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let n=Math.floor(t*r);for(let i=0;;i++){let{from:s,to:o}=e[i],a=o-s;if(n<=a)return s+n;n-=a}}function dw(t,e){let r=0;for(let{from:n,to:i}of t.ranges){if(e<=i){r+=e-n;break}r+=i-n}return r/t.total}function oHe(t,e){for(let r of t)if(e(r))return r}const yz={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class uN{constructor(e,r,n){let i=0,s=0,o=0;this.viewports=n.map(({from:a,to:l})=>{let u=r.lineAt(a,Qr.ByPos,e,0,0).top,h=r.lineAt(l,Qr.ByPos,e,0,0).bottom;return i+=h-u,{from:a,to:l,top:u,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(r.height-i);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let r=0,n=0,i=0;;r++){let s=r<this.viewports.length?this.viewports[r]:null;if(!s||e<s.top)return i+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,i=s.domBottom}}fromDOM(e){for(let r=0,n=0,i=0;;r++){let s=r<this.viewports.length?this.viewports[r]:null;if(!s||e<s.domTop)return n+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,i=s.domBottom}}eq(e){return e instanceof uN?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((r,n)=>r.from==e.viewports[n].from&&r.to==e.viewports[n].to):!1}}function vg(t,e){if(e.scale==1)return t;let r=e.toDOM(t.top),n=e.toDOM(t.bottom);return new Cl(t.from,t.length,r,n-r,Array.isArray(t._content)?t._content.map(i=>vg(i,e)):t._content)}const pw=Ke.define({combine:t=>t.join(" ")}),EM=Ke.define({combine:t=>t.indexOf(!0)>-1}),RM=qu.newName(),aee=qu.newName(),lee=qu.newName(),cee={"&light":"."+aee,"&dark":"."+lee};function AM(t,e,r){return new qu(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,i=>{if(i=="&")return t;if(!r||!r[i])throw new RangeError(`Unsupported selector: ${i}`);return r[i]}):t+" "+n}})}const aHe=AM("."+RM,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},cee),lHe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},eO=Qe.ie&&Qe.ie_version<=11;class cHe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new U3e,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let n of r)this.queue.push(n);(Qe.ie&&Qe.ie_version<=11||Qe.ios&&e.composing)&&r.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Qe.chrome&&Qe.chrome_version<126)&&(this.editContext=new fHe(e),e.state.facet(bc)&&(e.contentDOM.editContext=this.editContext.editContext)),eO&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,n)=>r!=e[n]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(bc)?n.root.activeElement!=this.dom:!Kw(this.dom,i))return;let s=i.anchorNode&&n.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(Qe.ie&&Qe.ie_version<=11||Qe.android&&Qe.chrome)&&!n.state.selection.main.empty&&i.focusNode&&Gg(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=Iv(e.root);if(!r)return!1;let n=Qe.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&uHe(this.view,r)||r;if(!n||this.selectionRange.eq(n))return!1;let i=Kw(this.dom,n);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&G3e(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let n=this.dom;n;)if(n.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=r)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,lHe),eO&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),eO&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var n;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Rp(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,n=-1,i=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(i=!0),r==-1?{from:r,to:n}=o:(r=Math.min(o.from,r),n=Math.max(o.to,n)))}return{from:r,to:n,typeOver:i}}readChange(){let{from:e,to:r,typeOver:n}=this.processRecords(),i=this.selectionChanged&&Kw(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new AFe(this.view,e,r,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return this.view.requestMeasure(),!1;let n=this.view.state,i=QJ(this.view,r);return this.view.state==n&&(r.domChanged||r.newSel&&!r.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let r=this.view.docView.nearest(e.target);if(!r||r.ignoreMutation(e))return null;if(r.markDirty(e.type=="attributes"),e.type=="attributes"&&(r.flags|=4),e.type=="childList"){let n=xz(r,e.previousSibling||e.target.previousSibling,-1),i=xz(r,e.nextSibling||e.target.nextSibling,1);return{from:n?r.posAfter(n):r.posAtStart,to:i?r.posBefore(i):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(bc)!=e.state.facet(bc)&&(e.view.contentDOM.editContext=e.state.facet(bc)?this.editContext.editContext:null))}destroy(){var e,r,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function xz(t,e,r){for(;e;){let n=Lr.get(e);if(n&&n.parent==t)return n;let i=e.parentNode;e=i!=t.dom?i:r>0?e.nextSibling:e.previousSibling}return null}function wz(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return Gg(o.node,o.offset,i,s)&&([r,n,i,s]=[i,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}}function uHe(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return wz(t,i)}let r=null;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),r?wz(t,r):null}class fHe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let r=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let i=e.state.selection.main,{anchor:s,head:o}=i,a=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:a,drifted:!1});let u={from:a,to:l,insert:cr.of(n.text.split(`
`))};if(u.from==this.from&&s<this.from?u.from=s:u.to==this.to&&s>this.to&&(u.to=s),u.from==u.to&&!u.insert.length){let h=Pe.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));h.main.eq(i)||e.dispatch({selection:h,userEvent:"select"});return}if((Qe.mac||Qe.android)&&u.from==o-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(u={from:a,to:l,insert:cr.of([n.text.replace("."," ")])}),this.pendingContextChange=u,!e.state.readOnly){let h=this.to-this.from+(u.to-u.from+u.insert.length);lN(e,u,Pe.single(this.toEditorPos(n.selectionStart,h),this.toEditorPos(n.selectionEnd,h)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let i=[],s=null;for(let o=this.toEditorPos(n.rangeStart),a=this.toEditorPos(n.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,i.push(s)}r.updateCharacterBounds(n.rangeStart,i)},this.handlers.textformatupdate=n=>{let i=[];for(let s of n.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(o!="None"&&a!="None"){let l=this.toEditorPos(s.rangeStart),u=this.toEditorPos(s.rangeEnd);if(l<u){let h=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;i.push(ft.mark({attributes:{style:h}}).range(l,u))}}}e.dispatch({effects:UJ.of(ft.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)r.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let i=Iv(n.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let r=0,n=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,u)=>{if(n)return;let h=u.length-(o-s);if(i&&o>=i.to)if(i.from==s&&i.to==o&&i.insert.eq(u)){i=this.pendingContextChange=null,r+=h,this.to+=h;return}else i=null,this.revertPending(e.state);if(s+=r,o+=r,o<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+u.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),u.toString()),this.to+=h}r+=h}),i&&!n&&this.revertPending(e.state),!n}update(e){let r=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||r)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:r}=e.selection.main;this.from=Math.max(0,r-1e4),this.to=Math.min(e.doc.length,r+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let r=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(r.from),this.toContextPos(r.from+r.insert.length),e.doc.sliceString(r.from,r.to))}setSelection(e){let{main:r}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,r.anchor))),i=this.toContextPos(r.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(n,i)}rangeIsValid(e){let{head:r}=e.selection.main;return!(this.from>0&&r-this.from<500||this.to<e.doc.length&&this.to-r<500||this.to-this.from>1e4*3)}toEditorPos(e,r=this.to-this.from){e=Math.min(e,r);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let r=this.composing;return r&&r.drifted?r.contextBase+(e-r.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class $e{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var r;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(s=>n(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||$3e(e.parent)||document,this.viewState=new vz(e.state||Qt.create(e)),e.scrollTo&&e.scrollTo.is(lw)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(hp).map(i=>new Xk(i));for(let i of this.plugins)i.update(this);this.observer=new cHe(this),this.inputState=new DFe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new ZW(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((r=document.fonts)===null||r===void 0)&&r.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let r=e.length==1&&e[0]instanceof hi?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(r,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,n=!1,i,s=this.state;for(let m of e){if(m.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=m.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(m=>m.annotation(nee))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=iee(s,o),l||(a=1));let u=this.observer.delayedAndroidKey,h=null;if(u?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Qt.phrases)!=this.state.facet(Qt.phrases))return this.setState(s);i=Yb.create(this,s,e),i.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let m of e){if(d&&(d=d.map(m.changes)),m.scrollIntoView){let{main:g}=m.state.selection;d=new Ap(g.empty?g:Pe.cursor(g.head,g.head>g.anchor?-1:1))}for(let g of m.effects)g.is(lw)&&(d=g.value.clip(this.state))}this.viewState.update(i,d),this.bidiCache=Kb.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),r=this.docView.update(i),this.state.facet(mg)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(pw)!=i.state.facet(pw)&&(this.viewState.mustMeasureContent=!0),(r||n||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),r&&this.docViewUpdate(),!i.empty)for(let m of this.state.facet(bM))try{m(i)}catch(g){js(this.state,g,"update listener")}(l||h)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!QJ(this,h)&&u.force&&Rp(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new vz(e),this.plugins=e.facet(hp).map(n=>new Xk(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new ZW(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(hp),n=e.state.facet(hp);if(r!=n){let i=[];for(let s of n){let o=r.indexOf(s);if(o<0)i.push(new Xk(s));else{let a=this.plugins[o];a.mustUpdate=e,i.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);r!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let r=e.value;if(r&&r.docViewUpdate)try{r.docViewUpdate(this)}catch(n){js(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(yJ(n))s=-1,o=this.viewState.heightMap.height;else{let g=this.viewState.scrollAnchorAt(i);s=g.from,o=g.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let h=u.map(g=>{try{return g.read(this)}catch(y){return js(this.state,y),bz}}),d=Yb.create(this,this.state,[]),m=!1;d.flags|=l,r?r.flags|=l:r=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),m=this.docView.update(d),m&&this.docViewUpdate());for(let g=0;g<u.length;g++)if(h[g]!=bz)try{let y=u[g];y.write&&y.write(h[g],this)}catch(y){js(this.state,y)}if(m&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let y=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(y>1||y<-1){i=i+y,n.scrollTop=i/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let a of this.state.facet(bM))a(r)}get themeClasses(){return RM+" "+(this.state.facet(EM)?lee:aee)+" "+this.state.facet(pw)}updateAttrs(){let e=Sz(this,$J,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(bc)?"true":"false",class:"cm-content",style:`${Qe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),Sz(this,sN,r);let n=this.observer.ignore(()=>{let i=gM(this.contentDOM,this.contentAttrs,r),s=gM(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=r,n}showAnnouncements(e){let r=!0;for(let n of e)for(let i of n.effects)if(i.is($e.announce)){r&&(this.announceDOM.textContent=""),r=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(mg);let e=this.state.facet($e.cspNonce);qu.mount(this.root,this.styleModules.concat(aHe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.plugin!=e)&&this.pluginMap.set(e,r=this.plugins.find(n=>n.plugin==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,n){return Zk(this,e,nz(this,e,r,n))}moveByGroup(e,r){return Zk(this,e,nz(this,e,r,n=>CFe(this,e.head,n)))}visualLineSide(e,r){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=n[r?n.length-1:0];return Pe.cursor(s.side(r,i)+e.from,s.forward(!r,i)?1:-1)}moveToLineBoundary(e,r,n=!0){return SFe(this,e,r,n)}moveVertically(e,r,n){return Zk(this,e,TFe(this,e,r,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){return this.readMeasured(),XJ(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let n=this.docView.coordsAt(e,r);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[Iu.find(s,e-i.from,-1,r)];return Iy(n,o.dir==en.LTR==r>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(jJ)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>hHe)return PJ(e.length);let r=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==r&&(s.fresh||DJ(s.isolates,n=QW(this,e))))return s.order;n||(n=QW(this,e));let i=oFe(e.text,r,n);return this.bidiCache.push(new Kb(e.from,e.to,r,n,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Qe.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{gJ(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return lw.of(new Ap(typeof e=="number"?Pe.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:r}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return lw.of(new Ap(Pe.cursor(n.from),"start","start",n.top-e,r,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Fn.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Fn.define(()=>({}),{eventObservers:e})}static theme(e,r){let n=qu.newName(),i=[pw.of(n),mg.of(AM(`.${n}`,e))];return r&&r.dark&&i.push(EM.of(!0)),i}static baseTheme(e){return Xh.lowest(mg.of(AM("."+RM,e,cee)))}static findFromDOM(e){var r;let n=e.querySelector(".cm-content"),i=n&&Lr.get(n)||Lr.get(e);return((r=i==null?void 0:i.rootView)===null||r===void 0?void 0:r.view)||null}}$e.styleModule=mg;$e.inputHandler=BJ;$e.clipboardInputFilter=nN;$e.clipboardOutputFilter=iN;$e.scrollHandler=zJ;$e.focusChangeEffect=VJ;$e.perLineTextDirection=jJ;$e.exceptionSink=HJ;$e.updateListener=bM;$e.editable=bc;$e.mouseSelectionStyle=FJ;$e.dragMovesSelection=LJ;$e.clickAddsSelectionRange=NJ;$e.decorations=Nv;$e.outerDecorations=GJ;$e.atomicRanges=oN;$e.bidiIsolatedRanges=YJ;$e.scrollMargins=qJ;$e.darkTheme=EM;$e.cspNonce=Ke.define({combine:t=>t.length?t[0]:""});$e.contentAttributes=sN;$e.editorAttributes=$J;$e.lineWrapping=$e.contentAttributes.of({class:"cm-lineWrapping"});$e.announce=Mt.define();const hHe=4096,bz={};class Kb{constructor(e,r,n,i,s,o){this.from=e,this.to=r,this.dir=n,this.isolates=i,this.fresh=s,this.order=o}static update(e,r){if(r.empty&&!e.some(s=>s.fresh))return e;let n=[],i=e.length?e[e.length-1].dir:en.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!r.touchesRange(o.from,o.to)&&n.push(new Kb(r.mapPos(o.from,1),r.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function Sz(t,e,r){for(let n=t.state.facet(e),i=n.length-1;i>=0;i--){let s=n[i],o=typeof s=="function"?s(t):s;o&&mM(o,r)}return r}const dHe=Qe.mac?"mac":Qe.windows?"win":Qe.linux?"linux":"key";function pHe(t,e){const r=t.split(/-(?!$)/);let n=r[r.length-1];n=="Space"&&(n=" ");let i,s,o,a;for(let l=0;l<r.length-1;++l){const u=r[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return i&&(n="Alt-"+n),s&&(n="Ctrl-"+n),a&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function mw(t,e,r){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r!==!1&&e.shiftKey&&(t="Shift-"+t),t}const mHe=Xh.default($e.domEventHandlers({keydown(t,e){return fee(uee(e.state),t,e,"editor")}})),gC=Ke.define({enables:mHe}),Cz=new WeakMap;function uee(t){let e=t.facet(gC),r=Cz.get(e);return r||Cz.set(e,r=yHe(e.reduce((n,i)=>n.concat(i),[]))),r}function gHe(t,e,r){return fee(uee(t.state),e,t,r)}let Eu=null;const vHe=4e3;function yHe(t,e=dHe){let r=Object.create(null),n=Object.create(null),i=(o,a)=>{let l=n[o];if(l==null)n[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,u,h)=>{var d,m;let g=r[o]||(r[o]=Object.create(null)),y=a.split(/ (?!$)/).map(C=>pHe(C,e));for(let C=1;C<y.length;C++){let E=y.slice(0,C).join(" ");i(E,!0),g[E]||(g[E]={preventDefault:!0,stopPropagation:!1,run:[R=>{let k=Eu={view:R,prefix:E,scope:o};return setTimeout(()=>{Eu==k&&(Eu=null)},vHe),!0}]})}let x=y.join(" ");i(x,!1);let b=g[x]||(g[x]={preventDefault:!1,stopPropagation:!1,run:((m=(d=g._any)===null||d===void 0?void 0:d.run)===null||m===void 0?void 0:m.slice())||[]});l&&b.run.push(l),u&&(b.preventDefault=!0),h&&(b.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of a){let h=r[u]||(r[u]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:d}=o;for(let m in h)h[m].run.push(g=>d(g,kM))}let l=o[e]||o.key;if(l)for(let u of a)s(u,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return r}let kM=null;function fee(t,e,r,n){kM=e;let i=V3e(e),s=Ns(i,0),o=Sl(s)==i.length&&i!=" ",a="",l=!1,u=!1,h=!1;Eu&&Eu.view==r&&Eu.scope==n&&(a=Eu.prefix+" ",JJ.indexOf(e.keyCode)<0&&(u=!0,Eu=null));let d=new Set,m=b=>{if(b){for(let C of b.run)if(!d.has(C)&&(d.add(C),C(r)))return b.stopPropagation&&(h=!0),!0;b.preventDefault&&(b.stopPropagation&&(h=!0),u=!0)}return!1},g=t[n],y,x;return g&&(m(g[a+mw(i,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Qe.windows&&e.ctrlKey&&e.altKey)&&(y=Ku[e.keyCode])&&y!=i?(m(g[a+mw(y,e,!0)])||e.shiftKey&&(x=Pv[e.keyCode])!=i&&x!=y&&m(g[a+mw(x,e,!1)]))&&(l=!0):o&&e.shiftKey&&m(g[a+mw(i,e,!0)])&&(l=!0),!l&&m(g._any)&&(l=!0)),u&&(l=!0),l&&h&&e.stopPropagation(),kM=null,l}class Fy{constructor(e,r,n,i,s){this.className=e,this.left=r,this.top=n,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let s=hee(e);return[new Fy(r,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return xHe(e,r,n)}}function hee(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==en.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function Tz(t,e,r,n){let i=t.coordsAtPos(e,r*2);if(!i)return n;let s=t.dom.getBoundingClientRect(),o=(i.top+i.bottom)/2,a=t.posAtCoords({x:s.left+1,y:o}),l=t.posAtCoords({x:s.right-1,y:o});return a==null||l==null?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}function xHe(t,e,r){if(r.to<=t.viewport.from||r.from>=t.viewport.to)return[];let n=Math.max(r.from,t.viewport.from),i=Math.min(r.to,t.viewport.to),s=t.textDirection==en.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=hee(t),u=o.querySelector(".cm-line"),h=u&&window.getComputedStyle(u),d=a.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),m=a.right-(h?parseInt(h.paddingRight):0),g=CM(t,n,1),y=CM(t,i,-1),x=g.type==ys.Text?g:null,b=y.type==ys.Text?y:null;if(x&&(t.lineWrapping||g.widgetLineBreaks)&&(x=Tz(t,n,1,x)),b&&(t.lineWrapping||y.widgetLineBreaks)&&(b=Tz(t,i,-1,b)),x&&b&&x.from==b.from&&x.to==b.to)return E(R(r.from,r.to,x));{let O=x?R(r.from,null,x):k(g,!1),P=b?R(null,r.to,b):k(y,!0),D=[];return(x||g).to<(b||y).from-(x&&b?1:0)||g.widgetLineBreaks>1&&O.bottom+t.defaultLineHeight/2<P.top?D.push(C(d,O.bottom,m,P.top)):O.bottom<P.top&&t.elementAtHeight((O.bottom+P.top)/2).type==ys.Text&&(O.bottom=P.top=(O.bottom+P.top)/2),E(O).concat(D).concat(E(P))}function C(O,P,D,H){return new Fy(e,O-l.left,P-l.top,D-O,H-P)}function E({top:O,bottom:P,horizontal:D}){let H=[];for(let N=0;N<D.length;N+=2)H.push(C(D[N],O,D[N+1],P));return H}function R(O,P,D){let H=1e9,N=-1e9,_=[];function B(oe,re,q,Z,ve){let ie=t.coordsAtPos(oe,oe==D.to?-2:2),K=t.coordsAtPos(q,q==D.from?2:-2);!ie||!K||(H=Math.min(ie.top,K.top,H),N=Math.max(ie.bottom,K.bottom,N),ve==en.LTR?_.push(s&&re?d:ie.left,s&&Z?m:K.right):_.push(!s&&Z?d:K.left,!s&&re?m:ie.right))}let j=O??D.from,ee=P??D.to;for(let oe of t.visibleRanges)if(oe.to>j&&oe.from<ee)for(let re=Math.max(oe.from,j),q=Math.min(oe.to,ee);;){let Z=t.state.doc.lineAt(re);for(let ve of t.bidiSpans(Z)){let ie=ve.from+Z.from,K=ve.to+Z.from;if(ie>=q)break;K>re&&B(Math.max(ie,re),O==null&&ie<=j,Math.min(K,q),P==null&&K>=ee,ve.dir)}if(re=Z.to+1,re>=q)break}return _.length==0&&B(j,O==null,ee,P==null,t.textDirection),{top:H,bottom:N,horizontal:_}}function k(O,P){let D=a.top+(P?O.top:O.bottom);return{top:D,bottom:D,horizontal:[]}}}function wHe(t,e){return t.constructor==e.constructor&&t.eq(e)}class bHe{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(Jw)!=e.state.facet(Jw)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let r=0,n=e.facet(Jw);for(;r<n.length&&n[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:r}=this.view;(e!=this.scaleX||r!=this.scaleY)&&(this.scaleX=e,this.scaleY=r,this.dom.style.transform=`scale(${1/e}, ${1/r})`)}draw(e){if(e.length!=this.drawn.length||e.some((r,n)=>!wHe(r,this.drawn[n]))){let r=this.dom.firstChild,n=0;for(let i of e)i.update&&r&&i.constructor&&this.drawn[n].constructor&&i.update(r,this.drawn[n])?(r=r.nextSibling,n++):this.dom.insertBefore(i.draw(),r);for(;r;){let i=r.nextSibling;r.remove(),r=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Jw=Ke.define();function dee(t){return[Fn.define(e=>new bHe(e,t)),Jw.of(t)]}const Lv=Ke.define({combine(t){return $l(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function SHe(t={}){return[Lv.of(t),CHe,THe,EHe,WJ.of(!0)]}function pee(t){return t.startState.facet(Lv)!=t.state.facet(Lv)}const CHe=dee({above:!0,markers(t){let{state:e}=t,r=e.facet(Lv),n=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty||r.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=i.empty?i:Pe.cursor(i.head,i.head>i.anchor?-1:1);for(let l of Fy.forRange(t,o,a))n.push(l)}}return n},update(t,e){t.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=pee(t);return r&&Ez(t.state,e),t.docChanged||t.selectionSet||r},mount(t,e){Ez(e.state,t)},class:"cm-cursorLayer"});function Ez(t,e){e.style.animationDuration=t.facet(Lv).cursorBlinkRate+"ms"}const THe=dee({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Fy.forRange(t,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||pee(t)},class:"cm-selectionLayer"}),EHe=Xh.highest($e.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),mee=Mt.define({map(t,e){return t==null?null:e.mapPos(t)}}),yg=Wi.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((r,n)=>n.is(mee)?n.value:r,t)}}),RHe=Fn.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let r=t.state.field(yg);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(yg)!=r||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(yg),r=e!=null&&t.coordsAtPos(e);if(!r)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:r.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:r.bottom-r.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:r}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/r+"px",this.cursor.style.height=t.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(yg)!=t&&this.view.dispatch({effects:mee.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function AHe(){return[yg,RHe]}function Rz(t,e,r,n,i){e.lastIndex=0;for(let s=t.iterRange(r,n),o=r,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)i(o+a.index,a)}function kHe(t,e){let r=t.visibleRanges;if(r.length==1&&r[0].from==t.viewport.from&&r[0].to==t.viewport.to)return r;let n=[];for(let{from:i,to:s}of r)i=Math.max(t.state.doc.lineAt(i).from,i-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=i?n[n.length-1].to=s:n.push({from:i,to:s});return n}class OHe{constructor(e){const{regexp:r,decoration:n,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!r.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=r,i)this.addMatch=(a,l,u,h)=>i(h,u,u+a[0].length,a,l);else if(typeof n=="function")this.addMatch=(a,l,u,h)=>{let d=n(a,l,u);d&&h(u,u+a[0].length,d)};else if(n)this.addMatch=(a,l,u,h)=>h(u,u+a[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let r=new Lc,n=r.add.bind(r);for(let{from:i,to:s}of kHe(e,this.maxLength))Rz(e.state.doc,this.regexp,i,s,(o,a)=>this.addMatch(a,e,o,n));return r.finish()}updateDeco(e,r){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>=e.view.viewport.from&&a<=e.view.viewport.to&&(n=Math.min(a,n),i=Math.max(l,i))}),e.viewportMoved||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,r.map(e.changes),n,i):r}updateRange(e,r,n,i){for(let s of e.visibleRanges){let o=Math.max(s.from,n),a=Math.min(s.to,i);if(a>=o){let l=e.state.doc.lineAt(o),u=l.to<a?e.state.doc.lineAt(a):l,h=Math.max(s.from,l.from),d=Math.min(s.to,u.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){h=o;break}for(;a<u.to;a++)if(this.boundary.test(u.text[a-u.from])){d=a;break}}let m=[],g,y=(x,b,C)=>m.push(C.range(x,b));if(l==u)for(this.regexp.lastIndex=h-l.from;(g=this.regexp.exec(l.text))&&g.index<d-l.from;)this.addMatch(g,e,g.index+l.from,y);else Rz(e.state.doc,this.regexp,h,d,(x,b)=>this.addMatch(b,e,x,y));r=r.update({filterFrom:h,filterTo:d,filter:(x,b)=>x<h||b>d,add:m})}}return r}}const OM=/x/.unicode!=null?"gu":"g",_He=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,OM),MHe={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let tO=null;function DHe(){var t;if(tO==null&&typeof document<"u"&&document.body){let e=document.body.style;tO=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return tO||!1}const eb=Ke.define({combine(t){let e=$l(t,{render:null,specialChars:_He,addSpecialChars:null});return(e.replaceTabs=!DHe())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,OM)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,OM)),e}});function PHe(t={}){return[eb.of(t),IHe()]}let Az=null;function IHe(){return Az||(Az=Fn.fromClass(class{constructor(t){this.view=t,this.decorations=ft.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(eb)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new OHe({regexp:t.specialChars,decoration:(e,r,n)=>{let{doc:i}=r.state,s=Ns(e[0],0);if(s==9){let o=i.lineAt(n),a=r.state.tabSize,l=b0(o.text,a,n-o.from);return ft.replace({widget:new HHe((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=ft.replace({widget:new FHe(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(eb);t.startState.facet(eb)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const NHe="";function LHe(t){return t>=32?NHe:t==10?"":String.fromCharCode(9216+t)}class FHe extends Uc{constructor(e,r){super(),this.options=e,this.code=r}eq(e){return e.code==this.code}toDOM(e){let r=LHe(this.code),n=e.state.phrase("Control character")+" "+(MHe[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,r);if(i)return i;let s=document.createElement("span");return s.textContent=r,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class HHe extends Uc{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function BHe(){return jHe}const VHe=ft.line({class:"cm-activeLine"}),jHe=Fn.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,r=[];for(let n of t.state.selection.ranges){let i=t.lineBlockAt(n.head);i.from>e&&(r.push(VHe.range(i.from)),e=i.from)}return ft.set(r)}},{decorations:t=>t.decorations});class WHe extends Uc{constructor(e){super(),this.content=e}toDOM(e){let r=document.createElement("span");return r.className="cm-placeholder",r.style.pointerEvents="none",r.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),r.setAttribute("aria-hidden","true"),r}coordsAt(e){let r=e.firstChild?Kp(e.firstChild):[];if(!r.length)return null;let n=window.getComputedStyle(e.parentNode),i=Iy(r[0],n.direction!="rtl"),s=parseInt(n.lineHeight);return i.bottom-i.top>s*1.5?{left:i.left,right:i.right,top:i.top,bottom:i.top+s}:i}ignoreEvent(){return!1}}function zHe(t){let e=Fn.fromClass(class{constructor(r){this.view=r,this.placeholder=t?ft.set([ft.widget({widget:new WHe(t),side:1}).range(0)]):ft.none}get decorations(){return this.view.state.doc.length?ft.none:this.placeholder}},{decorations:r=>r.decorations});return typeof t=="string"?[e,$e.contentAttributes.of({"aria-placeholder":t})]:e}const _M=2e3;function UHe(t,e,r){let n=Math.min(e.line,r.line),i=Math.max(e.line,r.line),s=[];if(e.off>_M||r.off>_M||e.col<0||r.col<0){let o=Math.min(e.off,r.off),a=Math.max(e.off,r.off);for(let l=n;l<=i;l++){let u=t.doc.line(l);u.length<=a&&s.push(Pe.range(u.from+o,u.to+a))}}else{let o=Math.min(e.col,r.col),a=Math.max(e.col,r.col);for(let l=n;l<=i;l++){let u=t.doc.line(l),h=lM(u.text,o,t.tabSize,!0);if(h<0)s.push(Pe.cursor(u.to));else{let d=lM(u.text,a,t.tabSize);s.push(Pe.range(u.from+h,u.from+d))}}}return s}function $He(t,e){let r=t.coordsAtPos(t.viewport.from);return r?Math.round(Math.abs((r.left-e)/t.defaultCharacterWidth)):-1}function kz(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(r),i=r-n.from,s=i>_M?-1:i==n.length?$He(t,e.clientX):b0(n.text,t.state.tabSize,r-n.from);return{line:n.number,col:s,off:i}}function GHe(t,e){let r=kz(t,e),n=t.state.selection;return r?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(r.line).from),o=i.state.doc.lineAt(s);r={line:o.number,col:r.col,off:Math.min(r.off,o.length)},n=n.map(i.changes)}},get(i,s,o){let a=kz(t,i);if(!a)return n;let l=UHe(t.state,r,a);return l.length?o?Pe.create(l.concat(n.ranges)):Pe.create(l):n}}:null}function YHe(t){let e=r=>r.altKey&&r.button==0;return $e.mouseSelectionStyle.of((r,n)=>e(n)?GHe(r,n):null)}const qHe={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},KHe={style:"cursor: crosshair"};function XHe(t={}){let[e,r]=qHe[t.key||"Alt"],n=Fn.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||r(i))},keyup(i){(i.keyCode==e||!r(i))&&this.set(!1)},mousemove(i){this.set(r(i))}}});return[n,$e.contentAttributes.of(i=>{var s;return!((s=i.plugin(n))===null||s===void 0)&&s.isDown?KHe:null})]}const Jm="-10000px";class gee{constructor(e,r,n,i){this.facet=r,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(r),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=n(o,s))}update(e,r){var n;let i=e.state.facet(this.facet),s=i.filter(l=>l);if(i===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=r?[]:null;for(let l=0;l<s.length;l++){let u=s[l],h=-1;if(u){for(let d=0;d<this.tooltips.length;d++){let m=this.tooltips[d];m&&m.create==u.create&&(h=d)}if(h<0)o[l]=this.createTooltipView(u,l?o[l-1]:null),a&&(a[l]=!!u.above);else{let d=o[l]=this.tooltipViews[h];a&&(a[l]=r[h]),d.update&&d.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return r&&(a.forEach((l,u)=>r[u]=l),r.length=a.length),this.input=i,this.tooltips=s,this.tooltipViews=o,!0}}function QHe(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const rO=Ke.define({combine:t=>{var e,r,n;return{position:Qe.ios?"absolute":((e=t.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=t.find(i=>i.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((n=t.find(i=>i.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||QHe}}}),Oz=new WeakMap,fN=Fn.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(rO);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new gee(t,hN,(r,n)=>this.createTooltip(r,n),r=>{this.resizeObserver&&this.resizeObserver.unobserve(r.dom),r.dom.remove()}),this.above=this.manager.tooltips.map(r=>!!r.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let r=e||t.geometryChanged,n=t.state.facet(rO);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(t,e){let r=t.create(this.view),n=e?e.dom:null;if(r.dom.classList.add("cm-tooltip"),t.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",r.dom.appendChild(i)}return r.dom.style.position=this.position,r.dom.style.top=Jm,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var t,e,r;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(t=n.destroy)===null||t===void 0||t.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(r=this.intersectionObserver)===null||r===void 0||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,r=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(Qe.gecko)r=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Jm&&s.style.left=="0px"){let o=s.getBoundingClientRect();r=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(r||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(t=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=aN(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(rO).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:r}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:r,space:n,scaleX:i,scaleY:s}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],u=this.manager.tooltipViews[a],{dom:h}=u,d=t.pos[a],m=t.size[a];if(!d||l.clip!==!1&&(d.bottom<=Math.max(r.top,n.top)||d.top>=Math.min(r.bottom,n.bottom)||d.right<Math.max(r.left,n.left)-.1||d.left>Math.min(r.right,n.right)+.1)){h.style.top=Jm;continue}let g=l.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,y=g?7:0,x=m.right-m.left,b=(e=Oz.get(u))!==null&&e!==void 0?e:m.bottom-m.top,C=u.offset||JHe,E=this.view.textDirection==en.LTR,R=m.width>n.right-n.left?E?n.left:n.right-m.width:E?Math.max(n.left,Math.min(d.left-(g?14:0)+C.x,n.right-x)):Math.min(Math.max(n.left,d.left-x+(g?14:0)-C.x),n.right-x),k=this.above[a];!l.strictSide&&(k?d.top-b-y-C.y<n.top:d.bottom+b+y+C.y>n.bottom)&&k==n.bottom-d.bottom>d.top-n.top&&(k=this.above[a]=!k);let O=(k?d.top-n.top:n.bottom-d.bottom)-y;if(O<b&&u.resize!==!1){if(O<this.view.defaultLineHeight){h.style.top=Jm;continue}Oz.set(u,b),h.style.height=(b=O)/s+"px"}else h.style.height&&(h.style.height="");let P=k?d.top-b-y-C.y:d.bottom+y+C.y,D=R+x;if(u.overlap!==!0)for(let H of o)H.left<D&&H.right>R&&H.top<P+b&&H.bottom>P&&(P=k?H.top-b-2-y:H.bottom+y+2);if(this.position=="absolute"?(h.style.top=(P-t.parent.top)/s+"px",_z(h,(R-t.parent.left)/i)):(h.style.top=P/s+"px",_z(h,R/i)),g){let H=d.left+(E?C.x:-C.x)-(R+14-7);g.style.left=H/i+"px"}u.overlap!==!0&&o.push({left:R,top:P,right:D,bottom:P+b}),h.classList.toggle("cm-tooltip-above",k),h.classList.toggle("cm-tooltip-below",!k),u.positioned&&u.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Jm}},{eventObservers:{scroll(){this.maybeMeasure()}}});function _z(t,e){let r=parseInt(t.style.left,10);(isNaN(r)||Math.abs(e-r)>1)&&(t.style.left=e+"px")}const ZHe=$e.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),JHe={x:0,y:0},hN=Ke.define({enables:[fN,ZHe]}),Xb=Ke.define({combine:t=>t.reduce((e,r)=>e.concat(r),[])});class vC{static create(e){return new vC(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new gee(e,Xb,(r,n)=>this.createHostedView(r,n),r=>r.dom.remove())}createHostedView(e,r){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,r?r.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let r of this.manager.tooltipViews)r.mount&&r.mount(e);this.mounted=!0}positioned(e){for(let r of this.manager.tooltipViews)r.positioned&&r.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let r of this.manager.tooltipViews)(e=r.destroy)===null||e===void 0||e.call(r)}passProp(e){let r;for(let n of this.manager.tooltipViews){let i=n[e];if(i!==void 0){if(r===void 0)r=i;else if(r!==i)return}}return r}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const eBe=hN.compute([Xb],t=>{let e=t.facet(Xb);return e.length===0?null:{pos:Math.min(...e.map(r=>r.pos)),end:Math.max(...e.map(r=>{var n;return(n=r.end)!==null&&n!==void 0?n:r.pos})),create:vC.create,above:e[0].above,arrow:e.some(r=>r.arrow)}});class tBe{constructor(e,r,n,i,s){this.view=e,this.source=r,this.field=n,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:r}=this,n=e.docView.nearest(r.target);if(!n)return;let i,s=1;if(n instanceof Pu)i=n.posAtStart;else{if(i=e.posAtCoords(r),i==null)return;let a=e.coordsAtPos(i);if(!a||r.y<a.top||r.y>a.bottom||r.x<a.left-e.defaultCharacterWidth||r.x>a.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(i)).find(h=>h.from<=i&&h.to>=i),u=l&&l.dir==en.RTL?-1:1;s=r.x<a.left?-u:u}let o=this.source(e,i,s);if(o!=null&&o.then){let a=this.pending={pos:i};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>js(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(fN),r=e?e.manager.tooltips.findIndex(n=>n.create==vC.create):-1;return r>-1?e.manager.tooltipViews[r]:null}mousemove(e){var r,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!rBe(s.dom,e)||this.pending){let{pos:o}=i[0]||this.pending,a=(n=(r=i[0])===null||r===void 0?void 0:r.end)!==null&&n!==void 0?n:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!nBe(this.view,o,a,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:r}=this;if(r.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let r=n=>{e.removeEventListener("mouseleave",r),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",r)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const gw=4;function rBe(t,e){let{left:r,right:n,top:i,bottom:s}=t.getBoundingClientRect(),o;if(o=t.querySelector(".cm-tooltip-arrow")){let a=o.getBoundingClientRect();i=Math.min(a.top,i),s=Math.max(a.bottom,s)}return e.clientX>=r-gw&&e.clientX<=n+gw&&e.clientY>=i-gw&&e.clientY<=s+gw}function nBe(t,e,r,n,i,s){let o=t.scrollDOM.getBoundingClientRect(),a=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>n||o.right<n||o.top>i||Math.min(o.bottom,a)<i)return!1;let l=t.posAtCoords({x:n,y:i},!1);return l>=e&&l<=r}function iBe(t,e={}){let r=Mt.define(),n=Wi.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let a of i){let l=s.changes.mapPos(a.pos,-1,ps.TrackDel);if(l!=null){let u=Object.assign(Object.create(null),a);u.pos=l,u.end!=null&&(u.end=s.changes.mapPos(u.end)),o.push(u)}}i=o}for(let o of s.effects)o.is(r)&&(i=o.value),o.is(sBe)&&(i=[]);return i},provide:i=>Xb.from(i)});return{active:n,extension:[n,Fn.define(i=>new tBe(i,t,n,r,e.hoverTime||300)),eBe]}}function vee(t,e){let r=t.plugin(fN);if(!r)return null;let n=r.manager.tooltips.indexOf(e);return n<0?null:r.manager.tooltipViews[n]}const sBe=Mt.define(),Mz=Ke.define({combine(t){let e,r;for(let n of t)e=e||n.topContainer,r=r||n.bottomContainer;return{topContainer:e,bottomContainer:r}}});function Fv(t,e){let r=t.plugin(yee),n=r?r.specs.indexOf(e):-1;return n>-1?r.panels[n]:null}const yee=Fn.fromClass(class{constructor(t){this.input=t.state.facet(Hv),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(t));let e=t.state.facet(Mz);this.top=new vw(t,!0,e.topContainer),this.bottom=new vw(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(t){let e=t.state.facet(Mz);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new vw(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new vw(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=t.state.facet(Hv);if(r!=this.input){let n=r.filter(l=>l),i=[],s=[],o=[],a=[];for(let l of n){let u=this.specs.indexOf(l),h;u<0?(h=l(t.view),a.push(h)):(h=this.panels[u],h.update&&h.update(t)),i.push(h),(h.top?s:o).push(h)}this.specs=n,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>$e.scrollMargins.of(e=>{let r=e.plugin(t);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});class vw{constructor(e,r,n){this.view=e,this.top=r,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=Dz(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=Dz(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Dz(t){let e=t.nextSibling;return t.remove(),e}const Hv=Ke.define({enables:yee});class Hc extends kh{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Hc.prototype.elementClass="";Hc.prototype.toDOM=void 0;Hc.prototype.mapMode=ps.TrackBefore;Hc.prototype.startSide=Hc.prototype.endSide=-1;Hc.prototype.point=!0;const tb=Ke.define(),oBe=Ke.define(),aBe={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>lr.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},qg=Ke.define();function lBe(t){return[xee(),qg.of({...aBe,...t})]}const Pz=Ke.define({combine:t=>t.some(e=>e)});function xee(t){return[cBe]}const cBe=Fn.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(qg).map(e=>new Nz(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(Pz),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,r=t.view.viewport,n=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Pz)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let r=lr.iter(this.view.state.facet(tb),this.view.viewport.from),n=[],i=this.gutters.map(s=>new uBe(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==ys.Text&&o){MM(r,n,a.from);for(let l of i)l.line(this.view,a,n);o=!1}else if(a.widget)for(let l of i)l.widget(this.view,a)}else if(s.type==ys.Text){MM(r,n,s.from);for(let o of i)o.line(this.view,s,n)}else if(s.widget)for(let o of i)o.widget(this.view,s);for(let s of i)s.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(qg),r=t.state.facet(qg),n=t.docChanged||t.heightChanged||t.viewportChanged||!lr.eq(t.startState.facet(tb),t.state.facet(tb),t.view.viewport.from,t.view.viewport.to);if(e==r)for(let i of this.gutters)i.update(t)&&(n=!0);else{n=!0;let i=[];for(let s of r){let o=e.indexOf(s);o<0?i.push(new Nz(this.view,s)):(this.gutters[o].update(t),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)this.dom.appendChild(s.dom);this.gutters=i}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>$e.scrollMargins.of(e=>{let r=e.plugin(t);return!r||r.gutters.length==0||!r.fixed?null:e.textDirection==en.LTR?{left:r.dom.offsetWidth*e.scaleX}:{right:r.dom.offsetWidth*e.scaleX}})});function Iz(t){return Array.isArray(t)?t:[t]}function MM(t,e,r){for(;t.value&&t.from<=r;)t.from==r&&e.push(t.value),t.next()}class uBe{constructor(e,r,n){this.gutter=e,this.height=n,this.i=0,this.cursor=lr.iter(e.markers,r.from)}addElement(e,r,n){let{gutter:i}=this,s=(r.top-this.height)/e.scaleY,o=r.height/e.scaleY;if(this.i==i.elements.length){let a=new wee(e,o,s,n);i.elements.push(a),i.dom.appendChild(a.dom)}else i.elements[this.i].update(e,o,s,n);this.height=r.bottom,this.i++}line(e,r,n){let i=[];MM(this.cursor,i,r.from),n.length&&(i=i.concat(n));let s=this.gutter.config.lineMarker(e,r,i);s&&i.unshift(s);let o=this.gutter;i.length==0&&!o.config.renderEmptyElements||this.addElement(e,r,i)}widget(e,r){let n=this.gutter.config.widgetMarker(e,r.widget,r),i=n?[n]:null;for(let s of e.state.facet(oBe)){let o=s(e,r.widget,r);o&&(i||(i=[])).push(o)}i&&this.addElement(e,r,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}}class Nz{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in r.domEventHandlers)this.dom.addEventListener(n,i=>{let s=i.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=i.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);r.domEventHandlers[n](e,a,i)&&i.preventDefault()});this.markers=Iz(r.markers(e)),r.initialSpacer&&(this.spacer=new wee(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=Iz(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let n=e.view.viewport;return!lr.eq(this.markers,r,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class wee{constructor(e,r,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,n,i)}update(e,r,n,i){this.height!=r&&(this.height=r,this.dom.style.height=r+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),fBe(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,r){let n="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<r.length?r[s++]:null,u=!1;if(l){let h=l.elementClass;h&&(n+=" "+h);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,u=!0;break}}else a=this.markers.length;for(;o<a;){let h=this.markers[o++];if(h.toDOM){h.destroy(i);let d=i.nextSibling;i.remove(),i=d}}if(!l)break;l.toDOM&&(u?i=i.nextSibling:this.dom.insertBefore(l.toDOM(e),i)),u&&o++}this.dom.className=n,this.markers=r}destroy(){this.setMarkers(null,[])}}function fBe(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].compare(e[r]))return!1;return!0}const hBe=Ke.define(),dBe=Ke.define(),dp=Ke.define({combine(t){return $l(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let n=Object.assign({},e);for(let i in r){let s=n[i],o=r[i];n[i]=s?(a,l,u)=>s(a,l,u)||o(a,l,u):o}return n}})}});class nO extends Hc{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function iO(t,e){return t.state.facet(dp).formatNumber(e,t.state)}const pBe=qg.compute([dp],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(hBe)},lineMarker(e,r,n){return n.some(i=>i.toDOM)?null:new nO(iO(e,e.state.doc.lineAt(r.from).number))},widgetMarker:(e,r,n)=>{for(let i of e.state.facet(dBe)){let s=i(e,r,n);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(dp)!=e.state.facet(dp),initialSpacer(e){return new nO(iO(e,Lz(e.state.doc.lines)))},updateSpacer(e,r){let n=iO(r.view,Lz(r.view.state.doc.lines));return n==e.number?e:new nO(n)},domEventHandlers:t.facet(dp).domEventHandlers}));function mBe(t={}){return[dp.of(t),xee(),pBe]}function Lz(t){let e=9;for(;e<t;)e=e*10+9;return e}const gBe=new class extends Hc{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},vBe=tb.compute(["selection"],t=>{let e=[],r=-1;for(let n of t.selection.ranges){let i=t.doc.lineAt(n.head).from;i>r&&(r=i,e.push(gBe.range(i)))}return lr.of(e)});function yBe(){return vBe}const bee=1024;let xBe=0;class sO{constructor(e,r){this.from=e,this.to=r}}class Vt{constructor(e={}){this.id=xBe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Cs.match(e)),r=>{let n=e(r);return n===void 0?null:[this,n]}}}Vt.closedBy=new Vt({deserialize:t=>t.split(" ")});Vt.openedBy=new Vt({deserialize:t=>t.split(" ")});Vt.group=new Vt({deserialize:t=>t.split(" ")});Vt.isolate=new Vt({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});Vt.contextHash=new Vt({perNode:!0});Vt.lookAhead=new Vt({perNode:!0});Vt.mounted=new Vt({perNode:!0});class Qb{constructor(e,r,n){this.tree=e,this.overlay=r,this.parser=n}static get(e){return e&&e.props&&e.props[Vt.mounted.id]}}const wBe=Object.create(null);class Cs{constructor(e,r,n,i=0){this.name=e,this.props=r,this.id=n,this.flags=i}static define(e){let r=e.props&&e.props.length?Object.create(null):wBe,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new Cs(e.name||"",r,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(Vt.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let n in e)for(let i of n.split(" "))r[i]=e[n];return n=>{for(let i=n.prop(Vt.group),s=-1;s<(i?i.length:0);s++){let o=r[s<0?n.name:i[s]];if(o)return o}}}}Cs.none=new Cs("",Object.create(null),0,8);class yC{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let n of this.types){let i=null;for(let s of e){let o=s(n);o&&(i||(i=Object.assign({},n.props)),i[o[0].id]=o[1])}r.push(i?new Cs(n.name,i,n.id,n.flags):n)}return new yC(r)}}const yw=new WeakMap,Fz=new WeakMap;var wi;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(wi||(wi={}));class Fr{constructor(e,r,n,i,s){if(this.type=e,this.children=r,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Qb.get(this);if(e&&!e.overlay)return e.tree.toString();let r="";for(let n of this.children){let i=n.toString();i&&(r&&(r+=","),r+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new PM(this.topNode,e)}cursorAt(e,r=0,n=0){let i=yw.get(this)||this.topNode,s=new PM(i);return s.moveTo(e,r),yw.set(this,s._tree),s}get topNode(){return new ra(this,0,0,null)}resolve(e,r=0){let n=Bv(yw.get(this)||this.topNode,e,r,!1);return yw.set(this,n),n}resolveInner(e,r=0){let n=Bv(Fz.get(this)||this.topNode,e,r,!0);return Fz.set(this,n),n}resolveStack(e,r=0){return CBe(this,e,r)}iterate(e){let{enter:r,leave:n,from:i=0,to:s=this.length}=e,o=e.mode||0,a=(o&wi.IncludeAnonymous)>0;for(let l=this.cursor(o|wi.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=i&&(!a&&l.type.isAnonymous||r(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&n&&(a||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:mN(Cs.none,this.children,this.positions,0,this.children.length,0,this.length,(r,n,i)=>new Fr(this.type,r,n,i,this.propValues),e.makeTree||((r,n,i)=>new Fr(Cs.none,r,n,i)))}static build(e){return TBe(e)}}Fr.empty=new Fr(Cs.none,[],[],0);class dN{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new dN(this.buffer,this.index)}}class Qu{constructor(e,r,n){this.buffer=e,this.length=r,this.set=n}get type(){return Cs.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],n=this.buffer[e+3],i=this.set.types[r],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,r,n,i,s){let{buffer:o}=this,a=-1;for(let l=e;l!=r&&!(See(s,i,o[l+1],o[l+2])&&(a=l,n>0));l=o[l+3]);return a}slice(e,r,n){let i=this.buffer,s=new Uint16Array(r-e),o=0;for(let a=e,l=0;a<r;){s[l++]=i[a++],s[l++]=i[a++]-n;let u=s[l++]=i[a++]-n;s[l++]=i[a++]-e,o=Math.max(o,u)}return new Qu(s,o,this.set)}}function See(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}function Bv(t,e,r,n){for(var i;t.from==t.to||(r<1?t.from>=e:t.from>e)||(r>-1?t.to<=e:t.to<e);){let o=!n&&t instanceof ra&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=n?0:wi.IgnoreOverlays;if(n)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof ra&&o.index<0&&((i=a.enter(e,r,s))===null||i===void 0?void 0:i.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,r,s);if(!o)return t;t=o}}class Cee{cursor(e=0){return new PM(this,e)}getChild(e,r=null,n=null){let i=Hz(this,e,r,n);return i.length?i[0]:null}getChildren(e,r=null,n=null){return Hz(this,e,r,n)}resolve(e,r=0){return Bv(this,e,r,!1)}resolveInner(e,r=0){return Bv(this,e,r,!0)}matchContext(e){return DM(this.parent,e)}enterUnfinishedNodesBefore(e){let r=this.childBefore(e),n=this;for(;r;){let i=r.lastChild;if(!i||i.to!=r.to)break;i.type.isError&&i.from==i.to?(n=r,r=i.prevSibling):r=i}return n}get node(){return this}get next(){return this.parent}}class ra extends Cee{constructor(e,r,n,i){super(),this._tree=e,this.from=r,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,n,i,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=r>0?a.length:-1;e!=u;e+=r){let h=a[e],d=l[e]+o.from;if(See(i,n,d,d+h.length)){if(h instanceof Qu){if(s&wi.ExcludeBuffers)continue;let m=h.findChild(0,h.buffer.length,r,n-d,i);if(m>-1)return new Nu(new bBe(o,h,e,d),null,m)}else if(s&wi.IncludeAnonymous||!h.type.isAnonymous||pN(h)){let m;if(!(s&wi.IgnoreMounts)&&(m=Qb.get(h))&&!m.overlay)return new ra(m.tree,d,e,o);let g=new ra(h,d,e,o);return s&wi.IncludeAnonymous||!g.type.isAnonymous?g:g.nextChild(r<0?h.children.length-1:0,r,n,i)}}}if(s&wi.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+r:e=r<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,r,n=0){let i;if(!(n&wi.IgnoreOverlays)&&(i=Qb.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:o,to:a}of i.overlay)if((r>0?o<=s:o<s)&&(r<0?a>=s:a>s))return new ra(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Hz(t,e,r,n){let i=t.cursor(),s=[];if(!i.firstChild())return s;if(r!=null){for(let o=!1;!o;)if(o=i.type.is(r),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function DM(t,e,r=e.length-1){for(let n=t;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[r]&&e[r]!=n.name)return!1;r--}}return!0}class bBe{constructor(e,r,n,i){this.parent=e,this.buffer=r,this.index=n,this.start=i}}class Nu extends Cee{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,n){super(),this.context=e,this._parent=r,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,r,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,r-this.context.start,n);return s<0?null:new Nu(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,r,n=0){if(n&wi.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return s<0?null:new Nu(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Nu(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new Nu(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],r=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let o=n.buffer[this.index+1];e.push(n.slice(i,s,o)),r.push(0)}return new Fr(this.type,e,r,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Tee(t){if(!t.length)return null;let e=0,r=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>r.from||o.to<r.to)&&(r=o,e=s)}let n=r instanceof ra&&r.index<0?null:r.parent,i=t.slice();return n?i[e]=n:i.splice(e,1),new SBe(i,r)}class SBe{constructor(e,r){this.heads=e,this.node=r}get next(){return Tee(this.heads)}}function CBe(t,e,r){let n=t.resolveInner(e,r),i=null;for(let s=n instanceof ra?n:n.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(i||(i=[n])).push(o.resolve(e,r)),s=o}else{let o=Qb.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new ra(o.tree,o.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(Bv(a,e,r,!1))}}return i?Tee(i):n}class PM{get name(){return this.type.name}constructor(e,r=0){if(this.mode=r,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ra)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=r||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof ra?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,r-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,n=this.mode){return this.buffer?n&wi.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&wi.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&wi.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(r.findChild(i,this.index,-1,0,4))}else{let i=r.buffer[this.index+3];if(i<(n<0?r.buffer.length:r.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:r,parent:n}=i)}else({index:r,_parent:n}=this._tree);for(;n;{index:r,_parent:n}=n)if(r>-1)for(let s=r+e,o=e<0?-1:n._tree.children.length;s!=o;s+=e){let a=n._tree.children[s];if(this.mode&wi.IncludeAnonymous||a instanceof Qu||!a.type.isAnonymous||pN(a))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;r=o,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)r=new Nu(this.buffer,r,this.stack[i]);return this.bufferNode=new Nu(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&r&&r(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return DM(this.node.parent,e);let{buffer:r}=this.buffer,{types:n}=r.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return DM(this._tree,e,i);let o=n[r.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function pN(t){return t.children.some(e=>e instanceof Qu||!e.type.isAnonymous||pN(e))}function TBe(t){var e;let{buffer:r,nodeSet:n,maxBufferLength:i=bee,reused:s=[],minRepeatType:o=n.types.length}=t,a=Array.isArray(r)?new dN(r,r.length):r,l=n.types,u=0,h=0;function d(O,P,D,H,N,_){let{id:B,start:j,end:ee,size:oe}=a,re=h,q=u;for(;oe<0;)if(a.next(),oe==-1){let ce=s[B];D.push(ce),H.push(j-O);return}else if(oe==-3){u=B;return}else if(oe==-4){h=B;return}else throw new RangeError(`Unrecognized record size: ${oe}`);let Z=l[B],ve,ie,K=j-O;if(ee-j<=i&&(ie=b(a.pos-P,N))){let ce=new Uint16Array(ie.size-ie.skip),S=a.pos-ie.size,A=ce.length;for(;a.pos>S;)A=C(ie.start,ce,A);ve=new Qu(ce,ee-ie.start,n),K=ie.start-O}else{let ce=a.pos-oe;a.next();let S=[],A=[],M=B>=o?B:-1,L=0,V=ee;for(;a.pos>ce;)M>=0&&a.id==M&&a.size>=0?(a.end<=V-i&&(y(S,A,j,L,a.end,V,M,re,q),L=S.length,V=a.end),a.next()):_>2500?m(j,ce,S,A):d(j,ce,S,A,M,_+1);if(M>=0&&L>0&&L<S.length&&y(S,A,j,L,j,V,M,re,q),S.reverse(),A.reverse(),M>-1&&L>0){let J=g(Z,q);ve=mN(Z,S,A,0,S.length,0,ee-j,J,J)}else ve=x(Z,S,A,ee-j,re-ee,q)}D.push(ve),H.push(K)}function m(O,P,D,H){let N=[],_=0,B=-1;for(;a.pos>P;){let{id:j,start:ee,end:oe,size:re}=a;if(re>4)a.next();else{if(B>-1&&ee<B)break;B<0&&(B=oe-i),N.push(j,ee,oe),_++,a.next()}}if(_){let j=new Uint16Array(_*4),ee=N[N.length-2];for(let oe=N.length-3,re=0;oe>=0;oe-=3)j[re++]=N[oe],j[re++]=N[oe+1]-ee,j[re++]=N[oe+2]-ee,j[re++]=re;D.push(new Qu(j,N[2]-ee,n)),H.push(ee-O)}}function g(O,P){return(D,H,N)=>{let _=0,B=D.length-1,j,ee;if(B>=0&&(j=D[B])instanceof Fr){if(!B&&j.type==O&&j.length==N)return j;(ee=j.prop(Vt.lookAhead))&&(_=H[B]+j.length+ee)}return x(O,D,H,N,_,P)}}function y(O,P,D,H,N,_,B,j,ee){let oe=[],re=[];for(;O.length>H;)oe.push(O.pop()),re.push(P.pop()+D-N);O.push(x(n.types[B],oe,re,_-N,j-_,ee)),P.push(N-D)}function x(O,P,D,H,N,_,B){if(_){let j=[Vt.contextHash,_];B=B?[j].concat(B):[j]}if(N>25){let j=[Vt.lookAhead,N];B=B?[j].concat(B):[j]}return new Fr(O,P,D,H,B)}function b(O,P){let D=a.fork(),H=0,N=0,_=0,B=D.end-i,j={size:0,start:0,skip:0};e:for(let ee=D.pos-O;D.pos>ee;){let oe=D.size;if(D.id==P&&oe>=0){j.size=H,j.start=N,j.skip=_,_+=4,H+=4,D.next();continue}let re=D.pos-oe;if(oe<0||re<ee||D.start<B)break;let q=D.id>=o?4:0,Z=D.start;for(D.next();D.pos>re;){if(D.size<0)if(D.size==-3)q+=4;else break e;else D.id>=o&&(q+=4);D.next()}N=Z,H+=oe,_+=q}return(P<0||H==O)&&(j.size=H,j.start=N,j.skip=_),j.size>4?j:void 0}function C(O,P,D){let{id:H,start:N,end:_,size:B}=a;if(a.next(),B>=0&&H<o){let j=D;if(B>4){let ee=a.pos-(B-4);for(;a.pos>ee;)D=C(O,P,D)}P[--D]=j,P[--D]=_-O,P[--D]=N-O,P[--D]=H}else B==-3?u=H:B==-4&&(h=H);return D}let E=[],R=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,E,R,-1,0);let k=(e=t.length)!==null&&e!==void 0?e:E.length?R[0]+E[0].length:0;return new Fr(l[t.topID],E.reverse(),R.reverse(),k)}const Bz=new WeakMap;function rb(t,e){if(!t.isAnonymous||e instanceof Qu||e.type!=t)return 1;let r=Bz.get(e);if(r==null){r=1;for(let n of e.children){if(n.type!=t||!(n instanceof Fr)){r=1;break}r+=rb(t,n)}Bz.set(e,r)}return r}function mN(t,e,r,n,i,s,o,a,l){let u=0;for(let y=n;y<i;y++)u+=rb(t,e[y]);let h=Math.ceil(u*1.5/8),d=[],m=[];function g(y,x,b,C,E){for(let R=b;R<C;){let k=R,O=x[R],P=rb(t,y[R]);for(R++;R<C;R++){let D=rb(t,y[R]);if(P+D>=h)break;P+=D}if(R==k+1){if(P>h){let D=y[k];g(D.children,D.positions,0,D.children.length,x[k]+E);continue}d.push(y[k])}else{let D=x[R-1]+y[R-1].length-O;d.push(mN(t,y,x,k,R,O,D,null,l))}m.push(O+E-s)}}return g(e,r,n,i,0),(a||l)(d,m,o)}class dh{constructor(e,r,n,i,s=!1,o=!1){this.from=e,this.to=r,this.tree=n,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],n=!1){let i=[new dh(0,e.length,e,0,!1,n)];for(let s of r)s.to>e.length&&i.push(s);return i}static applyChanges(e,r,n=128){if(!r.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,u=0;;a++){let h=a<r.length?r[a]:null,d=h?h.fromA:1e9;if(d-l>=n)for(;o&&o.from<d;){let m=o;if(l>=m.from||d<=m.to||u){let g=Math.max(m.from,l)-u,y=Math.min(m.to,d)-u;m=g>=y?null:new dh(g,y,m.tree,m.offset+u,a>0,!!h)}if(m&&i.push(m),o.to>d)break;o=s<e.length?e[s++]:null}if(!h)break;l=h.toA,u=h.toA-h.toB}return i}}class gN{startParse(e,r,n){return typeof e=="string"&&(e=new EBe(e)),n=n?n.length?n.map(i=>new sO(i.from,i.to)):[new sO(0,0)]:[new sO(0,e.length)],this.createParse(e,r||[],n)}parse(e,r,n){let i=this.startParse(e,r,n);for(;;){let s=i.advance();if(s)return s}}}class EBe{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}}new Vt({perNode:!0});let RBe=0;class Yo{constructor(e,r,n,i){this.name=e,this.set=r,this.base=n,this.modified=i,this.id=RBe++}toString(){let{name:e}=this;for(let r of this.modified)r.name&&(e=`${r.name}(${e})`);return e}static define(e,r){let n=typeof e=="string"?e:"?";if(e instanceof Yo&&(r=e),r!=null&&r.base)throw new Error("Can not derive from a modified tag");let i=new Yo(n,[],null,[]);if(i.set.push(i),r)for(let s of r.set)i.set.push(s);return i}static defineModifier(e){let r=new Zb(e);return n=>n.modified.indexOf(r)>-1?n:Zb.get(n.base||n,n.modified.concat(r).sort((i,s)=>i.id-s.id))}}let ABe=0;class Zb{constructor(e){this.name=e,this.instances=[],this.id=ABe++}static get(e,r){if(!r.length)return e;let n=r[0].instances.find(a=>a.base==e&&kBe(r,a.modified));if(n)return n;let i=[],s=new Yo(e.name,i,e,r);for(let a of r)a.instances.push(s);let o=OBe(r);for(let a of e.set)if(!a.modified.length)for(let l of o)i.push(Zb.get(a,l));return s}}function kBe(t,e){return t.length==e.length&&t.every((r,n)=>r==e[n])}function OBe(t){let e=[[]];for(let r=0;r<t.length;r++)for(let n=0,i=e.length;n<i;n++)e.push(e[n].concat(t[r]));return e.sort((r,n)=>n.length-r.length)}function Eee(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let i of r.split(" "))if(i){let s=[],o=2,a=i;for(let d=0;;){if(a=="..."&&d>0&&d+3==i.length){o=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!m)throw new RangeError("Invalid path: "+i);if(s.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),d+=m[0].length,d==i.length)break;let g=i[d++];if(d==i.length&&g=="!"){o=0;break}if(g!="/")throw new RangeError("Invalid path: "+i);a=i.slice(d)}let l=s.length-1,u=s[l];if(!u)throw new RangeError("Invalid path: "+i);let h=new Jb(n,o,l>0?s.slice(0,l):null);e[u]=h.sort(e[u])}}return Ree.add(e)}const Ree=new Vt;class Jb{constructor(e,r,n,i){this.tags=e,this.mode=r,this.context=n,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Jb.empty=new Jb([],2,null);function Aee(t,e){let r=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))r[s.tag.id]=s.class;else for(let o of s.tag)r[o.id]=s.class;let{scope:n,all:i=null}=e||{};return{style:s=>{let o=i;for(let a of s)for(let l of a.set){let u=r[l.id];if(u){o=o?o+" "+u:u;break}}return o},scope:n}}function _Be(t,e){let r=null;for(let n of t){let i=n.style(e);i&&(r=r?r+" "+i:i)}return r}function MBe(t,e,r,n=0,i=t.length){let s=new DBe(n,Array.isArray(e)?e:[e],r);s.highlightRange(t.cursor(),n,i,"",s.highlighters),s.flush(i)}class DBe{constructor(e,r,n){this.at=e,this.highlighters=r,this.span=n,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,n,i,s){let{type:o,from:a,to:l}=e;if(a>=n||l<=r)return;o.isTop&&(s=this.highlighters.filter(g=>!g.scope||g.scope(o)));let u=i,h=PBe(e)||Jb.empty,d=_Be(s,h.tags);if(d&&(u&&(u+=" "),u+=d,h.mode==1&&(i+=(i?" ":"")+d)),this.startSpan(Math.max(r,a),u),h.opaque)return;let m=e.tree&&e.tree.prop(Vt.mounted);if(m&&m.overlay){let g=e.node.enter(m.overlay[0].from+a,1),y=this.highlighters.filter(b=>!b.scope||b.scope(m.tree.type)),x=e.firstChild();for(let b=0,C=a;;b++){let E=b<m.overlay.length?m.overlay[b]:null,R=E?E.from+a:l,k=Math.max(r,C),O=Math.min(n,R);if(k<O&&x)for(;e.from<O&&(this.highlightRange(e,k,O,i,s),this.startSpan(Math.min(O,e.to),u),!(e.to>=R||!e.nextSibling())););if(!E||R>n)break;C=E.to+a,C>r&&(this.highlightRange(g.cursor(),Math.max(r,E.from+a),Math.min(n,C),"",y),this.startSpan(Math.min(n,C),u))}x&&e.parent()}else if(e.firstChild()){m&&(i="");do if(!(e.to<=r)){if(e.from>=n)break;this.highlightRange(e,r,n,i,s),this.startSpan(Math.min(n,e.to),u)}while(e.nextSibling());e.parent()}}}function PBe(t){let e=t.type.prop(Ree);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const Ve=Yo.define,xw=Ve(),Su=Ve(),Vz=Ve(Su),jz=Ve(Su),Cu=Ve(),ww=Ve(Cu),oO=Ve(Cu),pl=Ve(),Ff=Ve(pl),ul=Ve(),fl=Ve(),IM=Ve(),eg=Ve(IM),bw=Ve(),Te={comment:xw,lineComment:Ve(xw),blockComment:Ve(xw),docComment:Ve(xw),name:Su,variableName:Ve(Su),typeName:Vz,tagName:Ve(Vz),propertyName:jz,attributeName:Ve(jz),className:Ve(Su),labelName:Ve(Su),namespace:Ve(Su),macroName:Ve(Su),literal:Cu,string:ww,docString:Ve(ww),character:Ve(ww),attributeValue:Ve(ww),number:oO,integer:Ve(oO),float:Ve(oO),bool:Ve(Cu),regexp:Ve(Cu),escape:Ve(Cu),color:Ve(Cu),url:Ve(Cu),keyword:ul,self:Ve(ul),null:Ve(ul),atom:Ve(ul),unit:Ve(ul),modifier:Ve(ul),operatorKeyword:Ve(ul),controlKeyword:Ve(ul),definitionKeyword:Ve(ul),moduleKeyword:Ve(ul),operator:fl,derefOperator:Ve(fl),arithmeticOperator:Ve(fl),logicOperator:Ve(fl),bitwiseOperator:Ve(fl),compareOperator:Ve(fl),updateOperator:Ve(fl),definitionOperator:Ve(fl),typeOperator:Ve(fl),controlOperator:Ve(fl),punctuation:IM,separator:Ve(IM),bracket:eg,angleBracket:Ve(eg),squareBracket:Ve(eg),paren:Ve(eg),brace:Ve(eg),content:pl,heading:Ff,heading1:Ve(Ff),heading2:Ve(Ff),heading3:Ve(Ff),heading4:Ve(Ff),heading5:Ve(Ff),heading6:Ve(Ff),contentSeparator:Ve(pl),list:Ve(pl),quote:Ve(pl),emphasis:Ve(pl),strong:Ve(pl),link:Ve(pl),monospace:Ve(pl),strikethrough:Ve(pl),inserted:Ve(),deleted:Ve(),changed:Ve(),invalid:Ve(),meta:bw,documentMeta:Ve(bw),annotation:Ve(bw),processingInstruction:Ve(bw),definition:Yo.defineModifier("definition"),constant:Yo.defineModifier("constant"),function:Yo.defineModifier("function"),standard:Yo.defineModifier("standard"),local:Yo.defineModifier("local"),special:Yo.defineModifier("special")};for(let t in Te){let e=Te[t];e instanceof Yo&&(e.name=t)}Aee([{tag:Te.link,class:"tok-link"},{tag:Te.heading,class:"tok-heading"},{tag:Te.emphasis,class:"tok-emphasis"},{tag:Te.strong,class:"tok-strong"},{tag:Te.keyword,class:"tok-keyword"},{tag:Te.atom,class:"tok-atom"},{tag:Te.bool,class:"tok-bool"},{tag:Te.url,class:"tok-url"},{tag:Te.labelName,class:"tok-labelName"},{tag:Te.inserted,class:"tok-inserted"},{tag:Te.deleted,class:"tok-deleted"},{tag:Te.literal,class:"tok-literal"},{tag:Te.string,class:"tok-string"},{tag:Te.number,class:"tok-number"},{tag:[Te.regexp,Te.escape,Te.special(Te.string)],class:"tok-string2"},{tag:Te.variableName,class:"tok-variableName"},{tag:Te.local(Te.variableName),class:"tok-variableName tok-local"},{tag:Te.definition(Te.variableName),class:"tok-variableName tok-definition"},{tag:Te.special(Te.variableName),class:"tok-variableName2"},{tag:Te.definition(Te.propertyName),class:"tok-propertyName tok-definition"},{tag:Te.typeName,class:"tok-typeName"},{tag:Te.namespace,class:"tok-namespace"},{tag:Te.className,class:"tok-className"},{tag:Te.macroName,class:"tok-macroName"},{tag:Te.propertyName,class:"tok-propertyName"},{tag:Te.operator,class:"tok-operator"},{tag:Te.comment,class:"tok-comment"},{tag:Te.meta,class:"tok-meta"},{tag:Te.invalid,class:"tok-invalid"},{tag:Te.punctuation,class:"tok-punctuation"}]);var aO;const ih=new Vt;function kee(t){return Ke.define({combine:t?e=>e.concat(t):void 0})}const IBe=new Vt;class Xo{constructor(e,r,n=[],i=""){this.data=e,this.name=i,Qt.prototype.hasOwnProperty("tree")||Object.defineProperty(Qt.prototype,"tree",{get(){return Ci(this)}}),this.parser=r,this.extension=[Zu.of(this),Qt.languageData.of((s,o,a)=>{let l=Wz(s,o,a),u=l.type.prop(ih);if(!u)return[];let h=s.facet(u),d=l.type.prop(IBe);if(d){let m=l.resolve(o-l.from,a);for(let g of d)if(g.test(m,s)){let y=s.facet(g.facet);return g.type=="replace"?y:y.concat(h)}}return h})].concat(n)}isActiveAt(e,r,n=-1){return Wz(e,r,n).type.prop(ih)==this.data}findRegions(e){let r=e.facet(Zu);if((r==null?void 0:r.data)==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let n=[],i=(s,o)=>{if(s.prop(ih)==this.data){n.push({from:o,to:o+s.length});return}let a=s.prop(Vt.mounted);if(a){if(a.tree.prop(ih)==this.data){if(a.overlay)for(let l of a.overlay)n.push({from:l.from+o,to:l.to+o});else n.push({from:o,to:o+s.length});return}else if(a.overlay){let l=n.length;if(i(a.tree,a.overlay[0].from+o),n.length>l)return}}for(let l=0;l<s.children.length;l++){let u=s.children[l];u instanceof Fr&&i(u,s.positions[l]+o)}};return i(Ci(e),0),n}get allowsNesting(){return!0}}Xo.setState=Mt.define();function Wz(t,e,r){let n=t.facet(Zu),i=Ci(t).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,r,wi.ExcludeBuffers))s.type.isTop&&(i=s);return i}class eS extends Xo{constructor(e,r,n){super(e,r,[],n),this.parser=r}static define(e){let r=kee(e.languageData);return new eS(r,e.parser.configure({props:[ih.add(n=>n.isTop?r:void 0)]}),e.name)}configure(e,r){return new eS(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ci(t){let e=t.field(Xo.state,!1);return e?e.tree:Fr.empty}class NBe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let n=this.cursorPos-this.string.length;return e<n||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-n,r-n)}}let tg=null;class Jp{constructor(e,r,n=[],i,s,o,a,l){this.parser=e,this.state=r,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,r,n){return new Jp(e,r,[],Fr.empty,0,n,[],null)}startParse(){return this.parser.startParse(new NBe(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=Fr.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(dh.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(dh.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=tg;tg=this;try{return e()}finally{tg=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=zz(e,r.from,r.to);return e}changes(e,r){let{fragments:n,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,h,d,m)=>l.push({fromA:u,toA:h,fromB:d,toB:m})),n=dh.applyChanges(n,l),i=Fr.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let h=e.mapPos(u.from,1),d=e.mapPos(u.to,-1);h<d&&a.push({from:h,to:d})}}}return new Jp(this.parser,r,n,i,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=zz(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends gN{createParse(r,n,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let l=tg;if(l){for(let u of i)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Fr(Cs.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return tg}}function zz(t,e,r){return dh.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}class e0{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,n)||r.takeTree(),new e0(r)}static init(e){let r=Math.min(3e3,e.doc.length),n=Jp.create(e.facet(Zu).parser,e,{from:0,to:r});return n.work(20,r)||n.takeTree(),new e0(n)}}Xo.state=Wi.define({create:e0.init,update(t,e){for(let r of e.effects)if(r.is(Xo.setState))return r.value;return e.startState.facet(Zu)!=e.state.facet(Zu)?e0.init(e.state):t.apply(e)}});let Oee=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Oee=t=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const lO=typeof navigator<"u"&&(!((aO=navigator.scheduling)===null||aO===void 0)&&aO.isInputPending)?()=>navigator.scheduling.isInputPending():null,LBe=Fn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(Xo.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(Xo.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=Oee(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(Xo.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!lO?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<i&&n.doc.length>i+1e3,l=s.context.work(()=>lO&&lO()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-r,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Xo.setState.of(new e0(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>js(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Zu=Ke.define({combine(t){return t.length?t[0]:null},enables:t=>[Xo.state,LBe,$e.contentAttributes.compute([t],e=>{let r=e.facet(t);return r&&r.name?{"data-language":r.name}:{}})]});class FBe{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}}const HBe=Ke.define(),xC=Ke.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function Dh(t){let e=t.facet(xC);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Vv(t,e){let r="",n=t.tabSize,i=t.facet(xC)[0];if(i=="	"){for(;e>=n;)r+="	",e-=n;i=" "}for(let s=0;s<e;s++)r+=i;return r}function vN(t,e){t instanceof Qt&&(t=new wC(t));for(let n of t.state.facet(HBe)){let i=n(t,e);if(i!==void 0)return i}let r=Ci(t.state);return r.length>=e?BBe(t,r,e):null}class wC{constructor(e,r={}){this.state=e,this.options=r,this.unit=Dh(e)}lineAt(e,r=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=n.from&&i<=n.to?s&&i==e?{text:"",from:e}:(r<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,r);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,r=1){let{text:n,from:i}=this.lineAt(e,r),s=this.countColumn(n,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,r=e.length){return b0(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:n,from:i}=this.lineAt(e,r),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const yN=new Vt;function BBe(t,e,r){let n=e.resolveStack(r),i=e.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(i!=n.node){let s=[];for(let o=i;o&&!(o.from<n.node.from||o.to>n.node.to||o.from==n.node.from&&o.type==n.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)n={node:s[o],next:n}}return _ee(n,t,r)}function _ee(t,e,r){for(let n=t;n;n=n.next){let i=jBe(n.node);if(i)return i(xN.create(e,r,n))}return 0}function VBe(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function jBe(t){let e=t.type.prop(yN);if(e)return e;let r=t.firstChild,n;if(r&&(n=r.type.prop(Vt.closedBy))){let i=t.lastChild,s=i&&n.indexOf(i.name)>-1;return o=>$Be(o,!0,1,void 0,s&&!VBe(o)?i.from:void 0)}return t.parent==null?WBe:null}function WBe(){return 0}class xN extends wC{constructor(e,r,n){super(e.state,e.options),this.base=e,this.pos=r,this.context=n}get node(){return this.context.node}static create(e,r,n){return new xN(e,r,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let r=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(r.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(zBe(n,e))break;r=this.state.doc.lineAt(n.from)}return this.lineIndent(r.from)}continue(){return _ee(this.context.next,this.base,this.pos)}}function zBe(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function UBe(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let i=t.options.simulateBreak,s=t.state.doc.lineAt(r.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let a=r.to;;){let l=e.childAfter(a);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let u=/^ */.exec(s.text.slice(r.to-s.from))[0].length;return{from:r.from,to:r.to+u}}a=l.to}}function $Be(t,e,r,n,i){let s=t.textAfter,o=s.match(/^\s*/)[0].length,a=n&&s.slice(o,o+n.length)==n||i==t.pos+o,l=UBe(t);return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*r)}function GBe({except:t,units:e=1}={}){return r=>{let n=t&&t.test(r.textAfter);return r.baseIndent+(n?0:e*r.unit)}}const YBe=200;function qBe(){return Qt.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let r=t.newDoc,{head:n}=t.newSelection.main,i=r.lineAt(n);if(n>i.from+YBe)return t;let s=r.sliceString(i.from,n);if(!e.some(u=>u.test(s)))return t;let{state:o}=t,a=-1,l=[];for(let{head:u}of o.selection.ranges){let h=o.doc.lineAt(u);if(h.from==a)continue;a=h.from;let d=vN(o,h.from);if(d==null)continue;let m=/^\s*/.exec(h.text)[0],g=Vv(o,d);m!=g&&l.push({from:h.from,to:h.from+m.length,insert:g})}return l.length?[t,{changes:l,sequential:!0}]:t})}const KBe=Ke.define(),Mee=new Vt;function XBe(t,e,r){let n=Ci(t);if(n.length<r)return null;let i=n.resolveStack(r,1),s=null;for(let o=i;o;o=o.next){let a=o.node;if(a.to<=r||a.from>r)continue;if(s&&a.from<e)break;let l=a.type.prop(Mee);if(l&&(a.to<n.length-50||n.length==t.doc.length||!QBe(a))){let u=l(a,t);u&&u.from<=r&&u.from>=e&&u.to>r&&(s=u)}}return s}function QBe(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function tS(t,e,r){for(let n of t.facet(KBe)){let i=n(t,e,r);if(i)return i}return XBe(t,e,r)}function Dee(t,e){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return r>=n?void 0:{from:r,to:n}}const bC=Mt.define({map:Dee}),Hy=Mt.define({map:Dee});function Pee(t){let e=[];for(let{head:r}of t.state.selection.ranges)e.some(n=>n.from<=r&&n.to>=r)||e.push(t.lineBlockAt(r));return e}const Ph=Wi.define({create(){return ft.none},update(t,e){t=t.map(e.changes);for(let r of e.effects)if(r.is(bC)&&!ZBe(t,r.value.from,r.value.to)){let{preparePlaceholder:n}=e.state.facet(Lee),i=n?ft.replace({widget:new s5e(n(e.state,r.value))}):Uz;t=t.update({add:[i.range(r.value.from,r.value.to)]})}else r.is(Hy)&&(t=t.update({filter:(n,i)=>r.value.from!=n||r.value.to!=i,filterFrom:r.value.from,filterTo:r.value.to}));if(e.selection){let r=!1,{head:n}=e.selection.main;t.between(n,n,(i,s)=>{i<n&&s>n&&(r=!0)}),r&&(t=t.update({filterFrom:n,filterTo:n,filter:(i,s)=>s<=n||i>=n}))}return t},provide:t=>$e.decorations.from(t),toJSON(t,e){let r=[];return t.between(0,e.doc.length,(n,i)=>{r.push(n,i)}),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<t.length;){let n=t[r++],i=t[r++];if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(Uz.range(n,i))}return ft.set(e,!0)}});function rS(t,e,r){var n;let i=null;return(n=t.field(Ph,!1))===null||n===void 0||n.between(e,r,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function ZBe(t,e,r){let n=!1;return t.between(e,e,(i,s)=>{i==e&&s==r&&(n=!0)}),n}function Iee(t,e){return t.field(Ph,!1)?e:e.concat(Mt.appendConfig.of(Fee()))}const JBe=t=>{for(let e of Pee(t)){let r=tS(t.state,e.from,e.to);if(r)return t.dispatch({effects:Iee(t.state,[bC.of(r),Nee(t,r)])}),!0}return!1},e5e=t=>{if(!t.state.field(Ph,!1))return!1;let e=[];for(let r of Pee(t)){let n=rS(t.state,r.from,r.to);n&&e.push(Hy.of(n),Nee(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function Nee(t,e,r=!0){let n=t.state.doc.lineAt(e.from).number,i=t.state.doc.lineAt(e.to).number;return $e.announce.of(`${t.state.phrase(r?"Folded lines":"Unfolded lines")} ${n} ${t.state.phrase("to")} ${i}.`)}const t5e=t=>{let{state:e}=t,r=[];for(let n=0;n<e.doc.length;){let i=t.lineBlockAt(n),s=tS(e,i.from,i.to);s&&r.push(bC.of(s)),n=(s?t.lineBlockAt(s.to):i).to+1}return r.length&&t.dispatch({effects:Iee(t.state,r)}),!!r.length},r5e=t=>{let e=t.state.field(Ph,!1);if(!e||!e.size)return!1;let r=[];return e.between(0,t.state.doc.length,(n,i)=>{r.push(Hy.of({from:n,to:i}))}),t.dispatch({effects:r}),!0},n5e=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:JBe},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e5e},{key:"Ctrl-Alt-[",run:t5e},{key:"Ctrl-Alt-]",run:r5e}],i5e={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},Lee=Ke.define({combine(t){return $l(t,i5e)}});function Fee(t){return[Ph,l5e]}function Hee(t,e){let{state:r}=t,n=r.facet(Lee),i=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=rS(t.state,a.from,a.to);l&&t.dispatch({effects:Hy.of(l)}),o.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,i,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",r.phrase("folded code")),s.title=r.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const Uz=ft.replace({widget:new class extends Uc{toDOM(t){return Hee(t,null)}}});class s5e extends Uc{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Hee(e,this.value)}}const o5e={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class cO extends Hc{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}}function a5e(t={}){let e={...o5e,...t},r=new cO(e,!0),n=new cO(e,!1),i=Fn.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Zu)!=o.state.facet(Zu)||o.startState.field(Ph,!1)!=o.state.field(Ph,!1)||Ci(o.startState)!=Ci(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new Lc;for(let l of o.viewportLineBlocks){let u=rS(o.state,l.from,l.to)?n:tS(o.state,l.from,l.to)?r:null;u&&a.add(l.from,l.from,u)}return a.finish()}}),{domEventHandlers:s}=e;return[i,lBe({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(i))===null||a===void 0?void 0:a.markers)||lr.empty},initialSpacer(){return new cO(e,!1)},domEventHandlers:{...s,click:(o,a,l)=>{if(s.click&&s.click(o,a,l))return!0;let u=rS(o.state,a.from,a.to);if(u)return o.dispatch({effects:Hy.of(u)}),!0;let h=tS(o.state,a.from,a.to);return h?(o.dispatch({effects:bC.of(h)}),!0):!1}}}),Fee()]}const l5e=$e.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class By{constructor(e,r){this.specs=e;let n;function i(a){let l=qu.newName();return(n||(n=Object.create(null)))["."+l]=a,l}const s=typeof r.all=="string"?r.all:r.all?i(r.all):void 0,o=r.scope;this.scope=o instanceof Xo?a=>a.prop(ih)==o.data:o?a=>a==o:void 0,this.style=Aee(e.map(a=>({tag:a.tag,class:a.class||i(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=n?new qu(n):null,this.themeType=r.themeType}static define(e,r){return new By(e,r||{})}}const NM=Ke.define(),Bee=Ke.define({combine(t){return t.length?[t[0]]:null}});function uO(t){let e=t.facet(NM);return e.length?e:t.facet(Bee)}function Vee(t,e){let r=[u5e],n;return t instanceof By&&(t.module&&r.push($e.styleModule.of(t.module)),n=t.themeType),e!=null&&e.fallback?r.push(Bee.of(t)):n?r.push(NM.computeN([$e.darkTheme],i=>i.facet($e.darkTheme)==(n=="dark")?[t]:[])):r.push(NM.of(t)),r}class c5e{constructor(e){this.markCache=Object.create(null),this.tree=Ci(e.state),this.decorations=this.buildDeco(e,uO(e.state)),this.decoratedTo=e.viewport.to}update(e){let r=Ci(e.state),n=uO(e.state),i=n!=uO(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);r.length<s.to&&!i&&r.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(r!=this.tree||e.viewportChanged||i)&&(this.tree=r,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,r){if(!r||!this.tree.length)return ft.none;let n=new Lc;for(let{from:i,to:s}of e.visibleRanges)MBe(this.tree,r,(o,a,l)=>{n.add(o,a,this.markCache[l]||(this.markCache[l]=ft.mark({class:l})))},i,s);return n.finish()}}const u5e=Xh.high(Fn.fromClass(c5e,{decorations:t=>t.decorations})),f5e=By.define([{tag:Te.meta,color:"#404740"},{tag:Te.link,textDecoration:"underline"},{tag:Te.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Te.emphasis,fontStyle:"italic"},{tag:Te.strong,fontWeight:"bold"},{tag:Te.strikethrough,textDecoration:"line-through"},{tag:Te.keyword,color:"#708"},{tag:[Te.atom,Te.bool,Te.url,Te.contentSeparator,Te.labelName],color:"#219"},{tag:[Te.literal,Te.inserted],color:"#164"},{tag:[Te.string,Te.deleted],color:"#a11"},{tag:[Te.regexp,Te.escape,Te.special(Te.string)],color:"#e40"},{tag:Te.definition(Te.variableName),color:"#00f"},{tag:Te.local(Te.variableName),color:"#30a"},{tag:[Te.typeName,Te.namespace],color:"#085"},{tag:Te.className,color:"#167"},{tag:[Te.special(Te.variableName),Te.macroName],color:"#256"},{tag:Te.definition(Te.propertyName),color:"#00c"},{tag:Te.comment,color:"#940"},{tag:Te.invalid,color:"#f00"}]),h5e=$e.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),jee=1e4,Wee="()[]{}",zee=Ke.define({combine(t){return $l(t,{afterCursor:!0,brackets:Wee,maxScanDistance:jee,renderMatch:m5e})}}),d5e=ft.mark({class:"cm-matchingBracket"}),p5e=ft.mark({class:"cm-nonmatchingBracket"});function m5e(t){let e=[],r=t.matched?d5e:p5e;return e.push(r.range(t.start.from,t.start.to)),t.end&&e.push(r.range(t.end.from,t.end.to)),e}const g5e=Wi.define({create(){return ft.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let r=[],n=e.state.facet(zee);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=Tl(e.state,i.head,-1,n)||i.head>0&&Tl(e.state,i.head-1,1,n)||n.afterCursor&&(Tl(e.state,i.head,1,n)||i.head<e.state.doc.length&&Tl(e.state,i.head+1,-1,n));s&&(r=r.concat(n.renderMatch(s,e.state)))}return ft.set(r,!0)},provide:t=>$e.decorations.from(t)}),v5e=[g5e,h5e];function y5e(t={}){return[zee.of(t),v5e]}const x5e=new Vt;function LM(t,e,r){let n=t.prop(e<0?Vt.openedBy:Vt.closedBy);if(n)return n;if(t.name.length==1){let i=r.indexOf(t.name);if(i>-1&&i%2==(e<0?1:0))return[r[i+e]]}return null}function FM(t){let e=t.type.prop(x5e);return e?e(t.node):t}function Tl(t,e,r,n={}){let i=n.maxScanDistance||jee,s=n.brackets||Wee,o=Ci(t),a=o.resolveInner(e,r);for(let l=a;l;l=l.parent){let u=LM(l.type,r,s);if(u&&l.from<l.to){let h=FM(l);if(h&&(r>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return w5e(t,e,r,l,h,u,s)}}return b5e(t,e,r,o,a.type,i,s)}function w5e(t,e,r,n,i,s,o){let a=n.parent,l={from:i.from,to:i.to},u=0,h=a==null?void 0:a.cursor();if(h&&(r<0?h.childBefore(n.from):h.childAfter(n.to)))do if(r<0?h.to<=n.from:h.from>=n.to){if(u==0&&s.indexOf(h.type.name)>-1&&h.from<h.to){let d=FM(h);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(LM(h.type,r,o))u++;else if(LM(h.type,-r,o)){if(u==0){let d=FM(h);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}u--}}while(r<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function b5e(t,e,r,n,i,s,o){let a=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=r>0)return null;let u={from:r<0?e-1:e,to:r>0?e+1:e},h=t.doc.iterRange(e,r>0?t.doc.length:0),d=0;for(let m=0;!h.next().done&&m<=s;){let g=h.value;r<0&&(m+=g.length);let y=e+m*r;for(let x=r>0?0:g.length-1,b=r>0?g.length:-1;x!=b;x+=r){let C=o.indexOf(g[x]);if(!(C<0||n.resolveInner(y+x,1).type!=i))if(C%2==0==r>0)d++;else{if(d==1)return{start:u,end:{from:y+x,to:y+x+1},matched:C>>1==l>>1};d--}}r>0&&(m+=g.length)}return h.done?{start:u,matched:!1}:null}function $z(t,e,r,n=0,i=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=i;for(let o=n;o<e;o++)t.charCodeAt(o)==9?s+=r-s%r:s++;return s}class Uee{constructor(e,r,n,i){this.string=e,this.tabSize=r,this.indentUnit=n,this.overrideIndent=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let r=this.string.charAt(this.pos),n;if(typeof e=="string"?n=r==e:n=r&&(e instanceof RegExp?e.test(r):e(r)),n)return++this.pos,r}eatWhile(e){let r=this.pos;for(;this.eat(e););return this.pos>r}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let r=this.string.indexOf(e,this.pos);if(r>-1)return this.pos=r,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=$z(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:$z(this.string,null,this.tabSize)}match(e,r,n){if(typeof e=="string"){let i=o=>n?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return i(s)==i(e)?(r!==!1&&(this.pos+=e.length),!0):null}else{let i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&r!==!1&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}}function S5e(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||C5e,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||bN,mergeTokens:t.mergeTokens!==!1}}function C5e(t){if(typeof t!="object")return t;let e={};for(let r in t){let n=t[r];e[r]=n instanceof Array?n.slice():n}return e}const Gz=new WeakMap;class nS extends Xo{constructor(e){let r=kee(e.languageData),n=S5e(e),i,s=new class extends gN{createParse(o,a,l){return new E5e(i,o,a,l)}};super(r,s,[],e.name),this.topNode=k5e(r,this),i=this,this.streamParser=n,this.stateAfter=new Vt({perNode:!0}),this.tokenTable=e.tokenTable?new qee(n.tokenTable):A5e}static define(e){return new nS(e)}getIndent(e){let r,{overrideIndentation:n}=e.options;n&&(r=Gz.get(e.state),r!=null&&r<e.pos-1e4&&(r=void 0));let i=wN(this,e.node.tree,e.node.from,e.node.from,r??e.pos),s,o;if(i?(o=i.state,s=i.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let l=e.state.doc.lineAt(s),u=Math.min(e.pos,l.to);if(l.length){let h=n?n(l.from):-1,d=new Uee(l.text,e.state.tabSize,e.unit,h<0?void 0:h);for(;d.pos<u-l.from;)Gee(this.streamParser.token,d,o)}else this.streamParser.blankLine(o,e.unit);if(u==e.pos)break;s=l.to+1}let a=e.lineAt(e.pos);return n&&r==null&&Gz.set(e.state,a.from),this.streamParser.indent(o,/^\s*(.*)/.exec(a.text)[1],e)}get allowsNesting(){return!1}}function wN(t,e,r,n,i){let s=r>=n&&r+e.length<=i&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:r+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=r+e.positions[o],u=a instanceof Fr&&l<i&&wN(t,a,l,n,i);if(u)return u}return null}function $ee(t,e,r,n,i){if(i&&r<=0&&n>=e.length)return e;!i&&r==0&&e.type==t.topNode&&(i=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<n&&a instanceof Fr){if(!(l=$ee(t,a,r-o,n-o,i)))break;return i?new Fr(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function T5e(t,e,r,n,i){for(let s of e){let o=s.from+(s.openStart?25:0),a=s.to-(s.openEnd?25:0),l=o<=r&&a>r&&wN(t,s.tree,0-s.offset,r,a),u;if(l&&l.pos<=n&&(u=$ee(t,s.tree,r+s.offset,l.pos+s.offset,!1)))return{state:l.state,tree:u}}return{state:t.streamParser.startState(i?Dh(i):4),tree:Fr.empty}}let E5e=class{constructor(e,r,n,i){this.lang=e,this.input=r,this.fragments=n,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let s=Jp.get(),o=i[0].from,{state:a,tree:l}=T5e(e,n,o,this.to,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);s&&this.parsedPos<s.viewport.from-1e5&&i.some(u=>u.from<=s.viewport.from&&u.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(Dh(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=Jp.get(),r=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(r,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=r?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,r),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let r=this.input.chunk(e);if(this.input.lineChunks)r==`
`&&(r="");else{let n=r.indexOf(`
`);n>-1&&(r=r.slice(0,n))}return e+r.length<=this.to?r:r.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,r=this.lineAfter(e),n=e+r.length;for(let i=this.rangeIndex;;){let s=this.ranges[i].to;if(s>=n||(r=r.slice(0,s-(n-r.length)),i++,i==this.ranges.length))break;let o=this.ranges[i].from,a=this.lineAfter(o);r+=a,n=o+a.length}return{line:r,end:n}}skipGapsTo(e,r,n){for(;;){let i=this.ranges[this.rangeIndex].to,s=e+r;if(n>0?i>s:i>=s)break;let o=this.ranges[++this.rangeIndex].from;r+=o-i}return r}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,r,n,i){let s=4;if(this.ranges.length>1){i=this.skipGapsTo(r,i,1),r+=i;let a=this.chunk.length;i=this.skipGapsTo(n,i,-1),n+=i,s+=this.chunk.length-a}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==r?this.chunk[o+2]=n:this.chunk.push(e,r,n,s),i}parseLine(e){let{line:r,end:n}=this.nextLine(),i=0,{streamParser:s}=this.lang,o=new Uee(r,e?e.state.tabSize:4,e?Dh(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=Gee(s.token,o,this.state);if(a&&(i=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,i)),o.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Fr.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:R5e,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Fr(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Fr(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function Gee(t,e,r){e.start=e.pos;for(let n=0;n<10;n++){let i=t(e,r);if(e.pos>e.start)return i}throw new Error("Stream parser failed to advance stream.")}const bN=Object.create(null),jv=[Cs.none],R5e=new yC(jv),Yz=[],qz=Object.create(null),Yee=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Yee[t]=Kee(bN,e);class qee{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Yee)}resolve(e){return e?this.table[e]||(this.table[e]=Kee(this.extra,e)):0}}const A5e=new qee(bN);function fO(t,e){Yz.indexOf(t)>-1||(Yz.push(t),console.warn(e))}function Kee(t,e){let r=[];for(let a of e.split(" ")){let l=[];for(let u of a.split(".")){let h=t[u]||Te[u];h?typeof h=="function"?l.length?l=l.map(h):fO(u,`Modifier ${u} used at start of tag`):l.length?fO(u,`Tag ${u} used as modifier`):l=Array.isArray(h)?h:[h]:fO(u,`Unknown highlighting tag ${u}`)}for(let u of l)r.push(u)}if(!r.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+r.map(a=>a.id),s=qz[i];if(s)return s.id;let o=qz[i]=Cs.define({id:jv.length,name:n,props:[Eee({[n]:r})]});return jv.push(o),o.id}function k5e(t,e){let r=Cs.define({id:jv.length,name:"Document",props:[ih.add(()=>t),yN.add(()=>n=>e.getIndent(n))],top:!0});return jv.push(r),r}en.RTL,en.LTR;const O5e=t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=CN(t.state,r.from);return n.line?_5e(t):n.block?D5e(t):!1};function SN(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let i=t(e,r);return i?(n(r.update(i)),!0):!1}}const _5e=SN(N5e,0),M5e=SN(Xee,0),D5e=SN((t,e)=>Xee(t,e,I5e(e)),0);function CN(t,e){let r=t.languageDataAt("commentTokens",e,1);return r.length?r[0]:{}}const rg=50;function P5e(t,{open:e,close:r},n,i){let s=t.sliceDoc(n-rg,n),o=t.sliceDoc(i,i+rg),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,u=s.length-a;if(s.slice(u-e.length,u)==e&&o.slice(l,l+r.length)==r)return{open:{pos:n-a,margin:a&&1},close:{pos:i+l,margin:l&&1}};let h,d;i-n<=2*rg?h=d=t.sliceDoc(n,i):(h=t.sliceDoc(n,n+rg),d=t.sliceDoc(i-rg,i));let m=/^\s*/.exec(h)[0].length,g=/\s*$/.exec(d)[0].length,y=d.length-g-r.length;return h.slice(m,m+e.length)==e&&d.slice(y,y+r.length)==r?{open:{pos:n+m+e.length,margin:/\s/.test(h.charAt(m+e.length))?1:0},close:{pos:i-g-r.length,margin:/\s/.test(d.charAt(y-1))?1:0}}:null}function I5e(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),i=r.to<=n.to?n:t.doc.lineAt(r.to);i.from>n.from&&i.from==r.to&&(i=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=i.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return e}function Xee(t,e,r=e.selection.ranges){let n=r.map(s=>CN(e,s.from).block);if(!n.every(s=>s))return null;let i=r.map((s,o)=>P5e(e,n[o],s.from,s.to));if(t!=2&&!i.every(s=>s))return{changes:e.changes(r.map((s,o)=>i[o]?[]:[{from:s.from,insert:n[o].open+" "},{from:s.to,insert:" "+n[o].close}]))};if(t!=1&&i.some(s=>s)){let s=[];for(let o=0,a;o<i.length;o++)if(a=i[o]){let l=n[o],{open:u,close:h}=a;s.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:h.pos-h.margin,to:h.pos+l.close.length})}return{changes:s}}return null}function N5e(t,e,r=e.selection.ranges){let n=[],i=-1;for(let{from:s,to:o}of r){let a=n.length,l=1e9,u=CN(e,s).line;if(u){for(let h=s;h<=o;){let d=e.doc.lineAt(h);if(d.from>i&&(s==o||o>d.from)){i=d.from;let m=/^\s*/.exec(d.text)[0].length,g=m==d.length,y=d.text.slice(m,m+u.length)==u?m:-1;m<d.text.length&&m<l&&(l=m),n.push({line:d,comment:y,token:u,indent:m,empty:g,single:!1})}h=d.to+1}if(l<1e9)for(let h=a;h<n.length;h++)n[h].indent<n[h].line.text.length&&(n[h].indent=l);n.length==a+1&&(n[a].single=!0)}}if(t!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:u,empty:h,single:d}of n)(d||!h)&&s.push({from:a.from+u,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of n)if(a>=0){let u=o.from+a,h=u+l.length;o.text[h-o.from]==" "&&h++,s.push({from:u,to:h})}return{changes:s}}return null}const HM=Ul.define(),L5e=Ul.define(),F5e=Ke.define(),Qee=Ke.define({combine(t){return $l(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(n,i)=>e(n,i)||r(n,i)})}}),Zee=Wi.define({create(){return El.empty},update(t,e){let r=e.state.facet(Qee),n=e.annotation(HM);if(n){let l=Ws.fromTransaction(e,n.selection),u=n.side,h=u==0?t.undone:t.done;return l?h=iS(h,h.length,r.minDepth,l):h=tte(h,e.startState.selection),new El(u==0?n.rest:h,u==0?h:n.rest)}let i=e.annotation(L5e);if((i=="full"||i=="before")&&(t=t.isolate()),e.annotation(hi.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=Ws.fromTransaction(e),o=e.annotation(hi.time),a=e.annotation(hi.userEvent);return s?t=t.addChanges(s,o,a,r,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,r.newGroupDelay)),(i=="full"||i=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new El(t.done.map(Ws.fromJSON),t.undone.map(Ws.fromJSON))}});function H5e(t={}){return[Zee,Qee.of(t),$e.domEventHandlers({beforeinput(e,r){let n=e.inputType=="historyUndo"?Jee:e.inputType=="historyRedo"?BM:null;return n?(e.preventDefault(),n(r)):!1}})]}function SC(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let i=r.field(Zee,!1);if(!i)return!1;let s=i.pop(t,r,e);return s?(n(s),!0):!1}}const Jee=SC(0,!1),BM=SC(1,!1),B5e=SC(0,!0),V5e=SC(1,!0);class Ws{constructor(e,r,n,i,s){this.changes=e,this.effects=r,this.mapped=n,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new Ws(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new Ws(e.changes&&ci.fromJSON(e.changes),[],e.mapped&&Dl.fromJSON(e.mapped),e.startSelection&&Pe.fromJSON(e.startSelection),e.selectionsAfter.map(Pe.fromJSON))}static fromTransaction(e,r){let n=Qo;for(let i of e.startState.facet(F5e)){let s=i(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new Ws(e.changes.invert(e.startState.doc),n,void 0,r||e.startState.selection,Qo)}static selection(e){return new Ws(void 0,Qo,void 0,void 0,e)}}function iS(t,e,r,n){let i=e+1>r+20?e-r-1:0,s=t.slice(i,e);return s.push(n),s}function j5e(t,e){let r=[],n=!1;return t.iterChangedRanges((i,s)=>r.push(i,s)),e.iterChangedRanges((i,s,o,a)=>{for(let l=0;l<r.length;){let u=r[l++],h=r[l++];a>=u&&o<=h&&(n=!0)}}),n}function W5e(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((r,n)=>r.empty!=e.ranges[n].empty).length===0}function ete(t,e){return t.length?e.length?t.concat(e):t:e}const Qo=[],z5e=200;function tte(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-z5e));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),iS(t,t.length-1,1e9,r.setSelAfter(n)))}else return[Ws.selection([e])]}function U5e(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function hO(t,e){if(!t.length)return t;let r=t.length,n=Qo;for(;r;){let i=$5e(t[r-1],e,n);if(i.changes&&!i.changes.empty||i.effects.length){let s=t.slice(0,r);return s[r-1]=i,s}else e=i.mapped,r--,n=i.selectionsAfter}return n.length?[Ws.selection(n)]:Qo}function $5e(t,e,r){let n=ete(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):Qo,r);if(!t.changes)return Ws.selection(n);let i=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new Ws(i,Mt.mapEffects(t.effects,e),o,t.startSelection.map(s),n)}const G5e=/^(input\.type|delete)($|\.)/;class El{constructor(e,r,n=0,i=void 0){this.done=e,this.undone=r,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new El(this.done,this.undone):this}addChanges(e,r,n,i,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!n||G5e.test(n))&&(!a.selectionsAfter.length&&r-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,j5e(a.changes,e.changes))||n=="input.type.compose")?o=iS(o,o.length-1,i.minDepth,new Ws(e.changes.compose(a.changes),ete(Mt.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,Qo)):o=iS(o,o.length,i.minDepth,e),new El(o,Qo,r,n)}addSelection(e,r,n,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Qo;return s.length>0&&r-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&W5e(s[s.length-1],e)?this:new El(tte(this.done,e),this.undone,r,n)}addMapping(e){return new El(hO(this.done,e),hO(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,n){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],o=s.selectionsAfter[0]||r.selection;if(n&&s.selectionsAfter.length)return r.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:HM.of({side:e,rest:U5e(i),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=i.length==1?Qo:i.slice(0,i.length-1);return s.mapped&&(a=hO(a,s.mapped)),r.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:HM.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}El.empty=new El(Qo,Qo);const Y5e=[{key:"Mod-z",run:Jee,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:BM,preventDefault:!0},{linux:"Ctrl-Shift-z",run:BM,preventDefault:!0},{key:"Mod-u",run:B5e,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:V5e,preventDefault:!0}];function S0(t,e){return Pe.create(t.ranges.map(e),t.mainIndex)}function Gl(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Ka({state:t,dispatch:e},r){let n=S0(t.selection,r);return n.eq(t.selection,!0)?!1:(e(Gl(t,n)),!0)}function CC(t,e){return Pe.cursor(e?t.to:t.from)}function rte(t,e){return Ka(t,r=>r.empty?t.moveByChar(r,e):CC(r,e))}function as(t){return t.textDirectionAt(t.state.selection.main.head)==en.LTR}const nte=t=>rte(t,!as(t)),ite=t=>rte(t,as(t));function ste(t,e){return Ka(t,r=>r.empty?t.moveByGroup(r,e):CC(r,e))}const q5e=t=>ste(t,!as(t)),K5e=t=>ste(t,as(t));function X5e(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function TC(t,e,r){let n=Ci(t).resolveInner(e.head),i=r?Vt.closedBy:Vt.openedBy;for(let l=e.head;;){let u=r?n.childAfter(l):n.childBefore(l);if(!u)break;X5e(t,u,i)?n=u:l=r?u.to:u.from}let s=n.type.prop(i),o,a;return s&&(o=r?Tl(t,n.from,1):Tl(t,n.to,-1))&&o.matched?a=r?o.end.to:o.end.from:a=r?n.to:n.from,Pe.cursor(a,r?-1:1)}const Q5e=t=>Ka(t,e=>TC(t.state,e,!as(t))),Z5e=t=>Ka(t,e=>TC(t.state,e,as(t)));function ote(t,e){return Ka(t,r=>{if(!r.empty)return CC(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}const ate=t=>ote(t,!1),lte=t=>ote(t,!0);function cte(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,r=0,n=0,i;if(e){for(let s of t.state.facet($e.scrollMargins)){let o=s(t);o!=null&&o.top&&(r=Math.max(o==null?void 0:o.top,r)),o!=null&&o.bottom&&(n=Math.max(o==null?void 0:o.bottom,n))}i=t.scrollDOM.clientHeight-r-n}else i=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,i-5)}}function ute(t,e){let r=cte(t),{state:n}=t,i=S0(n.selection,o=>o.empty?t.moveVertically(o,e,r.height):CC(o,e));if(i.eq(n.selection))return!1;let s;if(r.selfScroll){let o=t.coordsAtPos(n.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+r.marginTop,u=a.bottom-r.marginBottom;o&&o.top>l&&o.bottom<u&&(s=$e.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(Gl(n,i),{effects:s}),!0}const Kz=t=>ute(t,!1),VM=t=>ute(t,!0);function of(t,e,r){let n=t.lineBlockAt(e.head),i=t.moveToLineBoundary(e,r);if(i.head==e.head&&i.head!=(r?n.to:n.from)&&(i=t.moveToLineBoundary(e,r,!1)),!r&&i.head==n.from&&n.length){let s=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(i=Pe.cursor(n.from+s))}return i}const J5e=t=>Ka(t,e=>of(t,e,!0)),e6e=t=>Ka(t,e=>of(t,e,!1)),t6e=t=>Ka(t,e=>of(t,e,!as(t))),r6e=t=>Ka(t,e=>of(t,e,as(t))),n6e=t=>Ka(t,e=>Pe.cursor(t.lineBlockAt(e.head).from,1)),i6e=t=>Ka(t,e=>Pe.cursor(t.lineBlockAt(e.head).to,-1));function s6e(t,e,r){let n=!1,i=S0(t.selection,s=>{let o=Tl(t,s.head,-1)||Tl(t,s.head,1)||s.head>0&&Tl(t,s.head-1,1)||s.head<t.doc.length&&Tl(t,s.head+1,-1);if(!o||!o.end)return s;n=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return Pe.cursor(a)});return n?(e(Gl(t,i)),!0):!1}const o6e=({state:t,dispatch:e})=>s6e(t,e);function ma(t,e){let r=S0(t.state.selection,n=>{let i=e(n);return Pe.range(n.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return r.eq(t.state.selection)?!1:(t.dispatch(Gl(t.state,r)),!0)}function fte(t,e){return ma(t,r=>t.moveByChar(r,e))}const hte=t=>fte(t,!as(t)),dte=t=>fte(t,as(t));function pte(t,e){return ma(t,r=>t.moveByGroup(r,e))}const a6e=t=>pte(t,!as(t)),l6e=t=>pte(t,as(t)),c6e=t=>ma(t,e=>TC(t.state,e,!as(t))),u6e=t=>ma(t,e=>TC(t.state,e,as(t)));function mte(t,e){return ma(t,r=>t.moveVertically(r,e))}const gte=t=>mte(t,!1),vte=t=>mte(t,!0);function yte(t,e){return ma(t,r=>t.moveVertically(r,e,cte(t).height))}const Xz=t=>yte(t,!1),Qz=t=>yte(t,!0),f6e=t=>ma(t,e=>of(t,e,!0)),h6e=t=>ma(t,e=>of(t,e,!1)),d6e=t=>ma(t,e=>of(t,e,!as(t))),p6e=t=>ma(t,e=>of(t,e,as(t))),m6e=t=>ma(t,e=>Pe.cursor(t.lineBlockAt(e.head).from)),g6e=t=>ma(t,e=>Pe.cursor(t.lineBlockAt(e.head).to)),Zz=({state:t,dispatch:e})=>(e(Gl(t,{anchor:0})),!0),Jz=({state:t,dispatch:e})=>(e(Gl(t,{anchor:t.doc.length})),!0),e7=({state:t,dispatch:e})=>(e(Gl(t,{anchor:t.selection.main.anchor,head:0})),!0),t7=({state:t,dispatch:e})=>(e(Gl(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),v6e=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),y6e=({state:t,dispatch:e})=>{let r=EC(t).map(({from:n,to:i})=>Pe.range(n,Math.min(i+1,t.doc.length)));return e(t.update({selection:Pe.create(r),userEvent:"select"})),!0},x6e=({state:t,dispatch:e})=>{let r=S0(t.selection,n=>{let i=Ci(t),s=i.resolveStack(n.from,1);if(n.empty){let o=i.resolveStack(n.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:a}=o;if((a.from<n.from&&a.to>=n.to||a.to>n.to&&a.from<=n.from)&&o.next)return Pe.range(a.to,a.from)}return n});return r.eq(t.selection)?!1:(e(Gl(t,r)),!0)},w6e=({state:t,dispatch:e})=>{let r=t.selection,n=null;return r.ranges.length>1?n=Pe.create([r.main]):r.main.empty||(n=Pe.create([Pe.cursor(r.main.head)])),n?(e(Gl(t,n)),!0):!1};function Vy(t,e){if(t.state.readOnly)return!1;let r="delete.selection",{state:n}=t,i=n.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(r="delete.backward",l=Sw(t,l,!1)):l>o&&(r="delete.forward",l=Sw(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=Sw(t,o,!1),a=Sw(t,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:Pe.cursor(o,o<s.head?-1:1)}});return i.changes.empty?!1:(t.dispatch(n.update(i,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?$e.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Sw(t,e,r){if(t instanceof $e)for(let n of t.state.facet($e.atomicRanges).map(i=>i(t)))n.between(e,e,(i,s)=>{i<e&&s>e&&(e=r?s:i)});return e}const xte=(t,e,r)=>Vy(t,n=>{let i=n.from,{state:s}=t,o=s.doc.lineAt(i),a,l;if(r&&!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,i-o.from))){if(a[a.length-1]=="	")return i-1;let u=b0(a,s.tabSize),h=u%Dh(s)||Dh(s);for(let d=0;d<h&&a[a.length-1-d]==" ";d++)i--;l=i}else l=Hi(o.text,i-o.from,e,e)+o.from,l==i&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,i-o.from))&&(l=Hi(o.text,l-o.from,!1,!1)+o.from);return l}),jM=t=>xte(t,!1,!0),wte=t=>xte(t,!0,!1),bte=(t,e)=>Vy(t,r=>{let n=r.head,{state:i}=t,s=i.doc.lineAt(n),o=i.charCategorizer(n);for(let a=null;;){if(n==(e?s.to:s.from)){n==r.head&&s.number!=(e?i.doc.lines:1)&&(n+=e?1:-1);break}let l=Hi(s.text,n-s.from,e)+s.from,u=s.text.slice(Math.min(n,l)-s.from,Math.max(n,l)-s.from),h=o(u);if(a!=null&&h!=a)break;(u!=" "||n!=r.head)&&(a=h),n=l}return n}),Ste=t=>bte(t,!1),b6e=t=>bte(t,!0),S6e=t=>Vy(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),C6e=t=>Vy(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)}),T6e=t=>Vy(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),E6e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:cr.of(["",""])},range:Pe.cursor(n.from)}));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},R6e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{if(!n.empty||n.from==0||n.from==t.doc.length)return{range:n};let i=n.from,s=t.doc.lineAt(i),o=i==s.from?i-1:Hi(s.text,i-s.from,!1)+s.from,a=i==s.to?i+1:Hi(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:t.doc.slice(i,a).append(t.doc.slice(o,i))},range:Pe.cursor(a)}});return r.changes.empty?!1:(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function EC(t){let e=[],r=-1;for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=t.doc.lineAt(n.to-1)),r>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(n)}else e.push({from:i.from,to:s.to,ranges:[n]});r=s.number+1}return e}function Cte(t,e,r){if(t.readOnly)return!1;let n=[],i=[];for(let s of EC(t)){if(r?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(r?s.to+1:s.from-1),a=o.length+1;if(r){n.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let l of s.ranges)i.push(Pe.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{n.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let l of s.ranges)i.push(Pe.range(l.anchor-a,l.head-a))}}return n.length?(e(t.update({changes:n,scrollIntoView:!0,selection:Pe.create(i,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const A6e=({state:t,dispatch:e})=>Cte(t,e,!1),k6e=({state:t,dispatch:e})=>Cte(t,e,!0);function Tte(t,e,r){if(t.readOnly)return!1;let n=[];for(let i of EC(t))r?n.push({from:i.from,insert:t.doc.slice(i.from,i.to)+t.lineBreak}):n.push({from:i.to,insert:t.lineBreak+t.doc.slice(i.from,i.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const O6e=({state:t,dispatch:e})=>Tte(t,e,!1),_6e=({state:t,dispatch:e})=>Tte(t,e,!0),M6e=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(EC(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),n=S0(e.selection,i=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(i.head),a=t.coordsAtPos(i.head,i.assoc||1);a&&(s=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(i,!0,s)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function D6e(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=Ci(t).resolveInner(e),n=r.childBefore(e),i=r.childAfter(e),s;return n&&i&&n.to<=e&&i.from>=e&&(s=n.type.prop(Vt.closedBy))&&s.indexOf(i.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(i.from).from&&!/\S/.test(t.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}const r7=Ete(!1),P6e=Ete(!0);function Ete(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(i=>{let{from:s,to:o}=i,a=e.doc.lineAt(s),l=!t&&s==o&&D6e(e,s);t&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let u=new wC(e,{simulateBreak:s,simulateDoubleBreak:!!l}),h=vN(u,s);for(h==null&&(h=b0(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",Vv(e,h)];return l&&d.push(Vv(e,u.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:cr.of(d)},range:Pe.cursor(s+1+d[1].length)}});return r(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function TN(t,e){let r=-1;return t.changeByRange(n=>{let i=[];for(let o=n.from;o<=n.to;){let a=t.doc.lineAt(o);a.number>r&&(n.empty||n.to>a.from)&&(e(a,i,n),r=a.number),o=a.to+1}let s=t.changes(i);return{changes:i,range:Pe.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}const I6e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new wC(t,{overrideIndentation:s=>{let o=r[s];return o??-1}}),i=TN(t,(s,o,a)=>{let l=vN(n,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let u=/^\s*/.exec(s.text)[0],h=Vv(t,l);(u!=h||a.from<s.from+u.length)&&(r[s.from]=l,o.push({from:s.from,to:s.from+u.length,insert:h}))});return i.changes.empty||e(t.update(i,{userEvent:"indent"})),!0},Rte=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(TN(t,(r,n)=>{n.push({from:r.from,insert:t.facet(xC)})}),{userEvent:"input.indent"})),!0),Ate=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(TN(t,(r,n)=>{let i=/^\s*/.exec(r.text)[0];if(!i)return;let s=b0(i,t.tabSize),o=0,a=Vv(t,Math.max(0,s-Dh(t)));for(;o<i.length&&o<a.length&&i.charCodeAt(o)==a.charCodeAt(o);)o++;n.push({from:r.from+o,to:r.from+i.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),N6e=t=>(t.setTabFocusMode(),!0),L6e=[{key:"Ctrl-b",run:nte,shift:hte,preventDefault:!0},{key:"Ctrl-f",run:ite,shift:dte},{key:"Ctrl-p",run:ate,shift:gte},{key:"Ctrl-n",run:lte,shift:vte},{key:"Ctrl-a",run:n6e,shift:m6e},{key:"Ctrl-e",run:i6e,shift:g6e},{key:"Ctrl-d",run:wte},{key:"Ctrl-h",run:jM},{key:"Ctrl-k",run:S6e},{key:"Ctrl-Alt-h",run:Ste},{key:"Ctrl-o",run:E6e},{key:"Ctrl-t",run:R6e},{key:"Ctrl-v",run:VM}],F6e=[{key:"ArrowLeft",run:nte,shift:hte,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:q5e,shift:a6e,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:t6e,shift:d6e,preventDefault:!0},{key:"ArrowRight",run:ite,shift:dte,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:K5e,shift:l6e,preventDefault:!0},{mac:"Cmd-ArrowRight",run:r6e,shift:p6e,preventDefault:!0},{key:"ArrowUp",run:ate,shift:gte,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Zz,shift:e7},{mac:"Ctrl-ArrowUp",run:Kz,shift:Xz},{key:"ArrowDown",run:lte,shift:vte,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Jz,shift:t7},{mac:"Ctrl-ArrowDown",run:VM,shift:Qz},{key:"PageUp",run:Kz,shift:Xz},{key:"PageDown",run:VM,shift:Qz},{key:"Home",run:e6e,shift:h6e,preventDefault:!0},{key:"Mod-Home",run:Zz,shift:e7},{key:"End",run:J5e,shift:f6e,preventDefault:!0},{key:"Mod-End",run:Jz,shift:t7},{key:"Enter",run:r7,shift:r7},{key:"Mod-a",run:v6e},{key:"Backspace",run:jM,shift:jM},{key:"Delete",run:wte},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Ste},{key:"Mod-Delete",mac:"Alt-Delete",run:b6e},{mac:"Mod-Backspace",run:C6e},{mac:"Mod-Delete",run:T6e}].concat(L6e.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),H6e=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Q5e,shift:c6e},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Z5e,shift:u6e},{key:"Alt-ArrowUp",run:A6e},{key:"Shift-Alt-ArrowUp",run:O6e},{key:"Alt-ArrowDown",run:k6e},{key:"Shift-Alt-ArrowDown",run:_6e},{key:"Escape",run:w6e},{key:"Mod-Enter",run:P6e},{key:"Alt-l",mac:"Ctrl-l",run:y6e},{key:"Mod-i",run:x6e,preventDefault:!0},{key:"Mod-[",run:Ate},{key:"Mod-]",run:Rte},{key:"Mod-Alt-\\",run:I6e},{key:"Shift-Mod-k",run:M6e},{key:"Shift-Mod-\\",run:o6e},{key:"Mod-/",run:O5e},{key:"Alt-A",run:M5e},{key:"Ctrl-m",mac:"Shift-Alt-m",run:N6e}].concat(F6e),B6e={key:"Tab",run:Rte,shift:Ate},n7=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class t0{constructor(e,r,n=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=s?a=>s(n7(a)):n7,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ns(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=QI(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Sl(e);let i=this.normalize(r);if(i.length)for(let s=0,o=n;;s++){let a=i.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==i.length-1){if(l)return this.value=l,this;break}o==n&&s<r.length&&r.charCodeAt(s)==a&&o++}}}match(e,r,n){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:n}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:r,to:n}:this.matches.push(1,r)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(t0.prototype[Symbol.iterator]=function(){return this});const kte={from:-1,to:-1,match:/.*/.exec("")},EN="gm"+(/x/.unicode==null?"":"u");class Ote{constructor(e,r,n,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=kte,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new _te(e,r,n,i,s);this.re=new RegExp(r,EN+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=sS(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,i=n+r[0].length;if(this.matchPos=sS(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,r)))return this.value={from:n,to:i,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const dO=new WeakMap;class kp{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let i=dO.get(e);if(!i||i.from>=n||i.to<=r){let a=new kp(r,e.sliceString(r,n));return dO.set(e,a),a}if(i.from==r&&i.to==n)return i;let{text:s,from:o}=i;return o>r&&(s=e.sliceString(r,o)+s,o=r),i.to<n&&(s+=e.sliceString(i.to,n)),dO.set(e,new kp(o,s)),new kp(r,s.slice(r-o,n-o))}}class _te{constructor(e,r,n,i,s){this.text=e,this.to=s,this.done=!1,this.value=kte,this.matchPos=sS(e,i),this.re=new RegExp(r,EN+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=kp.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,i=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,i,r)))return this.value={from:n,to:i,match:r},this.matchPos=sS(this.text,i+(n==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=kp.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Ote.prototype[Symbol.iterator]=_te.prototype[Symbol.iterator]=function(){return this});function V6e(t){try{return new RegExp(t,EN),!0}catch{return!1}}function sS(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}function WM(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),r=Pr("input",{class:"cm-textfield",name:"line",value:e}),n=Pr("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:Kg.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},Pr("label",t.state.phrase("Go to line"),": ",r)," ",Pr("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),Pr("button",{name:"close",onclick:()=>{t.dispatch({effects:Kg.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},[""]));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(r.value);if(!s)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,u,h,d]=s,m=h?+h.slice(1):0,g=u?+u:a.number;if(u&&d){let b=g/100;l&&(b=b*(l=="-"?-1:1)+a.number/o.doc.lines),g=Math.round(o.doc.lines*b)}else u&&l&&(g=g*(l=="-"?-1:1)+a.number);let y=o.doc.line(Math.max(1,Math.min(o.doc.lines,g))),x=Pe.cursor(y.from+Math.max(0,Math.min(m,y.length)));t.dispatch({effects:[Kg.of(!1),$e.scrollIntoView(x.from,{y:"center"})],selection:x}),t.focus()}return{dom:n}}const Kg=Mt.define(),i7=Wi.define({create(){return!0},update(t,e){for(let r of e.effects)r.is(Kg)&&(t=r.value);return t},provide:t=>Hv.from(t,e=>e?WM:null)}),j6e=t=>{let e=Fv(t,WM);if(!e){let r=[Kg.of(!0)];t.state.field(i7,!1)==null&&r.push(Mt.appendConfig.of([i7,W6e])),t.dispatch({effects:r}),e=Fv(t,WM)}return e&&e.dom.querySelector("input").select(),!0},W6e=$e.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),z6e={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},U6e=Ke.define({combine(t){return $l(t,z6e,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function $6e(t){return[X6e,K6e]}const G6e=ft.mark({class:"cm-selectionMatch"}),Y6e=ft.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function s7(t,e,r,n){return(r==0||t(e.sliceDoc(r-1,r))!=un.Word)&&(n==e.doc.length||t(e.sliceDoc(n,n+1))!=un.Word)}function q6e(t,e,r,n){return t(e.sliceDoc(r,r+1))==un.Word&&t(e.sliceDoc(n-1,n))==un.Word}const K6e=Fn.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(U6e),{state:r}=t,n=r.selection;if(n.ranges.length>1)return ft.none;let i=n.main,s,o=null;if(i.empty){if(!e.highlightWordAroundCursor)return ft.none;let l=r.wordAt(i.head);if(!l)return ft.none;o=r.charCategorizer(i.head),s=r.sliceDoc(l.from,l.to)}else{let l=i.to-i.from;if(l<e.minSelectionLength||l>200)return ft.none;if(e.wholeWords){if(s=r.sliceDoc(i.from,i.to),o=r.charCategorizer(i.head),!(s7(o,r,i.from,i.to)&&q6e(o,r,i.from,i.to)))return ft.none}else if(s=r.sliceDoc(i.from,i.to),!s)return ft.none}let a=[];for(let l of t.visibleRanges){let u=new t0(r.doc,s,l.from,l.to);for(;!u.next().done;){let{from:h,to:d}=u.value;if((!o||s7(o,r,h,d))&&(i.empty&&h<=i.from&&d>=i.to?a.push(Y6e.range(h,d)):(h>=i.to||d<=i.from)&&a.push(G6e.range(h,d)),a.length>e.maxMatches))return ft.none}}return ft.set(a)}},{decorations:t=>t.decorations}),X6e=$e.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Q6e=({state:t,dispatch:e})=>{let{selection:r}=t,n=Pe.create(r.ranges.map(i=>t.wordAt(i.head)||Pe.cursor(i.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function Z6e(t,e){let{main:r,ranges:n}=t.selection,i=t.wordAt(r.head),s=i&&i.from==r.from&&i.to==r.to;for(let o=!1,a=new t0(t.doc,e,n[n.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new t0(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(l=>l.from==a.value.from))continue;if(s){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const J6e=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(s=>s.from===s.to))return Q6e({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=n))return!1;let i=Z6e(t,n);return i?(e(t.update({selection:t.selection.addRange(Pe.range(i.from,i.to),!1),effects:$e.scrollIntoView(i.to)})),!0):!1},C0=Ke.define({combine(t){return $l(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new f8e(e),scrollToMatch:e=>$e.scrollIntoView(e)})}});class Mte{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||V6e(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new n8e(this):new t8e(this)}getCursor(e,r=0,n){let i=e.doc?e:Qt.create({doc:e});return n==null&&(n=i.doc.length),this.regexp?tp(this,i,r,n):ep(this,i,r,n)}}class Dte{constructor(e){this.spec=e}}function ep(t,e,r,n){return new t0(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:i=>i.toLowerCase(),t.wholeWord?e8e(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function e8e(t,e){return(r,n,i,s)=>((s>r||s+i.length<n)&&(s=Math.max(0,r-2),i=t.sliceString(s,Math.min(t.length,n+2))),(e(oS(i,r-s))!=un.Word||e(aS(i,r-s))!=un.Word)&&(e(aS(i,n-s))!=un.Word||e(oS(i,n-s))!=un.Word))}class t8e extends Dte{constructor(e){super(e)}nextMatch(e,r,n){let i=ep(this.spec,e,n,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,r+this.spec.unquoted.length);i=ep(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==r&&i.value.to==n?null:i.value}prevMatchInRange(e,r,n){for(let i=n;;){let s=Math.max(r,i-1e4-this.spec.unquoted.length),o=ep(this.spec,e,s,i),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==r)return null;i-=1e4}}prevMatch(e,r,n){let i=this.prevMatchInRange(e,0,r);return i||(i=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=r||i.to!=n)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=ep(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=r)return null;i.push(n.value)}return i}highlight(e,r,n,i){let s=ep(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function tp(t,e,r,n){return new Ote(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?r8e(e.charCategorizer(e.selection.main.head)):void 0},r,n)}function oS(t,e){return t.slice(Hi(t,e,!1),e)}function aS(t,e){return t.slice(e,Hi(t,e))}function r8e(t){return(e,r,n)=>!n[0].length||(t(oS(n.input,n.index))!=un.Word||t(aS(n.input,n.index))!=un.Word)&&(t(aS(n.input,n.index+n[0].length))!=un.Word||t(oS(n.input,n.index+n[0].length))!=un.Word)}class n8e extends Dte{nextMatch(e,r,n){let i=tp(this.spec,e,n,e.doc.length).next();return i.done&&(i=tp(this.spec,e,0,r).next()),i.done?null:i.value}prevMatchInRange(e,r,n){for(let i=1;;i++){let s=Math.max(r,n-i*1e4),o=tp(this.spec,e,s,n),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==r||a.from>s+10))return a;if(s==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(r,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let i=n.length;i>0;i--){let s=+n.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+n.slice(i)}return r})}matchAll(e,r){let n=tp(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=r)return null;i.push(n.value)}return i}highlight(e,r,n,i){let s=tp(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Wv=Mt.define(),RN=Mt.define(),Bu=Wi.define({create(t){return new pO(zM(t).create(),null)},update(t,e){for(let r of e.effects)r.is(Wv)?t=new pO(r.value.create(),t.panel):r.is(RN)&&(t=new pO(t.query,r.value?AN:null));return t},provide:t=>Hv.from(t,e=>e.panel)});class pO{constructor(e,r){this.query=e,this.panel=r}}const i8e=ft.mark({class:"cm-searchMatch"}),s8e=ft.mark({class:"cm-searchMatch cm-searchMatch-selected"}),o8e=Fn.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Bu))}update(t){let e=t.state.field(Bu);(e!=t.startState.field(Bu)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return ft.none;let{view:r}=this,n=new Lc;for(let i=0,s=r.visibleRanges,o=s.length;i<o;i++){let{from:a,to:l}=s[i];for(;i<o-1&&l>s[i+1].from-2*250;)l=s[++i].to;t.highlight(r.state,a,l,(u,h)=>{let d=r.state.selection.ranges.some(m=>m.from==u&&m.to==h);n.add(u,h,d?s8e:i8e)})}return n.finish()}},{decorations:t=>t.decorations});function jy(t){return e=>{let r=e.state.field(Bu,!1);return r&&r.query.spec.valid?t(e,r):Nte(e)}}const lS=jy((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let i=Pe.single(n.from,n.to),s=t.state.facet(C0);return t.dispatch({selection:i,effects:[kN(t,n),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),Ite(t),!0}),cS=jy((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,i=e.prevMatch(r,n,n);if(!i)return!1;let s=Pe.single(i.from,i.to),o=t.state.facet(C0);return t.dispatch({selection:s,effects:[kN(t,i),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),Ite(t),!0}),a8e=jy((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:Pe.create(r.map(n=>Pe.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),l8e=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:i}=r.main,s=[],o=0;for(let a=new t0(t.doc,t.sliceDoc(n,i));!a.next().done;){if(s.length>1e3)return!1;a.value.from==n&&(o=s.length),s.push(Pe.range(a.value.from,a.value.to))}return e(t.update({selection:Pe.create(s,o),userEvent:"select.search.matches"})),!0},o7=jy((t,{query:e})=>{let{state:r}=t,{from:n,to:i}=r.selection.main;if(r.readOnly)return!1;let s=e.nextMatch(r,n,n);if(!s)return!1;let o=s,a=[],l,u,h=[];o.from==n&&o.to==i&&(u=r.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:u}),o=e.nextMatch(r,o.from,o.to),h.push($e.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+".")));let d=t.state.changes(a);return o&&(l=Pe.single(o.from,o.to).map(d),h.push(kN(t,o)),h.push(r.facet(C0).scrollToMatch(l.main,t))),t.dispatch({changes:d,selection:l,effects:h,userEvent:"input.replace"}),!0}),c8e=jy((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(i=>{let{from:s,to:o}=i;return{from:s,to:o,insert:e.getReplacement(i)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:$e.announce.of(n),userEvent:"input.replace.all"}),!0});function AN(t){return t.state.facet(C0).createPanel(t)}function zM(t,e){var r,n,i,s,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let u=t.facet(C0);return new Mte({search:((r=e==null?void 0:e.literal)!==null&&r!==void 0?r:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:u.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function Pte(t){let e=Fv(t,AN);return e&&e.dom.querySelector("[main-field]")}function Ite(t){let e=Pte(t);e&&e==t.root.activeElement&&e.select()}const Nte=t=>{let e=t.state.field(Bu,!1);if(e&&e.panel){let r=Pte(t);if(r&&r!=t.root.activeElement){let n=zM(t.state,e.query.spec);n.valid&&t.dispatch({effects:Wv.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[RN.of(!0),e?Wv.of(zM(t.state,e.query.spec)):Mt.appendConfig.of(d8e)]});return!0},Lte=t=>{let e=t.state.field(Bu,!1);if(!e||!e.panel)return!1;let r=Fv(t,AN);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:RN.of(!1)}),!0},u8e=[{key:"Mod-f",run:Nte,scope:"editor search-panel"},{key:"F3",run:lS,shift:cS,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:lS,shift:cS,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Lte,scope:"editor search-panel"},{key:"Mod-Shift-l",run:l8e},{key:"Mod-Alt-g",run:j6e},{key:"Mod-d",run:J6e,preventDefault:!0}];class f8e{constructor(e){this.view=e;let r=this.query=e.state.field(Bu).query.spec;this.commit=this.commit.bind(this),this.searchField=Pr("input",{value:r.search,placeholder:no(e,"Find"),"aria-label":no(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Pr("input",{value:r.replace,placeholder:no(e,"Replace"),"aria-label":no(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Pr("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=Pr("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=Pr("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(i,s,o){return Pr("button",{class:"cm-button",name:i,onclick:s,type:"button"},o)}this.dom=Pr("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,n("next",()=>lS(e),[no(e,"next")]),n("prev",()=>cS(e),[no(e,"previous")]),n("select",()=>a8e(e),[no(e,"all")]),Pr("label",null,[this.caseField,no(e,"match case")]),Pr("label",null,[this.reField,no(e,"regexp")]),Pr("label",null,[this.wordField,no(e,"by word")]),...e.state.readOnly?[]:[Pr("br"),this.replaceField,n("replace",()=>o7(e),[no(e,"replace")]),n("replaceAll",()=>c8e(e),[no(e,"replace all")])],Pr("button",{name:"close",onclick:()=>Lte(e),"aria-label":no(e,"close"),type:"button"},[""])])}commit(){let e=new Mte({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Wv.of(e)}))}keydown(e){gHe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?cS:lS)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),o7(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(Wv)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(C0).top}}function no(t,e){return t.state.phrase(e)}const Cw=30,Tw=/[\s\.,:;?!]/;function kN(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),i=t.state.doc.lineAt(r).to,s=Math.max(n.from,e-Cw),o=Math.min(i,r+Cw),a=t.state.sliceDoc(s,o);if(s!=n.from){for(let l=0;l<Cw;l++)if(!Tw.test(a[l+1])&&Tw.test(a[l])){a=a.slice(l);break}}if(o!=i){for(let l=a.length-1;l>a.length-Cw;l--)if(!Tw.test(a[l-1])&&Tw.test(a[l])){a=a.slice(0,l);break}}return $e.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${n.number}.`)}const h8e=$e.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),d8e=[Bu,Xh.low(o8e),h8e];class Fte{constructor(e,r,n,i){this.state=e,this.pos=r,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let r=Ci(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),n=Math.max(r.from,this.pos-250),i=r.text.slice(n-r.from,this.pos-r.from),s=i.search(Bte(e,!1));return s<0?null:{from:n+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,r,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(r),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function a7(t){let e=Object.keys(t).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function p8e(t){let e=Object.create(null),r=Object.create(null);for(let{label:i}of t){e[i[0]]=!0;for(let s=1;s<i.length;s++)r[i[s]]=!0}let n=a7(e)+a7(r)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function Hte(t){let e=t.map(i=>typeof i=="string"?{label:i}:i),[r,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:p8e(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:r}:null}}function m8e(t,e){return r=>{for(let n=Ci(r.state).resolveInner(r.pos,-1);n;n=n.parent){if(t.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(r)}}class l7{constructor(e,r,n,i){this.completion=e,this.source=r,this.match=n,this.score=i}}function ph(t){return t.selection.main.from}function Bte(t,e){var r;let{source:n}=t,i=e&&n[0]!="^",s=n[n.length-1]!="$";return!i&&!s?t:new RegExp(`${i?"^":""}(?:${n})${s?"$":""}`,(r=t.flags)!==null&&r!==void 0?r:t.ignoreCase?"i":"")}const Vte=Ul.define();function g8e(t,e,r,n){let{main:i}=t.selection,s=r-i.from,o=n-i.from;return Object.assign(Object.assign({},t.changeByRange(a=>{if(a!=i&&r!=n&&t.sliceDoc(a.from+s,a.from+o)!=t.sliceDoc(r,n))return{range:a};let l=t.toText(e);return{changes:{from:a.from+s,to:n==i.from?a.to:a.from+o,insert:l},range:Pe.cursor(a.from+s+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const c7=new WeakMap;function v8e(t){if(!Array.isArray(t))return t;let e=c7.get(t);return e||c7.set(t,e=Hte(t)),e}const uS=Mt.define(),zv=Mt.define();class y8e{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let r=0;r<e.length;){let n=Ns(e,r),i=Sl(n);this.chars.push(n);let s=e.slice(r,r+i),o=s.toUpperCase();this.folded.push(Ns(o==s?s.toLowerCase():o,0)),r+=i}this.astral=e.length!=this.chars.length}ret(e,r){return this.score=e,this.matched=r,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:r,folded:n,any:i,precise:s,byWord:o}=this;if(r.length==1){let E=Ns(e,0),R=Sl(E),k=R==e.length?0:-100;if(E!=r[0])if(E==n[0])k+=-200;else return null;return this.ret(k,[0,R])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=r.length,u=0;if(a<0){for(let E=0,R=Math.min(e.length,200);E<R&&u<l;){let k=Ns(e,E);(k==r[u]||k==n[u])&&(i[u++]=E),E+=Sl(k)}if(u<l)return null}let h=0,d=0,m=!1,g=0,y=-1,x=-1,b=/[a-z]/.test(e),C=!0;for(let E=0,R=Math.min(e.length,200),k=0;E<R&&d<l;){let O=Ns(e,E);a<0&&(h<l&&O==r[h]&&(s[h++]=E),g<l&&(O==r[g]||O==n[g]?(g==0&&(y=E),x=E+1,g++):g=0));let P,D=O<255?O>=48&&O<=57||O>=97&&O<=122?2:O>=65&&O<=90?1:0:(P=QI(O))!=P.toLowerCase()?1:P!=P.toUpperCase()?2:0;(!E||D==1&&b||k==0&&D!=0)&&(r[d]==O||n[d]==O&&(m=!0)?o[d++]=E:o.length&&(C=!1)),k=D,E+=Sl(O)}return d==l&&o[0]==0&&C?this.result(-100+(m?-200:0),o,e):g==l&&y==0?this.ret(-200-e.length+(x==e.length?0:-100),[0,x]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):g==l?this.ret(-900-e.length,[y,x]):d==l?this.result(-100+(m?-200:0)+-700+(C?0:-1100),o,e):r.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,r,n){let i=[],s=0;for(let o of r){let a=o+(this.astral?Sl(Ns(n,o)):1);s&&i[s-1]==o?i[s-1]=a:(i[s++]=o,i[s++]=a)}return this.ret(e-n.length,i)}}class x8e{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let r=e.slice(0,this.pattern.length),n=r==this.pattern?0:r.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,r.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const bi=Ke.define({combine(t){return $l(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:w8e,filterStrict:!1,compareCompletions:(e,r)=>e.label.localeCompare(r.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>n=>u7(e(n),r(n)),optionClass:(e,r)=>n=>u7(e(n),r(n)),addToOptions:(e,r)=>e.concat(r),filterStrict:(e,r)=>e||r})}});function u7(t,e){return t?e?t+" "+e:t:e}function w8e(t,e,r,n,i,s){let o=t.textDirection==en.RTL,a=o,l=!1,u="top",h,d,m=e.left-i.left,g=i.right-e.right,y=n.right-n.left,x=n.bottom-n.top;if(a&&m<Math.min(y,g)?a=!1:!a&&g<Math.min(y,m)&&(a=!0),y<=(a?m:g))h=Math.max(i.top,Math.min(r.top,i.bottom-x))-e.top,d=Math.min(400,a?m:g);else{l=!0,d=Math.min(400,(o?e.right:i.right-e.left)-30);let E=i.bottom-e.bottom;E>=x||E>e.top?h=r.bottom-e.top:(u="bottom",h=e.bottom-r.top)}let b=(e.bottom-e.top)/s.offsetHeight,C=(e.right-e.left)/s.offsetWidth;return{style:`${u}: ${h/b}px; max-width: ${d/C}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function b8e(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(r){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),r.type&&n.classList.add(...r.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(r,n,i,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=r.displayLabel||r.label,l=0;for(let u=0;u<s.length;){let h=s[u++],d=s[u++];h>l&&o.appendChild(document.createTextNode(a.slice(l,h)));let m=o.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(a.slice(h,d))),m.className="cm-completionMatchedText",l=d}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(r){if(!r.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=r.detail,n},position:80}),e.sort((r,n)=>r.position-n.position).map(r=>r.render)}function mO(t,e,r){if(t<=r)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let i=Math.floor(e/r);return{from:i*r,to:(i+1)*r}}let n=Math.floor((t-e)/r);return{from:t-(n+1)*r,to:t-n*r}}class S8e{constructor(e,r,n){this.view=e,this.stateField=r,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let i=e.state.field(r),{options:s,selected:o}=i.open,a=e.state.facet(bi);this.optionContent=b8e(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=mO(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:u}=e.state.field(r).open;for(let h=l.target,d;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(d=/-(\d+)$/.exec(h.id))&&+d[1]<u.length){this.applyCompletion(e,u[+d[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(bi).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:zv.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,r){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,r,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var r;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:s,selected:o,disabled:a}=n.open;(!i.open||i.open.options!=s)&&(this.range=mO(s.length,o,e.state.facet(bi).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),a!=((r=i.open)===null||r===void 0?void 0:r.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of r.split(" "))n&&this.dom.classList.add(n);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;if((r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=mO(r.options.length,r.selected,this.view.state.facet(bi).maxRenderedOptions),this.showOptions(r.options,e.id)),this.updateSelectedOption(r.selected)){this.destroyInfo();let{completion:n}=r.options[r.selected],{info:i}=n;if(!i)return;let s=typeof i=="string"?document.createTextNode(i):i(n);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>js(this.view.state,o,"completion info")):this.addInfoPane(s,n)}}addInfoPane(e,r){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;n.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)n.nodeName!="LI"||!n.id?i--:i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),r=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return r&&T8e(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return i.top>Math.min(s.bottom,r.bottom)-10||i.bottom<Math.max(s.top,r.top)+10?null:this.view.state.facet(bi).positionInfo(this.view,r,i,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,n){const i=document.createElement("ul");i.id=r,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",o=>{o.target==i&&o.preventDefault()});let s=null;for(let o=n.from;o<n.to;o++){let{completion:a,match:l}=e[o],{section:u}=a;if(u){let m=typeof u=="string"?u:u.name;if(m!=s&&(o>n.from||n.from==0))if(s=m,typeof u!="string"&&u.header)i.appendChild(u.header(u));else{let g=i.appendChild(document.createElement("completion-section"));g.textContent=m}}const h=i.appendChild(document.createElement("li"));h.id=r+"-"+o,h.setAttribute("role","option");let d=this.optionClass(a);d&&(h.className=d);for(let m of this.optionContent){let g=m(a,this.view.state,this.view,l);g&&h.appendChild(g)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function C8e(t,e){return r=>new S8e(r,t,e)}function T8e(t,e){let r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=r.height/t.offsetHeight;n.top<r.top?t.scrollTop-=(r.top-n.top)/i:n.bottom>r.bottom&&(t.scrollTop+=(n.bottom-r.bottom)/i)}function f7(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function E8e(t,e){let r=[],n=null,i=u=>{r.push(u);let{section:h}=u.completion;if(h){n||(n=[]);let d=typeof h=="string"?h:h.name;n.some(m=>m.name==d)||n.push(typeof h=="string"?{name:d}:h)}},s=e.facet(bi);for(let u of t)if(u.hasResult()){let h=u.result.getMatch;if(u.result.filter===!1)for(let d of u.result.options)i(new l7(d,u.source,h?h(d):[],1e9-r.length));else{let d=e.sliceDoc(u.from,u.to),m,g=s.filterStrict?new x8e(d):new y8e(d);for(let y of u.result.options)if(m=g.match(y.label)){let x=y.displayLabel?h?h(y,m.matched):[]:m.matched;i(new l7(y,u.source,x,m.score+(y.boost||0)))}}}if(n){let u=Object.create(null),h=0,d=(m,g)=>{var y,x;return((y=m.rank)!==null&&y!==void 0?y:1e9)-((x=g.rank)!==null&&x!==void 0?x:1e9)||(m.name<g.name?-1:1)};for(let m of n.sort(d))h-=1e5,u[m.name]=h;for(let m of r){let{section:g}=m.completion;g&&(m.score+=u[typeof g=="string"?g:g.name])}}let o=[],a=null,l=s.compareCompletions;for(let u of r.sort((h,d)=>d.score-h.score||l(h.completion,d.completion))){let h=u.completion;!a||a.label!=h.label||a.detail!=h.detail||a.type!=null&&h.type!=null&&a.type!=h.type||a.apply!=h.apply||a.boost!=h.boost?o.push(u):f7(u.completion)>f7(a)&&(o[o.length-1]=u),a=u.completion}return o}class pp{constructor(e,r,n,i,s,o){this.options=e,this.attrs=r,this.tooltip=n,this.timestamp=i,this.selected=s,this.disabled=o}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new pp(this.options,h7(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,n,i,s,o){if(i&&!o&&e.some(u=>u.isPending))return i.setDisabled();let a=E8e(e,r);if(!a.length)return i&&e.some(u=>u.isPending)?i.setDisabled():null;let l=r.facet(bi).selectOnOpen?0:-1;if(i&&i.selected!=l&&i.selected!=-1){let u=i.options[i.selected].completion;for(let h=0;h<a.length;h++)if(a[h].completion==u){l=h;break}}return new pp(a,h7(n,l),{pos:e.reduce((u,h)=>h.hasResult()?Math.min(u,h.from):u,1e8),create:M8e,above:s.aboveCursor},i?i.timestamp:Date.now(),l,!1)}map(e){return new pp(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new pp(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class fS{constructor(e,r,n){this.active=e,this.id=r,this.open=n}static start(){return new fS(O8e,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,n=r.facet(bi),s=(n.override||r.languageDataAt("autocomplete",ph(r)).map(v8e)).map(l=>(this.active.find(h=>h.source==l)||new Zo(l,this.active.some(h=>h.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((l,u)=>l==this.active[u])&&(s=this.active);let o=this.open,a=e.effects.some(l=>l.is(ON));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!R8e(s,this.active)||a?o=pp.build(s,r,this.id,o,n,a):o&&o.disabled&&!s.some(l=>l.isPending)&&(o=null),!o&&s.every(l=>!l.isPending)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Zo(l.source,0):l));for(let l of e.effects)l.is(Wte)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new fS(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?A8e:k8e}}function R8e(t,e){if(t==e)return!0;for(let r=0,n=0;;){for(;r<t.length&&!t[r].hasResult();)r++;for(;n<e.length&&!e[n].hasResult();)n++;let i=r==t.length,s=n==e.length;if(i||s)return i==s;if(t[r++].result!=e[n++].result)return!1}}const A8e={"aria-autocomplete":"list"},k8e={};function h7(t,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(r["aria-activedescendant"]=t+"-"+e),r}const O8e=[];function jte(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(Vte);if(n&&e.activateOnCompletion(n))return 12}let r=t.isUserEvent("input.type");return r&&e.activateOnTyping?5:r?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class Zo{constructor(e,r,n=!1){this.source=e,this.state=r,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,r){let n=jte(e,r),i=this;(n&8||n&16&&this.touches(e))&&(i=new Zo(i.source,0)),n&4&&i.state==0&&(i=new Zo(this.source,1)),i=i.updateFor(e,n);for(let s of e.effects)if(s.is(uS))i=new Zo(i.source,1,s.value);else if(s.is(zv))i=new Zo(i.source,0);else if(s.is(ON))for(let o of s.value)o.source==i.source&&(i=o);return i}updateFor(e,r){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(ph(e.state))}}class Op extends Zo{constructor(e,r,n,i,s,o){super(e,3,r),this.limit=n,this.result=i,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,r){var n;if(!(r&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=ph(e.state);if(a>o||!i||r&2&&(ph(e.startState)==this.from||a<this.limit))return new Zo(this.source,r&4?1:0);let l=e.changes.mapPos(this.limit);return _8e(i.validFor,e.state,s,o)?new Op(this.source,this.explicit,l,i,s,o):i.update&&(i=i.update(i,s,o,new Fte(e.state,a,!1)))?new Op(this.source,this.explicit,l,i,i.from,(n=i.to)!==null&&n!==void 0?n:ph(e.state)):new Zo(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Op(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Zo(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function _8e(t,e,r,n){if(!t)return!1;let i=e.sliceDoc(r,n);return typeof t=="function"?t(i,r,n,e):Bte(t,!0).test(i)}const ON=Mt.define({map(t,e){return t.map(r=>r.map(e))}}),Wte=Mt.define(),Fs=Wi.define({create(){return fS.start()},update(t,e){return t.update(e)},provide:t=>[hN.from(t,e=>e.tooltip),$e.contentAttributes.from(t,e=>e.attrs)]});function _N(t,e){const r=e.completion.apply||e.completion.label;let n=t.state.field(Fs).active.find(i=>i.source==e.source);return n instanceof Op?(typeof r=="string"?t.dispatch(Object.assign(Object.assign({},g8e(t.state,r,n.from,n.to)),{annotations:Vte.of(e.completion)})):r(t,e.completion,n.from,n.to),!0):!1}const M8e=C8e(Fs,_N);function Ew(t,e="option"){return r=>{let n=r.state.field(Fs,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(bi).interactionDelay)return!1;let i=1,s;e=="page"&&(s=vee(r,n.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,a=n.open.selected>-1?n.open.selected+i*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),r.dispatch({effects:Wte.of(a)}),!0}}const D8e=t=>{let e=t.state.field(Fs,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(bi).interactionDelay?!1:_N(t,e.open.options[e.open.selected])},d7=t=>t.state.field(Fs,!1)?(t.dispatch({effects:uS.of(!0)}),!0):!1,P8e=t=>{let e=t.state.field(Fs,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(t.dispatch({effects:zv.of(null)}),!0)};class I8e{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}}const N8e=50,L8e=1e3,F8e=Fn.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(Fs).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(Fs),r=t.state.facet(bi);if(!t.selectionSet&&!t.docChanged&&t.startState.field(Fs)==e)return;let n=t.transactions.some(s=>{let o=jte(s,r);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(n||o.context.abortOnDocChange&&t.docChanged||o.updates.length+t.transactions.length>N8e&&Date.now()-o.time>L8e){for(let a of o.context.abortListeners)try{a()}catch(l){js(this.view.state,l)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(s=>s.effects.some(o=>o.is(uS)))&&(this.pendingStart=!0);let i=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of t.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(Fs);for(let r of e.active)r.isPending&&!this.running.some(n=>n.active.source==r.source)&&this.startQuery(r);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(bi).updateSyncTime))}startQuery(t){let{state:e}=this.view,r=ph(e),n=new Fte(e,r,t.explicit,this.view),i=new I8e(t,n);this.running.push(i),Promise.resolve(t.source(n)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:zv.of(null)}),js(this.view.state,s)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(bi).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(bi),n=this.view.state.field(Fs);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let a=ph(s.updates.length?s.updates[0].startState:this.view.state),l=Math.min(a,s.done.from+(s.active.explicit?0:1)),u=new Op(s.active.source,s.active.explicit,l,s.done,s.done.from,(t=s.done.to)!==null&&t!==void 0?t:a);for(let h of s.updates)u=u.update(h,r);if(u.hasResult()){e.push(u);continue}}let o=n.active.find(a=>a.source==s.active.source);if(o&&o.isPending)if(s.done==null){let a=new Zo(s.active.source,0);for(let l of s.updates)a=a.update(l,r);a.isPending||e.push(a)}else this.startQuery(o)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:ON.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(Fs,!1);if(e&&e.tooltip&&this.view.state.facet(bi).closeOnBlur){let r=e.open&&vee(this.view,e.open.tooltip);(!r||!r.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:zv.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:uS.of(!1)}),20),this.composing=0}}}),H8e=typeof navigator=="object"&&/Win/.test(navigator.platform),B8e=Xh.highest($e.domEventHandlers({keydown(t,e){let r=e.state.field(Fs,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||t.key.length>1||t.ctrlKey&&!(H8e&&t.altKey)||t.metaKey)return!1;let n=r.open.options[r.open.selected],i=r.active.find(o=>o.source==n.source),s=n.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(t.key)>-1&&_N(e,n),!1}})),V8e=$e.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Uv={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},sh=Mt.define({map(t,e){let r=e.mapPos(t,-1,ps.TrackAfter);return r??void 0}}),MN=new class extends kh{};MN.startSide=1;MN.endSide=-1;const zte=Wi.define({create(){return lr.empty},update(t,e){if(t=t.map(e.changes),e.selection){let r=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:n=>n>=r.from&&n<=r.to})}for(let r of e.effects)r.is(sh)&&(t=t.update({add:[MN.range(r.value,r.value+1)]}));return t}});function j8e(){return[z8e,zte]}const gO="()[]{}<>";function Ute(t){for(let e=0;e<gO.length;e+=2)if(gO.charCodeAt(e)==t)return gO.charAt(e+1);return QI(t<128?t:t+1)}function $te(t,e){return t.languageDataAt("closeBrackets",e)[0]||Uv}const W8e=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),z8e=$e.inputHandler.of((t,e,r,n)=>{if((W8e?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let i=t.state.selection.main;if(n.length>2||n.length==2&&Sl(Ns(n,0))==1||e!=i.from||r!=i.to)return!1;let s=G8e(t.state,n);return s?(t.dispatch(s),!0):!1}),U8e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=$te(t,t.selection.main.head).brackets||Uv.brackets,i=null,s=t.changeByRange(o=>{if(o.empty){let a=Y8e(t.doc,o.head);for(let l of n)if(l==a&&RC(t.doc,o.head)==Ute(Ns(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:Pe.cursor(o.head-l.length)}}return{range:i=o}});return i||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},$8e=[{key:"Backspace",run:U8e}];function G8e(t,e){let r=$te(t,t.selection.main.head),n=r.brackets||Uv.brackets;for(let i of n){let s=Ute(Ns(i,0));if(e==i)return s==i?X8e(t,i,n.indexOf(i+i+i)>-1,r):q8e(t,i,s,r.before||Uv.before);if(e==s&&Gte(t,t.selection.main.from))return K8e(t,i,s)}return null}function Gte(t,e){let r=!1;return t.field(zte).between(0,t.doc.length,n=>{n==e&&(r=!0)}),r}function RC(t,e){let r=t.sliceString(e,e+2);return r.slice(0,Sl(Ns(r,0)))}function Y8e(t,e){let r=t.sliceString(e-2,e);return Sl(Ns(r,0))==r.length?r:r.slice(1)}function q8e(t,e,r,n){let i=null,s=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:r,from:o.to}],effects:sh.of(o.to+e.length),range:Pe.range(o.anchor+e.length,o.head+e.length)};let a=RC(t.doc,o.head);return!a||/\s/.test(a)||n.indexOf(a)>-1?{changes:{insert:e+r,from:o.head},effects:sh.of(o.head+e.length),range:Pe.cursor(o.head+e.length)}:{range:i=o}});return i?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function K8e(t,e,r){let n=null,i=t.changeByRange(s=>s.empty&&RC(t.doc,s.head)==r?{changes:{from:s.head,to:s.head+r.length,insert:r},range:Pe.cursor(s.head+r.length)}:n={range:s});return n?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function X8e(t,e,r,n){let i=n.stringPrefixes||Uv.stringPrefixes,s=null,o=t.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:e,from:a.to}],effects:sh.of(a.to+e.length),range:Pe.range(a.anchor+e.length,a.head+e.length)};let l=a.head,u=RC(t.doc,l),h;if(u==e){if(p7(t,l))return{changes:{insert:e+e,from:l},effects:sh.of(l+e.length),range:Pe.cursor(l+e.length)};if(Gte(t,l)){let m=r&&t.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+m.length,insert:m},range:Pe.cursor(l+m.length)}}}else{if(r&&t.sliceDoc(l-2*e.length,l)==e+e&&(h=m7(t,l-2*e.length,i))>-1&&p7(t,h))return{changes:{insert:e+e+e+e,from:l},effects:sh.of(l+e.length),range:Pe.cursor(l+e.length)};if(t.charCategorizer(l)(u)!=un.Word&&m7(t,l,i)>-1&&!Q8e(t,l,e,i))return{changes:{insert:e+e,from:l},effects:sh.of(l+e.length),range:Pe.cursor(l+e.length)}}return{range:s=a}});return s?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function p7(t,e){let r=Ci(t).resolveInner(e+1);return r.parent&&r.from==e}function Q8e(t,e,r,n){let i=Ci(t).resolveInner(e,-1),s=n.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=t.sliceDoc(i.from,Math.min(i.to,i.from+r.length+s)),l=a.indexOf(r);if(!l||l>-1&&n.indexOf(a.slice(0,l))>-1){let h=i.firstChild;for(;h&&h.from==i.from&&h.to-h.from>r.length+l;){if(t.sliceDoc(h.to-r.length,h.to)==r)return!1;h=h.firstChild}return!0}let u=i.to==e&&i.parent;if(!u)break;i=u}return!1}function m7(t,e,r){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=un.Word)return e;for(let i of r){let s=e-i.length;if(t.sliceDoc(s,e)==i&&n(t.sliceDoc(s-1,s))!=un.Word)return s}return-1}function Z8e(t={}){return[B8e,Fs,bi.of(t),F8e,J8e,V8e]}const Yte=[{key:"Ctrl-Space",run:d7},{mac:"Alt-`",run:d7},{key:"Escape",run:P8e},{key:"ArrowDown",run:Ew(!0)},{key:"ArrowUp",run:Ew(!1)},{key:"PageDown",run:Ew(!0,"page")},{key:"PageUp",run:Ew(!1,"page")},{key:"Enter",run:D8e}],J8e=Xh.highest(gC.computeN([bi],t=>t.facet(bi).defaultKeymap?[Yte]:[]));class g7{constructor(e,r,n){this.from=e,this.to=r,this.diagnostic=n}}class Xf{constructor(e,r,n){this.diagnostics=e,this.panel=r,this.selected=n}static init(e,r,n){let i=n.facet($v).markerFilter;i&&(e=i(e,n));let s=e.slice().sort((h,d)=>h.from-d.from||h.to-d.to),o=new Lc,a=[],l=0;for(let h=0;;){let d=h==s.length?null:s[h];if(!d&&!a.length)break;let m,g;for(a.length?(m=l,g=a.reduce((x,b)=>Math.min(x,b.to),d&&d.from>m?d.from:1e8)):(m=d.from,g=d.to,a.push(d),h++);h<s.length;){let x=s[h];if(x.from==m&&(x.to>x.from||x.to==m))a.push(x),h++,g=Math.min(x.to,g);else{g=Math.min(x.from,g);break}}let y=hVe(a);if(a.some(x=>x.from==x.to||x.from==x.to-1&&n.doc.lineAt(x.from).to==x.from))o.add(m,m,ft.widget({widget:new lVe(y),diagnostics:a.slice()}));else{let x=a.reduce((b,C)=>C.markClass?b+" "+C.markClass:b,"");o.add(m,g,ft.mark({class:"cm-lintRange cm-lintRange-"+y+x,diagnostics:a.slice(),inclusiveEnd:a.some(b=>b.to>g)}))}l=g;for(let x=0;x<a.length;x++)a[x].to<=l&&a.splice(x--,1)}let u=o.finish();return new Xf(u,r,r0(u))}}function r0(t,e=null,r=0){let n=null;return t.between(r,1e9,(i,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!n)n=new g7(i,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new g7(n.from,s,n.diagnostic)}}),n}function eVe(t,e){let r=e.pos,n=e.end||r,i=t.state.facet($v).hideOn(t,r,n);if(i!=null)return i;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(qte))||t.changes.touchesRange(s.from,Math.max(s.to,n)))}function tVe(t,e){return t.field(fo,!1)?e:e.concat(Mt.appendConfig.of(dVe))}const qte=Mt.define(),DN=Mt.define(),Kte=Mt.define(),fo=Wi.define({create(){return new Xf(ft.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let r=t.diagnostics.map(e.changes),n=null,i=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);n=r0(r,t.selected.diagnostic,s)||r0(r,null,s)}!r.size&&i&&e.state.facet($v).autoPanel&&(i=null),t=new Xf(r,i,n)}for(let r of e.effects)if(r.is(qte)){let n=e.state.facet($v).autoPanel?r.value.length?Gv.open:null:t.panel;t=Xf.init(r.value,n,e.state)}else r.is(DN)?t=new Xf(t.diagnostics,r.value?Gv.open:null,t.selected):r.is(Kte)&&(t=new Xf(t.diagnostics,t.panel,r.value));return t},provide:t=>[Hv.from(t,e=>e.panel),$e.decorations.from(t,e=>e.diagnostics)]}),rVe=ft.mark({class:"cm-lintRange cm-lintRange-active"});function nVe(t,e,r){let{diagnostics:n}=t.state.field(fo),i,s=-1,o=-1;n.between(e-(r<0?1:0),e+(r>0?1:0),(l,u,{spec:h})=>{if(e>=l&&e<=u&&(l==u||(e>l||r>0)&&(e<u||r<0)))return i=h.diagnostics,s=l,o=u,!1});let a=t.state.facet($v).tooltipFilter;return i&&a&&(i=a(i,t.state)),i?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:iVe(t,i)}}}:null}function iVe(t,e){return Pr("ul",{class:"cm-tooltip-lint"},e.map(r=>Qte(t,r,!1)))}const sVe=t=>{let e=t.state.field(fo,!1);(!e||!e.panel)&&t.dispatch({effects:tVe(t.state,[DN.of(!0)])});let r=Fv(t,Gv.open);return r&&r.dom.querySelector(".cm-panel-lint ul").focus(),!0},v7=t=>{let e=t.state.field(fo,!1);return!e||!e.panel?!1:(t.dispatch({effects:DN.of(!1)}),!0)},oVe=t=>{let e=t.state.field(fo,!1);if(!e)return!1;let r=t.state.selection.main,n=e.diagnostics.iter(r.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==r.from&&n.to==r.to)?!1:(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},aVe=[{key:"Mod-Shift-m",run:sVe,preventDefault:!0},{key:"F8",run:oVe}],$v=Ke.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},$l(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,r)=>e?r?n=>e(n)||r(n):e:r}))}});function Xte(t){let e=[];if(t)e:for(let{name:r}of t){for(let n=0;n<r.length;n++){let i=r[n];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function Qte(t,e,r){var n;let i=r?Xte(e.actions):[];return Pr("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Pr("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,o)=>{let a=!1,l=m=>{if(m.preventDefault(),a)return;a=!0;let g=r0(t.state.field(fo).diagnostics,e);g&&s.apply(t,g.from,g.to)},{name:u}=s,h=i[o]?u.indexOf(i[o]):-1,d=h<0?u:[u.slice(0,h),Pr("u",u.slice(h,h+1)),u.slice(h+1)];return Pr("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${u}${h<0?"":` (access key "${i[o]})"`}.`},d)}),e.source&&Pr("div",{class:"cm-diagnosticSource"},e.source))}class lVe extends Uc{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Pr("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class y7{constructor(e,r){this.diagnostic=r,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Qte(e,r,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Gv{constructor(e){this.view=e,this.items=[];let r=i=>{if(i.keyCode==27)v7(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=Xte(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==i.keyCode){let l=r0(this.view.state.field(fo).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;i.preventDefault()},n=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=Pr("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:r,onclick:n}),this.dom=Pr("div",{class:"cm-panel-lint"},this.list,Pr("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>v7(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(fo).selected;if(!e)return-1;for(let r=0;r<this.items.length;r++)if(this.items[r].diagnostic==e.diagnostic)return r;return-1}update(){let{diagnostics:e,selected:r}=this.view.state.field(fo),n=0,i=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(a,l,{spec:u})=>{for(let h of u.diagnostics){if(o.has(h))continue;o.add(h);let d=-1,m;for(let g=n;g<this.items.length;g++)if(this.items[g].diagnostic==h){d=g;break}d<0?(m=new y7(this.view,h),this.items.splice(n,0,m),i=!0):(m=this.items[d],d>n&&(this.items.splice(n,d-n),i=!0)),r&&m.diagnostic==r.diagnostic?m.dom.hasAttribute("aria-selected")||(m.dom.setAttribute("aria-selected","true"),s=m):m.dom.hasAttribute("aria-selected")&&m.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new y7(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let u=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/u:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/u)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function r(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)r();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)r()}moveSelection(e){if(this.selectedIndex<0)return;let r=this.view.state.field(fo),n=r0(r.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Kte.of(n)})}static open(e){return new Gv(e)}}function cVe(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function Rw(t){return cVe(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const uVe=$e.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Rw("#d11")},".cm-lintRange-warning":{backgroundImage:Rw("orange")},".cm-lintRange-info":{backgroundImage:Rw("#999")},".cm-lintRange-hint":{backgroundImage:Rw("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function fVe(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function hVe(t){let e="hint",r=1;for(let n of t){let i=fVe(n.severity);i>r&&(r=i,e=n.severity)}return e}const dVe=[fo,$e.decorations.compute([fo],t=>{let{selected:e,panel:r}=t.field(fo);return!e||!r||e.from==e.to?ft.none:ft.set([rVe.range(e.from,e.to)])}),iBe(nVe,{hideOn:eVe}),uVe];var x7=function(e){e===void 0&&(e={});var{crosshairCursor:r=!1}=e,n=[];e.closeBracketsKeymap!==!1&&(n=n.concat($8e)),e.defaultKeymap!==!1&&(n=n.concat(H6e)),e.searchKeymap!==!1&&(n=n.concat(u8e)),e.historyKeymap!==!1&&(n=n.concat(Y5e)),e.foldKeymap!==!1&&(n=n.concat(n5e)),e.completionKeymap!==!1&&(n=n.concat(Yte)),e.lintKeymap!==!1&&(n=n.concat(aVe));var i=[];return e.lineNumbers!==!1&&i.push(mBe()),e.highlightActiveLineGutter!==!1&&i.push(yBe()),e.highlightSpecialChars!==!1&&i.push(PHe()),e.history!==!1&&i.push(H5e()),e.foldGutter!==!1&&i.push(a5e()),e.drawSelection!==!1&&i.push(SHe()),e.dropCursor!==!1&&i.push(AHe()),e.allowMultipleSelections!==!1&&i.push(Qt.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&i.push(qBe()),e.syntaxHighlighting!==!1&&i.push(Vee(f5e,{fallback:!0})),e.bracketMatching!==!1&&i.push(y5e()),e.closeBrackets!==!1&&i.push(j8e()),e.autocompletion!==!1&&i.push(Z8e()),e.rectangularSelection!==!1&&i.push(YHe()),r!==!1&&i.push(XHe()),e.highlightActiveLine!==!1&&i.push(BHe()),e.highlightSelectionMatches!==!1&&i.push($6e()),e.tabSize&&typeof e.tabSize=="number"&&i.push(xC.of(" ".repeat(e.tabSize))),i.concat([gC.of(n.flat())]).filter(Boolean)};const pVe="#e5c07b",w7="#e06c75",mVe="#56b6c2",gVe="#ffffff",nb="#abb2bf",UM="#7d8799",vVe="#61afef",yVe="#98c379",b7="#d19a66",xVe="#c678dd",wVe="#21252b",S7="#2c313a",C7="#282c34",vO="#353a42",bVe="#3E4451",T7="#528bff",SVe=$e.theme({"&":{color:nb,backgroundColor:C7},".cm-content":{caretColor:T7},".cm-cursor, .cm-dropCursor":{borderLeftColor:T7},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:bVe},".cm-panels":{backgroundColor:wVe,color:nb},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:C7,color:UM,border:"none"},".cm-activeLineGutter":{backgroundColor:S7},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:vO},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:vO,borderBottomColor:vO},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:S7,color:nb}}},{dark:!0}),CVe=By.define([{tag:Te.keyword,color:xVe},{tag:[Te.name,Te.deleted,Te.character,Te.propertyName,Te.macroName],color:w7},{tag:[Te.function(Te.variableName),Te.labelName],color:vVe},{tag:[Te.color,Te.constant(Te.name),Te.standard(Te.name)],color:b7},{tag:[Te.definition(Te.name),Te.separator],color:nb},{tag:[Te.typeName,Te.className,Te.number,Te.changed,Te.annotation,Te.modifier,Te.self,Te.namespace],color:pVe},{tag:[Te.operator,Te.operatorKeyword,Te.url,Te.escape,Te.regexp,Te.link,Te.special(Te.string)],color:mVe},{tag:[Te.meta,Te.comment],color:UM},{tag:Te.strong,fontWeight:"bold"},{tag:Te.emphasis,fontStyle:"italic"},{tag:Te.strikethrough,textDecoration:"line-through"},{tag:Te.link,color:UM,textDecoration:"underline"},{tag:Te.heading,fontWeight:"bold",color:w7},{tag:[Te.atom,Te.bool,Te.special(Te.variableName)],color:b7},{tag:[Te.processingInstruction,Te.string,Te.inserted],color:yVe},{tag:Te.invalid,color:gVe}]),TVe=[SVe,Vee(CVe)];var EVe=$e.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),RVe=function(e){e===void 0&&(e={});var{indentWithTab:r=!0,editable:n=!0,readOnly:i=!1,theme:s="light",placeholder:o="",basicSetup:a=!0}=e,l=[];switch(r&&l.unshift(gC.of([B6e])),a&&(typeof a=="boolean"?l.unshift(x7()):l.unshift(x7(a))),o&&l.unshift(zHe(o)),s){case"light":l.push(EVe);break;case"dark":l.push(TVe);break;case"none":break;default:l.push(s);break}return n===!1&&l.push($e.editable.of(!1)),i&&l.push(Qt.readOnly.of(!0)),[...l]},AVe=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)}),E7=Ul.define(),kVe=[];function OVe(t){var{value:e,selection:r,onChange:n,onStatistics:i,onCreateEditor:s,onUpdate:o,extensions:a=kVe,autoFocus:l,theme:u="light",height:h=null,minHeight:d=null,maxHeight:m=null,width:g=null,minWidth:y=null,maxWidth:x=null,placeholder:b="",editable:C=!0,readOnly:E=!1,indentWithTab:R=!0,basicSetup:k=!0,root:O,initialState:P}=t,[D,H]=Y.useState(),[N,_]=Y.useState(),[B,j]=Y.useState(),ee=$e.theme({"&":{height:h,minHeight:d,maxHeight:m,width:g,minWidth:y,maxWidth:x},"& .cm-scroller":{height:"100% !important"}}),oe=$e.updateListener.of(Z=>{if(Z.docChanged&&typeof n=="function"&&!Z.transactions.some(K=>K.annotation(E7))){var ve=Z.state.doc,ie=ve.toString();n(ie,Z)}i&&i(AVe(Z))}),re=RVe({theme:u,editable:C,readOnly:E,placeholder:b,indentWithTab:R,basicSetup:k}),q=[oe,ee,...re];return o&&typeof o=="function"&&q.push($e.updateListener.of(o)),q=q.concat(a),Y.useLayoutEffect(()=>{if(D&&!B){var Z={doc:e,selection:r,extensions:q},ve=P?Qt.fromJSON(P.json,Z,P.fields):Qt.create(Z);if(j(ve),!N){var ie=new $e({state:ve,parent:D,root:O});_(ie),s&&s(ie,ve)}}return()=>{N&&(j(void 0),_(void 0))}},[D,B]),Y.useEffect(()=>{t.container&&H(t.container)},[t.container]),Y.useEffect(()=>()=>{N&&(N.destroy(),_(void 0))},[N]),Y.useEffect(()=>{l&&N&&N.focus()},[l,N]),Y.useEffect(()=>{N&&N.dispatch({effects:Mt.reconfigure.of(q)})},[u,a,h,d,m,g,y,x,b,C,E,R,k,n,o]),Y.useEffect(()=>{if(e!==void 0){var Z=N?N.state.doc.toString():"";N&&e!==Z&&N.dispatch({changes:{from:0,to:Z.length,insert:e||""},annotations:[E7.of(!0)]})}},[e,N]),{state:B,setState:j,view:N,setView:_,container:D,setContainer:H}}var _Ve=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Ih=Y.forwardRef((t,e)=>{var{className:r,value:n="",selection:i,extensions:s=[],onChange:o,onStatistics:a,onCreateEditor:l,onUpdate:u,autoFocus:h,theme:d="light",height:m,minHeight:g,maxHeight:y,width:x,minWidth:b,maxWidth:C,basicSetup:E,placeholder:R,indentWithTab:k,editable:O,readOnly:P,root:D,initialState:H}=t,N=wD(t,_Ve),_=Y.useRef(null),{state:B,view:j,container:ee,setContainer:oe}=OVe({root:D,value:n,autoFocus:h,theme:d,height:m,minHeight:g,maxHeight:y,width:x,minWidth:b,maxWidth:C,basicSetup:E,placeholder:R,indentWithTab:k,editable:O,readOnly:P,selection:i,onChange:o,onStatistics:a,onCreateEditor:l,onUpdate:u,extensions:s,initialState:H});Y.useImperativeHandle(e,()=>({editor:_.current,state:B,view:j}),[_,ee,B,j]);var re=Y.useCallback(Z=>{_.current=Z,oe(Z)},[oe]);if(typeof n!="string")throw new Error("value must be typeof string but got "+typeof n);var q=typeof d=="string"?"cm-theme-"+d:"cm-theme";return I.jsx("div",Xg({ref:re,className:""+q+(r?" "+r:"")},N))});Ih.displayName="CodeMirror";var bn={},R7={eq:"operator",lt:"operator",le:"operator",gt:"operator",ge:"operator",in:"operator",ne:"operator",or:"operator"},MVe=/(<=|>=|!=|<>)/,DVe=/[=\(:\),{}.*<>+\-\/^\[\]]/;function Ri(t,e,r){if(r)for(var n=e.split(" "),i=0;i<n.length;i++)bn[n[i]]={style:t,state:r}}Ri("def","stack pgm view source debug nesting nolist",["inDataStep"]);Ri("def","if while until for do do; end end; then else cancel",["inDataStep"]);Ri("def","label format _n_ _error_",["inDataStep"]);Ri("def","ALTER BUFNO BUFSIZE CNTLLEV COMPRESS DLDMGACTION ENCRYPT ENCRYPTKEY EXTENDOBSCOUNTER GENMAX GENNUM INDEX LABEL OBSBUF OUTREP PW PWREQ READ REPEMPTY REPLACE REUSE ROLE SORTEDBY SPILL TOBSNO TYPE WRITE FILECLOSE FIRSTOBS IN OBS POINTOBS WHERE WHEREUP IDXNAME IDXWHERE DROP KEEP RENAME",["inDataStep"]);Ri("def","filevar finfo finv fipname fipnamel fipstate first firstobs floor",["inDataStep"]);Ri("def","varfmt varinfmt varlabel varlen varname varnum varray varrayx vartype verify vformat vformatd vformatdx vformatn vformatnx vformatw vformatwx vformatx vinarray vinarrayx vinformat vinformatd vinformatdx vinformatn vinformatnx vinformatw vinformatwx vinformatx vlabel vlabelx vlength vlengthx vname vnamex vnferr vtype vtypex weekday",["inDataStep"]);Ri("def","zipfips zipname zipnamel zipstate",["inDataStep"]);Ri("def","put putc putn",["inDataStep"]);Ri("builtin","data run",["inDataStep"]);Ri("def","data",["inProc"]);Ri("def","%if %end %end; %else %else; %do %do; %then",["inMacro"]);Ri("builtin","proc run; quit; libname filename %macro %mend option options",["ALL"]);Ri("def","footnote title libname ods",["ALL"]);Ri("def","%let %put %global %sysfunc %eval ",["ALL"]);Ri("variable","&sysbuffr &syscc &syscharwidth &syscmd &sysdate &sysdate9 &sysday &sysdevic &sysdmg &sysdsn &sysencoding &sysenv &syserr &syserrortext &sysfilrc &syshostname &sysindex &sysinfo &sysjobid &syslast &syslckrc &syslibrc &syslogapplname &sysmacroname &sysmenv &sysmsg &sysncpu &sysodspath &sysparm &syspbuff &sysprocessid &sysprocessname &sysprocname &sysrc &sysscp &sysscpl &sysscpl &syssite &sysstartid &sysstartname &systcpiphostname &systime &sysuserid &sysver &sysvlong &sysvlong4 &syswarningtext",["ALL"]);Ri("def","source2 nosource2 page pageno pagesize",["ALL"]);Ri("def","_all_ _character_ _cmd_ _freq_ _i_ _infile_ _last_ _msg_ _null_ _numeric_ _temporary_ _type_ abort abs addr adjrsq airy alpha alter altlog altprint and arcos array arsin as atan attrc attrib attrn authserver autoexec awscontrol awsdef awsmenu awsmenumerge awstitle backward band base betainv between blocksize blshift bnot bor brshift bufno bufsize bxor by byerr byline byte calculated call cards cards4 catcache cbufno cdf ceil center cexist change chisq cinv class cleanup close cnonct cntllev coalesce codegen col collate collin column comamid comaux1 comaux2 comdef compbl compound compress config continue convert cos cosh cpuid create cross crosstab css curobs cv daccdb daccdbsl daccsl daccsyd dacctab dairy datalines datalines4 datejul datepart datetime day dbcslang dbcstype dclose ddfm ddm delete delimiter depdb depdbsl depsl depsyd deptab dequote descending descript design= device dflang dhms dif digamma dim dinfo display distinct dkricond dkrocond dlm dnum do dopen doptname doptnum dread drop dropnote dsname dsnferr echo else emaildlg emailid emailpw emailserver emailsys encrypt end endsas engine eof eov erf erfc error errorcheck errors exist exp fappend fclose fcol fdelete feedback fetch fetchobs fexist fget file fileclose fileexist filefmt filename fileref  fmterr fmtsearch fnonct fnote font fontalias  fopen foptname foptnum force formatted formchar formdelim formdlim forward fpoint fpos fput fread frewind frlen from fsep fuzz fwrite gaminv gamma getoption getvarc getvarn go goto group gwindow hbar hbound helpenv helploc hms honorappearance hosthelp hostprint hour hpct html hvar ibessel ibr id if index indexc indexw initcmd initstmt inner input inputc inputn inr insert int intck intnx into intrr invaliddata irr is jbessel join juldate keep kentb kurtosis label lag last lbound leave left length levels lgamma lib  library libref line linesize link list log log10 log2 logpdf logpmf logsdf lostcard lowcase lrecl ls macro macrogen maps mautosource max maxdec maxr mdy mean measures median memtype merge merror min minute missing missover mlogic mod mode model modify month mopen mort mprint mrecall msglevel msymtabmax mvarsize myy n nest netpv new news nmiss no nobatch nobs nocaps nocardimage nocenter nocharcode nocmdmac nocol nocum nodate nodbcs nodetails nodmr nodms nodmsbatch nodup nodupkey noduplicates noechoauto noequals noerrorabend noexitwindows nofullstimer noicon noimplmac noint nolist noloadlist nomiss nomlogic nomprint nomrecall nomsgcase nomstored nomultenvappl nonotes nonumber noobs noovp nopad nopercent noprint noprintinit normal norow norsasuser nosetinit  nosplash nosymbolgen note notes notitle notitles notsorted noverbose noxsync noxwait npv null number numkeys nummousekeys nway obs  on open     order ordinal otherwise out outer outp= output over ovp p(1 5 10 25 50 75 90 95 99) pad pad2  paired parm parmcards path pathdll pathname pdf peek peekc pfkey pmf point poisson poke position printer probbeta probbnml probchi probf probgam probhypr probit probnegb probnorm probsig probt procleave prt ps  pw pwreq qtr quote r ranbin rancau random ranexp rangam range ranks rannor ranpoi rantbl rantri ranuni rcorr read recfm register regr remote remove rename repeat repeated replace resolve retain return reuse reverse rewind right round rsquare rtf rtrace rtraceloc s s2 samploc sasautos sascontrol sasfrscr sasmsg sasmstore sasscript sasuser saving scan sdf second select selection separated seq serror set setcomm setot sign simple sin sinh siteinfo skewness skip sle sls sortedby sortpgm sortseq sortsize soundex  spedis splashlocation split spool sqrt start std stderr stdin stfips stimer stname stnamel stop stopover sub subgroup subpopn substr sum sumwgt symbol symbolgen symget symput sysget sysin sysleave sysmsg sysparm sysprint sysprintfont sysprod sysrc system t table tables tan tanh tapeclose tbufsize terminal test then timepart tinv  tnonct to today tol tooldef totper transformout translate trantab tranwrd trigamma trim trimn trunc truncover type unformatted uniform union until upcase update user usericon uss validate value var  weight when where while wincharset window work workinit workterm write wsum xsync xwait yearcutoff yes yyq  min max",["inDataStep","inProc"]);Ri("operator","and not ",["inDataStep","inProc"]);function PVe(t,e){var r=t.next();if(r==="/"&&t.eat("*"))return e.continueComment=!0,"comment";if(e.continueComment===!0)return r==="*"&&t.peek()==="/"?(t.next(),e.continueComment=!1):t.skipTo("*")?(t.skipTo("*"),t.next(),t.eat("/")&&(e.continueComment=!1)):t.skipToEnd(),"comment";if(r=="*"&&t.column()==t.indentation())return t.skipToEnd(),"comment";var n=r+t.peek();if((r==='"'||r==="'")&&!e.continueString)return e.continueString=r,"string";if(e.continueString)return e.continueString==r?e.continueString=null:t.skipTo(e.continueString)?(t.next(),e.continueString=null):t.skipToEnd(),"string";if(e.continueString!==null&&t.eol())return t.skipTo(e.continueString)||t.skipToEnd(),"string";if(/[\d\.]/.test(r))return r==="."?t.match(/^[0-9]+([eE][\-+]?[0-9]+)?/):r==="0"?t.match(/^[xX][0-9a-fA-F]+/)||t.match(/^0[0-7]+/):t.match(/^[0-9]*\.?[0-9]*([eE][\-+]?[0-9]+)?/),"number";if(MVe.test(r+t.peek()))return t.next(),"operator";if(R7.hasOwnProperty(n)){if(t.next(),t.peek()===" ")return R7[n.toLowerCase()]}else if(DVe.test(r))return"operator";var i;if(t.match(/[%&;\w]+/,!1)!=null){if(i=r+t.match(/[%&;\w]+/,!0),/&/.test(i))return"variable"}else i=r;if(e.nextword)return t.match(/[\w]+/),t.peek()==="."&&t.skipTo(" "),e.nextword=!1,"variableName.special";if(i=i.toLowerCase(),e.inDataStep){if(i==="run;"||t.match(/run\s;/))return e.inDataStep=!1,"builtin";if(i&&t.next()===".")return/\w/.test(t.peek())?"variableName.special":"variable";if(i&&bn.hasOwnProperty(i)&&(bn[i].state.indexOf("inDataStep")!==-1||bn[i].state.indexOf("ALL")!==-1)){t.start<t.pos&&t.backUp(t.pos-t.start);for(var s=0;s<i.length;++s)t.next();return bn[i].style}}if(e.inProc){if(i==="run;"||i==="quit;")return e.inProc=!1,"builtin";if(i&&bn.hasOwnProperty(i)&&(bn[i].state.indexOf("inProc")!==-1||bn[i].state.indexOf("ALL")!==-1))return t.match(/[\w]+/),bn[i].style}return e.inMacro?i==="%mend"?(t.peek()===";"&&t.next(),e.inMacro=!1,"builtin"):i&&bn.hasOwnProperty(i)&&(bn[i].state.indexOf("inMacro")!==-1||bn[i].state.indexOf("ALL")!==-1)?(t.match(/[\w]+/),bn[i].style):"atom":i&&bn.hasOwnProperty(i)?(t.backUp(1),t.match(/[\w]+/),i==="data"&&/=/.test(t.peek())===!1?(e.inDataStep=!0,e.nextword=!0,"builtin"):i==="proc"?(e.inProc=!0,e.nextword=!0,"builtin"):i==="%macro"?(e.inMacro=!0,e.nextword=!0,"builtin"):/title[1-9]/.test(i)?"def":i==="footnote"?(t.eat(/[1-9]/),"def"):e.inDataStep===!0&&bn[i].state.indexOf("inDataStep")!==-1||e.inProc===!0&&bn[i].state.indexOf("inProc")!==-1||e.inMacro===!0&&bn[i].state.indexOf("inMacro")!==-1||bn[i].state.indexOf("ALL")!==-1?bn[i].style:null):null}const A7={name:"sas",startState:function(){return{inDataStep:!1,inProc:!1,inMacro:!1,nextword:!1,continueString:null,continueComment:!1}},token:function(t,e){return t.eatSpace()?null:PVe(t,e)},languageData:{commentTokens:{block:{open:"/*",close:"*/"}}}},IVe=`
%setup(version=260,
    localsetup=root/%scan(&_exec_programpath.,2,/)/%scan(&_exec_programpath.,3,/)/%scan(&_exec_programpath.,4,/)/ar/%scan(&_exec_programpath.,6,/)/common/%scan(&_exec_programpath.,8,/)/macro/localsetup.sas
);

/* Remove call to localsetup macro if it is not needed */
%localsetup;
/**************************************************************************
 * 1. Dataset setup.
 *************************************************************************/
data adtte;
    set adam.adtte;
    where paramcd='TRPROGM' and parqual='INDEPENDENT ASSESSOR' and mittfl='Y';
run;
/**************************************************************************
 * 2. Header and treatment group setting.
 *************************************************************************/
%m_u_popn(
    inds=adam.adsl,
    pop_flag=mittfl="Y",
    trtgrpn=trt01pn,
    trtlev=1|2,
    UniqueIDVars=usubjid,
    trtfmtC=_tlf_setup_trtfmteff,
    gmacro=mittpopb,
    BigN=Y,
    nformat=,
    debug=Y
);
/**************************************************************************
 * 3. Analaysis process.
 *************************************************************************/
/* Number counting part */
%m_u_effcount(
    inds=adtte,
    pop_flag=mittfl='Y',
    trtgrpn=trt01pn,
    denomds=,
    pop_mvar=mittpopb,
    index={cond=CNSR=0 # label=%nrbquote(Total events [a], n (%)) #level=0 subord=1}
          {cond=cnsr=0 and find(evntdesc,'RECIST progression') label=RECIST progression level=1 subord=2}
          {cond=cnsr=0 and find(evntdesc,'RECIST progression with target') label=Target lesion [b] level=2 subord=3}
          {cond=cnsr=1 label=%nrbquote(Censored patients, n (%)) level=0 subord=4}
          {cond=cnsr=1 and find(evntdesc,'Censored RECIST progression') label=Censored RECIST progression [c] level=1 subord=5},
    statlabel=Y,
    ord=1,
    debug=N
);

/* PFS median and rate at x time with CI */
%m_u_km(
    inds=adtte,
    WHR=,
    alpha=0.05,
    method=KM,
    conftype=LOG,
    trtgrpn=trt01pN,
    trtgrpnord=2 | 1,
    trtgrpn2=,
    var_time=AVAL,
    var_status=CNSR,
    cen_num=0,
    evnt_num=,
    step_list=160 to 1686 by 160,
    step_unit=days,
    XDIVISOR=,
    plot=0,
    outdat_median=final2,
    median_label=Progression-free survival (<<unit>>) [e] [f],
    outdat_timelist=final3,
    timelist_label=Progression-free survival rate [e]
);

/* Comparison between group (HR, CI and p-value) */
%m_u_cox_logrank(
    inds=adtte,
    out=final_cox/*default: a_final_cox*/,
    blocklbl=Comparison of treatment groups [g],
    modelkey=cox|logrank,
    transfl=Y,
    trtgrpn=trt01pn,
    var=aval,
    byvar=,
    alpha=0.05,
    censor=,
    indicator=,
    ties=,
    pair=1-2,
    strata=STRAT1 STRAT2,
    pvalside=,
    missval=,
    digit=,
    cidecimal=,
    hrlbl=,
    pvallbl=,
    cilbl=,
    prefix=,
    debug=Y
);

/**************************************************************************
 * 4. Final report data manipulation.
 *************************************************************************/
data final0;
    set final_effcount_1(keep=col: ord) final_cox(in=b);
    if b then ord=2;
run;

data final0; set final0; ord=1; run;
data final2; set final2; ord=3; run;
data final3; set final3; ord=4; run;
data final;
    set final0 final2 final3;
    ord1 = _n_;
run;

%m_u_col_header(
    inds=final,
    outds=final1,
    gmacro=mittpopb
); /* call macro to add label for each treatment group variables */
/* %m_ucol_header(inds=final0,outds=final1,gmacro=mittpopb ); call macro to add label for each treatment group variables */

%let output = %scan(&_exec_programname.,1, ".");
%let sfx = a;
data final tlf.&output.&sfx.(drop=ord);
    set final1(rename=(col1=col3 col2=col4 col_blocklabel=col1 col_statlabel=col2));
    label col2 = 'Statistic';
run;

/**************************************************************************
 * 5. Output
 *************************************************************************/
%istartv2(SUFFIX=a);
%m_u_report(
    table=final,
    lenlist=31#17#17#17,
    justlist=l#l#c#c,
    justlist_header=l#l#c#c,
    nolblist=Y#N#N#N,
    orderlist=Y#Y#N#N,
    defcol=(col1 col2 col3 col4),
    blank_after=ord,
    pg=18
);
%istopv2;
`,NVe=`
%setup(version=260,
       localsetup=root/%scan(&_exec_programpath.,2,/)/%scan(&_exec_programpath.,3,/)/%scan(&_exec_programpath.,4,/)/ar/%scan(&_exec_programpath.,6,/)/common/%scan(&_exec_programpath.,8,/)/macro/localsetup.sas);

** Remove call to localsetup macro if it is not needed **;
%localsetup;
								
/**************************************************************************
 * 1. Dataset setup.
 *************************************************************************/
data adtte;
	set adam.adtte;
run;
/**************************************************************************
 * 2. call display macro.
 *************************************************************************/
%m_t_aztoncef04(
    /*public*/
     inds					=	 adtte
    ,whr            		=	paramcd='TRPROGM' and parqual='INDEPENDENT ASSESSOR'
    ,pop_flag       		=	mittfl='Y'
    ,pop_mvar				=	ittdummyn2
    ,trtgrpn       		 	=	trt01pN 		
    ,var					=	aval
    ,alpha					=	0.05
    /*,pair       			=	1-2|4-2|6-2|5-2|7-2*/
    ,pair       			=	1-5|4-5|6-5|3-5|7-5
    ,debug					=   Y
    /*effcount*/   
    ,effcount_index			=   {cond=CNSR=0 # label=%nrbquote(Total events [a], n (%)) #level=0 subord=1}
								  {cond=cnsr=0 and find(evntdesc,'RECIST progression')  # label=RECIST progression #level=1 subord=2}
								  {cond=cnsr=0 and find(evntdesc,'RECIST progression with target') # label=Target lesion [b] #level=2 subord=3}
								  {cond=cnsr=1 label=%nrbquote(Censored patients, n (%)) #level=0 subord=4}
								  {cond=cnsr=1 and find(evntdesc,'Censored RECIST progression')  # label=Censored RECIST progression [c] #level=1 /*section=6*/ subord=5}
						      
    /*cox, logrank*/
    ,coxlog_blocklbl	    =   Comparison of treatment groups [g]
    ,coxlog_modelkey		=   cox|logrank			
    ,coxlog_strata			= 	STRAT1 STRAT2                                                                          
       
    /*km*/	 
	,km_method         		=   km
	,km_conftype       		=   log 
    ,km_cen_num       		=   0
	,km_step_list	   		=   160 to 1686 by 160
    ,km_step_unit      		=   days
	,km_median_label   		=   Progression-free survival (days) [e] [f]
	,km_timelist_label 		=   Progression-free survival rate [e]
    /*desc_stat*/		
	,desc_stat_inds    		 =   adtte
	,desc_stat_whr    		 =  %str(paramcd='TRTTFST' and mittfl='Y')
	,desc_stat_var     		 =  aval
	,desc_stat_label   		 =  %str(Duration between <<RECIST>> progression and the last evaluable <<RECIST>>  assessment prior to progression (<<unit>>))

    /*report*/
	, lenlist 		   		=  20#7#10#10#10#10#10#10 
	, justlist 		   		=  l#l#c#c#c#c#c#c 
	, justlist_header 		=  l#l#c#c#c#c#c#c 
	, nolblist 		   		=  Y#N#N#N#N#N#N#N 
	, orderlist 	   		=  N#N#N#N#N#N#N#N
	, defcol 		  		=  (col1 col2 col3 col5 col6 col7 col8 col4)
	, rtf					=	y
	, sfx					=	a
);

`,LVe=[{id:"simplicity",title:"Simplicity",description:"Easy to understand and maintain code structure",icon:I.jsx(p3e,{sx:{color:"#36e09e",fontSize:"2rem"}})},{id:"flexibility",title:"Flexibility",description:"Adaptable to various analysis requirements",icon:I.jsx(m3e,{sx:{color:"#36e09e",fontSize:"2rem"}})},{id:"consistency",title:"Consistency",description:"Standardized approach across all analyses",icon:I.jsx(g3e,{sx:{color:"#36e09e",fontSize:"2rem"}})},{id:"accuracy",title:"Accuracy",description:"Precise and reliable results every time",icon:I.jsx(v3e,{sx:{color:"#36e09e",fontSize:"2rem"}})}],FVe=({theme:t})=>{const[e,r]=Y.useState(0),n=(i,s)=>{r(s)};return I.jsx(qs,{title:"Code Structure and Steps",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:"column",height:"calc(100% - 60px)",justifyContent:"space-between",mt:-2},children:[I.jsxs(_e,{sx:{display:"flex",gap:2,height:"450px",mb:4},children:[I.jsxs(_e,{sx:{width:"50%"},children:[I.jsx(pt,{variant:"subtitle2",sx:{fontSize:"1.2rem",mb:1,color:t.palette.primary.main,fontWeight:600},children:"Display Macros for Standard Outputs"}),I.jsxs(Iw,{sx:{height:"100%",bgcolor:"#181c24",position:"relative",borderRadius:1,overflow:"hidden"},children:[I.jsx(_e,{sx:{position:"absolute",right:5,top:"15%",height:"70%",width:24,zIndex:10,display:"flex",justifyContent:"center"},children:I.jsx(_e,{sx:{height:"100%",width:4,borderRadius:4,bgcolor:"rgba(255,255,255,0.1)",position:"relative"},children:I.jsx(_e,{sx:{position:"absolute",left:"-5px",width:14,height:18,bgcolor:"#666",borderRadius:2,top:`${e}%`,transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onMouseDown:i=>{const s=i.currentTarget.parentElement;if(!s)return;const o=s.clientHeight,a=u=>{const h=s.getBoundingClientRect(),d=u.clientY-h.top,m=Math.max(0,Math.min(100,d/o*100));n(null,m)},l=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",l)},children:I.jsx(PW,{sx:{fontSize:"0.6rem",color:"#fff"}})})})}),I.jsx(_e,{sx:{height:"100%",overflow:"auto",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},ref:i=>{if(i){const s=i.scrollHeight-i.clientHeight;i.scrollTop=e/100*s}},children:I.jsx(Ih,{value:NVe,height:"100%",theme:"dark",extensions:[nS.define(A7)],editable:!1,style:{fontSize:"0.82rem",backgroundColor:"#181c24"}})})]})]}),I.jsxs(_e,{sx:{width:"50%"},children:[I.jsx(pt,{variant:"subtitle2",sx:{fontSize:"1.2rem",mb:1,color:t.palette.primary.main,fontWeight:600},children:"Template Code with Utility Macros"}),I.jsxs(Iw,{sx:{height:"100%",bgcolor:"#181c24",position:"relative",borderRadius:1,overflow:"hidden"},children:[I.jsx(_e,{sx:{position:"absolute",right:5,top:"15%",height:"70%",width:24,zIndex:10,display:"flex",justifyContent:"center"},children:I.jsx(_e,{sx:{height:"100%",width:4,borderRadius:4,bgcolor:"rgba(255,255,255,0.1)",position:"relative"},children:I.jsx(_e,{sx:{position:"absolute",left:"-5px",width:14,height:18,bgcolor:"#666",borderRadius:2,top:`${e}%`,transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onMouseDown:i=>{const s=i.currentTarget.parentElement;if(!s)return;const o=s.clientHeight,a=u=>{const h=s.getBoundingClientRect(),d=u.clientY-h.top,m=Math.max(0,Math.min(100,d/o*100));n(null,m)},l=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",l)},children:I.jsx(PW,{sx:{fontSize:"0.6rem",color:"#fff"}})})})}),I.jsx(_e,{sx:{height:"100%",overflow:"auto",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},ref:i=>{if(i){const s=i.scrollHeight-i.clientHeight;i.scrollTop=e/100*s}},children:I.jsx(Ih,{value:IVe,height:"100%",theme:"dark",extensions:[nS.define(A7)],editable:!1,style:{fontSize:"0.82rem",backgroundColor:"#181c24"}})})]})]})]}),I.jsx(_e,{sx:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:2,mb:2,mt:4,height:"100px",px:4},children:LVe.map(i=>I.jsx(_e,{sx:{position:"relative","&:hover":{transform:"scale(1.05)",transition:"transform 0.2s ease-in-out"}},children:I.jsxs(Iw,{sx:{p:1.5,height:"100%",display:"flex",alignItems:"center",bgcolor:"rgba(54, 224, 158, 0.1)",borderRadius:"8px",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",transition:"all 0.2s ease-in-out",cursor:"pointer","&:hover":{bgcolor:"rgba(54, 224, 158, 0.15)",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}},children:[I.jsx(_e,{sx:{mr:2},children:i.icon}),I.jsxs(_e,{children:[I.jsx(pt,{variant:"subtitle2",sx:{fontSize:"0.9rem",fontWeight:600,mb:.3,color:t.palette.primary.main},children:i.title}),I.jsx(pt,{variant:"caption",sx:{fontSize:"0.75rem",display:"block",color:"#666",lineHeight:1.2},children:i.description})]})]})},i.id))})]})})},HVe=({theme:t})=>I.jsx(qs,{title:"Example: AZTONCEF04",children:I.jsx(_e,{sx:{display:"flex",justifyContent:"center",alignItems:"flex-start",width:"100%",height:"100%",pt:2,pb:6,px:4},children:I.jsx(_e,{component:"img",src:"/ogemsharing/images/ef04.PNG",alt:"AZTONCEF04 Example",sx:{maxWidth:"100%",maxHeight:"75vh",objectFit:"contain",boxShadow:3,borderRadius:2,mt:-2}})})},"aztoncef04");var k7={};class hS{constructor(e,r,n,i,s,o,a,l,u,h=0,d){this.p=e,this.stack=r,this.state=n,this.reducePos=i,this.pos=s,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=u,this.lookAhead=h,this.parent=d}toString(){return`[${this.stack.filter((e,r)=>r%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,r,n=0){let i=e.parser.context;return new hS(e,[],r,n,n,0,[],0,i?new O7(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,r){this.stack.push(this.state,r,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var r;let n=e>>19,i=e&65535,{parser:s}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let a=s.dynamicPrecedence(i);if(a&&(this.score+=a),n==0){this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(i,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),u=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-u;h>=2e3&&!(!((r=this.p.parser.nodeSet.types[i])===null||r===void 0)&&r.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=h));let d=l?this.stack[l-1]:0,m=this.bufferBase+this.buffer.length-d;if(i<s.minRepeatTerm||e&131072){let g=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,u,g,m+4,!0)}if(e&262144)this.state=this.stack[l];else{let g=this.stack[l-3];this.state=s.getGoto(g,i,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(i,u)}storeNode(e,r,n,i=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(r==n)return;if(o.buffer[a-2]>=r){o.buffer[a-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,r,n,i);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let a=!1;for(let l=o;l>0&&this.buffer[l-2]>n;l-=4)if(this.buffer[l-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>n;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,i>4&&(i-=4)}this.buffer[o]=e,this.buffer[o+1]=r,this.buffer[o+2]=n,this.buffer[o+3]=i}}shift(e,r,n,i){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let s=e,{parser:o}=this.p;(i>this.pos||r<=o.maxNode)&&(this.pos=i,o.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,n),this.shiftContext(r,n),r<=o.maxNode&&this.buffer.push(r,n,i,4)}else this.pos=i,this.shiftContext(r,n),r<=this.p.parser.maxNode&&this.buffer.push(r,n,i,4)}apply(e,r,n,i){e&65536?this.reduce(e):this.shift(e,r,n,i)}useNode(e,r){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(r,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,r=e.buffer.length;for(;r>0&&e.buffer[r-2]>e.reducePos;)r-=4;let n=e.buffer.slice(r),i=e.bufferBase+r;for(;e&&i==e.bufferBase;)e=e.parent;return new hS(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,r){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,r,4),this.storeNode(0,this.pos,r,n?8:4),this.pos=this.reducePos=r,this.score-=190}canShift(e){for(let r=new BVe(this);;){let n=this.p.parser.stateSlot(r.state,4)||this.p.parser.hasAction(r.state,e);if(n==0)return!1;if((n&65536)==0)return!0;r.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let r=this.p.parser.nextStates(this.state);if(r.length>8||this.stack.length>=120){let i=[];for(let s=0,o;s<r.length;s+=2)(o=r[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&i.push(r[s],o);if(this.stack.length<120)for(let s=0;i.length<8&&s<r.length;s+=2){let o=r[s+1];i.some((a,l)=>l&1&&a==o)||i.push(r[s],o)}r=i}let n=[];for(let i=0;i<r.length&&n.length<4;i+=2){let s=r[i+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(r[i],this.pos),o.reducePos=this.pos,o.score-=200,n.push(o)}return n}forceReduce(){let{parser:e}=this.p,r=e.stateSlot(this.state,5);if((r&65536)==0)return!1;if(!e.validAction(this.state,r)){let n=r>>19,i=r&65535,s=this.stack.length-n*3;if(s<0||e.getGoto(this.stack[s],i,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;r=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(r),!0}findForcedReduction(){let{parser:e}=this.p,r=[],n=(i,s)=>{if(!r.includes(i))return r.push(i),e.allActions(i,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-s;if(a>1){let l=o&65535,u=this.stack.length-a*3;if(u>=0&&e.getGoto(this.stack[u],l,!1)>=0)return a<<19|65536|l}}else{let a=n(o,s+1);if(a!=null)return a}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let r=0;r<this.stack.length;r+=3)if(this.stack[r]!=e.stack[r])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(r)))}reduceContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(r)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let r=new O7(this.curContext.tracker,e);r.hash!=this.curContext.hash&&this.emitContext(),this.curContext=r}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class O7{constructor(e,r){this.tracker=e,this.context=r,this.hash=e.strict?e.hash(r):0}}class BVe{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let r=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],r,!0);this.state=i}}class dS{constructor(e,r,n){this.stack=e,this.pos=r,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,r=e.bufferBase+e.buffer.length){return new dS(e,r,r-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new dS(this.stack,this.pos,this.index)}}function Aw(t,e=Uint16Array){if(typeof t!="string")return t;let r=null;for(let n=0,i=0;n<t.length;){let s=0;for(;;){let o=t.charCodeAt(n++),a=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),s+=l,a)break;s*=46}r?r[i++]=s:r=new e(s)}return r}class ib{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const _7=new ib;class VVe{constructor(e,r){this.input=e,this.ranges=r,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=_7,this.rangeIndex=0,this.pos=this.chunkPos=r[0].from,this.range=r[0],this.end=r[r.length-1].to,this.readNext()}resolveOffset(e,r){let n=this.range,i=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!i)return null;let o=this.ranges[--i];s-=n.from-o.to,n=o}for(;r<0?s>n.to:s>=n.to;){if(i==this.ranges.length-1)return null;let o=this.ranges[++i];s+=o.from-n.to,n=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let r of this.ranges)if(r.to>e)return Math.max(e,r.from);return this.end}peek(e){let r=this.chunkOff+e,n,i;if(r>=0&&r<this.chunk.length)n=this.pos+e,i=this.chunk.charCodeAt(r);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=n;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-n)),i=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),i}acceptToken(e,r=0){let n=r?this.resolveOffset(r,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,r){this.token.value=e,this.token.end=r}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:r}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=r,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),r=this.pos+e.length;this.chunk=r>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,r){if(r?(this.token=r,r.start=e,r.lookAhead=e+1,r.value=r.extended=-1):this.token=_7,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,r){if(e>=this.chunkPos&&r<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,r-this.chunkPos);if(e>=this.chunk2Pos&&r<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,r-this.chunk2Pos);if(e>=this.range.from&&r<=this.range.to)return this.input.read(e,r);let n="";for(let i of this.ranges){if(i.from>=r)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,r)))}return n}}class _p{constructor(e,r){this.data=e,this.id=r}token(e,r){let{parser:n}=r.p;WVe(this.data,e,r,this.id,n.data,n.tokenPrecTable)}}_p.prototype.contextual=_p.prototype.fallback=_p.prototype.extend=!1;_p.prototype.fallback=_p.prototype.extend=!1;class jVe{constructor(e,r={}){this.token=e,this.contextual=!!r.contextual,this.fallback=!!r.fallback,this.extend=!!r.extend}}function WVe(t,e,r,n,i,s){let o=0,a=1<<n,{dialect:l}=r.p.parser;e:for(;(a&t[o])!=0;){let u=t[o+1];for(let g=o+3;g<u;g+=2)if((t[g+1]&a)>0){let y=t[g];if(l.allows(y)&&(e.token.value==-1||e.token.value==y||zVe(y,e.token.value,i,s))){e.acceptToken(y);break}}let h=e.next,d=0,m=t[o+2];if(e.next<0&&m>d&&t[u+m*3-3]==65535){o=t[u+m*3-1];continue e}for(;d<m;){let g=d+m>>1,y=u+g+(g<<1),x=t[y],b=t[y+1]||65536;if(h<x)m=g;else if(h>=b)d=g+1;else{o=t[y+2],e.advance();continue e}}break}}function M7(t,e,r){for(let n=e,i;(i=t[n])!=65535;n++)if(i==r)return n-e;return-1}function zVe(t,e,r,n){let i=M7(r,n,e);return i<0||M7(r,n,t)<i}const io=typeof process<"u"&&k7&&/\bparse\b/.test(k7.LOG);let yO=null;function D7(t,e,r){let n=t.cursor(wi.IncludeAnonymous);for(n.moveTo(e);;)if(!(r<0?n.childBefore(e):n.childAfter(e)))for(;;){if((r<0?n.to<e:n.from>e)&&!n.type.isError)return r<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(r<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return r<0?0:t.length}}class UVe{constructor(e,r){this.fragments=e,this.nodeSet=r,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?D7(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?D7(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let r=this.trees.length-1;if(r<0)return this.nextFragment(),null;let n=this.trees[r],i=this.index[r];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[i],o=this.start[r]+n.positions[i];if(o>e)return this.nextStart=o,null;if(s instanceof Fr){if(o==e){if(o<this.safeFrom)return null;let a=o+s.length;if(a<=this.safeTo){let l=s.prop(Vt.lookAhead);if(!l||a+l<this.fragment.to)return s}}this.index[r]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[r]++,this.nextStart=o+s.length}}}class $Ve{constructor(e,r){this.stream=r,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new ib)}getActions(e){let r=0,n=null,{parser:i}=e.p,{tokenizers:s}=i,o=i.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,l=0;for(let u=0;u<s.length;u++){if((1<<u&o)==0)continue;let h=s[u],d=this.tokens[u];if(!(n&&!h.fallback)&&((h.contextual||d.start!=e.pos||d.mask!=o||d.context!=a)&&(this.updateCachedToken(d,h,e),d.mask=o,d.context=a),d.lookAhead>d.end+25&&(l=Math.max(d.lookAhead,l)),d.value!=0)){let m=r;if(d.extended>-1&&(r=this.addActions(e,d.extended,d.end,r)),r=this.addActions(e,d.value,d.end,r),!h.extend&&(n=d,r>m))break}}for(;this.actions.length>r;)this.actions.pop();return l&&e.setLookAhead(l),!n&&e.pos==this.stream.end&&(n=new ib,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,r=this.addActions(e,n.value,n.end,r)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let r=new ib,{pos:n,p:i}=e;return r.start=n,r.end=Math.min(n+1,i.stream.end),r.value=n==i.stream.end?i.parser.eofTerm:0,r}updateCachedToken(e,r,n){let i=this.stream.clipPos(n.pos);if(r.token(this.stream.reset(i,e),n),e.value>-1){let{parser:s}=n.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let a=s.specializers[o](this.stream.read(e.start,e.end),n);if(a>=0&&n.p.parser.dialect.allows(a>>1)){(a&1)==0?e.value=a>>1:e.extended=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,r,n,i){for(let s=0;s<i;s+=3)if(this.actions[s]==e)return i;return this.actions[i++]=e,this.actions[i++]=r,this.actions[i++]=n,i}addActions(e,r,n,i){let{state:s}=e,{parser:o}=e.p,{data:a}=o;for(let l=0;l<2;l++)for(let u=o.stateSlot(s,l?2:1);;u+=3){if(a[u]==65535)if(a[u+1]==1)u=yc(a,u+2);else{i==0&&a[u+1]==2&&(i=this.putAction(yc(a,u+2),r,n,i));break}a[u]==r&&(i=this.putAction(yc(a,u+1),r,n,i))}return i}}class GVe{constructor(e,r,n,i){this.parser=e,this.input=r,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new VVe(r,i),this.tokens=new $Ve(e,this.stream),this.topTerm=e.top[1];let{from:s}=i[0];this.stacks=[hS.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new UVe(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,r=this.minStackPos,n=this.stacks=[],i,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let a=e[o];for(;;){if(this.tokens.mainToken=null,a.pos>r)n.push(a);else{if(this.advanceStack(a,n,e))continue;{i||(i=[],s=[]),i.push(a);let l=this.tokens.getMainToken(a);s.push(l.value,l.end)}}break}}if(!n.length){let o=i&&qVe(i);if(o)return io&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw io&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5)}if(this.recovering&&i){let o=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,s,n);if(o)return io&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(n.length>o)for(n.sort((a,l)=>l.score-a.score);n.length>o;)n.pop();n.some(a=>a.reducePos>r)&&this.recovering--}else if(n.length>1){e:for(let o=0;o<n.length-1;o++){let a=n[o];for(let l=o+1;l<n.length;l++){let u=n[l];if(a.sameState(u)||a.buffer.length>500&&u.buffer.length>500)if((a.score-u.score||a.buffer.length-u.buffer.length)>0)n.splice(l--,1);else{n.splice(o--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let o=1;o<n.length;o++)n[o].pos<this.minStackPos&&(this.minStackPos=n[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,r,n){let i=e.pos,{parser:s}=this,o=io?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let u=e.curContext&&e.curContext.tracker.strict,h=u?e.curContext.hash:0;for(let d=this.fragments.nodeAt(i);d;){let m=this.parser.nodeSet.types[d.type.id]==d.type?s.getGoto(e.state,d.type.id):-1;if(m>-1&&d.length&&(!u||(d.prop(Vt.contextHash)||0)==h))return e.useNode(d,m),io&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(d.type.id)})`),!0;if(!(d instanceof Fr)||d.children.length==0||d.positions[0]>0)break;let g=d.children[0];if(g instanceof Fr&&d.positions[0]==0)d=g;else break}}let a=s.stateSlot(e.state,4);if(a>0)return e.reduce(a),io&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(a&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let u=0;u<l.length;){let h=l[u++],d=l[u++],m=l[u++],g=u==l.length||!n,y=g?e:e.split(),x=this.tokens.mainToken;if(y.apply(h,d,x?x.start:y.pos,m),io&&console.log(o+this.stackID(y)+` (via ${(h&65536)==0?"shift":`reduce of ${s.getName(h&65535)}`} for ${s.getName(d)} @ ${i}${y==e?"":", split"})`),g)return!0;y.pos>i?r.push(y):n.push(y)}return!1}advanceFully(e,r){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return P7(e,r),!0}}runRecovery(e,r,n){let i=null,s=!1;for(let o=0;o<e.length;o++){let a=e[o],l=r[o<<1],u=r[(o<<1)+1],h=io?this.stackID(a)+" -> ":"";if(a.deadEnd&&(s||(s=!0,a.restart(),io&&console.log(h+this.stackID(a)+" (restarted)"),this.advanceFully(a,n))))continue;let d=a.split(),m=h;for(let g=0;d.forceReduce()&&g<10&&(io&&console.log(m+this.stackID(d)+" (via force-reduce)"),!this.advanceFully(d,n));g++)io&&(m=this.stackID(d)+" -> ");for(let g of a.recoverByInsert(l))io&&console.log(h+this.stackID(g)+" (via recover-insert)"),this.advanceFully(g,n);this.stream.end>a.pos?(u==a.pos&&(u++,l=0),a.recoverByDelete(l,u),io&&console.log(h+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),P7(a,n)):(!i||i.score<a.score)&&(i=a)}return i}stackToTree(e){return e.close(),Fr.build({buffer:dS.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let r=(yO||(yO=new WeakMap)).get(e);return r||yO.set(e,r=String.fromCodePoint(this.nextStackID++)),r+e}}function P7(t,e){for(let r=0;r<e.length;r++){let n=e[r];if(n.pos==t.pos&&n.sameState(t)){e[r].score<t.score&&(e[r]=t);return}}e.push(t)}class YVe{constructor(e,r,n){this.source=e,this.flags=r,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}class pS extends gN{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let r=e.nodeNames.split(" ");this.minRepeatTerm=r.length;for(let a=0;a<e.repeatNodeCount;a++)r.push("");let n=Object.keys(e.topRules).map(a=>e.topRules[a][1]),i=[];for(let a=0;a<r.length;a++)i.push([]);function s(a,l,u){i[a].push([l,l.deserialize(String(u))])}if(e.nodeProps)for(let a of e.nodeProps){let l=a[0];typeof l=="string"&&(l=Vt[l]);for(let u=1;u<a.length;){let h=a[u++];if(h>=0)s(h,l,a[u++]);else{let d=a[u+-h];for(let m=-h;m>0;m--)s(a[u++],l,d);u++}}}this.nodeSet=new yC(r.map((a,l)=>Cs.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:i[l],top:n.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=bee;let o=Aw(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(I7),this.states=Aw(e.states,Uint32Array),this.data=Aw(e.stateData),this.goto=Aw(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(a=>typeof a=="number"?new _p(o,a):a),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,r,n){let i=new GVe(this,e,r,n);for(let s of this.wrappers)i=s(i,e,r,n);return i}getGoto(e,r,n=!1){let i=this.goto;if(r>=i[0])return-1;for(let s=i[r+1];;){let o=i[s++],a=o&1,l=i[s++];if(a&&n)return l;for(let u=s+(o>>1);s<u;s++)if(i[s]==e)return l;if(a)return-1}}hasAction(e,r){let n=this.data;for(let i=0;i<2;i++)for(let s=this.stateSlot(e,i?2:1),o;;s+=3){if((o=n[s])==65535)if(n[s+1]==1)o=n[s=yc(n,s+2)];else{if(n[s+1]==2)return yc(n,s+2);break}if(o==r||o==0)return yc(n,s+1)}return 0}stateSlot(e,r){return this.states[e*6+r]}stateFlag(e,r){return(this.stateSlot(e,0)&r)>0}validAction(e,r){return!!this.allActions(e,n=>n==r?!0:null)}allActions(e,r){let n=this.stateSlot(e,4),i=n?r(n):void 0;for(let s=this.stateSlot(e,1);i==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=yc(this.data,s+2);else break;i=r(yc(this.data,s+1))}return i}nextStates(e){let r=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=yc(this.data,n+2);else break;if((this.data[n+2]&1)==0){let i=this.data[n+1];r.some((s,o)=>o&1&&s==i)||r.push(this.data[n],i)}}return r}configure(e){let r=Object.assign(Object.create(pS.prototype),this);if(e.props&&(r.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);r.top=n}return e.tokenizers&&(r.tokenizers=this.tokenizers.map(n=>{let i=e.tokenizers.find(s=>s.from==n);return i?i.to:n})),e.specializers&&(r.specializers=this.specializers.slice(),r.specializerSpecs=this.specializerSpecs.map((n,i)=>{let s=e.specializers.find(a=>a.from==n.external);if(!s)return n;let o=Object.assign(Object.assign({},n),{external:s.to});return r.specializers[i]=I7(o),o})),e.contextTracker&&(r.context=e.contextTracker),e.dialect&&(r.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(r.strict=e.strict),e.wrap&&(r.wrappers=r.wrappers.concat(e.wrap)),e.bufferLength!=null&&(r.bufferLength=e.bufferLength),r}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let r=this.dynamicPrecedences;return r==null?0:r[e]||0}parseDialect(e){let r=Object.keys(this.dialects),n=r.map(()=>!1);if(e)for(let s of e.split(" ")){let o=r.indexOf(s);o>=0&&(n[o]=!0)}let i=null;for(let s=0;s<r.length;s++)if(!n[s])for(let o=this.dialects[r[s]],a;(a=this.data[o++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[a]=1;return new YVe(e,n,i)}static deserialize(e){return new pS(e)}}function yc(t,e){return t[e]|t[e+1]<<16}function qVe(t){let e=null;for(let r of t){let n=r.p.stoppedAt;(r.pos==r.p.stream.end||n!=null&&r.pos>n)&&r.p.parser.stateFlag(r.state,2)&&(!e||e.score<r.score)&&(e=r)}return e}function I7(t){if(t.external){let e=t.extend?1:0;return(r,n)=>t.external(r,n)<<1|e}return t.get}const KVe=36,N7=1,XVe=2,Kd=3,xO=4,QVe=5,ZVe=6,JVe=7,e9e=8,t9e=9,r9e=10,n9e=11,i9e=12,s9e=13,o9e=14,a9e=15,l9e=16,c9e=17,L7=18,u9e=19,Zte=20,Jte=21,F7=22,f9e=23,h9e=24;function $M(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57}function d9e(t){return t>=48&&t<=57||t>=97&&t<=102||t>=65&&t<=70}function Wf(t,e,r){for(let n=!1;;){if(t.next<0)return;if(t.next==e&&!n){t.advance();return}n=r&&!n&&t.next==92,t.advance()}}function p9e(t,e){e:for(;;){if(t.next<0)return;if(t.next==36){t.advance();for(let r=0;r<e.length;r++){if(t.next!=e.charCodeAt(r))continue e;t.advance()}if(t.next==36){t.advance();return}}else t.advance()}}function m9e(t,e){let r="[{<(".indexOf(String.fromCharCode(e)),n=r<0?e:"]}>)".charCodeAt(r);for(;;){if(t.next<0)return;if(t.next==n&&t.peek(1)==39){t.advance(2);return}t.advance()}}function GM(t,e){for(;!(t.next!=95&&!$M(t.next));)e!=null&&(e+=String.fromCharCode(t.next)),t.advance();return e}function g9e(t){if(t.next==39||t.next==34||t.next==96){let e=t.next;t.advance(),Wf(t,e,!1)}else GM(t)}function H7(t,e){for(;t.next==48||t.next==49;)t.advance();e&&t.next==e&&t.advance()}function B7(t,e){for(;;){if(t.next==46){if(e)break;e=!0}else if(t.next<48||t.next>57)break;t.advance()}if(t.next==69||t.next==101)for(t.advance(),(t.next==43||t.next==45)&&t.advance();t.next>=48&&t.next<=57;)t.advance()}function V7(t){for(;!(t.next<0||t.next==10);)t.advance()}function Hf(t,e){for(let r=0;r<e.length;r++)if(e.charCodeAt(r)==t)return!0;return!1}const wO=` 	\r
`;function ere(t,e,r){let n=Object.create(null);n.true=n.false=QVe,n.null=n.unknown=ZVe;for(let i of t.split(" "))i&&(n[i]=Zte);for(let i of e.split(" "))i&&(n[i]=Jte);for(let i of(r||"").split(" "))i&&(n[i]=h9e);return n}const v9e="array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying ",y9e="absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone ",YM={backslashEscapes:!1,hashComments:!1,spaceAfterDashes:!1,slashComments:!1,doubleQuotedStrings:!1,doubleDollarQuotedStrings:!1,unquotedBitLiterals:!1,treatBitsAsBytes:!1,charSetCasts:!1,plsqlQuotingMechanism:!1,operatorChars:"*+-%<>!=&|~^/",specialVar:"?",identifierQuotes:'"',caseInsensitiveIdentifiers:!1,words:ere(y9e,v9e)};function x9e(t,e,r,n){let i={};for(let s in YM)i[s]=(t.hasOwnProperty(s)?t:YM)[s];return e&&(i.words=ere(e,r||"",n)),i}function tre(t){return new jVe(e=>{var r;let{next:n}=e;if(e.advance(),Hf(n,wO)){for(;Hf(e.next,wO);)e.advance();e.acceptToken(KVe)}else if(n==36&&t.doubleDollarQuotedStrings){let i=GM(e,"");e.next==36&&(e.advance(),p9e(e,i),e.acceptToken(Kd))}else if(n==39||n==34&&t.doubleQuotedStrings)Wf(e,n,t.backslashEscapes),e.acceptToken(Kd);else if(n==35&&t.hashComments||n==47&&e.next==47&&t.slashComments)V7(e),e.acceptToken(N7);else if(n==45&&e.next==45&&(!t.spaceAfterDashes||e.peek(1)==32))V7(e),e.acceptToken(N7);else if(n==47&&e.next==42){e.advance();for(let i=1;;){let s=e.next;if(e.next<0)break;if(e.advance(),s==42&&e.next==47){if(i--,e.advance(),!i)break}else s==47&&e.next==42&&(i++,e.advance())}e.acceptToken(XVe)}else if((n==101||n==69)&&e.next==39)e.advance(),Wf(e,39,!0),e.acceptToken(Kd);else if((n==110||n==78)&&e.next==39&&t.charSetCasts)e.advance(),Wf(e,39,t.backslashEscapes),e.acceptToken(Kd);else if(n==95&&t.charSetCasts)for(let i=0;;i++){if(e.next==39&&i>1){e.advance(),Wf(e,39,t.backslashEscapes),e.acceptToken(Kd);break}if(!$M(e.next))break;e.advance()}else if(t.plsqlQuotingMechanism&&(n==113||n==81)&&e.next==39&&e.peek(1)>0&&!Hf(e.peek(1),wO)){let i=e.peek(1);e.advance(2),m9e(e,i),e.acceptToken(Kd)}else if(n==40)e.acceptToken(JVe);else if(n==41)e.acceptToken(e9e);else if(n==123)e.acceptToken(t9e);else if(n==125)e.acceptToken(r9e);else if(n==91)e.acceptToken(n9e);else if(n==93)e.acceptToken(i9e);else if(n==59)e.acceptToken(s9e);else if(t.unquotedBitLiterals&&n==48&&e.next==98)e.advance(),H7(e),e.acceptToken(F7);else if((n==98||n==66)&&(e.next==39||e.next==34)){const i=e.next;e.advance(),t.treatBitsAsBytes?(Wf(e,i,t.backslashEscapes),e.acceptToken(f9e)):(H7(e,i),e.acceptToken(F7))}else if(n==48&&(e.next==120||e.next==88)||(n==120||n==88)&&e.next==39){let i=e.next==39;for(e.advance();d9e(e.next);)e.advance();i&&e.next==39&&e.advance(),e.acceptToken(xO)}else if(n==46&&e.next>=48&&e.next<=57)B7(e,!0),e.acceptToken(xO);else if(n==46)e.acceptToken(o9e);else if(n>=48&&n<=57)B7(e,!1),e.acceptToken(xO);else if(Hf(n,t.operatorChars)){for(;Hf(e.next,t.operatorChars);)e.advance();e.acceptToken(a9e)}else if(Hf(n,t.specialVar))e.next==n&&e.advance(),g9e(e),e.acceptToken(c9e);else if(Hf(n,t.identifierQuotes))Wf(e,n,!1),e.acceptToken(u9e);else if(n==58||n==44)e.acceptToken(l9e);else if($M(n)){let i=GM(e,String.fromCharCode(n));e.acceptToken(e.next==46||e.peek(-i.length-1)==46?L7:(r=t.words[i.toLowerCase()])!==null&&r!==void 0?r:L7)}})}const rre=tre(YM),w9e=pS.deserialize({version:14,states:"%vQ]QQOOO#wQRO'#DSO$OQQO'#CwO%eQQO'#CxO%lQQO'#CyO%sQQO'#CzOOQQ'#DS'#DSOOQQ'#C}'#C}O'UQRO'#C{OOQQ'#Cv'#CvOOQQ'#C|'#C|Q]QQOOQOQQOOO'`QQO'#DOO(xQRO,59cO)PQQO,59cO)UQQO'#DSOOQQ,59d,59dO)cQQO,59dOOQQ,59e,59eO)jQQO,59eOOQQ,59f,59fO)qQQO,59fOOQQ-E6{-E6{OOQQ,59b,59bOOQQ-E6z-E6zOOQQ,59j,59jOOQQ-E6|-E6|O+VQRO1G.}O+^QQO,59cOOQQ1G/O1G/OOOQQ1G/P1G/POOQQ1G/Q1G/QP+kQQO'#C}O+rQQO1G.}O)PQQO,59cO,PQQO'#Cw",stateData:",[~OtOSPOSQOS~ORUOSUOTUOUUOVROXSOZTO]XO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O^]ORvXSvXTvXUvXVvXXvXZvX]vX_vX`vXavXbvXcvXdvXevXfvXgvXhvX~OsvX~P!jOa_Ob_Oc_O~ORUOSUOTUOUUOVROXSOZTO^tO_UO`UOa`Ob`Oc`OdUOeUOfUOgUOhUO~OWaO~P$ZOYcO~P$ZO[eO~P$ZORUOSUOTUOUUOVROXSOZTO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O]hOsoX~P%zOajObjOcjO~O^]ORkaSkaTkaUkaVkaXkaZka]ka_ka`kaakabkackadkaekafkagkahka~Oska~P'kO^]O~OWvXYvX[vX~P!jOWnO~P$ZOYoO~P$ZO[pO~P$ZO^]ORkiSkiTkiUkiVkiXkiZki]ki_ki`kiakibkickidkiekifkigkihki~Oski~P)xOWkaYka[ka~P'kO]hO~P$ZOWkiYki[ki~P)xOasObsOcsO~O",goto:"#hwPPPPPPPPPPPPPPPPPPPPPPPPPPx||||!Y!^!d!xPPP#[TYOZeUORSTWZbdfqT[OZQZORiZSWOZQbRQdSQfTZgWbdfqQ^PWk^lmrQl_Qm`RrseVORSTWZbdfq",nodeNames:" LineComment BlockComment String Number Bool Null ( ) { } [ ] ; . Operator Punctuation SpecialVar Identifier QuotedIdentifier Keyword Type Bits Bytes Builtin Script Statement CompositeIdentifier Parens Braces Brackets Statement",maxTerm:38,nodeProps:[["isolate",-4,1,2,3,19,""]],skippedNodes:[0,1,2],repeatNodeCount:3,tokenData:"RORO",tokenizers:[0,rre],topRules:{Script:[0,25]},tokenPrec:0});function qM(t){let e=t.cursor().moveTo(t.from,-1);for(;/Comment/.test(e.name);)e.moveTo(e.from,-1);return e.node}function Yv(t,e){let r=t.sliceString(e.from,e.to),n=/^([`'"])(.*)\1$/.exec(r);return n?n[2]:r}function mS(t){return t&&(t.name=="Identifier"||t.name=="QuotedIdentifier")}function b9e(t,e){if(e.name=="CompositeIdentifier"){let r=[];for(let n=e.firstChild;n;n=n.nextSibling)mS(n)&&r.push(Yv(t,n));return r}return[Yv(t,e)]}function j7(t,e){for(let r=[];;){if(!e||e.name!=".")return r;let n=qM(e);if(!mS(n))return r;r.unshift(Yv(t,n)),e=qM(n)}}function S9e(t,e){let r=Ci(t).resolveInner(e,-1),n=T9e(t.doc,r);return r.name=="Identifier"||r.name=="QuotedIdentifier"||r.name=="Keyword"?{from:r.from,quoted:r.name=="QuotedIdentifier"?t.doc.sliceString(r.from,r.from+1):null,parents:j7(t.doc,qM(r)),aliases:n}:r.name=="."?{from:e,quoted:null,parents:j7(t.doc,r),aliases:n}:{from:e,quoted:null,parents:[],empty:!0,aliases:n}}const C9e=new Set("where group having order union intersect except all distinct limit offset fetch for".split(" "));function T9e(t,e){let r;for(let i=e;!r;i=i.parent){if(!i)return null;i.name=="Statement"&&(r=i)}let n=null;for(let i=r.firstChild,s=!1,o=null;i;i=i.nextSibling){let a=i.name=="Keyword"?t.sliceString(i.from,i.to).toLowerCase():null,l=null;if(!s)s=a=="from";else if(a=="as"&&o&&mS(i.nextSibling))l=Yv(t,i.nextSibling);else{if(a&&C9e.has(a))break;o&&mS(i)&&(l=Yv(t,i))}l&&(n||(n=Object.create(null)),n[l]=b9e(t,o)),o=/Identifier$/.test(i.name)?i:null}return n}function E9e(t,e){return t?e.map(r=>({...r,label:r.label[0]==t?r.label:t+r.label+t,apply:void 0})):e}const R9e=/^\w*$/,A9e=/^[`'"]?\w*[`'"]?$/;function W7(t){return t.self&&typeof t.self.label=="string"}class PN{constructor(e,r){this.idQuote=e,this.idCaseInsensitive=r,this.list=[],this.children=void 0}child(e){let r=this.children||(this.children=Object.create(null)),n=r[e];return n||(e&&!this.list.some(i=>i.label==e)&&this.list.push(z7(e,"type",this.idQuote,this.idCaseInsensitive)),r[e]=new PN(this.idQuote,this.idCaseInsensitive))}maybeChild(e){return this.children?this.children[e]:null}addCompletion(e){let r=this.list.findIndex(n=>n.label==e.label);r>-1?this.list[r]=e:this.list.push(e)}addCompletions(e){for(let r of e)this.addCompletion(typeof r=="string"?z7(r,"property",this.idQuote,this.idCaseInsensitive):r)}addNamespace(e){Array.isArray(e)?this.addCompletions(e):W7(e)?this.addNamespace(e.children):this.addNamespaceObject(e)}addNamespaceObject(e){for(let r of Object.keys(e)){let n=e[r],i=null,s=r.replace(/\\?\./g,a=>a=="."?"\0":a).split("\0"),o=this;W7(n)&&(i=n.self,n=n.children);for(let a=0;a<s.length;a++)i&&a==s.length-1&&o.addCompletion(i),o=o.child(s[a].replace(/\\\./g,"."));o.addNamespace(n)}}}function z7(t,e,r,n){return new RegExp("^[a-z_][a-z_\\d]*$",n?"i":"").test(t)?{label:t,type:e}:{label:t,type:e,apply:r+t+r}}function k9e(t,e,r,n,i,s){var o;let a=((o=s==null?void 0:s.spec.identifierQuotes)===null||o===void 0?void 0:o[0])||'"',l=new PN(a,!!(s!=null&&s.spec.caseInsensitiveIdentifiers)),u=i?l.child(i):null;return l.addNamespace(t),e&&(u||l).addCompletions(e),r&&l.addCompletions(r),u&&l.addCompletions(u.list),n&&l.addCompletions((u||l).child(n).list),h=>{let{parents:d,from:m,quoted:g,empty:y,aliases:x}=S9e(h.state,h.pos);if(y&&!h.explicit)return null;x&&d.length==1&&(d=x[d[0]]||d);let b=l;for(let R of d){for(;!b.children||!b.children[R];)if(b==l&&u)b=u;else if(b==u&&n)b=b.child(n);else return null;let k=b.maybeChild(R);if(!k)return null;b=k}let C=g&&h.state.sliceDoc(h.pos,h.pos+1)==g,E=b.list;return b==l&&x&&(E=E.concat(Object.keys(x).map(R=>({label:R,type:"constant"})))),{from:m,to:C?h.pos+1:void 0,options:E9e(g,E),validFor:g?A9e:R9e}}}function O9e(t){return t==Jte?"type":t==Zte?"keyword":"variable"}function _9e(t,e,r){let n=Object.keys(t).map(i=>r(e?i.toUpperCase():i,O9e(t[i])));return m8e(["QuotedIdentifier","SpecialVar","String","LineComment","BlockComment","."],Hte(n))}let M9e=w9e.configure({props:[yN.add({Statement:GBe()}),Mee.add({Statement(t,e){return{from:Math.min(t.from+100,e.doc.lineAt(t.from).to),to:t.to}},BlockComment(t){return{from:t.from+2,to:t.to-2}}}),Eee({Keyword:Te.keyword,Type:Te.typeName,Builtin:Te.standard(Te.name),Bits:Te.number,Bytes:Te.string,Bool:Te.bool,Null:Te.null,Number:Te.number,String:Te.string,Identifier:Te.name,QuotedIdentifier:Te.special(Te.string),SpecialVar:Te.special(Te.name),LineComment:Te.lineComment,BlockComment:Te.blockComment,Operator:Te.operator,"Semi Punctuation":Te.punctuation,"( )":Te.paren,"{ }":Te.brace,"[ ]":Te.squareBracket})]});class gS{constructor(e,r,n){this.dialect=e,this.language=r,this.spec=n}get extension(){return this.language.extension}configureLanguage(e,r){return new gS(this.dialect,this.language.configure(e,r),this.spec)}static define(e){let r=x9e(e,e.keywords,e.types,e.builtin),n=eS.define({name:"sql",parser:M9e.configure({tokenizers:[{from:rre,to:tre(r)}]}),languageData:{commentTokens:{line:"--",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]}}});return new gS(r,n,e)}}function D9e(t,e){return{label:t,type:e,boost:-1}}function P9e(t,e=!1,r){return _9e(t.dialect.words,e,r||D9e)}function I9e(t){return t.schema?k9e(t.schema,t.tables,t.schemas,t.defaultTable,t.defaultSchema,t.dialect||IN):()=>null}function N9e(t){return t.schema?(t.dialect||IN).language.data.of({autocomplete:I9e(t)}):[]}function AC(t={}){let e=t.dialect||IN;return new FBe(e.language,[N9e(t),e.language.data.of({autocomplete:P9e(e,t.upperCaseKeywords,t.keywordCompletion)})])}const IN=gS.define({}),L9e=`%m_t_aztoncef04(
    /*public*/
     inds                   =    adtte
    ,whr                   =    paramcd='TRPROGM' and parqual='INDEPENDENT ASSESSOR'
    ,pop_flag              =    mittfl='Y'
    ,pop_mvar              =    ittdummyn2
    ,trtgrpn               =    trt01pN         
    ,var                   =    aval
    ,alpha                 =    0.05
    /*,pair                 =    1-2|4-2|6-2|5-2|7-2*/
    ,pair                  =    1-5|4-5|6-5|3-5|7-5
    ,debug                 =   Y
    /*effcount*/   
    ,effcount_index        =   {cond=CNSR=0 # label=%nrbquote(Total events [a], n (%)) #level=0 subord=1}
                                  {cond=cnsr=0 and find(evntdesc,'RECIST progression')  # label=RECIST progression #level=1 subord=2}
                                  {cond=cnsr=0 and find(evntdesc,'RECIST progression with target') # label=Target lesion [b] #level=2 subord=3}
                                  {cond=cnsr=1 label=%nrbquote(Censored patients, n (%)) #level=0 subord=4}
                                  {cond=cnsr=1 and find(evntdesc,'Censored RECIST progression')  # label=Censored RECIST progression [c] #level=1 /*section=6*/ subord=5}
                          
    /*cox, logrank*/
    ,coxlog_blocklbl       =   Comparison of treatment groups [g]
    ,coxlog_modelkey       =   cox|logrank            
    ,coxlog_strata         =   STRAT1 STRAT2                                                                          
       
    /*km*/     
    ,km_method             =   km
    ,km_conftype           =   log 
    ,km_cen_num            =   0
    ,km_step_list          =   160 to 1686 by 160
    ,km_step_unit          =   days
    ,km_median_label       =   Progression-free survival (days) [e] [f]
    ,km_timelist_label     =   Progression-free survival rate [e]
    /*desc_stat*/        
    ,desc_stat_inds            =   adtte
    ,desc_stat_whr             =  %str(paramcd='TRTTFST' and mittfl='Y')
    ,desc_stat_var             =  aval
    ,desc_stat_label           =  %str(Duration between <<RECIST>> progression and the last evaluable <<RECIST>>  assessment prior to progression (<<unit>>))

    /*report*/
    , lenlist                  =  20#7#10#10#10#10#10#10 
    , justlist                 =  l#l#c#c#c#c#c#c 
    , justlist_header          =  l#l#c#c#c#c#c#c 
    , nolblist                 =  Y#N#N#N#N#N#N#N 
    , orderlist                =  N#N#N#N#N#N#N#N
    , defcol                   =  (col1 col2 col3 col5 col6 col7 col8 col4)
    , rtf                      =  y
    , sfx                      =  a
);
`,F9e=`|                                              |              | AZD1          | AZD2        |              |
| -------------------------------------------- | ------------ | ------------- | ----------- | ------------ |
|                                              |Statistic     | <<low dose>>  | <<high dose>> | Control     |
|                                              |              |N=xxx          | N=xxx       | N=xxx        |
|Event [a]                                     |              |               |             |              |
| Any                                          | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| <<RECIST>> progression                       | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|    Target lesions [b]                        | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|    Non target lesions [b]                    | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|    New lesions [b]                           | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Death without progression                    | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|                                              |              |               |             |              |
| Censored observations                        |              |               |
| Any                                          | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Censored at Day 1                            | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Censored <<RECIST>> progression or death [c] | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Progression-free [d]                         | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Prematurely censored                         | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Progression-free at time of the analysis     | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Early study discontinuation                  | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Lost to follow-up                            | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Withdrew consent                             | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| <<category>>                                 | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|                                              |              |               |             |              |
| Progression-free survival                    | P25          |      x.x      |      x.x    |      x.x     |
| (<<unit>>) [e] [f]                           | Median       |     xx.x      |     xx.x    |     xx.x     |
|                                              | <<x>>% CI    |   x.x, x.x    |    x.x, x.x |    x.x, x.x  |
|                                              | P75          |      x.x      |      x.x    |      x.x     |
| P<<x>>                                       |      x.x     |      x.x      |      x.x    |
|                                              |              |               |             |              |
| Comparison of treatment groups [g]           | Hazard ratio |      x.x      |      x.x    |              |
|                                              | <<x>>% CI    | x.x, x.x      | x.x, x.x    |              |
|                                              | <<x>>% CI    | x.x, x.x      | x.x, x.x    |              |
|                                              | p-value      |      0.xxx    |      0.xxx  |              |
|                                              |              |               |             |              |
|                                              |              |               |             |              |
| Progression-free survival rate [e]           |              |               |             |              |
| <<xx months>>                                | %            |     xx.x      |     xx.x    |      xx.x    |
|                                              | <<x>>% CI    | x.x, x.x      |   x.x, x.x  |     x.x, x.x |
| <<xx months>>                                | %            |     xx.x      |     xx.x    |      xx.x    |
|                                              | <<x>>% CI    | x.x, x.x      |   x.x, x.x  |     x.x, x.x |
|                                              |             |               |             |              |
|                                              |              |               |             |              |
|                                              |              |               |             |              |
|                                              |              |               |             |              |
| Missed two or more consecutive               | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| <<RECIST>> assessments                       |              |               |             |              |
|                                              |              |               |             |              |
| Duration between <<RECIST>> progression      | n            |      x        |      x      |      x       |
| and the last evaluable <<RECIST>>            | Min          |     xx.x      |     xx.x    |     xx.x     |
| assessment prior to progression (<<unit>>)   | Q1           |      x.x      |      x.x    |      x.x     |
|                                              | Median       |     xx.x      |     xx.x    |     xx.x     |
|                                              | Q3           |     xx.x      |     xx.x    |     xx.x     |
|                                              | Max          |     xx        |     xx      |     xx       |
`,H9e=[{code:"effcount",start:"Event [a]",end:"<<category>>"},{code:"cox",start:"Comparison of treatment groups [g]",end:"p-value"},{code:"km",start:"Progression-free survival",end:"P<<x>>",extra:{start:"Progression-free survival rate",end:""}}],B9e=({theme:t})=>{const[e,r]=Y.useState(L9e),[n,i]=Y.useState(null),s=Y.useRef(null),o=m=>{r(m)},a=m=>{const g=m.state.selection.main.head,x=m.state.doc.lineAt(g).text;x.includes("effcount")?i("effcount"):x.includes("cox")?i("cox"):x.includes("km")?i("km"):i(null)};let l=new Set;const u=F9e.split(`
`),h=H9e.find(m=>m.code===n);if(h){let m=-1,g=-1;for(let y=0;y<u.length;y++)m===-1&&u[y].includes(h.start)&&(m=y),m!==-1&&g===-1&&u[y].includes(h.end)&&(g=y);if(m!==-1&&g!==-1&&g>=m)for(let y=m;y<=g;y++)l.add(y);if(h.code==="km"&&h.extra){let y=-1,x=-1;for(let b=0;b<u.length;b++)y===-1&&u[b].includes(h.extra.start)&&(y=b),y!==-1&&x===-1&&u[b].trim().startsWith("|")&&u[b].includes(h.extra.end)&&(x=b);if(y!==-1&&x!==-1&&x>=y)for(let b=y;b<=x;b++)l.add(b)}}const d=()=>I.jsx("table",{style:{width:"100%",fontSize:"0.85rem",borderCollapse:"collapse"},children:I.jsx("tbody",{children:u.map((m,g)=>{if(!m.trim().startsWith("|"))return null;const y=m.split("|").slice(1,-1);return I.jsx("tr",{style:l.has(g)?{background:"#ffe9b3"}:{},children:y.map((x,b)=>I.jsx("td",{style:{border:"1px solid #d0d7de",padding:"3px 6px",textAlign:"left",fontSize:"0.82rem",whiteSpace:"pre",fontFamily:"Balancing Simplicity"},children:x},b))},g)})})});return I.jsx(qs,{title:"AZTONCEF04 Display Macro",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:4,alignItems:"flex-start",width:"100%"},children:[I.jsxs(Bi,{sx:{flex:1,minWidth:420,maxWidth:800,p:2,bgcolor:"#fafbfc",boxShadow:2,height:"60vh",display:"flex",flexDirection:"column"},children:[I.jsx(_e,{sx:{flex:1,overflow:"auto"},children:d()}),I.jsx(pt,{variant:"body2",sx:{mt:2,color:"text.secondary",fontStyle:"italic",fontSize:"1rem",fontWeight:600},children:"Utility macros: m_u_km / m_u_cox_logrank / m_u_effcount"})]}),I.jsxs(Bi,{sx:{flex:1,minWidth:320,maxWidth:600,p:2,bgcolor:"#181c24",color:"#fff",boxShadow:2,display:"flex",flexDirection:"column",height:"60vh"},children:[I.jsx(pt,{variant:"subtitle1",sx:{color:"#fff",mb:1,fontWeight:600},children:"SAS Macro"}),I.jsx(_e,{sx:{flex:1,display:"flex",flexDirection:"column",overflow:"auto"},children:I.jsx(Ih,{ref:s,value:e,height:"100%",theme:"dark",extensions:[AC()],onChange:o,onUpdate:a,style:{minHeight:"400px",width:"100%",background:"#181c24",color:"#fff",fontSize:"0.92rem",borderRadius:6}})})]})]})})},V9e=`data adtte;
    set adam.adtte;
    where paramcd='TRPROGM' and parqual='INDEPENDENT ASSESSOR' and mittfl='Y';
run;

%m_u_popn(
    inds=adam.adsl,
    pop_flag=mittfl="Y",
    trtgrpn=trt01pn,
    trtlev=1|2,
    UniqueIDVars=usubjid,
    trtfmtC=_tlf_setup_trtfmteff,
    gmacro=mittpopb,
    BigN=Y,
    nformat=,
    debug=Y
);

/* Number counting part */
%m_u_effcount(
    inds=adtte,
    pop_flag=mittfl='Y',
    trtgrpn=trt01pn,
    denomds=,
    pop_mvar=mittpopb,
    index={cond=CNSR=0 # label=%nrbquote(Total events [a], n (%)) #level=0 subord=1}
          {cond=cnsr=0 and find(evntdesc,'RECIST progression') label=RECIST progression level=1 subord=2}
          {cond=cnsr=0 and find(evntdesc,'RECIST progression with target') label=Target lesion [b] level=2 subord=3}
          {cond=cnsr=1 label=%nrbquote(Censored patients, n (%)) level=0 subord=4}
          {cond=cnsr=1 and find(evntdesc,'Censored RECIST progression') label=Censored RECIST progression [c] level=1 subord=5},
    statlabel=Y,
    ord=1,
    debug=N
);

/* PFS median and rate at x time with CI */
%m_u_km(
    inds=adtte,
    WHR=,
    alpha=0.05,
    method=KM,
    conftype=LOG,
    trtgrpn=trt01pN,
    trtgrpnord=2 | 1,
    trtgrpn2=,
    var_time=AVAL,
    var_status=CNSR,
    cen_num=0,
    evnt_num=,
    step_list=160 to 1686 by 160,
    step_unit=days,
    XDIVISOR=,
    plot=0,
    outdat_median=final2,
    median_label=Progression-free survival (<<unit>>) [e] [f],
    outdat_timelist=final3,
    timelist_label=Progression-free survival rate [e]
);

/* Comparison between group (HR, CI and p-value) */
%m_u_cox_logrank(
    inds=adtte,
    out=final_cox,
    blocklbl=Comparison of treatment groups [g],
    modelkey=cox|logrank,
    transfl=Y,
    trtgrpn=trt01pn,
    var=aval,
    byvar=,
    alpha=0.05,
    censor=,
    indicator=,
    ties=,
    pair=1-2,
    strata=STRAT1 STRAT2,
    pvalside=,
    missval=,
    digit=,
    cidecimal=,
    hrlbl=,
    pvallbl=,
    cilbl=,
    prefix=,
    debug=Y
);
%m_u_effcount(
    inds=adtte,
    pop_flag=mittfl='Y',
    trtgrpn=trt01pn,
    denomds=,
    pop_mvar=mittpopb,
    index={cond=MIS2TAFL='Y' # label=%nrbquote(Missed two or more consecutive Tumor Assesement) #level=0 subord=1}
    statlabel=Y,
    ord=5,
    debug=N
);
`,j9e=`|                                              |              | AZD1          | AZD2        |              |
| -------------------------------------------- | ------------ | ------------- | ----------- | ------------ |
|                                              |Statistic     | <<low dose>>  | <<high dose>> | Control     |
|                                              |              |N=xxx          | N=xxx       | N=xxx        |
|Event [a]                                     |              |               |             |              |
| Any                                          | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| <<RECIST>> progression                       | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|    Target lesions [b]                        | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|    Non target lesions [b]                    | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|    New lesions [b]                           | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Death without progression                    | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|                                              |              |               |             |              |
| Censored observations                        |              |               |             |              |
| Any                                          | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Censored at Day 1                            | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Censored <<RECIST>> progression or death [c] | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Progression-free [d]                         | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Prematurely censored                         | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Progression-free at time of the analysis     | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Early study discontinuation                  | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Lost to follow-up                            | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| Withdrew consent                             | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| <<category>>                                 | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
|                                              |              |               |             |              |
| Progression-free survival                    | P25          |      x.x      |      x.x    |      x.x     |
| (<<unit>>) [e] [f]                           | Median       |     xx.x      |     xx.x    |     xx.x     |
|                                              | <<x>>% CI    |   x.x, x.x    |    x.x, x.x |    x.x, x.x  |
|                                              | P75          |      x.x      |      x.x    |      x.x     |
| P<<x>>                                       |      x.x     |      x.x      |      x.x    |              |
|                                              |              |               |             |              |
| Comparison of treatment groups [g]           | Hazard ratio |      x.x      |      x.x    |              |
|                                              | <<x>>% CI    | x.x, x.x      | x.x, x.x    |              |
|                                              | <<x>>% CI    | x.x, x.x      | x.x, x.x    |              |
|                                              | p-value      |      0.xxx    |      0.xxx  |              |
|                                              |              |               |             |              |
|                                              |              |               |             |              |
| Progression-free survival rate [e]           |              |               |             |              |
| <<xx months>>                                | %            |     xx.x      |     xx.x    |      xx.x    |
|                                              | <<x>>% CI    | x.x, x.x      |   x.x, x.x  |     x.x, x.x |
|                                              |              |               |             |              |
| <<xx months>>                                | %            |     xx.x      |     xx.x    |      xx.x    |
|                                              | <<x>>% CI    | x.x, x.x      |   x.x, x.x  |     x.x, x.x |
|                                              |             |               |             |              |
|                                              |              |               |             |              |
| Missed two or more consecutive               | n (%)        |   x (x.x)     |   xx (xx.x) |   x (x.x)    |
| <<RECIST>> assessments                       |              |               |             |              |
|                                              |              |               |             |              |
| Duration between <<RECIST>> progression      | n            |      x        |      x      |      x       |
| and the last evaluable <<RECIST>>            | Min          |     xx.x      |     xx.x    |     xx.x     |
| assessment prior to progression (<<unit>>)   | Q1           |      x.x      |      x.x    |      x.x     |
|                                              | Median       |     xx.x      |     xx.x    |     xx.x     |
|                                              | Q3           |     xx.x      |     xx.x    |     xx.x     |
|                                              | Max          |     xx        |     xx      |     xx       |`,W9e=[{code:"effcount",start:"Event [a]",end:"<<category>>",extra:{start:"Missed two or more consecutive",end:"<<RECIST>> assessments"}},{code:"km",start:"Progression-free survival",end:"P<<x>>",extra:{start:"Progression-free survival rate",end:""}},{code:"cox",start:"Comparison of treatment groups [g]",end:"p-value"},{code:"popn",start:"|                                              |              | AZD1          | AZD2        |              |",end:"|                                              |              |N=xxx          | N=xxx       | N=xxx        |"}],z9e=({theme:t})=>{const[e,r]=Y.useState(V9e),[n,i]=Y.useState(null),s=Y.useRef(null),o=m=>{r(m)},a=m=>{const g=m.state.selection.main.head,x=m.state.doc.lineAt(g).text;x.includes("effcount")?i("effcount"):x.includes("cox")?i("cox"):x.includes("km")?i("km"):x.includes("m_u_popn")?i("popn"):i(null)};let l=new Set;const u=j9e.split(`
`),h=W9e.find(m=>m.code===n);if(h){let m=-1,g=-1;for(let y=0;y<u.length;y++)m===-1&&u[y].includes(h.start)&&(m=y),m!==-1&&g===-1&&u[y].includes(h.end)&&(g=y);if(m!==-1&&g!==-1&&g>=m)for(let y=m;y<=g;y++)l.add(y);if(h.extra){let y=-1,x=-1;for(let b=0;b<u.length;b++)y===-1&&u[b].includes(h.extra.start)&&(y=b),y!==-1&&x===-1&&u[b].includes(h.extra.end)&&(x=b);if(y!==-1&&x!==-1&&x>=y)for(let b=y;b<=x;b++)l.add(b)}}const d=()=>I.jsx("table",{style:{width:"100%",fontSize:"0.85rem",borderCollapse:"collapse"},children:I.jsx("tbody",{children:u.map((m,g)=>{if(!m.trim().startsWith("|"))return null;const y=m.split("|").slice(1,-1);return I.jsx("tr",{style:l.has(g)?{background:"#ffe9b3"}:{},children:y.map((x,b)=>I.jsx("td",{style:{border:"1px solid #d0d7de",padding:"3px 6px",textAlign:"left",fontSize:"0.82rem",whiteSpace:"pre",fontFamily:"Balancing Simplicity"},children:x},b))},g)})})});return I.jsx(qs,{title:"AZTONCEF04 Open Code Template",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:4,alignItems:"flex-start",width:"100%"},children:[I.jsx(Bi,{sx:{flex:1,minWidth:420,maxWidth:800,p:2,bgcolor:"#fafbfc",boxShadow:2,height:"60vh",display:"flex",flexDirection:"column"},children:I.jsx(_e,{sx:{flex:1,overflow:"auto"},children:d()})}),I.jsxs(Bi,{sx:{flex:1,minWidth:320,maxWidth:600,p:2,bgcolor:"#181c24",color:"#fff",boxShadow:2,display:"flex",flexDirection:"column",height:"60vh"},children:[I.jsx(pt,{variant:"subtitle1",sx:{color:"#fff",mb:1,fontWeight:600},children:"SAS Macro"}),I.jsx(_e,{sx:{flex:1,display:"flex",flexDirection:"column",overflow:"auto"},children:I.jsx(Ih,{ref:s,value:e,height:"100%",theme:"dark",extensions:[AC()],onChange:o,onUpdate:a,style:{minHeight:"400px",width:"100%",background:"#181c24",color:"#fff",fontSize:"0.92rem",borderRadius:6}})})]})]})})},U9e=({theme:t})=>I.jsx(qs,{title:"Example: AZTONCEF02",children:I.jsx(_e,{sx:{display:"flex",justifyContent:"center",alignItems:"flex-start",width:"100%",height:"100%",pt:2,pb:6,px:4},children:I.jsx(_e,{component:"img",src:"/ogemsharing/images/ef02.PNG",alt:"AZTONCEF02 Example",sx:{maxWidth:"100%",maxHeight:"75vh",objectFit:"contain",boxShadow:3,borderRadius:2,mt:-2}})})},"aztoncef02"),$9e=`%m_t_aztoncef02(
    inds=adeff_all
    , adsl= adsl_all
    , trtgrpn= trt01pn
    , trtgrp= trt01p
    , trtfmt=
    , pop_flag= ittfl='Y'
    , whr= paramcd='TRORESPU' and OTLVBPFL='Y' and PARQUAL='INDEPENDENT ASSESSOR'
    , strata= strat1n strat2n
    , event=
    , var=
    , reportout= Y
    , debug= N
    , rate_ci= N
    , rate_alpha= 0.05
    , rate_decim=
    , rate_missval= 
    , rate_adj= Y
    , rate_adj_alpha= 0.05
    , rate_adj_cidecim=
    , rate_adj_missval=
    , odds= Y
    , cmh= N
    , trtpair= 1-3|2-3
    , cal_alpha=
    , cal_pside=
    , cal_pdecim=
    , cal_cidecim=
    , cal_missval= 
    , cmh_cltype=
    , collabel= col1='Group' col2='Number (%)' col3='Estimate' col4='95% CI' col5='Odds ratio' col6='95% CI' col7='p-value'
    , lenlist = 27#12#12#12#12#12#12
    , justlist = l#c#c#c#c#c#c
    , justlist_header = l#c#c#c#c#c#c
    , nolblist = Y#N#N#N#N#N#N
    , orderlist = Y#N#N#N#N#N#N
    , defcol = (col1) ("(*ESC*)S={just = center borderbottomwidth=0pt MARGINBOTTOM= 2pt}Subjects with response(*ESC*)S={}"col2) ("(*ESC*)S={just = center borderbottomwidth=0pt MARGINBOTTOM= 2pt}Adjusted rate (%)(*ESC*)S={}" col3 col4) ("(*ESC*)S={just = center borderbottomwidth=0pt MARGINBOTTOM= 2pt}Comparison of treatment groups(*ESC*)S={}" col5 col6 col7)
    , pg= 18
    , blank_after=
    , sfx = a
);
`,G9e=`|                          |                                         |                   |           |                                |           |         |
| ------------------------ | ---------------------------------------- | ----------------- | --------- | ------------------------------ | --------- | ------- |
|                          | Subjects with [[objective respons etc.]] | Adjusted rate (%) |           | Comparison of treatment groups |           |         |
|                          |                                          |                   |           |                                |           |         |
| Group                    | Number (%)                               | Estimate          | <<x>>% CI | Odds ratio                     | <<x>>% CI | p-value |
| AZD1 <<low dose>> N=xxx  | xx (xx.x)                                | xx.x              | x.x, x.x  | x.x                            | x.x, x.x  | 0.xxx   |
|                          |                                          |                   |           |                                |           |         |
| AZD2 <<high dose>> N=xxx | xx (xx.x)                                | xx.x              | x.x, x.x  | x.x                            | x.x, x.x  | 0.xxx   |
| Control N=xxx            | xx (xx.x)                                | xx.x              | x.x, x.x  |                                |           |         |
|                         |                                          |                   |           |                                |           |         |`,Y9e=`|                    | Relative risk |            | Risk difference |            |         |
| ------------------ | ------------- | ---------- | --------------- | ---------- | ------- |
| Group              | Estimate      | <<x>>% CI  | Estimate        | <<x>>% CI  | p-value |
| AZD1 <<low dose>>  | xx.x          | xx.x, xx.x | xx.x            | xx.x, xx.x | 0.xxx   |
| N=xxx              |               |            |                 |            |         |
|                    |               |            |                 |            |         |
| AZD2 <<high dose>> | xx.x          | xx.x, xx.x | xx.x            | xx.x, xx.x | 0.xxx   |
| N=xxx              |               |            |                 |            |         |
|                    |               |            |                 |            |         |
| Control            |               |            |                 |            |         |
| N=xxx              |               |            |
|                   |               |            |                 |            |         |`,q9e=[{code:"rate_",table:1,cols:[1]},{code:"rate_adj",table:1,cols:[2,3]},{code:"odds",table:1,cols:[4,5,6]},{code:"cmh",table:2,cols:[1,2,3,4,5]}],K9e=({theme:t})=>{const[e,r]=Y.useState($9e),[n,i]=Y.useState(null),s=Y.useRef(null),o=u=>{r(u)},a=u=>{const h=u.state.selection.main.head,m=u.state.doc.lineAt(h).text;m.includes("odds")?i("odds"):m.includes("rate_adj")?i("rate_adj"):m.includes("cmh")?i("cmh"):m.includes("rate_")?i("rate_"):i(null)},l=(u,h,d)=>{const m=u.split(`
`),g=q9e.find(y=>y.code===n&&y.table===h);return I.jsxs(_e,{sx:{mb:2},children:[I.jsx(pt,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:d}),I.jsx("table",{style:{width:"100%",fontSize:"0.85rem",borderCollapse:"collapse",marginBottom:16},children:I.jsx("tbody",{children:m.map((y,x)=>{if(!y.trim().startsWith("|"))return null;const b=y.split("|").slice(1,-1);return I.jsx("tr",{children:b.map((C,E)=>{const R=g&&g.cols&&g.cols.includes(E);return I.jsx("td",{style:{border:"1px solid #d0d7de",padding:"3px 6px",textAlign:"left",fontSize:"0.82rem",whiteSpace:"pre",fontFamily:"Balancing Simplicity",background:R?"#ffe9b3":void 0},children:C},E)})},x)})})})]})};return I.jsx(qs,{title:"AZTONCEF02 Display Macro",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:4,alignItems:"flex-start",width:"100%"},children:[I.jsxs(Bi,{sx:{flex:1,minWidth:420,maxWidth:800,p:2,bgcolor:"#fafbfc",boxShadow:2,height:"60vh",display:"flex",flexDirection:"column"},children:[I.jsxs(_e,{sx:{flex:1,overflow:"auto"},children:[l(G9e,1,"ef02a"),l(Y9e,2,"ef02b")]}),I.jsx(pt,{variant:"body2",sx:{mt:2,color:"text.secondary",fontStyle:"italic",fontSize:"1rem",fontWeight:600},children:"Utility macros: m_u_binom_odds / m_u_binom_cp_grp / m_u_binom_adjrate"})]}),I.jsxs(Bi,{sx:{flex:1,minWidth:320,maxWidth:600,p:2,bgcolor:"#181c24",color:"#fff",boxShadow:2,display:"flex",flexDirection:"column",height:"60vh"},children:[I.jsx(pt,{variant:"subtitle1",sx:{color:"#fff",mb:1,fontWeight:600},children:"SAS Macro"}),I.jsx(_e,{sx:{flex:1,display:"flex",flexDirection:"column",overflow:"auto"},children:I.jsx(Ih,{ref:s,value:e,height:"100%",theme:"dark",extensions:[AC()],onChange:o,onUpdate:a,style:{minHeight:"400px",width:"100%",background:"#181c24",color:"#fff",fontSize:"0.92rem",borderRadius:6}})})]})]})})},X9e=`%setup(version=260,
       localsetup=root/%scan(&_exec_programpath.,2,/)/%scan(&_exec_programpath.,3,/)/%scan(&_exec_programpath.,4,/)/ar/%scan(&_exec_programpath.,6,/)/common/%scan(&_exec_programpath.,8,/)/macro/localsetup.sas);

** Remove call to localsetup macro if it is not needed **;
%localsetup;
***********************************************************************************************;
* Setup analysis datasets;
***********************************************************************************************;
data adsl;
    set adam.adsl;
    where ittfl='Y';
    if trt01pn=2 then trt01pn=3;
run;
data adsl_dummy;
    set adsl;
    num=_n_;
    if int(num/5)=num/5;
    trt01pn=2;
    trt01p='DummyDrug';
    usubjid=tranwrd(tranwrd(tranwrd(usubjid,'1','2'),'0','3'),'4','5');
    drop num;
run;
data adsl_all;
    set adsl adsl_dummy;
    proc sort;by usubjid;
run;
data adeff_anl;
    set adam.adeff;
    if trt01pn=2 then trt01pn=3;
    where ittfl='Y' and paramcd='TRORESPU' and OTLVBPFL='Y' and PARQUAL='INDEPENDENT ASSESSOR';
run;
data dummy;
    set adeff_anl;
    num=_n_;
    if int(num/5)=num/5;
    trt01pn=2;
    trt01p='DummyDrug';
    usubjid=tranwrd(tranwrd(tranwrd(usubjid,'1','2'),'0','3'),'4','5');
    drop num;
run;
data adeff_all;
    set adeff_anl dummy;
    proc sort;by usubjid;
run;

***********************************************************************************************;
*Calculation section;
***********************************************************************************************;
*****calculation of rate*****;
%m_u_binom_cp_grp(inds=adeff_all
                ,byvar = trt01p
                ,adsl=adsl_all
                ,alpha = 0.05
                ,final_ds = final_est
                ,debug = Y);

****************************************************************;
* Adjusted rate calculation;
****************************************************************; 
%m_u_binom_adjrate(
                   inds=adeff_all,
                   outds=final_adjrate,
                   trtgrpn=trt01pn,
                   strata=strat1n strat2n,
                   where=,
                   var=aval,
                   event=1,
                   alpha=0.01,
                   missval=NR,
                   cidecim=3,
                   debug=Y
                   );

***********************************************************************************************;
* Odds ratio/Relative risk/Risk diff calculation;
***********************************************************************************************;				 
%m_u_binom_odds (
				/******Dataset related parameter******/
				inds= adeff_all,/*Required*/
				whr= paramcd='TRORESPU' and OTLVBPFL='Y' and PARQUAL='INDEPENDENT ASSESSOR',/*Optional*/
				pop_flag= ittfl='Y',/*Required*/
				
				/******Analysis related parameter******/
				trtgrpn=trt01pn,/*Required*/
				trtgrp=trt01p, /*(for creating fromat automatically)*/
				trtpair=1 3,/*For 2by 2 compare,optional ie.str(1,2) or 1 2*/
				trtfmt= , /*Optional, if trtgrpn=trt01pn then will automatically create format */
				trtref= 3,/*Required*/
				strata= strat1n strat2n, /*Optional, just input strata1 strata2*/
				var= aval,/*Optional default is aval*/
				event= 1,/*Optional default=1*/
				alpha= 0.05,/*Optional default=0.05*/
				pvalside= 2,/*set the p value sided, default is 2 sided.*/
				pvdecim=2,/*Optional default=2*/
				cidecim=2,/*Optional default=2*/
				
				/******Relative risk/risk diff related parameter******/
				relcal=Y,/*Default is N, use Y to get relative risk calculation.*/
				cltype=, /*Optional defaulted by Miettinen-Nurminen method to calculate the CI*/
				supds=,/*Optional for creating dummy dataset when some treatment or aval is 0*/
				/*Output and debug related parameter*/
				missval=NE,/*NR,NE,NA. default is NA*/
				
				/******Dataset and macro related parameter******/
				ord=1,/*Required*/
				debug=Y
						); 
%m_u_binom_odds (
				/*Dataset related parameter*/
				inds= adeff_all,/*Required*/
				whr= paramcd='TRORESPU' and OTLVBPFL='Y' and PARQUAL='INDEPENDENT ASSESSOR',/*Optional*/
				pop_flag= ittfl='Y',/*Required*/
				/*Analysis related parameter*/
				trtgrpn=trt01pn,/*Required*/
				trtgrp=trt01p, /*(for creating fromat automatically)*/
				trtpair=2 3,/*For 2by 2 compare,optional ie.str(1,2) or 1 2*/
				trtfmt= , /*Optional, if trtgrpn=trt01pn then will automatically create format */
				trtref= 3,/*Required*/
				strata= strat1n strat2n, /*Optional, just input strata1 strata2*/
				var= aval,/*Optional default is aval*/
				event= 1,/*Optional default=1*/
				alpha= 0.05,/*Optional default=0.05*/
				pvalside= 2,/*set the p value sided, default is 2 sided.*/
				pvdecim=2,/*Optional default=2*/
				cidecim=2,/*Optional default=2*/
				/*Relative risk/risk diff related parameter*/
				relcal=Y,/*Default is N, use Y to get relative risk calculation.*/
				cltype=, /*Optional defaulted by Miettinen-Nurminen method to calculate the CI*/
				supds=,/*Optional for creating dummy dataset when some treatment or aval is 0*/
				/*Output and debug related parameter*/
				missval=NE,/*NR,NE,NA. default is NA*/
				ord=2,/*Required*/
				debug=Y
						); 						   
***********************************************************************************************;
* Handle with the final datasets;
***********************************************************************************************;
data est_all;
	set final_est;
	subord=sub_ord;
run;
data odds_all;
	set final_odds:;
	drop col_label;
run;
data cmh_all;
	set final_cmh:;
	drop col_label;
run;
data report_all;
	merge est_all odds_all cmh_all;
	by ord subord;
run;

%m_u_col_reorg(inds=report_all,/*Get set option in this macro, rename all the colin to macro defined content and renmae col out to col1-colx*/
			  outds=report_1
				);
%m_u_col_header(inds=report_1,outds=report,collabel=col1='Group' col2='Estimate' col3='95% CI' col4='Odds ratio' col5='95% CI' col6='p-value');
***********************************************************************************************;
* Report process;
***********************************************************************************************;
%let sfx=a;
option mprint mlogic;
%istartv2(SUFFIX=a);
%m_u_report(table=report,
	lenlist=28#12#12#12#12#12,    
	justlist=l#c#c#c#c#c,
	justlist_header=l#c#c#c#c#c,
	nolblist=Y#N#N#N#N#N,
	orderlist=Y#N#N#N#N#N,
	defcol=(col1 col2 col3 col4 col5 col6),
	blank_after = ord,
    pg=18);
%istopv2;

%let output = %scan(&_exec_programname.,1,".");
data tlf.&output.&sfx.;/**/
	set report_all;
	keep col:;
run;
`,Q9e=`|                          |                                         |                   |           |                                |           |         |
                        | ------------------------ | ---------------------------------------- | ----------------- | --------- | ------------------------------ | --------- | ------- |
                        |                          | Subjects with [[objective respons etc.]] | Adjusted rate (%) |           | Comparison of treatment groups |           |         |
                        |                          |                                          |                   |           |                                |           |         |
                        | Group                    | Number (%)                               | Estimate          | <<x>>% CI | Odds ratio                     | <<x>>% CI | p-value |
                        | AZD1 <<low dose>> N=xxx  | xx (xx.x)                                | xx.x              | x.x, x.x  | x.x                            | x.x, x.x  | 0.xxx   |
                        |                          |                                          |                   |           |                                |           |         |
                        | AZD2 <<high dose>> N=xxx | xx (xx.x)                                | xx.x              | x.x, x.x  | x.x                            | x.x, x.x  | 0.xxx   |
                        | Control N=xxx            | xx (xx.x)                                | xx.x              | x.x, x.x  |                                |           |         |
                        |                         |                                          |                   |           |                                |           |         |`,Z9e=`|                    | Relative risk |            | Risk difference |            |         |
                        | ------------------ | ------------- | ---------- | --------------- | ---------- | ------- |
                        | Group              | Estimate      | <<x>>% CI  | Estimate        | <<x>>% CI  | p-value |
                        | AZD1 <<low dose>>  | xx.x          | xx.x, xx.x | xx.x            | xx.x, xx.x | 0.xxx   |
                        | N=xxx              |               |            |                 |            |         |
                        |                    |               |            |                 |            |         |
                        | AZD2 <<high dose>> | xx.x          | xx.x, xx.x | xx.x            | xx.x, xx.x | 0.xxx   |
                        | N=xxx              |               |            |                 |            |         |
                        |                    |               |            |                 |            |         |
                        | Control            |               |            |                 |            |         |
                        | N=xxx              |               |            |
                        |                   |               |            |                 |            |         |`,J9e=[{code:"rate_",table:1,cols:[1]},{code:"rate_adj",table:1,cols:[2,3]},{code:"odds",table:1,cols:[4,5,6]},{code:"cmh",table:2,cols:[1,2,3,4,5]}],eje=({theme:t})=>{const[e,r]=Y.useState(X9e),[n,i]=Y.useState(null),s=Y.useRef(null),o=h=>{r(h)},a=h=>{const d=h.state.selection.main.head,g=h.state.doc.lineAt(d).text;g.includes("binom_cp_grp")?i("rate_"):g.includes("binom_adjrate")?i("rate_adj"):g.includes("binom_odds")&&!g.includes("relcal")?i("odds"):g.includes("relcal=Y")?i("cmh"):i(null)},l=J9e.find(h=>h.code===n),u=(h,d)=>{const m=h.split(`
`);return I.jsx("table",{style:{width:"100%",fontSize:"0.85rem",borderCollapse:"collapse",marginBottom:d===1?"20px":0},children:I.jsx("tbody",{children:m.map((g,y)=>{if(!g.trim().startsWith("|"))return null;const x=g.split("|").slice(1,-1);return I.jsx("tr",{children:x.map((b,C)=>{const E=(l==null?void 0:l.table)===d&&l.cols.includes(C);return I.jsx("td",{style:{border:"1px solid #d0d7de",padding:"3px 6px",textAlign:"left",fontSize:"0.82rem",whiteSpace:"pre",fontFamily:"Balancing Simplicity",background:E?"#ffe9b3":"transparent"},children:b.trim()},C)})},y)})})})};return I.jsx(qs,{title:"AZTONCEF02 Open Code Template",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:4,alignItems:"flex-start",width:"100%"},children:[I.jsx(Bi,{sx:{flex:1,minWidth:420,maxWidth:800,p:2,bgcolor:"#fafbfc",boxShadow:2,height:"60vh",display:"flex",flexDirection:"column"},children:I.jsxs(_e,{sx:{flex:1,overflow:"auto"},children:[u(Q9e,1),u(Z9e,2)]})}),I.jsxs(Bi,{sx:{flex:1,minWidth:320,maxWidth:600,p:2,bgcolor:"#181c24",color:"#fff",boxShadow:2,display:"flex",flexDirection:"column",height:"60vh"},children:[I.jsx(pt,{variant:"subtitle1",sx:{color:"#fff",mb:1,fontWeight:600},children:"SAS Macro"}),I.jsx(_e,{sx:{flex:1,display:"flex",flexDirection:"column",overflow:"auto"},children:I.jsx(Ih,{ref:s,value:e,height:"100%",theme:"dark",extensions:[AC()],onChange:o,onUpdate:a,style:{minHeight:"400px",width:"100%",background:"#181c24",color:"#fff",fontSize:"0.92rem",borderRadius:6}})})]})]})})},U7=rn(I.jsx("path",{d:"m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83"})),$7=rn(I.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"})),tje=({theme:t})=>{const e={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2}}},r={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}};return I.jsx(qs,{title:"O-GEM Benefits",children:I.jsx(_e,{sx:{position:"relative",height:"100%",width:"100%",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:"url(/ogemsharing/images/benefits.png)",backgroundSize:"cover",backgroundPosition:"center",opacity:.5,zIndex:0}},children:I.jsx(_e,{sx:{position:"relative",zIndex:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",p:4},children:I.jsxs(_e,{component:ti.div,variants:e,initial:"hidden",animate:"visible",sx:{width:"100%",maxWidth:"1200px",display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:4},children:[I.jsx(ti.div,{variants:r,children:I.jsxs(_e,{className:"main-card float-card",sx:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:3,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.15)",transition:"transform 0.3s ease-in-out","&:hover":{transform:"translateY(-5px)"}},children:[I.jsx(_e,{className:"title-card",sx:{background:"linear-gradient(135deg, #1976d2 0%, #2196f3 100%)",p:2},children:I.jsxs(_e,{sx:{display:"flex",alignItems:"center"},children:[I.jsx(bH,{sx:{bgcolor:"rgba(255,255,255,0.2)",mr:2,width:40,height:40,boxShadow:"0 4px 14px rgba(25, 118, 210, 0.3)"},children:I.jsx(U7,{})}),I.jsx(pt,{variant:"h6",sx:{fontWeight:600,color:"white"},children:"Efficiency"})]})}),I.jsx(_e,{className:"content-card",sx:{p:3},children:I.jsx(hb,{sx:{py:1},children:["Short learning curve","Saving time for one-side TLF generation (75%)","Less coding","TLF titles and footnotes doc is easy to be maintained"].map((n,i)=>I.jsxs(zf,{sx:{py:1.2},children:[I.jsx(Uf,{sx:{minWidth:"40px"},children:I.jsx(U7,{color:"primary",fontSize:"small"})}),I.jsx($f,{primary:n,primaryTypographyProps:{fontWeight:500,fontSize:"1.05rem",color:"#2c3e50"}})]},i))})})]})}),I.jsx(ti.div,{variants:r,children:I.jsxs(_e,{className:"main-card float-card",sx:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:3,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.15)",transition:"transform 0.3s ease-in-out","&:hover":{transform:"translateY(-5px)"}},children:[I.jsx(_e,{className:"title-card",sx:{background:"linear-gradient(135deg, #2e7d32 0%, #4caf50 100%)",p:2},children:I.jsxs(_e,{sx:{display:"flex",alignItems:"center"},children:[I.jsx(bH,{sx:{bgcolor:"rgba(255,255,255,0.2)",mr:2,width:40,height:40,boxShadow:"0 4px 14px rgba(46, 125, 50, 0.3)"},children:I.jsx($7,{})}),I.jsx(pt,{variant:"h6",sx:{fontWeight:600,color:"white"},children:"Compliance"})]})}),I.jsx(_e,{className:"content-card",sx:{p:3},children:I.jsx(hb,{sx:{py:1},children:["Standardized datasets for QC","Adherence to AZSOL","Following naming convention standard for TLFs"].map((n,i)=>I.jsxs(zf,{sx:{py:1.2},children:[I.jsx(Uf,{sx:{minWidth:"40px"},children:I.jsx($7,{color:"success",fontSize:"small"})}),I.jsx($f,{primary:n,primaryTypographyProps:{fontWeight:500,fontSize:"1.05rem",color:"#2c3e50"}})]},i))})})]})})]})})})},"ogem-benefits")},rje=rn(I.jsx("path",{d:"M9.19 6.35c-2.04 2.29-3.44 5.58-3.57 5.89L2 10.69l4.05-4.05c.47-.47 1.15-.68 1.81-.55zM11.17 17s3.74-1.55 5.89-3.7c5.4-5.4 4.5-9.62 4.21-10.57-.95-.3-5.17-1.19-10.57 4.21C8.55 9.09 7 12.83 7 12.83zm6.48-2.19c-2.29 2.04-5.58 3.44-5.89 3.57L13.31 22l4.05-4.05c.47-.47.68-1.15.55-1.81zM9 18c0 .83-.34 1.58-.88 2.12C6.94 21.3 2 22 2 22s.7-4.94 1.88-6.12C4.42 15.34 5.17 15 6 15c1.66 0 3 1.34 3 3m4-9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2"})),nje=rn(I.jsx("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"})),ije=rn(I.jsx("path",{d:"M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5s-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20zm-6 8h-4v-2h4zm0-4h-4v-2h4z"})),sje=({icon:t,title:e,description:r,delay:n,theme:i,isLast:s})=>I.jsxs(_e,{sx:{position:"relative",width:"100%"},children:[I.jsx(ti.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.6,delay:n,type:"spring",stiffness:100},style:{width:"100%"},children:I.jsx(Bi,{elevation:4,sx:{p:3,background:"#fff",borderRadius:3,position:"relative",overflow:"hidden",border:"2px solid #e0e0e0",fontFamily:'"Comic Sans MS", cursive',transform:"rotate(-1deg)","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"6px",background:`linear-gradient(90deg, ${i.palette.primary.main}, ${i.palette.secondary.main})`},"&:hover":{transform:"rotate(0deg) scale(1.02)",transition:"all 0.3s ease"}},children:I.jsxs(_e,{sx:{display:"flex",alignItems:"flex-start",gap:2.5},children:[I.jsx(_e,{sx:{color:i.palette.primary.main,backgroundColor:`${i.palette.primary.main}15`,padding:1.5,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center","& > svg":{fontSize:"2.5rem"}},children:t}),I.jsxs(_e,{children:[I.jsx(pt,{variant:"h6",sx:{fontWeight:700,mb:1,color:i.palette.primary.main,fontSize:"1.3rem",fontFamily:'"Comic Sans MS", cursive'},children:e}),I.jsx(pt,{variant:"body1",sx:{color:"#555",fontSize:"1rem",lineHeight:1.5,fontFamily:'"Comic Sans MS", cursive'},children:r})]})]})})}),!s&&I.jsx(_e,{sx:{position:"absolute",left:"50%",bottom:-40,width:"2px",height:40,background:`linear-gradient(to bottom, ${i.palette.primary.main}, ${i.palette.secondary.main})`,transform:"translateX(-50%)","&::before":{content:'""',position:"absolute",bottom:0,left:"50%",transform:"translateX(-50%)",width:"10px",height:"10px",borderRadius:"50%",background:i.palette.secondary.main}}})]}),oje=({theme:t})=>{const e=[{icon:I.jsx(rje,{}),title:"Release Version 2.0",description:"Launching the next version of o-gem with enhanced features and improved performance"},{icon:I.jsx(nje,{}),title:"Support Efficacy Figures",description:"Adding macros for figures and listings in efficacy part to enhance data visualization"},{icon:I.jsx(ije,{}),title:"Continuous Improvement",description:"Keep identifying and addressing gaps and bugs through user feedback and reviews"}];return I.jsx(qs,{title:"Our Journey Ahead",children:I.jsx(ti.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:I.jsxs(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:6,pt:3,px:{xs:2,md:6},height:"100%",position:"relative",maxWidth:800,mx:"auto"},children:[I.jsx(_e,{sx:{position:"absolute",top:"10%",right:"5%",width:"300px",height:"300px",background:`radial-gradient(circle, ${t.palette.primary.main}20, transparent 70%)`,borderRadius:"50%",filter:"blur(60px)",zIndex:0}}),I.jsx(_e,{sx:{position:"absolute",bottom:"15%",left:"5%",width:"250px",height:"250px",background:`radial-gradient(circle, ${t.palette.secondary.main}20, transparent 70%)`,borderRadius:"50%",filter:"blur(50px)",zIndex:0}}),I.jsx(_e,{sx:{display:"flex",flexDirection:"column",gap:6,width:"100%",zIndex:1,position:"relative","&::before":{content:'""',position:"absolute",left:"50%",top:0,bottom:0,width:"2px",background:`linear-gradient(to bottom, ${t.palette.primary.main}, ${t.palette.secondary.main})`,transform:"translateX(-50%)",zIndex:-1}},children:e.map((r,n)=>I.jsx(sje,{icon:r.icon,title:r.title,description:r.description,delay:n*.3,theme:t,isLast:n===e.length-1},r.title))})]})})},"future-plans")},aje=rn([I.jsx("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),I.jsx("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")]),lje=rn(I.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92"})),cje=({theme:t})=>I.jsx(qs,{title:"Q&A and Thanks",children:I.jsxs(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:"2rem"},children:[I.jsx(ti.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.7},children:I.jsx(pt,{variant:"h3",sx:{fontWeight:700,mb:4,textAlign:"center",background:`linear-gradient(135deg, ${t.palette.primary.main}, ${t.palette.secondary.main})`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Questions & Answers"})}),I.jsx(ti.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.7,delay:.3},children:I.jsx(pt,{variant:"h4",sx:{fontWeight:600,mb:3,textAlign:"center",color:t.palette.text.primary},children:"Thank You!"})}),I.jsx(ti.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.7,delay:.6},children:I.jsxs(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:3},children:[I.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:1},children:[I.jsx(lje,{sx:{color:t.palette.primary.main}}),I.jsx(pt,{variant:"h6",sx:{color:t.palette.text.secondary},children:"Visit O-GEM:"}),I.jsx(qE,{href:"https://azcollaboration.sharepoint.com/sites/O-GEM2/SitePages/CollabHome.aspx",target:"_blank",sx:{color:t.palette.primary.main,textDecoration:"none",fontWeight:600,"&:hover":{textDecoration:"underline"}},children:"O-GEM Collaboration Site"})]}),I.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:1},children:[I.jsx(aje,{sx:{color:t.palette.primary.main}}),I.jsx(pt,{variant:"h6",sx:{color:t.palette.text.secondary},children:"User Manual:"}),I.jsx(qE,{href:"https://glowing-broccoli-63jkjyr.pages.github.io/",target:"_blank",sx:{color:t.palette.primary.main,textDecoration:"none",fontWeight:600,"&:hover":{textDecoration:"underline"}},children:"O-GEM Documentation"})]}),I.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:1},children:[I.jsx(DG,{sx:{color:t.palette.primary.main}}),I.jsx(pt,{variant:"h6",sx:{color:t.palette.text.secondary},children:"Support Email:"}),I.jsx(qE,{href:"mailto:o365groups-ogem@AZCollaboration.onmicrosoft.com",sx:{color:t.palette.primary.main,textDecoration:"none",fontWeight:600,"&:hover":{textDecoration:"underline"}},children:"o365groups-ogem@AZCollaboration.onmicrosoft.com"})]})]})})]})},"last-section");function uje(){const[t,e]=Y.useState(0),r=$a(),n=[I.jsx(hge,{theme:r},"title"),I.jsx(mge,{theme:r},"overview-tlf-process"),I.jsx(h3e,{theme:r},"onco-core-efficacy-tables"),I.jsx(d3e,{theme:r},"ogem-efficacy-macros"),I.jsx(FVe,{theme:r},"ogem-code-demo"),I.jsx(HVe,{theme:r},"aztoncef04"),I.jsx(B9e,{theme:r},"aztoncef04display"),I.jsx(z9e,{theme:r},"aztoncef04open"),I.jsx(U9e,{theme:r},"aztoncef02"),I.jsx(K9e,{theme:r},"aztoncef02adisplay"),I.jsx(eje,{theme:r},"aztoncef02open"),I.jsx(tje,{theme:r},"ogem-benefits"),I.jsx(oje,{theme:r},"future-plans"),I.jsx(cje,{theme:r},"last-section")],i=()=>{t<n.length-1&&e(t+1)},s=()=>{t>0&&e(t-1)},o=a=>{e(a)};return I.jsx(lge,{totalSlides:n.length,currentSlide:t,onNextSlide:i,onPrevSlide:s,onGoToSlide:o,children:n[t]})}const fje=kS({palette:{primary:{main:"#fa7aab",light:"#ffaec7",dark:"#d04e7d",contrastText:"#FFFFFF"},secondary:{main:"#7852A9",light:"#9D7BC1",dark:"#533C76",contrastText:"#FFFFFF"},error:{main:"#D32F2F"},warning:{main:"#FFC107"},info:{main:"#0288D1"},success:{main:"#388E3C"},background:{default:"#FFFFFF",paper:"#F5F5F5"},text:{primary:"#333333",secondary:"#616161"}},typography:{fontFamily:'"Montserrat", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:700},h2:{fontSize:"2rem",fontWeight:700},h3:{fontSize:"1.75rem",fontWeight:600},h4:{fontSize:"1.5rem",fontWeight:600},h5:{fontSize:"1.25rem",fontWeight:500},h6:{fontSize:"1rem",fontWeight:500},body1:{fontSize:"1rem"},body2:{fontSize:"0.875rem"}},components:{MuiButton:{styleOverrides:{root:{borderRadius:"4px",textTransform:"none",fontWeight:600}}},MuiCard:{styleOverrides:{root:{borderRadius:"8px",boxShadow:"0px 2px 10px rgba(0, 0, 0, 0.08)"}}}}});bie.createRoot(document.getElementById("root")).render(I.jsx(Kt.StrictMode,{children:I.jsxs(jae,{theme:fje,children:[I.jsx(qae,{}),I.jsx(uje,{})]})}))});export default hje();
